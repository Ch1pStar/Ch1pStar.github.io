{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 334725b5c6feccd92c81","webpack:///./entry-6bcc5e05e02d437da7a3a29e427fb69b66c782032c816c62c84036e96df5027d.js","webpack:///./plugins/core/src/index.js","webpack:///./plugins/core/src/ecs/index.js","webpack:///./plugins/core/src/ecs/SelfRenderComponent.js","webpack:///./plugins/core/src/ecs/SelfRenderSystem.js","webpack:///./plugins/core/src/ecs/System.js","webpack:///./~/@fae/ecs/dist/ecs.js","webpack:///./plugins/core/src/render/Renderer.js","webpack:///./~/mini-signals/lib/mini-signals.js","webpack:///./plugins/core/src/gl/GLContext.js","webpack:///./plugins/core/src/gl/GLProgramCache.js","webpack:///./plugins/core/src/render/RenderTarget.js","webpack:///./plugins/core/src/gl/GLFramebuffer.js","webpack:///./plugins/core/src/gl/GLTexture.js","webpack:///./plugins/core/src/debug.js","webpack:///./plugins/core/src/math/Vector2d.js","webpack:///./plugins/core/src/math/Matrix2d.js","webpack:///./plugins/shapes/src/index.js","webpack:///./plugins/shapes/src/BoundingBox.js","webpack:///./plugins/shapes/src/Rectangle.js","webpack:///./plugins/shapes/src/BoundsComponent.js","webpack:///./plugins/shapes/src/Polygon.js","webpack:///./plugins/shapes/src/SpriteBoundsComponent.js","webpack:///./plugins/core/src/util/Color.js","webpack:///./plugins/core/src/render/RenderState.js","webpack:///./plugins/core/src/util/Flags.js","webpack:///./plugins/core/src/render/ObjectRenderer.js","webpack:///./plugins/core/src/util/index.js","webpack:///./plugins/core/src/util/Buffer.js","webpack:///./plugins/core/src/util/BlendMode.js","webpack:///./plugins/core/src/ecs/VisibilityComponent.js","webpack:///./plugins/core/src/ecs/Entity.js","webpack:///./plugins/core/src/gl/index.js","webpack:///./plugins/core/src/gl/GLBuffer.js","webpack:///./plugins/core/src/gl/GLQuad.js","webpack:///./plugins/core/src/gl/GLVertexArrayObject.js","webpack:///./~/ismobilejs/isMobile.js","webpack:///./plugins/core/src/gl/GLShader.js","webpack:///./plugins/core/src/gl/GLData.js","webpack:///./plugins/core/src/math/index.js","webpack:///./plugins/core/src/render/index.js","webpack:///./plugins/core/src/render/Shader.js","webpack:///./plugins/filters/src/index.js","webpack:///./plugins/filters/src/Filter.js","webpack:///./plugins/filters/src/default.vert","webpack:///./plugins/filters/src/FilterComponent.js","webpack:///./plugins/filters/src/FilterPrepareSystem.js","webpack:///./plugins/filters/src/FilterUtils.js","webpack:///./~/bit-twiddle/twiddle.js","webpack:///./plugins/filters/src/FilterRenderSystem.js","webpack:///./plugins/filters-pack/src/index.js","webpack:///./plugins/filters-pack/src/noise/NoiseFilter.js","webpack:///./plugins/filters-pack/src/noise/noise.frag","webpack:///./plugins/filters-pack/src/blur/BlurFilter.js","webpack:///./plugins/filters-pack/src/blur/BlurXFilter.js","webpack:///./plugins/filters-pack/src/blur/blurUtil.js","webpack:///./plugins/filters-pack/src/blur/blur.vert","webpack:///./plugins/filters-pack/src/blur/blur.frag","webpack:///./plugins/filters-pack/src/blur/BlurYFilter.js","webpack:///./plugins/filters-pack/src/fxaa/FXAAFilter.js","webpack:///./plugins/filters-pack/src/fxaa/fxaa.vert","webpack:///./plugins/filters-pack/src/fxaa/fxaa.frag","webpack:///./plugins/interaction/src/index.js","webpack:///./plugins/interaction/src/InteractionComponent.js","webpack:///./plugins/interaction/src/InteractionSystem.js","webpack:///./plugins/interaction/src/Pointer.js","webpack:///./plugins/sprites/src/index.js","webpack:///./plugins/sprites/src/Sprite.js","webpack:///./plugins/transform/src/index.js","webpack:///./plugins/transform/src/Transform.js","webpack:///./plugins/transform/src/TransformComponent.js","webpack:///./plugins/transform/src/TransformUpdateSystem.js","webpack:///./plugins/textures/src/index.js","webpack:///./plugins/textures/src/Texture.js","webpack:///./plugins/textures/src/TextureSource.js","webpack:///./plugins/textures/src/TextureUVs.js","webpack:///./plugins/textures/src/TextureComponent.js","webpack:///./plugins/sprites/src/SpriteComponent.js","webpack:///./plugins/sprites/src/SpriteRenderer.js","webpack:///./plugins/sprites/src/shader/multi-texture.vert","webpack:///./plugins/sprites/src/shader/multi-texture.frag","webpack:///./plugins/sprites/src/SpriteRenderSystem.js","webpack:///./plugins/text-canvas/src/index.js","webpack:///./plugins/text-canvas/src/CanvasTextWriter.js","webpack:///./plugins/text-canvas/src/CanvasTextStyle.js","webpack:///./~/core-js/fn/object/assign.js","webpack:///./~/core-js/modules/es6.object.assign.js","webpack:///./~/core-js/modules/_export.js","webpack:///./~/core-js/modules/_global.js","webpack:///./~/core-js/modules/_core.js","webpack:///./~/core-js/modules/_hide.js","webpack:///./~/core-js/modules/_object-dp.js","webpack:///./~/core-js/modules/_an-object.js","webpack:///./~/core-js/modules/_is-object.js","webpack:///./~/core-js/modules/_ie8-dom-define.js","webpack:///./~/core-js/modules/_descriptors.js","webpack:///./~/core-js/modules/_fails.js","webpack:///./~/core-js/modules/_dom-create.js","webpack:///./~/core-js/modules/_to-primitive.js","webpack:///./~/core-js/modules/_property-desc.js","webpack:///./~/core-js/modules/_redefine.js","webpack:///./~/core-js/modules/_has.js","webpack:///./~/core-js/modules/_uid.js","webpack:///./~/core-js/modules/_ctx.js","webpack:///./~/core-js/modules/_a-function.js","webpack:///./~/core-js/modules/_object-assign.js","webpack:///./~/core-js/modules/_object-keys.js","webpack:///./~/core-js/modules/_object-keys-internal.js","webpack:///./~/core-js/modules/_to-iobject.js","webpack:///./~/core-js/modules/_iobject.js","webpack:///./~/core-js/modules/_cof.js","webpack:///./~/core-js/modules/_defined.js","webpack:///./~/core-js/modules/_array-includes.js","webpack:///./~/core-js/modules/_to-length.js","webpack:///./~/core-js/modules/_to-integer.js","webpack:///./~/core-js/modules/_to-index.js","webpack:///./~/core-js/modules/_shared-key.js","webpack:///./~/core-js/modules/_shared.js","webpack:///./~/core-js/modules/_enum-bug-keys.js","webpack:///./~/core-js/modules/_object-gops.js","webpack:///./~/core-js/modules/_object-pie.js","webpack:///./~/core-js/modules/_to-object.js"],"names":["filters","filters_pack","interaction","shapes","sprites","text_canvas","textures","transform","ecs","glutil","math","render","util","debug","default","SelfRenderComponent","Base","SelfRenderSystem","renderer","priority","defaultPriority","frequency","test","entity","hasComponent","update","elapsed","addDefaultSystem","PRIORITY","RENDER","System","USER","destroy","PLUGIN","defaultSystems","Renderer","context","options","gl","nodeName","create","uid","clearBeforeRender","preserveDrawingBuffer","onContextLost","onContextRestored","onContextChange","onBeforeRender","onAfterRender","emptyRenderer","activeObjectRenderer","state","screen","_boundOnContextLost","_onContextLost","bind","_boundOnContextRestored","_onContextRestored","canvas","addEventListener","_initContext","i","length","system","addSystem","push","removeDefaultSystem","idx","indexOf","skipSort","sortSystems","addEntity","sortEntities","systems","sort","compareSystemsPriority","entities","compareRenderPriority","target","clear","isContextLost","dispatch","setRenderTarget","start","stop","setActiveObjectRenderer","objectRenderer","removeEventListener","detachAll","getExtension","loseContext","reset","width","height","defaultScaleMode","event","preventDefault","a","b","renderPriority","renderGroupHint","getContext","Error","PROGRAM_CACHE","get","key","set","program","vsrc","fsrc","RenderTarget","scaleMode","root","framebuffer","clearColor","BLACK","clone","size","projectionMatrix","defaultFrame","destinationFrame","sourceFrame","createRGBA","WebGLRenderingContext","NEAREST","texture","enableNearestScaling","enableLinearScaling","setFrame","resize","color","r","g","activate","calculateProjection","multiply","equals","enable","SCISSOR_TEST","scissor","x","y","disable","viewport","pm","identity","d","tx","ty","Math","floor","projectionFrame","LINEAR","GLFramebuffer","createFramebuffer","stencil","createFloat32","data","fromData","enableWrapClamp","fbo","enableTexture","unbind","framebufferTexture2D","FRAMEBUFFER","COLOR_ATTACHMENT0","TEXTURE_2D","enableStencil","createRenderbuffer","bindRenderbuffer","RENDERBUFFER","framebufferRenderbuffer","DEPTH_STENCIL_ATTACHMENT","renderbufferStorage","DEPTH_STENCIL","COLOR_BUFFER_BIT","bindFramebuffer","uploadData","deleteFramebuffer","FLOATING_POINT_AVAILABLE","lastBoundTextureId","GLTexture","format","RGBA","type","UNSIGNED_BYTE","createTexture","mipmap","premultiplyAlpha","fromSource","source","upload","videoWidth","videoHeight","pixelStorei","UNPACK_PREMULTIPLY_ALPHA_WEBGL","texImage2D","Float32Array","ext","FLOAT","location","activeTexture","TEXTURE0","bindTexture","minFilter","linear","texParameteri","TEXTURE_MIN_FILTER","LINEAR_MIPMAP_LINEAR","NEAREST_MIPMAP_NEAREST","magFilter","TEXTURE_MAG_FILTER","enableMipmap","generateMipmap","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","enableWrapRepeat","REPEAT","enableWrapMirrorRepeat","MIRRORED_REPEAT","isTexture","deleteTexture","ASSERT","bool","message","EPSILON","Vector2d","copy","add","subtract","divide","ceil","min","max","round","scale","scaleAndAdd","distance","sqrt","squaredDistance","squaredLength","negate","inverse","normalize","len","dot","lerp","t","random","PI","cos","sin","transformMatrix2d","m","c","toString","exactEquals","a0","a1","b0","b1","abs","LENGTH","BYTE_SIZE","BYTES_PER_ELEMENT","Matrix2d","_mat3","toMat3Array","transpose","out","invert","aa","ab","ac","ad","atx","aty","det","determinant","o","rotate","rad","a2","a3","s","translate","frob","pow","multiplyScalar","multiplyScalarAndAdd","a4","a5","b2","b3","b4","b5","valid","isNaN","Infinity","BoundingBox","_empty","addChild","bounds","union","addQuad","vertices","minX","minY","maxX","right","maxY","bottom","addVertices","offset","endOffset","matrix","worldTransform","rawX","rawY","wight","Rectangle","isEmpty","rectangle","contains","rect","intersection","widthR","inflate","dx","dy","fit","v","EMPTY","BoundsComponent","arguments","_bounds","getBounds","_updateBounds","Polygon","points","Array","isArray","p","closed","slice","close","inside","j","xi","yi","xj","yj","intersect","polygon","SpriteBoundsComponent","visible","_texture","ready","trim","orig","vertexData","wt","w0","_anchorX","w1","h0","_anchorY","h1","rgxRgbString","rgxHexShortString","rgxHexFullString","Color","normalized","_red","_green","_blue","fromRgb","num","rgb","fromArray","components","red","green","blue","fromString","str","firstChars","substring","values","exec","parseFloat","replace","parseInt","randomColor","randomize","mix","denormalize","_tempColor","factor","WHITE","RED","GREEN","BLUE","RenderState","stateFlags","defaultStateFlags","blendMode","shader","nativeVaoExtension","setBlendMode","mode","force","equal","setShader","uniforms","uProjectionMatrix","useProgram","enableBlend","enabled","FLAG","BLEND","enableDepthTest","DEPTH_TEST","enableCullFace","CULL_FACE","enableFrontFace","FRONT_FACE","flag","is","frontFace","CW","CCW","FLAG_GL_MAP","bindVertexArrayOES","UNPACK_FLIP_Y_WEBGL","Object","keys","forEach","k","isSet","F","Flags","initialValue","value","on","isUnset","flags","n","ObjectRenderer","object","error","log","removeElements","getMaxIfStatmentsInShader","nextUid","args","array","startIdx","removeCount","newLength","ifCheckShaderTemplate","maxIfs","createTempContext","tinyCanvas","document","createElement","createShader","FRAGMENT_SHADER","guess","result","testMaxIf","fragmentSrc","generateIfTestSrc","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","src","Buffer","parentBufferOrSize","_buffer","ArrayBuffer","buffer","bytesLength","byteLength","view32Length","bytes","Uint8Array","float32View","uint32View","Uint32Array","__isBuffer","isBuffer","BlendMode","sfactor","dfactor","equation","blendFunc","blendEquation","NORMAL","ONE","ONE_MINUS_SRC_ALPHA","FUNC_ADD","ADD","DST_ALPHA","SUBTRACT","FUNC_SUBTRACT","MULTIPLY","DST_COLOR","EXCLUSION","ONE_MINUS_DST_COLOR","ONE_MINUS_SRC_COLOR","VisibilityComponent","alpha","worldAlpha","Entity","GLData","EMPTY_ARRAY_BUFFER","GLBuffer","ARRAY_BUFFER","drawType","STATIC_DRAW","createBuffer","createVertexBuffer","createIndexBuffer","ELEMENT_ARRAY_BUFFER","dontBind","bufferSubData","bufferData","bindBuffer","deleteBuffer","GLQuad","uvs","interleaved","syncData","indices","createIndices","vertexBuffer","indexBuffer","vao","numQuads","totalIndices","Uint16Array","initVao","setIndexBuffer","addAttribute","attributes","aVertexPosition","aTextureCoord","ix","vx","map","targetTextureFrame","draw","TRIANGLES","GLVertexArrayObject","maxAttribs","getParameter","MAX_VERTEX_ATTRIBS","nativeVao","tempAttribState","attribState","dirty","FORCE_NO_NATIVE","createVertexArrayOES","lastBuffer","attrib","attribute","setup","setVertexAttribArrays","stride","drawElements","UNSIGNED_SHORT","deleteVertexArrayOES","tablet","phone","attribs","enableVertexAttribArray","disableVertexAttribArray","GLShader","vertexSrc","recompile","compileProgram","forceCompile","cacheKey","cachedProgram","glVertShader","VERTEX_SHADER","glFragShader","createProgram","attachShader","linkProgram","getProgramParameter","LINK_STATUS","VALIDATE_STATUS","getError","getProgramInfoLog","deleteProgram","deleteShader","getShaderInfoLog","extractAttributes","totalAttributes","ACTIVE_ATTRIBUTES","attribData","getActiveAttrib","name","getAttribLocation","attributeSetupFunction","extractUniforms","totalUniforms","ACTIVE_UNIFORMS","uniformData","getActiveUniform","getUniformLocation","generateUniformAccessObject","__data","uniformKeys","fullName","nameTokens","split","uniformGroup","getUniformGroup","uniform","Reflect","defineProperty","enumerable","loc","vertexAttribPointer","cur","getUniformDefault","GL_SIZE_MAP","FLOAT_VEC2","FLOAT_VEC3","FLOAT_VEC4","INT","INT_VEC2","INT_VEC3","INT_VEC4","BOOL","BOOL_VEC2","BOOL_VEC3","BOOL_VEC4","FLOAT_MAT2","FLOAT_MAT3","FLOAT_MAT4","SAMPLER_2D","GL_SETTER","uniform1f","uniform2f","uniform3f","uniform4f","uniform1i","uniform2i","uniform3i","uniform4i","uniformMatrix2fv","uniformMatrix3fv","uniformMatrix4fv","GL_ARRAY_SETTER","uniform1fv","uniform2fv","uniform3fv","uniform4fv","uniform1iv","uniform2iv","uniform3iv","uniform4iv","Int32Array","booleanArray","Shader","checkPrecision","_onContextChangeBinding","PRECISION","DEFAULT","LOW","MEDIUM","HIGH","lines","commentOpen","line","reservedUniforms","Filter","defaultVertexSrc","generateValueProperties","run","input","output","drawFilter","syncUniforms","textureCount","getGlTexture","toArray","val","require","FilterComponent","filterArea","FilterPrepareSystem","initialRenderTarget","activeRenderTarget","activeBounds","activeSize","_renderTargetPool","freeRenderTarget","nextPow2","getRenderTarget","renderTarget","pop","FilterRenderSystem","quad","_onContextChange","filter","activeFilters","flip","flop","_setAutomaticUniforms","uFilterArea","area","uFilterClamp","clamp","fragSrc","NoiseFilter","uNoise","BlurFilter","blurXFilter","blurYFilter","numPasses","strength","BlurXFilter","kernelSize","uBlurValues","uStrength","getFragSource","getVertSource","getMaxKernelSize","GAUSSIAN_VALUES","vertTemplate","fragTemplate","isHorizontal","maxVaryings","MAX_VARYING_VECTORS","BlurYFilter","tapLevel","vertSrc","FXAAFilter","InteractionComponent","onDown","onUp","onUpOutside","onMove","onCancel","onScroll","onClick","onHoverStart","onHoverEnd","hitTest","tempCoords","InteractionSystem","Number","MAX_SAFE_INTEGER","pointers","_boundHandleEvent","handleEvent","_eventsBound","convertClientToWorld","dom","getBoundingClientRect","left","top","pass","bindEvents","window","PointerEvent","unbindEvents","changedTouches","touch","pointer","_getPointer","worldCoords","clientX","clientY","hitObject","EVENT_CALL_MAP","initialize","dispose","interactions","onInteraction","pointerId","identifier","id","EMPTY_ARRAY","Pointer","TYPE","UNKNOWN","hoverTarget","scrollTarget","button","buttons","altKey","ctrlKey","metaKey","shiftKey","pressure","deltaX","deltaY","worldX","worldY","scrollDeltaX","scrollDeltaY","scrollDeltaZ","isDown","isHovering","_set","end","move","cancel","wasDown","wasHovering","scroll","deltaZ","calcDelta","pointerType","MOUSE","TOUCH","radiusX","radiusY","PEN","mousedown","touchstart","pointerdown","mouseup","touchend","pointerup","mousemove","touchmove","pointermove","mouseout","touchcancel","pointerout","wheel","shaders","vert","frag","Sprite","_onTextureUpdateBinding","destroyTexture","tint","detach","_onTextureChange","_vertsDirty","onUpdate","_onTextureUpdate","with","Transform","parent","_wt","_lt","_position","_scale","_skew","_pivot","_rotation","_localUpdateId","_worldUpdateId","_cachedLocalUpdateId","_cachedWorldUpdateId","_sr","_cr","_cy","_sy","_sx","_cx","invalidate","lt","pt","IDENTITY","TransformComponent","_cachedTransformUpdateId","TransformUpdateSystem","Texture","frame","rotation","_explicitFrame","_frame","_uvs","_onSourceUpdateBinding","_onSourceReadyBinding","_onSourceUpdate","onReady","once","_onSourceReady","destroySource","baseTexture","_updateUVs","_noop","TextureSource","wrapMode","defaultWrapMode","defaultMipMap","premultipliedAlpha","isPowerOfTwo","onError","_source","_updateLoop","_glTextures","_enabled","_id","_boundOnSourceLoad","_onSourceLoad","_boundOnSourceError","_onSourceError","_boundOnSourcePlay","_onSourcePlay","_boundOnSourceStop","_onSourceStop","_boundVideoUpdateLoop","_videoUpdateLoop","_onContextChangeBindings","w","silent","naturalWidth","naturalHeight","isPow2","_update","currentTime","paused","ended","_dispose","glTexture","_unbindSourceEvents","_load","_bindSourceEvents","complete","setTimeout","cancelAnimationFrame","requestAnimationFrame","loadOnly","TextureUVs","x0","y0","x1","y1","x2","y2","x3","y3","uvsUint32","baseFrame","tw","th","cx","cy","sr","cr","TextureComponent","_anchorDirty","SpriteComponent","vertSource","TICK","SpriteRenderer","vertSize","vertByteSize","DEFAULT_SPRITE_BATCH_SIZE","buffers","viewSize","currentIndex","groups","blend","startNumVaos","vertexBuffers","vaos","vertexCount","_maxTextures","_onBeforeRenderBinding","_onBeforeRender","flush","np2","log2","index","nextTexture","currentTexture","groupCount","currentGroup","sprite","bgr","textureId","_createVao","group","groupTextureCount","generateMultiTextureShader","_destroyGlObjects","_buffersMem","MAX_TEXTURE_IMAGE_UNITS","MAX_TEXTURE_COUNT","maxVaos","vbuffer","STREAM_DRAW","aColor","aTextureId","ctxRestore","maxTextures","fragSource","generateSampleSrc","sampleValues","uSamplers","SpriteRenderSystem","spriteRenderer","hasComponents","clean","calculateVertices","rgxNewline","CanvasTextWriter","autoSize","_textCtx","write","text","style","defaultStyle","ctx","outputText","wordWrap","_wordWrap","font","getFontString","strokeStyle","stroke","lineWidth","strokeThickness","textBaseline","lineJoin","miterLimit","fillStyle","getFillStyle","shadowBlur","shadowColor","shadowOffsetX","shadowOffsetY","lineWidths","fontProperties","_determineFontProperties","maxLineWidth","measureText","letterSpacing","dsSize","dropShadow","dropShadowDistance","padd","padding","fntLineHeight","fontSize","lineHeight","clearRect","linePositionX","linePositionY","ascent","align","_drawText","fontStyle","fontPropertiesCache","properties","fontPropertiesCanvas","fontPropertiesContext","testText","mwidth","baseline","fillRect","fillText","imagedata","getImageData","descent","wordWrapWidth","words","spaceLeft","wordWidth","breakWords","characters","characterWidth","wordWidthWithSpace","isStroke","strokeText","char","CanvasTextStyle","fillGradientVertical","fontFamily","fontVariant","fontWeight","fontSizeString","numLines","gradient","createLinearGradient","numFills","totalStops","addColorStop"],"mappings":"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wCAAuC,uCAAuC,gBAAgB;;AAE9F;AACA;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,wCAAuC,uCAAuC,gBAAgB;;AAE9F,mDAAkD,0CAA0C,0DAA0D,EAAE;;AAExJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;;AAEA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;;AAEA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAgB,OAAO;AACvB,kBAAiB,OAAO;AACxB;;;AAGA;AACA,yBAAwB,0BAA0B;AAClD;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,iBAAgB,OAAO;AACvB;;;AAGA;AACA;;AAEA;;AAEA;AACA,yBAAwB,yBAAyB;AACjD;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAgB,OAAO;AACvB,kBAAiB,OAAO;AACxB;;;AAGA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,iBAAgB,OAAO;AACvB;;;AAGA;AACA;AACA;;AAEA;AACA,yBAAwB,0BAA0B;AAClD;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAgB,OAAO;AACvB;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA,yBAAwB,0BAA0B;AAClD;;AAEA,6BAA4B,2BAA2B;AACvD;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,GAAE;;AAEF;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,YAAW;AACX;;AAEA;AACA;AACA;AACA;AACA;AACA,eAAc,EAAE;AAChB;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,wCAAuC,uCAAuC,gBAAgB;;AAE9F,mDAAkD,0CAA0C,0DAA0D,EAAE;;AAExJ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAgB,oBAAoB;AACpC;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;;AAEA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;;AAEA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB,aAAa;AAC7B,kBAAiB,UAAU;AAC3B;;;AAGA;AACA,+EAA8E,aAAa;AAC3F;AACA;;AAEA;AACA;AACA,yBAAwB,uBAAuB;AAC/C;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,iBAAgB,OAAO;AACvB;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,iBAAgB,OAAO;AACvB;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,GAAE;;AAEF;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,aAAa;AACzB,cAAa,UAAU;AACvB;AACA;AACA,8EAA6E,eAAe;AAC5F;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,OAAM;;AAEN;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,wBAAuB;AACvB,sBAAqB,uBAAuB,SAAS,IAAI;AACzD,KAAI;AACJ,GAAE;AACF;AACA;AACA;AACA;AACA,GAAE;;AAEF;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAE;AACF;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2DAA0D;AAC1D;AACA,OAAM;AACN;AACA,wBAAuB,iCAAiC;AACxD,OAAM;AACN,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gEAA+D,8BAA8B;AAC7F;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,4DAA2D,gBAAgB;;AAE3E;AACA;AACA;AACA,sBAAqB,oBAAoB;;AAEzC,4CAA2C,oBAAoB;;AAE/D;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,KAAI;AACJ,0BAAyB,eAAe,EAAE;AAC1C,0BAAyB,gBAAgB;AACzC,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA,sDAAqD,KAAK,QAAQ,iCAAiC;AACnG,GAAE;AACF;AACA,iDAAgD;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,yCAAwC;;AAExC,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA,yBAAwB;AACxB;AACA;AACA;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,mCAAkC,QAAQ,gBAAgB,UAAU,GAAG;AACvE,GAAE;;AAEF,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,uFAAsF,uBAAuB;AAC7G,qEAAoE;AACpE,kEAAiE;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe;AACf,gBAAe;AACf,gBAAe;AACf,gBAAe;AACf,iBAAgB;AAChB,iBAAgB;AAChB,iBAAgB;AAChB,kBAAiB;AACjB;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA,+BAA8B;AAC9B,uCAAsC;;AAEtC,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAE;AACF;AACA;AACA;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI,UAAU;AACd;AACA;AACA;AACA;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA,4FAA2F,gBAAgB,UAAU,GAAG;AACxH,GAAE;;AAEF,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA,GAAE;AACF;AACA,GAAE;;AAEF,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAkD;AAClD,GAAE;AACF;AACA,uBAAsB;AACtB;AACA,WAAU;AACV,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,qDAAoD;AACpD;AACA,yCAAwC;AACxC;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,oEAAmE,+BAA+B;AAClG;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,4DAA2D,sBAAsB;AACjF,kFAAiF,sBAAsB;AACvG;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA,mBAAkB;;AAElB;AACA;AACA;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM,WAAW,eAAe;AAChC;AACA,OAAM;AACN;AACA;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,6DAA4D;AAC5D;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA,gBAAe;;AAEf,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,+BAA8B;AAC9B;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA8B;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;;;AAGA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,oBAAmB;;AAEnB;AACA;;AAEA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;;;AAGA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAI,UAAU;AACd;AACA;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,2BAA0B,kBAAkB,EAAE;;AAE9C;AACA;AACA;AACA;AACA,KAAI,UAAU;AACd;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA,mDAAkD,0CAA0C,0DAA0D,EAAE;;AAExJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,eAAc,OAAO;AACrB;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;;AAEA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;;AAEA;AACA;AACA;AACA,gBAAe,OAAO;AACtB;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,GAAE;;AAEF;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA,kBAAiB,MAAM;AACvB;AACA;;AAEA;AACA;AACA;AACA,kBAAiB,aAAa;AAC9B;AACA;;AAEA;AACA;AACA;AACA,eAAc,OAAO;AACrB,eAAc,OAAO;AACrB,gBAAe,QAAQ;AACvB;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA,gBAAe,aAAa;AAC5B;AACA;AACA;AACA;AACA;;AAEA;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,EAAE;AACd,aAAY,SAAS;AACrB,cAAa,SAAS;AACtB;AACA;AACA;AACA,+CAA8C;AAC9C;AACA;;AAEA;AACA;AACA;AACA,aAAY,IAAI;AAChB,aAAY,OAAO;AACnB,aAAY,OAAO;AACnB;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA,8BAA6B,SAAS;AACtC;AACA;;AAEA;AACA;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA,mDAAkD,0CAA0C,0DAA0D,EAAE;;AAExJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAc,OAAO;AACrB;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;;AAEA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;;AAEA;AACA;AACA;AACA,eAAc,OAAO;AACrB;;;AAGA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,eAAc,OAAO;AACrB;;;AAGA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA,2DAA0D;;AAE1D;AACA;AACA;AACA;AACA;;;AAGA;AACA,qBAAoB,0BAA0B;AAC9C;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,eAAc,OAAO;AACrB,gBAAe,QAAQ;AACvB;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,eAAc,OAAO;AACrB;;;AAGA,uDAAsD;;AAEtD;AACA;AACA;AACA,eAAc,OAAO;AACrB;;;AAGA,qDAAoD;;AAEpD;AACA;AACA;AACA;AACA,eAAc,OAAO;AACrB,eAAc,OAAO;AACrB;;;AAGA,kEAAiE;;;AAGjE;AACA,GAAE;;AAEF;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA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BAA4B,cAAc;AAC1C,6BAA4B,cAAc;AAC1C;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,eAAc,OAAO;AACrB;AACA,mBAAkB,GAAG;AACrB;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;AC1MA;;AACA;;;;AACA;;;;;;;;;;;;AAEA;;;;KAIqBE,kB;;;AAEjB;;;;;;AAMA,iCAAYlrB,QAAZ,EACA;AAAA,aADsBC,QACtB,yDADkC,UAAIW,MAAJ,CAAWF,QAAX,CAAoBC,MAApB,GAA6B,GAC/D;AAAA,aADqER,SACrE,yDADiF,CACjF;;AAAA;;AAAA,sDACI,uBAAMH,QAAN,EAAgBC,QAAhB,EAA0BE,SAA1B,CADJ;;AAGI,eAAKgrB,IAAL,GAAY,IAAZ;;AAEA,eAAKrC,uBAAL,GAA+B9oB,SAAS4B,eAAT,CAAyBuL,GAAzB,CAA6B,MAAKie,gBAAlC,QAA/B;;AAEA,eAAKA,gBAAL;AAPJ;AAQC;;AAED;;;;;;;kCAKAA,gB,+BACA;AACI,aAAI,KAAKD,IAAT,EAAe,KAAKA,IAAL,CAAUrqB,OAAV;;AAEf,cAAKqqB,IAAL,GAAY,IAAI,aAAOjL,MAAX,CAAkB,KAAKlgB,QAAL,CAAcoB,EAAhC,CAAZ;;AAEA;AACH,M;;AAED;;;;;;;;kCAMAhB,I,iBAAKC,M,EACL;AACI,gBAAOA,OAAOC,YAAP,2BAAP;AACH,M;;AAED;;;;;;;kCAKAC,M,mBAAOF,M,EACP;AACI,aAAIA,OAAOvB,OAAP,CAAe8D,MAAf,KAA0B,CAA9B,EAAiC;;AAEjC;AACA,cAAK5C,QAAL,CAAcgC,oBAAd,CAAmCkC,IAAnC;;AAEA;AACA,cAAKinB,IAAL,CAAU7J,GAAV,CAAc,sBAAYmJ,kBAA1B,EAA8C,sBAAYC,YAA1D,EAAwE7f,MAAxE;;AAEA,aAAIxK,OAAOvB,OAAP,CAAe8D,MAAf,KAA0B,CAA9B,EACA;AACI,iBAAMyoB,SAAShrB,OAAOvB,OAAP,CAAe,CAAf,CAAf;;AAEA,iBAAIusB,OAAO9jB,MAAX,EACA;AACI8jB,wBAAO1B,GAAP,CAAW,IAAX,EAAiB,sBAAYc,kBAA7B,EAAiD,sBAAYD,mBAA7D,EAAkF,KAAlF;AACH;AACJ,UARD,MAUA;AACI,iBAAMc,gBAAgB,EAAtB;AACA,iBAAIC,OAAO,sBAAYd,kBAAvB;AACA,iBAAIe,OAAO,sBAAYT,eAAZ,CAA4B,KAAK/qB,QAAL,CAAcoB,EAA1C,CAAX;AACA,iBAAIuB,IAAI,CAAR;;AAEA,kBAAKA,IAAI,CAAT,EAAYA,IAAItC,OAAOvB,OAAP,CAAe8D,MAAf,GAAwB,CAAxC,EAA2C,EAAED,CAA7C,EACA;AACI,qBAAItC,OAAOvB,OAAP,CAAe6D,CAAf,EAAkB4E,MAAtB,EACA;AACI+jB,mCAAcvoB,IAAd,CAAmB1C,OAAOvB,OAAP,CAAe6D,CAAf,CAAnB;AACH;AACJ;;AAED,kBAAKA,IAAI,CAAT,EAAYA,IAAI2oB,cAAc1oB,MAAd,GAAuB,CAAvC,EAA0C,EAAED,CAA5C,EACA;AACI,qBAAM0oB,UAASC,cAAc3oB,CAAd,CAAf;;AAEA0oB,yBAAO1B,GAAP,CAAW,IAAX,EAAiB4B,IAAjB,EAAuBC,IAAvB,EAA6B,IAA7B;;AAEA,qBAAMld,IAAIid,IAAV;;AAEAA,wBAAOC,IAAP;AACAA,wBAAOld,CAAP;AACH;;AAEDgd,2BAAc3oB,CAAd,EAAiBgnB,GAAjB,CAAqB,IAArB,EAA2B4B,IAA3B,EAAiC,sBAAYf,mBAA7C,EAAkE,KAAlE;;AAEA,mCAAYK,gBAAZ,CAA6BW,IAA7B;AACH;;AAED;AACA,cAAKxrB,QAAL,CAAcgC,oBAAd,CAAmCiC,KAAnC;AACH,M;;AAED;;;;;;;;;;kCAQA6lB,U,uBAAWuB,M,EAAQzB,K,EAAOC,M,EAAQhmB,K,EAClC;AACI,aAAMzC,KAAK,KAAKpB,QAAL,CAAcoB,EAAzB;AACA,aAAMa,QAAQ,KAAKjC,QAAL,CAAciC,KAA5B;;AAEA,cAAKkpB,IAAL,CAAUrK,OAAV,CAAkBuK,MAAlB;;AAEAppB,eAAM+B,eAAN,CAAsB6lB,MAAtB;;AAEA,aAAIhmB,KAAJ,EACA;AACIzC,gBAAGwG,OAAH,CAAWxG,GAAGoG,YAAd;AACAqiB,oBAAOhmB,KAAP;AACAzC,gBAAGmG,MAAH,CAAUnG,GAAGoG,YAAb;AACH;;AAEDvF,eAAM2W,SAAN,CAAgByS,MAAhB;;AAEA,cAAKI,qBAAL,CAA2BJ,MAA3B;;AAEAA,gBAAOtB,YAAP;;AAEAH,eAAM7jB,WAAN,CAAkBY,OAAlB,CAA0BtE,IAA1B,CAA+B,CAA/B;;AAEAJ,eAAMuW,YAAN,CAAmB6S,OAAOhT,SAA1B;;AAEA,cAAK8S,IAAL,CAAU3J,IAAV;AACH,M;;AAED;;;;;;;;kCAMAiK,qB,kCAAsBJ,M,EACtB;AACI,aAAIA,OAAOlU,MAAP,CAAcuU,WAAlB,EACA;AACI,iBAAMC,OAAON,OAAOlU,MAAP,CAAcuU,WAA3B;;AAEAC,kBAAK,CAAL,IAAU,sBAAYlB,kBAAZ,CAA+BtkB,IAA/B,CAAoCuB,CAA9C;AACAikB,kBAAK,CAAL,IAAU,sBAAYlB,kBAAZ,CAA+BtkB,IAA/B,CAAoCwB,CAA9C;AACAgkB,kBAAK,CAAL,IAAU,sBAAYjB,YAAZ,CAAyBhjB,CAAnC;AACAikB,kBAAK,CAAL,IAAU,sBAAYjB,YAAZ,CAAyB/iB,CAAnC;AACH;;AAED,aAAI0jB,OAAOlU,MAAP,CAAcyU,YAAlB,EACA;AACI,iBAAMC,QAAQR,OAAOlU,MAAP,CAAcyU,YAA5B;;AAEAC,mBAAM,CAAN,IAAW,MAAM,sBAAYpB,kBAAZ,CAA+BtkB,IAA/B,CAAoCuB,CAArD;AACAmkB,mBAAM,CAAN,IAAW,MAAM,sBAAYpB,kBAAZ,CAA+BtkB,IAA/B,CAAoCwB,CAArD;AACAkkB,mBAAM,CAAN,IAAW,CAAC,sBAAYnB,YAAZ,CAAyBhmB,KAAzB,GAAiC,GAAlC,IAAyC,sBAAY+lB,kBAAZ,CAA+BtkB,IAA/B,CAAoCuB,CAAxF;AACAmkB,mBAAM,CAAN,IAAW,CAAC,sBAAYnB,YAAZ,CAAyB/lB,MAAzB,GAAkC,GAAnC,IAA0C,sBAAY8lB,kBAAZ,CAA+BtkB,IAA/B,CAAoCwB,CAAzF;AACH;AACJ,M;;;GAxK2C,UAAI/G,M;;mBAA/BsqB,kB;;;AA2KrB,cAAOjqB,QAAP,CAAgBR,gBAAhB,CAAiCyqB,kBAAjC,E;;;;;;;;;;;;;;;;;;iDCjLStrB,O;;;;;;;;;gDACAA,O;;;;;;;;;iDACAA,O;;;;;;;;;iDACAA,O;;;;;;;;;gDACAA,O;;;;;;;;;;;;;;;;;ACNT;;;;;;;;AAEA,KAAMksB,UAAU,mBAAA1B,CAAQ,sBAAR,CAAhB;;AAEA;;;;;;;KAMqB2B,W;;;AAEjB;;;AAGA,wBAAY/rB,QAAZ,EACA;AAAA;;AAAA,kDACI,mBAAMA,QAAN,EAAgB8rB,OAAhB,CADJ;;AAGI,WAAK3U,MAAL,CAAY6U,MAAZ,GAAqB,GAArB;AAHJ;AAIC;;;;;mBAVgBD,W;;;;;;;;;ACVrB,yCAAwC,mGAAmG,0DAA0D,sDAAsD,+BAA+B,uBAAuB,sMAAsM,wEAAwE,GAAG,kBAAkB,sDAAsD,gDAAgD,6BAA6B,GAAG,G;;;;;;;;;;;;;;;ACA1tB;;AACA;;;;AACA;;;;;;;;;;;;AAEA;;;KAGqBE,U;;;AAEjB;;;AAGA,yBAAYjsB,QAAZ,EACA;AAAA;;AAAA,sDACI,mBAAMA,QAAN,CADJ;;AAGI,eAAKksB,WAAL,GAAmB,0BAAgBlsB,QAAhB,CAAnB;AACA,eAAKmsB,WAAL,GAAmB,0BAAgBnsB,QAAhB,CAAnB;AAJJ;AAKC;;AAED;;;;;;;;;;0BAQA2pB,G,gBAAI9mB,M,EAAQ+mB,K,EAAOC,M,CAAO,a,EAC1B;AACI,aAAMmB,eAAe,qBAAYD,eAAZ,CAA4B,KAAK/qB,QAAL,CAAcoB,EAA1C,CAArB;;AAEA,cAAK8qB,WAAL,CAAiBvC,GAAjB,CAAqB9mB,MAArB,EAA6B+mB,KAA7B,EAAoCoB,YAApC,EAAkD,IAAlD;AACA,cAAKmB,WAAL,CAAiBxC,GAAjB,CAAqB9mB,MAArB,EAA6BmoB,YAA7B,EAA2CnB,MAA3C,EAAmD,KAAnD;;AAEA,8BAAYgB,gBAAZ,CAA6BG,YAA7B;AACH,M;;AAED;;;;;;;;;;;6BAQA;AACI,oBAAO,KAAKkB,WAAL,CAAiBE,SAAxB;AACH;;AAED;;;;;;;2BAMc1Y,C,EACd;AACI,kBAAKwY,WAAL,CAAiBE,SAAjB,GAA6B1Y,CAA7B;AACA,kBAAKyY,WAAL,CAAiBC,SAAjB,GAA6B1Y,CAA7B;AACH;;AAED;;;;;;;;;;6BAQA;AACI,oBAAO,KAAKwY,WAAL,CAAiBG,QAAxB;AACH;;AAED;;;;;;;2BAMa3Y,C,EACb;AACI,kBAAKwY,WAAL,CAAiBG,QAAjB,GAA4B3Y,CAA5B;AACA,kBAAKyY,WAAL,CAAiBE,QAAjB,GAA4B3Y,CAA5B;AACH;;;;;;mBA7EgBuY,U;;;;;;;;;;;;;ACPrB;;AACA;;;;;;;;AAEA;;;KAGqBK,W;;;AAEjB;;;AAGA,0BAAYtsB,QAAZ,EACA;AAAA;;AACI,aAAMusB,aAAa,gCAAiBvsB,SAASoB,EAA1B,CAAnB;;AAIA;AALJ,sDAGI,mBAAMpB,QAAN,EAAgB,6BAAcusB,UAAd,CAAhB,EAA2C,6BAAcA,UAAd,EAA0B,IAA1B,CAA3C,CAHJ;;AAMI,eAAKpV,MAAL,CAAYqV,WAAZ,GAA0B,0BAAgBD,UAAhB,CAA1B;;AAEA;;;;;;;AAOA,eAAKH,SAAL,GAAiB,CAAjB;;AAEA;;;;;;AAMA,eAAKC,QAAL,GAAgB,CAAhB;AAvBJ;AAwBC;;AAED;;;;;;;;;;2BAQA1C,G,gBAAI9mB,M,EAAQ+mB,K,EAAOC,M,EAAQhmB,K,EAC3B;AACI,cAAKsT,MAAL,CAAYsV,SAAZ,GAAyB,IAAI5C,OAAO1jB,IAAP,CAAYuB,CAAjB,IAAuBmiB,OAAO1jB,IAAP,CAAYuB,CAAZ,GAAgBkiB,MAAMzjB,IAAN,CAAWwB,CAAlD,CAAxB;AACA,cAAKwP,MAAL,CAAYsV,SAAZ,IAAyBtkB,KAAKiH,GAAL,CAAS,KAAKid,QAAd,CAAzB;AACA,cAAKlV,MAAL,CAAYsV,SAAZ,IAAyB,KAAKL,SAA9B;;AAEA,aAAI,KAAKA,SAAL,KAAmB,CAAvB,EACA;AACIvpB,oBAAOinB,UAAP,CAAkB,IAAlB,EAAwBF,KAAxB,EAA+BC,MAA/B,EAAuChmB,KAAvC;AACH,UAHD,MAKA;AACI,iBAAMmnB,eAAe,qBAAYD,eAAZ,CAA4B,KAAK/qB,QAAL,CAAcoB,EAA1C,CAArB;AACA,iBAAImqB,OAAO3B,KAAX;AACA,iBAAI4B,OAAOR,YAAX;;AAEA,kBAAK,IAAIroB,IAAI,CAAb,EAAgBA,IAAI,KAAKypB,SAAL,GAAiB,CAArC,EAAwC,EAAEzpB,CAA1C,EACA;AACIE,wBAAOinB,UAAP,CAAkB,IAAlB,EAAwByB,IAAxB,EAA8BC,IAA9B,EAAoC,IAApC;;AAEA,qBAAMld,IAAIid,IAAV;;AAEAA,wBAAOC,IAAP;AACAA,wBAAOld,CAAP;AACH;;AAEDzL,oBAAOinB,UAAP,CAAkB,IAAlB,EAAwByB,IAAxB,EAA8B1B,MAA9B,EAAsChmB,KAAtC;AACA,kCAAYgnB,gBAAZ,CAA6BG,YAA7B;AACH;AACJ,M;;;;;mBArEgBsB,W;;;;;;;;;;;;SCQLI,a,GAAAA,a;SAMAC,a,GAAAA,a;SAQAC,gB,GAAAA,gB;AA5BhB;AACO,KAAMC,4CAAkB;AAC3B,QAAI,CAAC,QAAD,EAAW,QAAX,EAAqB,QAArB,EAA+B,QAA/B,EAAyC,QAAzC,CADuB;AAE3B,QAAI,CAAC,QAAD,EAAW,QAAX,EAAqB,QAArB,EAA+B,QAA/B,EAAyC,QAAzC,EAAmD,QAAnD,EAA6D,QAA7D,CAFuB;AAG3B,QAAI,CAAC,QAAD,EAAW,QAAX,EAAqB,QAArB,EAA+B,QAA/B,EAAyC,QAAzC,EAAmD,QAAnD,EAA6D,QAA7D,EAAuE,QAAvE,EAAiF,QAAjF,CAHuB;AAI3B,SAAI,CAAC,QAAD,EAAW,QAAX,EAAqB,QAArB,EAA+B,QAA/B,EAAyC,QAAzC,EAAmD,QAAnD,EAA6D,QAA7D,EAAuE,QAAvE,EAAiF,QAAjF,EAA2F,QAA3F,EAAqG,MAArG,CAJuB;AAK3B,SAAI,CAAC,QAAD,EAAW,QAAX,EAAqB,QAArB,EAA+B,QAA/B,EAAyC,QAAzC,EAAmD,QAAnD,EAA6D,QAA7D,EAAuE,QAAvE,EAAiF,QAAjF,EAA2F,QAA3F,EAAqG,QAArG,EAA+G,QAA/G,EAAyH,QAAzH,CALuB;AAM3B,SAAI,CAAC,QAAD,EAAW,QAAX,EAAqB,QAArB,EAA+B,QAA/B,EAAyC,QAAzC,EAAmD,QAAnD,EAA6D,QAA7D,EAAuE,QAAvE,EAAiF,QAAjF,EAA2F,QAA3F,EAAqG,QAArG,EAA+G,QAA/G,EAAyH,QAAzH,EAAmI,QAAnI,EAA6I,QAA7I;AANuB,EAAxB;AAQP;;AAEA,KAAMC,eAAe,mBAAA1C,CAAQ,qBAAR,CAArB;AACA,KAAM2C,eAAe,mBAAA3C,CAAQ,qBAAR,CAArB;;AAEO,UAASsC,aAAT,CAAuBH,UAAvB,EACP;AACI,YAAOQ,aACFzV,OADE,CACM,UADN,EACkBiV,UADlB,CAAP;AAEH;;AAEM,UAASI,aAAT,CAAuBJ,UAAvB,EAAmCS,YAAnC,EACP;AACI,YAAOF,aACFxV,OADE,CACM,UADN,EACkBiV,UADlB,EAEFjV,OAFE,CAEM,gBAFN,EAEwBnP,KAAKmF,IAAL,CAAUif,aAAa,CAAvB,CAFxB,EAGFjV,OAHE,CAGM,gBAHN,EAGwB0V,eAAe,CAAf,GAAmB,CAH3C,CAAP;AAIH;;AAEM,UAASJ,gBAAT,CAA0BxrB,EAA1B,EACP;AACI,SAAM6rB,cAAc7rB,GAAGwgB,YAAH,CAAgBxgB,GAAG8rB,mBAAnB,CAApB;AACA,SAAIX,aAAa,EAAjB;;AAEA,YAAOA,aAAaU,WAApB,EACA;AACIV,uBAAc,CAAd;AACH;;AAED,YAAOA,UAAP;AACH,E;;;;;;;;;ACvCD,iEAAgE,MAAM,oCAAoC,YAAY,8BAA8B,YAAY,2GAA2G,+BAA+B,mCAAmC,0BAA0B,kDAAkD,sBAAsB,0FAA0F,2DAA2D,sBAAsB,YAAY,uHAAuH,oGAAoG,uBAAuB,GAAG,G;;;;;;;;;ACA31B,iEAAgE,MAAM,kDAAkD,+BAA+B,8CAA8C,sBAAsB,+BAA+B,2DAA2D,sBAAsB,YAAY,kFAAkF,OAAO,GAAG,G;;;;;;;;;;;;;ACAnb;;AACA;;AAEA;;;;;;;;AAEA;;;KAGqBY,W;;;AAEjB;;;;AAIA,0BAAYntB,QAAZ,EACA;AAAA,aADsBotB,QACtB,yDADiC,CACjC;;AAAA;;AACI,qBAAMvgB,MAAN,CAAa,0BAAgBugB,QAAhB,CAAb,0BAC0BA,QAD1B,8BAC2DlT,OAAOC,IAAP,2BAD3D;;AAKA;AANJ,sDAII,mBAAMna,QAAN,EAAgB,6BAAcotB,QAAd,CAAhB,EAAyC,6BAAcA,QAAd,EAAwB,KAAxB,CAAzC,CAJJ;;AAOI,eAAKjW,MAAL,CAAYqV,WAAZ,GAA0B,0BAAgBY,QAAhB,CAA1B;;AAEA;;;;;;;AAOA,eAAKhB,SAAL,GAAiB,CAAjB;;AAEA;;;;;;AAMA,eAAKC,QAAL,GAAgB,CAAhB;AAxBJ;AAyBC;;AAED;;;;;;;;;;2BAQA1C,G,gBAAI9mB,M,EAAQ+mB,K,EAAOC,M,EAAQhmB,K,EAC3B;AACI,cAAKsT,MAAL,CAAYsV,SAAZ,GAAyB,IAAI5C,OAAO1jB,IAAP,CAAYwB,CAAjB,IAAuBkiB,OAAO1jB,IAAP,CAAYwB,CAAZ,GAAgBiiB,MAAMzjB,IAAN,CAAWwB,CAAlD,CAAxB;AACA,cAAKwP,MAAL,CAAYsV,SAAZ,IAAyBtkB,KAAKiH,GAAL,CAAS,KAAKid,QAAd,CAAzB;AACA,cAAKlV,MAAL,CAAYsV,SAAZ,IAAyB,KAAKL,SAA9B;;AAEA,aAAI,KAAKA,SAAL,KAAmB,CAAvB,EACA;AACIvpB,oBAAOinB,UAAP,CAAkB,IAAlB,EAAwBF,KAAxB,EAA+BC,MAA/B,EAAuChmB,KAAvC;AACH,UAHD,MAKA;AACI,iBAAMmnB,eAAe,qBAAYD,eAAZ,CAA4B,KAAK/qB,QAAL,CAAcoB,EAA1C,CAArB;AACA,iBAAImqB,OAAO3B,KAAX;AACA,iBAAI4B,OAAOR,YAAX;;AAEA,kBAAK,IAAIroB,IAAI,CAAb,EAAgBA,IAAI,KAAKypB,SAAL,GAAiB,CAArC,EAAwC,EAAEzpB,CAA1C,EACA;AACIE,wBAAOinB,UAAP,CAAkB,IAAlB,EAAwByB,IAAxB,EAA8BC,IAA9B,EAAoC,IAApC;;AAEA,qBAAMld,IAAIid,IAAV;;AAEAA,wBAAOC,IAAP;AACAA,wBAAOld,CAAP;AACH;;AAEDzL,oBAAOinB,UAAP,CAAkB,IAAlB,EAAwByB,IAAxB,EAA8B1B,MAA9B,EAAsChmB,KAAtC;AACA,kCAAYgnB,gBAAZ,CAA6BG,YAA7B;AACH;AACJ,M;;;;;mBAvEgBmC,W;;;;;;;;;;;;;ACRrB;;;;;;;;AAEA,KAAME,UAAU,mBAAAjD,CAAQ,qBAAR,CAAhB;AACA,KAAM0B,UAAU,mBAAA1B,CAAQ,qBAAR,CAAhB;;AAEA;;;;;;;;;;KASqBkD,U;;;AAEjB;;;AAGA,uBAAYttB,QAAZ,EACA;AAAA;;AAAA,6CACI,mBAAMA,QAAN,EAAgB8rB,OAAhB,EAAyBuB,OAAzB,CADJ;AAEC;;;;;mBARgBC,U;;;;;;;;;ACdrB,qEAAoE,+BAA+B,wBAAwB,sBAAsB,sBAAsB,sBAAsB,qBAAqB,+BAA+B,mCAAmC,2BAA2B,gCAAgC,8BAA8B,8BAA8B,qBAAqB,GAAG,kCAAkC,8BAA8B,8BAA8B,qBAAqB,GAAG,yLAAyL,2CAA2C,0DAA0D,yDAAyD,yDAAyD,wDAAwD,0CAA0C,GAAG,qBAAqB,yFAAyF,qCAAqC,uDAAuD,mFAAmF,GAAG,G;;;;;;;;;ACA9yC,0DAAyD,sBAAsB,sBAAsB,sBAAsB,qBAAqB,+BAA+B,+BAA+B,2BAA2B,85CAA85C,iCAAiC,0tBAA0tB,iBAAiB,4EAA4E,+CAA+C,+CAA+C,+CAA+C,+CAA+C,6CAA6C,gCAAgC,4CAA4C,sCAAsC,sCAAsC,sCAAsC,sCAAsC,sCAAsC,gFAAgF,gFAAgF,yBAAyB,uDAAuD,uDAAuD,0IAA0I,0EAA0E,8JAA8J,uNAAuN,oOAAoO,sCAAsC,0FAA0F,mDAAmD,mBAAmB,GAAG,iBAAiB,wDAAwD,mBAAmB,iGAAiG,6BAA6B,GAAG,G;;;;;;;;;;;;;;;;;;0DCEn8I1tB,O;;;;;;;;;uDACAA,O;;;;;;;;;6CACAA,O;;;;;;;;;;;;;;;;mBCDe2tB,oB;;AAHxB;;;;AACA;;;;;;;;;;AAEe,UAASA,oBAAT,CAA8BztB,IAA9B,EACf;AACI;;;;;AAKA;AAAA;;AAEI;;;AAGA,uBACA;AAAA;;AACyB;;AAErB;;;;;;;AAHJ,oDACI,6BAAS+T,SAAT,CADJ;;AAUI,aAAK2Z,MAAL,GAAc,2BAAd;;AAEA;;;;;;;AAOA,aAAKC,IAAL,GAAY,2BAAZ;;AAEA;;;;;;;;AAQA,aAAKC,WAAL,GAAmB,2BAAnB;;AAEA;;;;;;;AAOA,aAAKC,MAAL,GAAc,2BAAd;;AAEA;;;;;;;AAOA,aAAKC,QAAL,GAAgB,2BAAhB;;AAEA;;;;;;;AAOA,aAAKC,QAAL,GAAgB,2BAAhB;;AAEA;;;;;;;AAOA,aAAKC,OAAL,GAAe,2BAAf;;AAEA;;;;;;;AAOA,aAAKC,YAAL,GAAoB,2BAApB;;AAEA;;;;;;;AAOA,aAAKC,UAAL,GAAkB,2BAAlB;;AAEA;;;;;;;;AArFJ;AA6FC;AACD;;;;;;;;;AApGJ,sBA2GIC,OA3GJ,oBA2GYvmB,CA3GZ,EA2GeC,CA3Gf,EA4GI;AACI,WAAI,KAAKoM,SAAL,GAAiBb,QAAjB,CAA0BxL,CAA1B,EAA6BC,CAA7B,CAAJ,EACA;AACI,gBAAO,IAAP;AACH;;AAED,cAAO,IAAP;AACH,MAnHL;;AAAA;AAAA,KAAqB,6BAAgB7H,IAAhB,CAArB;AAqHH,E;;;;;;;;;;;;;AC/HD;;;;AACA;;;;AACA;;;;;;;;;;AAEA,KAAMouB,aAAa,EAAExmB,GAAG,CAAL,EAAQC,GAAG,CAAX,EAAnB;;AAEA;;;;;KAIqBwmB,iB;;;AAEjB;;;AAGA,gCAAYnuB,QAAZ,EACA;AAAA;;AAGI;;;;;AAHJ,sDACI,uBAAMA,QAAN,EAAgB,CAAhB,EAAmBouB,OAAOC,gBAA1B,CADJ;;AAQI,eAAKC,QAAL,GAAgB,EAAhB;;AAEA;;;;;;AAMA,eAAKC,iBAAL,GAAyB,MAAKC,WAAL,CAAiBnsB,IAAjB,OAAzB;;AAEA,eAAKosB,YAAL,GAAoB,KAApB;AAlBJ;AAmBC;;AAED;;;;;;;;iCAMAruB,I,iBAAKC,M,EACL;AACI,gBAAOA,OAAOC,YAAP,gCAAP;AACH,M;;AAED;;;;;;;;;;;;iCAUAouB,oB,iCAAqBhnB,C,EAAGC,C,EACxB;AAAA,aAD2BiI,GAC3B,yDADiC,EAAElI,GAAG,CAAL,EAAQC,GAAG,CAAX,EACjC;;AACI,aAAMgnB,MAAM,KAAK3uB,QAAL,CAAcoB,EAAd,CAAiBoB,MAA7B;AACA,aAAM2Q,OAAOwb,IAAIC,qBAAJ,EAAb;;AAEAhf,aAAIlI,CAAJ,GAAS,CAACA,IAAIyL,KAAK0b,IAAV,KAAmBF,IAAIjqB,KAAJ,GAAYyO,KAAKzO,KAApC,CAAT;AACAkL,aAAIjI,CAAJ,GAAS,CAACA,IAAIwL,KAAK2b,GAAV,KAAkBH,IAAIhqB,MAAJ,GAAawO,KAAKxO,MAApC,CAAT;;AAEA,gBAAOiL,GAAP;AACH,M;;AAED;;;;;;;;;;iCAQAqe,O,oBAAQvmB,C,EAAGC,C,EACX;AACI,cAAK,IAAIhF,IAAI,CAAb,EAAgBA,IAAI,KAAKe,QAAL,CAAcd,MAAlC,EAA0C,EAAED,CAA5C,EACA;AACI,iBAAMosB,OAAO,KAAKrrB,QAAL,CAAcf,CAAd,EAAiBsrB,OAAjB,CAAyBvmB,CAAzB,EAA4BC,CAA5B,CAAb;;AAEA,iBAAIonB,IAAJ,EAAU,OAAOA,IAAP;AACb;;AAED,gBAAO,IAAP;AACH,M;;AAED;;;;;;;;;iCAOAC,U,yBACA;AACI,qBAAMniB,MAAN,CAAa,CAAC,KAAK4hB,YAAnB,EAAiC,0DAAjC;;AAEA,cAAKA,YAAL,GAAoB,IAApB;;AAEA,aAAME,MAAM,KAAK3uB,QAAL,CAAcoB,EAAd,CAAiBoB,MAA7B;;AAEA,aAAIysB,OAAOC,YAAX,EACA;AACIP,iBAAIlsB,gBAAJ,CAAqB,aAArB,EAAoC,KAAK8rB,iBAAzC;AACAI,iBAAIlsB,gBAAJ,CAAqB,aAArB,EAAoC,KAAK8rB,iBAAzC;AACAI,iBAAIlsB,gBAAJ,CAAqB,YAArB,EAAmC,KAAK8rB,iBAAxC;AACAU,oBAAOxsB,gBAAP,CAAwB,WAAxB,EAAqC,KAAK8rB,iBAA1C;AACH,UAND,MAQA;AACII,iBAAIlsB,gBAAJ,CAAqB,WAArB,EAAkC,KAAK8rB,iBAAvC;AACAI,iBAAIlsB,gBAAJ,CAAqB,WAArB,EAAkC,KAAK8rB,iBAAvC;AACAI,iBAAIlsB,gBAAJ,CAAqB,UAArB,EAAiC,KAAK8rB,iBAAtC;AACAU,oBAAOxsB,gBAAP,CAAwB,SAAxB,EAAmC,KAAK8rB,iBAAxC;;AAEAI,iBAAIlsB,gBAAJ,CAAqB,YAArB,EAAmC,KAAK8rB,iBAAxC;AACAI,iBAAIlsB,gBAAJ,CAAqB,WAArB,EAAkC,KAAK8rB,iBAAvC;AACAI,iBAAIlsB,gBAAJ,CAAqB,aAArB,EAAoC,KAAK8rB,iBAAzC;AACAU,oBAAOxsB,gBAAP,CAAwB,UAAxB,EAAoC,KAAK8rB,iBAAzC;AACH;;AAEDI,aAAIlsB,gBAAJ,CAAqB,OAArB,EAA8B,KAAK8rB,iBAAnC;AACH,M;;AAED;;;;;;iCAIAY,Y,2BACA;AACI,qBAAMtiB,MAAN,CAAa,KAAK4hB,YAAlB,EAAgC,iDAAhC;;AAEA,cAAKA,YAAL,GAAoB,KAApB;;AAEA,aAAME,MAAM,KAAK3uB,QAAL,CAAcoB,EAAd,CAAiBoB,MAA7B;;AAEA,aAAIysB,OAAOC,YAAX,EACA;AACIP,iBAAItqB,mBAAJ,CAAwB,aAAxB,EAAuC,KAAKkqB,iBAA5C;AACAI,iBAAItqB,mBAAJ,CAAwB,aAAxB,EAAuC,KAAKkqB,iBAA5C;AACAI,iBAAItqB,mBAAJ,CAAwB,YAAxB,EAAsC,KAAKkqB,iBAA3C;AACAU,oBAAO5qB,mBAAP,CAA2B,WAA3B,EAAwC,KAAKkqB,iBAA7C;AACH,UAND,MAQA;AACII,iBAAItqB,mBAAJ,CAAwB,WAAxB,EAAqC,KAAKkqB,iBAA1C;AACAI,iBAAItqB,mBAAJ,CAAwB,WAAxB,EAAqC,KAAKkqB,iBAA1C;AACAI,iBAAItqB,mBAAJ,CAAwB,UAAxB,EAAoC,KAAKkqB,iBAAzC;AACAU,oBAAO5qB,mBAAP,CAA2B,SAA3B,EAAsC,KAAKkqB,iBAA3C;;AAEAI,iBAAItqB,mBAAJ,CAAwB,YAAxB,EAAsC,KAAKkqB,iBAA3C;AACAI,iBAAItqB,mBAAJ,CAAwB,WAAxB,EAAqC,KAAKkqB,iBAA1C;AACAI,iBAAItqB,mBAAJ,CAAwB,aAAxB,EAAuC,KAAKkqB,iBAA5C;AACAU,oBAAO5qB,mBAAP,CAA2B,UAA3B,EAAuC,KAAKkqB,iBAA5C;AACH;;AAEDI,aAAItqB,mBAAJ,CAAwB,OAAxB,EAAiC,KAAKkqB,iBAAtC;AACH,M;;AAED;;;;;;;iCAKAC,W,wBAAY3pB,K,EACZ;AACI;AACA,aAAIA,MAAMuqB,cAAV,EACA;AACI,kBAAK,IAAIzsB,IAAI,CAAb,EAAgBA,IAAIkC,MAAMuqB,cAAN,CAAqBxsB,MAAzC,EAAiD,EAAED,CAAnD,EACA;AACI,qBAAM0sB,QAAQxqB,MAAMuqB,cAApB;AACA,qBAAME,UAAU,KAAKC,WAAL,CAAiBF,KAAjB,CAAhB;AACA,qBAAMG,cAAc,KAAKd,oBAAL,CAA0BW,MAAMI,OAAhC,EAAyCJ,MAAMK,OAA/C,EAAwDxB,UAAxD,CAApB;AACA,qBAAMyB,YAAY,KAAK1B,OAAL,CAAauB,YAAY9nB,CAAzB,EAA4B8nB,YAAY7nB,CAAxC,CAAlB;;AAEA2nB,yBAAQ,kBAAQM,cAAR,CAAuB/qB,MAAMyF,IAA7B,CAAR,EAA4C+kB,KAA5C,EAAmDM,SAAnD,EAA8DH,YAAY9nB,CAA1E,EAA6E8nB,YAAY7nB,CAAzF;AACH;AACJ,UAXD,MAaA;AACI,iBAAM2nB,WAAU,KAAKC,WAAL,CAAiB1qB,KAAjB,CAAhB;AACA,iBAAM2qB,eAAc,KAAKd,oBAAL,CAA0B7pB,MAAM4qB,OAAhC,EAAyC5qB,MAAM6qB,OAA/C,EAAwDxB,UAAxD,CAApB;AACA,iBAAMyB,aAAY,KAAK1B,OAAL,CAAauB,aAAY9nB,CAAzB,EAA4B8nB,aAAY7nB,CAAxC,CAAlB;;AAEA2nB,sBAAQ,kBAAQM,cAAR,CAAuB/qB,MAAMyF,IAA7B,CAAR,EAA4CzF,KAA5C,EAAmD8qB,UAAnD,EAA8DH,aAAY9nB,CAA1E,EAA6E8nB,aAAY7nB,CAAzF;AACH;AACJ,M;;AAED;;;;;;iCAIAkoB,U,yBACA;AACI,+BAAMA,UAAN;;AAEA,cAAKb,UAAL;AACH,M;;AAED;;;;;;iCAIAc,O,sBACA;AACI,+BAAMA,OAAN;;AAEA,cAAKX,YAAL;AACH,M;;AAED;;;;;;iCAIAruB,O,sBACA;AACI,+BAAMA,OAAN;;AAEA,cAAKivB,YAAL,GAAoB,IAApB;;AAEA,cAAKC,aAAL,CAAmB1rB,SAAnB;AACA,cAAK0rB,aAAL,GAAqB,IAArB;AACH,M;;AAED;;;;;;;;;iCAOAT,W,wBAAY5mB,I,EACZ;AACI,aAAIsnB,YAAY,CAAhB;;AAEA,aAAI,OAAOtnB,KAAKsnB,SAAZ,KAA0B,QAA9B,EAAwCA,YAAYtnB,KAAKsnB,SAAjB,CAAxC,KACK,IAAI,OAAOtnB,KAAKunB,UAAZ,KAA2B,QAA/B,EAAyCD,YAAYtnB,KAAKunB,UAAjB;;AAE9C,cAAK,IAAIvtB,IAAI,CAAb,EAAgBA,IAAI,KAAK2rB,QAAL,CAAc1rB,MAAlC,EAA0C,EAAED,CAA5C,EACA;AACI,iBAAI,KAAK2rB,QAAL,CAAc3rB,CAAd,EAAiBwtB,EAAjB,KAAwBF,SAA5B,EACA;AACI,wBAAO,KAAK3B,QAAL,CAAc3rB,CAAd,CAAP;AACH;AACJ;;AAED,aAAM2sB,UAAU,sBAAYW,SAAZ,CAAhB;;AAEA,cAAK3B,QAAL,CAAcvrB,IAAd,CAAmBusB,OAAnB;;AAEA,gBAAOA,OAAP;AACH,M;;;GArP0C,UAAI1uB,M;;mBAA9ButB,iB;;;AAwPrB,cAAOltB,QAAP,CAAgBR,gBAAhB,CAAiC0tB,iBAAjC;;AAEA;;;;;;AAMA;;;;;;;;;;;;;;;;;;;;;;;;AC1QA;;;;AAEA,KAAMiC,cAAc,EAApB;;AAEA;;;;;KAIqBC,O;AAEjB;;;AAGA,0BAAYF,EAAZ,EACA;AAAA;;AACI;;;;;;AAMA,sBAAKA,EAAL,GAAUA,EAAV;;AAEA;;;;;;AAMA,sBAAK7lB,IAAL,GAAY+lB,QAAQC,IAAR,CAAaC,OAAzB;;AAEA;;;;;;AAMA,sBAAK3sB,MAAL,GAAc,IAAd;;AAEA;;;;;;AAMA,sBAAK4sB,WAAL,GAAmB,IAAnB;;AAEA;;;;;;AAMA,sBAAKC,YAAL,GAAoB,IAApB;;AAEA;;;;;;;;;;AAUA,sBAAKC,MAAL,GAAc,CAAd;;AAEA;;;;;;AAMA,sBAAKC,OAAL,GAAeP,WAAf;;AAEA;;;;;;AAMA,sBAAKQ,MAAL,GAAc,KAAd;;AAEA;;;;;;AAMA,sBAAKC,OAAL,GAAe,KAAf;;AAEA;;;;;;AAMA,sBAAKC,OAAL,GAAe,KAAf;;AAEA;;;;;;AAMA,sBAAKC,QAAL,GAAgB,KAAhB;;AAEA;;;;;;;AAOA,sBAAKrsB,KAAL,GAAa,CAAb;;AAEA;;;;;;;AAOA,sBAAKC,MAAL,GAAc,CAAd;;AAEA;;;;;;;AAOA,sBAAKqsB,QAAL,GAAgB,GAAhB;;AAEA;;;;;;AAMA,sBAAKvB,OAAL,GAAe,CAAf;;AAEA;;;;;;AAMA,sBAAKC,OAAL,GAAe,CAAf;;AAEA;;;;;;;AAOA,sBAAKuB,MAAL,GAAc,CAAd;;AAEA;;;;;;;AAOA,sBAAKC,MAAL,GAAc,CAAd;;AAEA;;;;;;AAMA,sBAAKC,MAAL,GAAc,CAAd;;AAEA;;;;;;AAMA,sBAAKC,MAAL,GAAc,CAAd;;AAEA;;;;;;AAMA,sBAAKC,YAAL,GAAoB,CAApB;;AAEA;;;;;;AAMA,sBAAKC,YAAL,GAAoB,CAApB;;AAEA;;;;;;AAMA,sBAAKC,YAAL,GAAoB,CAApB;;AAEA;;;;;;AAMA,sBAAKC,MAAL,GAAc,KAAd;;AAEA;;;;;;AAMA,sBAAKC,UAAL,GAAkB,KAAlB;AACH;;AAED;;;;;;;;;;2BAQAxtB,K,kBAAM0E,I,EAAM/E,M,EAAQutB,M,EAAQC,M,EAC5B;AACI,6BAAMvkB,MAAN,CAAa,CAAC,KAAK2kB,MAAnB,EAA2B,gDAA3B;;AAEA,sBAAKA,MAAL,GAAc,IAAd;AACA,sBAAK5tB,MAAL,GAAcA,MAAd;;AAEA,sBAAK8sB,MAAL,GAAc/nB,KAAK+nB,MAAL,IAAe,CAA7B;AACA,sBAAKC,OAAL,GAAehoB,KAAKgoB,OAAL,IAAgBP,WAA/B;;AAEA,sBAAKsB,IAAL,CAAU/oB,IAAV,EAAgBwoB,MAAhB,EAAwBC,MAAxB;;AAEA,qBAAIxtB,MAAJ,EACA;AACIA,gCAAO4pB,MAAP,CAAczpB,QAAd,CAAuB,IAAvB,EAA6BH,MAA7B;AACH;AACJ,U;;AAED;;;;;;;;;;2BAQA+tB,G,gBAAIhpB,I,EAAM/E,M,EAAQutB,M,EAAQC,M,EAC1B;AACI;AACA,qBAAI,CAAC,KAAKI,MAAV,EAAkB;;AAElB,sBAAKA,MAAL,GAAc,KAAd;;AAEA,sBAAKE,IAAL,CAAU/oB,IAAV,EAAgBwoB,MAAhB,EAAwBC,MAAxB;;AAEA;AACA,qBAAI,KAAKxtB,MAAT,EACA;AACI,6BAAI,KAAKA,MAAL,KAAgBA,MAApB,EACA;AACI,sCAAKA,MAAL,CAAYkqB,OAAZ,CAAoB/pB,QAApB,CAA6B,IAA7B,EAAmC,KAAKH,MAAxC;AACH;;AAED,6BAAI,CAACA,MAAL,EACA;AACI,sCAAKA,MAAL,CAAY8pB,WAAZ,CAAwB3pB,QAAxB,CAAiC,IAAjC,EAAuC,KAAKH,MAA5C;AACH;AACJ;;AAED,sBAAKA,MAAL,GAAcA,MAAd;;AAEA,qBAAIA,MAAJ,EACA;AACIA,gCAAO6pB,IAAP,CAAY1pB,QAAZ,CAAqB,IAArB,EAA2BH,MAA3B;AACH;AACJ,U;;AAED;;;;;;;;;;2BAQAguB,I,iBAAKjpB,I,EAAM/E,M,EAAQutB,M,EAAQC,M,EAC3B;AACI,sBAAKM,IAAL,CAAU/oB,IAAV,EAAgBwoB,MAAhB,EAAwBC,MAAxB,EAAgC,KAAKI,MAAL,IAAe,KAAKC,UAApD;;AAEA;AACA,qBAAI,KAAKjB,WAAL,KAAqB5sB,MAAzB,EACA;AACI,6BAAI,KAAK6tB,UAAL,IAAmB,KAAKjB,WAA5B,EACA;AACI,sCAAKiB,UAAL,GAAkB,KAAlB;AACA,sCAAKjB,WAAL,CAAiBxC,UAAjB,CAA4BjqB,QAA5B,CAAqC,IAArC,EAA2C,KAAKysB,WAAhD;AACA,sCAAKA,WAAL,GAAmB,IAAnB;AACH;;AAED,6BAAI5sB,MAAJ,EACA;AACI,sCAAK6tB,UAAL,GAAkB,IAAlB;AACA,sCAAKjB,WAAL,GAAmB5sB,MAAnB;AACAA,wCAAOmqB,YAAP,CAAoBhqB,QAApB,CAA6B,IAA7B,EAAmCH,MAAnC;AACH;AACJ;;AAED;AACA;;AAEA,sBAAK4sB,WAAL,GAAmB5sB,MAAnB;;AAEA,qBAAIA,MAAJ,EACA;AACIA,gCAAO+pB,MAAP,CAAc5pB,QAAd,CAAuB,IAAvB,EAA6BH,MAA7B;AACH;AACJ,U;;AAED;;;;;;;;;;2BAQAiuB,M,mBAAOlpB,I,EAAM/E,M,EAAQutB,M,EAAQC,M,EAC7B;AACI,qBAAMU,UAAU,KAAKN,MAArB;AACA,qBAAMO,cAAc,KAAKN,UAAzB;;AAEA,sBAAKD,MAAL,GAAc,KAAd;AACA,sBAAKC,UAAL,GAAkB,KAAlB;;AAEA,sBAAKC,IAAL,CAAU/oB,IAAV,EAAgBwoB,MAAhB,EAAwBC,MAAxB;;AAEA,qBAAI,KAAKxtB,MAAT,EACA;AACI,8BAAKA,MAAL,CAAYgqB,QAAZ,CAAqB7pB,QAArB,CAA8B,KAAKH,MAAL,IAAe,KAAK4sB,WAAlD,EAA+D,IAA/D;;AAEA,6BAAIsB,OAAJ,EACA;AACI,sCAAKluB,MAAL,CAAY8pB,WAAZ,CAAwB3pB,QAAxB,CAAiC,IAAjC,EAAuC,KAAKH,MAA5C;AACH;AACJ;;AAED,qBAAImuB,eAAe,KAAKvB,WAAxB,EACA;AACI,8BAAKA,WAAL,CAAiBxC,UAAjB,CAA4BjqB,QAA5B,CAAqC,IAArC,EAA2C,KAAKysB,WAAhD;AACH;;AAED,sBAAK5sB,MAAL,GAAc,IAAd;AACA,sBAAK4sB,WAAL,GAAmB,IAAnB;AACA,sBAAKC,YAAL,GAAoB,IAApB;AACH,U;;AAED;;;;;;;;;;2BAQAuB,M,mBAAOrpB,I,EAAM/E,M,EAAQutB,M,EAAQC,M,EAC7B;AACI,sBAAKM,IAAL,CAAU/oB,IAAV,EAAgBwoB,MAAhB,EAAwBC,MAAxB;;AAEA,sBAAKC,YAAL,GAAoB1oB,KAAKsoB,MAAzB;AACA,sBAAKK,YAAL,GAAoB3oB,KAAKuoB,MAAzB;AACA,sBAAKK,YAAL,GAAoB5oB,KAAKspB,MAAzB;;AAEA,sBAAKxB,YAAL,GAAoB7sB,MAApB;;AAEA,qBAAIA,MAAJ,EACA;AACIA,gCAAOiqB,QAAP,CAAgB9pB,QAAhB,CAAyB,IAAzB,EAA+BH,MAA/B;AACH;AACJ,U;;AAED;;;;;;;;;;2BAQA8tB,I,iBAAK/oB,I,EAAMwoB,M,EAAQC,M,EACnB;AAAA,qBAD2Bc,SAC3B,yDADuC,KACvC;;AACI;AACA,qBAAIvpB,KAAKwpB,WAAT,EACA;AACI,8BAAK7nB,IAAL,GAAY3B,KAAKwpB,WAAjB;AACH,kBAHD,MAIK,IAAIxpB,KAAK2B,IAAL,IAAa3B,KAAK2B,IAAL,CAAU,CAAV,MAAiB,GAAlC,EACL;AACI,8BAAKA,IAAL,GAAY+lB,QAAQC,IAAR,CAAa8B,KAAzB;AACH,kBAHI,MAKL;AACI,8BAAK9nB,IAAL,GAAY+lB,QAAQC,IAAR,CAAa+B,KAAzB;AACH;;AAED;AACA,qBAAI,OAAO1pB,KAAKqoB,QAAZ,KAAyB,QAA7B,EACA;AACI,8BAAKA,QAAL,GAAgBroB,KAAKqoB,QAArB;AACH,kBAHD,MAIK,IAAI,OAAOroB,KAAK+P,KAAZ,KAAsB,QAA1B,EACL;AACI,8BAAKsY,QAAL,GAAgBroB,KAAK+P,KAArB;AACH,kBAHI,MAKL;AACI,8BAAKsY,QAAL,GAAgB,GAAhB;AACH;;AAED;AACA,sBAAKN,MAAL,GAAc/nB,KAAK+nB,MAAL,IAAe,CAA7B;AACA,sBAAKC,OAAL,GAAehoB,KAAKgoB,OAAL,IAAgBP,WAA/B;;AAEA;AACA,sBAAKQ,MAAL,GAAcjoB,KAAKioB,MAAL,IAAe,KAA7B;AACA,sBAAKC,OAAL,GAAeloB,KAAKkoB,OAAL,IAAgB,KAA/B;AACA,sBAAKC,OAAL,GAAenoB,KAAKmoB,OAAL,IAAgB,KAA/B;AACA,sBAAKC,QAAL,GAAgBpoB,KAAKooB,QAAL,IAAiB,KAAjC;;AAEA;AACA,sBAAKrsB,KAAL,GAAaiE,KAAKjE,KAAL,KAAe,OAAOiE,KAAK2pB,OAAZ,KAAwB,QAAxB,GAAmC3pB,KAAK2pB,OAAL,GAAe,CAAlD,GAAsD,CAArE,CAAb;AACA,sBAAK3tB,MAAL,GAAcgE,KAAKhE,MAAL,KAAgB,OAAOgE,KAAK4pB,OAAZ,KAAwB,QAAxB,GAAmC5pB,KAAK4pB,OAAL,GAAe,CAAlD,GAAsD,CAAtE,CAAd;;AAEA;AACA,sBAAK9C,OAAL,GAAe9mB,KAAK8mB,OAApB;AACA,sBAAKC,OAAL,GAAe/mB,KAAK+mB,OAApB;;AAEA;AACA,sBAAKuB,MAAL,GAAciB,YAAaf,SAAS,KAAKA,MAA3B,GAAqC,CAAnD;AACA,sBAAKD,MAAL,GAAcgB,YAAad,SAAS,KAAKA,MAA3B,GAAqC,CAAnD;;AAEA;AACA,sBAAKD,MAAL,GAAcA,MAAd;AACA,sBAAKC,MAAL,GAAcA,MAAd;AACH,U;;;;;AAGL;;;;;;;;;mBAncqBf,O;AA0crBA,SAAQC,IAAR,GAAe;AACX;AACAC,kBAAS,EAFE;AAGX;AACA6B,gBAAO,OAJI;AAKX;AACAC,gBAAO,OANI;AAOX;AACAG,cAAK;AARM,EAAf;;AAWA;;;;;;;AAOAnC,SAAQT,cAAR,GAAyB;AACrB6C,oBAAgB,OADK;AAErBC,qBAAgB,OAFK;AAGrBC,sBAAgB,OAHK;;AAKrBC,kBAAgB,KALK;AAMrBC,mBAAgB,KANK;AAOrBC,oBAAgB,KAPK;;AASrBC,oBAAgB,MATK;AAUrBC,oBAAgB,MAVK;AAWrBC,sBAAgB,MAXK;;AAarBC,mBAAgB,QAbK;AAcrBC,sBAAgB,QAdK;AAerBC,qBAAgB,QAfK;;AAiBrBC,gBAAgB;AAjBK,EAAzB,C;;;;;;;;;;;;;;;;;;gDCjeSzzB,O;;;;;;;;;wDACAA,O;;;;;;;;;yDACAA,O;;;;;;;;;4DACAA,O;;;;;;AAEF,KAAM0zB,4BAAU;AACnB3sB,cAAS;AACL4sB,eAAM,mBAAAnJ,CAAQ,qCAAR,CADD;AAELoJ,eAAM,mBAAApJ,CAAQ,qCAAR;AAFD;AADU,EAAhB,C;;;;;;;;;;;;;ACRP;;AACA;;AACA;;AACA;;;;AACA;;;;;;;;;;;;AAEA;;;;;;;;;;KAUqBqJ,M;;;AAOjB;;;;AAIA,uBACA;AAAA,aADY9sB,OACZ,yDADsB,kBAAQgN,KAC9B;;AAAA;;AAAA,sDACI,2BADJ;;AAGI,eAAKzO,eAAL;;AAEA,eAAKwuB,uBAAL,GAA+B,IAA/B;;AAEA;AACA,eAAK/sB,OAAL,GAAeA,OAAf;AARJ;AASC;;AAED;;;;;;;;;sBAOA7F,O,sBACA;AAAA,aADQK,OACR,yDADkB,KAClB;;AACI,oCAAML,OAAN,YAAcK,OAAd;;AAEA,aAAMwyB,iBAAiB,OAAOxyB,OAAP,KAAmB,SAAnB,GAA+BA,OAA/B,GAAyCA,WAAWA,QAAQwF,OAAnF;;AAEA,aAAIgtB,cAAJ,EACA;AACI,kBAAKhtB,OAAL,CAAa7F,OAAb,CAAqBK,OAArB;AACH;;AAED,cAAKyyB,IAAL,GAAY,IAAZ;AACA,cAAKvb,SAAL,GAAiB,IAAjB;AACA,cAAKC,MAAL,GAAc,IAAd;AACA,cAAK/C,UAAL,GAAkB,IAAlB;;AAEA,cAAKJ,QAAL,GAAgB,IAAhB;;AAEA,aAAI,KAAKue,uBAAT,EACA;AACI,kBAAKA,uBAAL,CAA6BG,MAA7B;AACA,kBAAKH,uBAAL,GAA+B,IAA/B;AACH;AACJ,M;;AAED;;;;;;;sBAKAI,gB,+BACA;AACI,aAAI,KAAKJ,uBAAT,EACA;AACI,kBAAKA,uBAAL,CAA6BG,MAA7B;AACA,kBAAKH,uBAAL,GAA+B,IAA/B;AACH;;AAED,cAAKK,WAAL,GAAmB,IAAnB;;AAEA,aAAI,KAAK5e,QAAT,EACA;AACI,kBAAKue,uBAAL,GAA+B,KAAKve,QAAL,CAAc6e,QAAd,CAAuB7mB,GAAvB,CAA2B,KAAK8mB,gBAAhC,EAAkD,IAAlD,CAA/B;;AAEA,iBAAI,KAAK9e,QAAL,CAAcC,KAAlB,EACA;AACI,sBAAK6e,gBAAL;AACH;AACJ;AACJ,M;;AAED;;;;;;;sBAKAA,gB,+BACA;AACI,cAAKF,WAAL,GAAmB,IAAnB;AACH,M;;;GAzF+B,UAAI7U,MAAJ,CAAWgV,IAAX,CAChC,UAAInV,mBAD4B,EACJ;AADI,gCAEJ;AAFI,6BAGJ;AAHI,2BAIJ;AAJI,E;;mBAAf0U,M;;;;;;;;;;;;;;;;;;+CCdZ7zB,O;;;;;;;;;wDACAA,O;;;;;;;;;2DACAA,O;;;;;;;;;;;;;;;;;;;ACJT;;;;AAEA;;;;;;;KAOqBu0B,S;AAEjB;;;;AAIA,0BACA;AAAA;;AACI;;;;;;AAMA,cAAKC,MAAL,GAAc,IAAd;;AAEA;;;;;;AAMA,cAAKC,GAAL,GAAW,IAAI,WAAK7kB,QAAT,EAAX;;AAEA;;;;;;AAMA,cAAK8kB,GAAL,GAAW,IAAI,WAAK9kB,QAAT,EAAX;;AAEA;;;;;;AAMA,cAAK+kB,SAAL,GAAiB,IAAI,WAAKtnB,QAAT,EAAjB;;AAEA;;;;;;AAMA,cAAKunB,MAAL,GAAc,IAAI,WAAKvnB,QAAT,CAAkB,CAAlB,EAAqB,CAArB,CAAd;;AAEA;;;;;;AAMA,cAAKwnB,KAAL,GAAa,IAAI,WAAKxnB,QAAT,EAAb;;AAEA;;;;;;AAMA,cAAKynB,MAAL,GAAc,IAAI,WAAKznB,QAAT,EAAd;;AAEA;;;;;;AAMA,cAAK0nB,SAAL,GAAiB,CAAjB;;AAEA;AACA,cAAKC,cAAL,GAAsB,CAAtB;AACA,cAAKC,cAAL,GAAsB,CAAtB;AACA,cAAKC,oBAAL,GAA4B,CAAC,CAA7B;AACA,cAAKC,oBAAL,GAA4B,CAAC,CAA7B;;AAEA;AACA,cAAKC,GAAL,GAAW7sB,KAAKuG,GAAL,CAAS,CAAT,CAAX;AACA,cAAKumB,GAAL,GAAW9sB,KAAKsG,GAAL,CAAS,CAAT,CAAX;AACA,cAAKymB,GAAL,GAAW/sB,KAAKsG,GAAL,CAAS,CAAT,CAAX,CA1EJ,CA0E4B;AACxB,cAAK0mB,GAAL,GAAWhtB,KAAKuG,GAAL,CAAS,CAAT,CAAX,CA3EJ,CA2E4B;AACxB,cAAK0mB,GAAL,GAAWjtB,KAAKuG,GAAL,CAAS,CAAT,CAAX,CA5EJ,CA4E4B;AACxB,cAAK2mB,GAAL,GAAWltB,KAAKsG,GAAL,CAAS,CAAT,CAAX,CA7EJ,CA6E4B;AAC3B;;AAED;;;;;;;AAuNA;;;;yBAIA6mB,U,yBACA;AACI,cAAKP,oBAAL,GAA4B,CAAC,CAA7B;AACH,M;;AAED;;;;;;yBAIAx0B,M,qBACA;AACI,cAAK0hB,KAAL,GAAa,IAAb;;AAEA,aAAMzM,KAAK,KAAK6e,GAAhB;AACA,aAAMkB,KAAK,KAAKjB,GAAhB;;AAEA,aAAI,KAAKM,cAAL,KAAwB,KAAKE,oBAAjC,EACA;AACI,iBAAM/vB,IAAK,KAAKkwB,GAAL,GAAW,KAAKT,MAAL,CAAY9sB,CAAlC;AACA,iBAAM1C,IAAK,KAAKgwB,GAAL,GAAW,KAAKR,MAAL,CAAY9sB,CAAlC;AACA,iBAAMmH,IAAI,CAAC,KAAKmmB,GAAN,GAAY,KAAKR,MAAL,CAAY7sB,CAAlC;AACA,iBAAMK,IAAK,KAAKitB,GAAL,GAAW,KAAKT,MAAL,CAAY7sB,CAAlC;;AAEA;AACA4tB,gBAAGxwB,CAAH,GAAQ,KAAKmwB,GAAL,GAAWnwB,CAAZ,GAAkB,KAAKowB,GAAL,GAAWtmB,CAApC;AACA0mB,gBAAGvwB,CAAH,GAAQ,KAAKkwB,GAAL,GAAWlwB,CAAZ,GAAkB,KAAKmwB,GAAL,GAAWntB,CAApC;AACAutB,gBAAG1mB,CAAH,GAAQ,KAAKumB,GAAL,GAAWrwB,CAAZ,GAAkB,KAAKswB,GAAL,GAAWxmB,CAApC;AACA0mB,gBAAGvtB,CAAH,GAAQ,KAAKotB,GAAL,GAAWpwB,CAAZ,GAAkB,KAAKqwB,GAAL,GAAWrtB,CAApC;;AAEA;AACAutB,gBAAGttB,EAAH,GAAQ,KAAKssB,SAAL,CAAe7sB,CAAf,IAAqB,KAAKgtB,MAAL,CAAYhtB,CAAZ,GAAgB6tB,GAAGxwB,CAApB,GAA0B,KAAK2vB,MAAL,CAAY/sB,CAAZ,GAAgB4tB,GAAG1mB,CAAjE,CAAR;AACA0mB,gBAAGrtB,EAAH,GAAQ,KAAKqsB,SAAL,CAAe5sB,CAAf,IAAqB,KAAK+sB,MAAL,CAAYhtB,CAAZ,GAAgB6tB,GAAGvwB,CAApB,GAA0B,KAAK0vB,MAAL,CAAY/sB,CAAZ,GAAgB4tB,GAAGvtB,CAAjE,CAAR;;AAEA,kBAAK8sB,oBAAL,GAA4B,KAAKF,cAAjC;AACA,kBAAKG,oBAAL,GAA4B,CAAC,CAA7B;AACH;;AAED,qBAAMloB,MAAN,CAAa,KAAKynB,GAAL,CAAS/iB,KAAT,EAAb,EAA+B,mEAA/B;;AAEA,aAAI,KAAK6iB,MAAT,EACA;AACI,iBAAI,KAAKW,oBAAL,KAA8B,KAAKX,MAAL,CAAYS,cAA9C,EACA;AACI,qBAAMW,KAAK,KAAKpB,MAAL,CAAYC,GAAvB;;AAEA;AACA7e,oBAAGzQ,CAAH,GAAQwwB,GAAGxwB,CAAH,GAAOywB,GAAGzwB,CAAX,GAAiBwwB,GAAGvwB,CAAH,GAAOwwB,GAAG3mB,CAAlC;AACA2G,oBAAGxQ,CAAH,GAAQuwB,GAAGxwB,CAAH,GAAOywB,GAAGxwB,CAAX,GAAiBuwB,GAAGvwB,CAAH,GAAOwwB,GAAGxtB,CAAlC;AACAwN,oBAAG3G,CAAH,GAAQ0mB,GAAG1mB,CAAH,GAAO2mB,GAAGzwB,CAAX,GAAiBwwB,GAAGvtB,CAAH,GAAOwtB,GAAG3mB,CAAlC;AACA2G,oBAAGxN,CAAH,GAAQutB,GAAG1mB,CAAH,GAAO2mB,GAAGxwB,CAAX,GAAiBuwB,GAAGvtB,CAAH,GAAOwtB,GAAGxtB,CAAlC;AACAwN,oBAAGvN,EAAH,GAASstB,GAAGttB,EAAH,GAAQutB,GAAGzwB,CAAZ,GAAkBwwB,GAAGrtB,EAAH,GAAQstB,GAAG3mB,CAA7B,GAAkC2mB,GAAGvtB,EAA7C;AACAuN,oBAAGtN,EAAH,GAASqtB,GAAGttB,EAAH,GAAQutB,GAAGxwB,CAAZ,GAAkBuwB,GAAGrtB,EAAH,GAAQstB,GAAGxtB,CAA7B,GAAkCwtB,GAAGttB,EAA7C;;AAEA,sBAAK6sB,oBAAL,GAA4B,KAAKX,MAAL,CAAYS,cAAxC;AACA,sBAAKA,cAAL;AACH;AACJ,UAjBD,MAkBK,IAAI,KAAKE,oBAAL,KAA8B,KAAKF,cAAvC,EACL;AACIrf,gBAAGtI,IAAH,CAAQ,KAAKonB,GAAb;AACA,kBAAKO,cAAL;AACA,kBAAKE,oBAAL,GAA4B,KAAKF,cAAjC;AACH;;AAED,qBAAMhoB,MAAN,CAAa,KAAKwnB,GAAL,CAAS9iB,KAAT,EAAb,EAA+B,mEAA/B;AACH,M;;AAED;;;;;yBAGAzQ,O,sBACA;AACI,cAAKuzB,GAAL,GAAW,IAAX;AACA,cAAKC,GAAL,GAAW,IAAX;AACA,cAAKC,SAAL,GAAiB,IAAjB;AACA,cAAKC,MAAL,GAAc,IAAd;AACA,cAAKC,KAAL,GAAa,IAAb;AACA,cAAKC,MAAL,GAAc,IAAd;AACH,M;;;;6BAnSD;AACI,oBAAO,KAAKJ,GAAZ;AACH;;AAED;;;;;;;;6BAMA;AACI,oBAAO,KAAKD,GAAZ;AACH;;AAED;;;;;;;;6BAMA;AACI,oBAAO,KAAKE,SAAL,CAAe7sB,CAAtB;AACH;;AAED;;;;;;2BAKMgM,C,EACN;AACI,kBAAK6gB,SAAL,CAAe7sB,CAAf,GAAmBgM,CAAnB;AACA,kBAAKkhB,cAAL;AACH;;AAED;;;;;;;;6BAMA;AACI,oBAAO,KAAKL,SAAL,CAAe5sB,CAAtB;AACH;;AAED;;;;;;2BAKM+L,C,EACN;AACI,kBAAK6gB,SAAL,CAAe5sB,CAAf,GAAmB+L,CAAnB;AACA,kBAAKkhB,cAAL;AACH;;AAED;;;;;;;;6BAMA;AACI,oBAAO,KAAKJ,MAAL,CAAY9sB,CAAnB;AACH;;AAED;;;;;;2BAKWgM,C,EACX;AACI,kBAAK8gB,MAAL,CAAY9sB,CAAZ,GAAgBgM,CAAhB;AACA,kBAAKkhB,cAAL;AACH;;AAED;;;;;;;;6BAMA;AACI,oBAAO,KAAKJ,MAAL,CAAY7sB,CAAnB;AACH;;AAED;;;;;;2BAKW+L,C,EACX;AACI,kBAAK8gB,MAAL,CAAY7sB,CAAZ,GAAgB+L,CAAhB;AACA,kBAAKkhB,cAAL;AACH;;AAED;;;;;;;;6BAMA;AACI,oBAAO,KAAKH,KAAL,CAAW/sB,CAAlB;AACH;;AAED;;;;;;2BAKUgM,C,EACV;AACI,kBAAK+gB,KAAL,CAAW/sB,CAAX,GAAegM,CAAf;AACA,kBAAK0hB,GAAL,GAAWjtB,KAAKuG,GAAL,CAASgF,CAAT,CAAX;AACA,kBAAK2hB,GAAL,GAAWltB,KAAKsG,GAAL,CAASiF,CAAT,CAAX;AACA,kBAAKkhB,cAAL;AACH;;AAED;;;;;;;;6BAMA;AACI,oBAAO,KAAKH,KAAL,CAAW9sB,CAAlB;AACH;;AAED;;;;;;2BAKU+L,C,EACV;AACI,kBAAK+gB,KAAL,CAAW9sB,CAAX,GAAe+L,CAAf;AACA,kBAAKwhB,GAAL,GAAW/sB,KAAKsG,GAAL,CAASiF,CAAT,CAAX;AACA,kBAAKyhB,GAAL,GAAWhtB,KAAKuG,GAAL,CAASgF,CAAT,CAAX;AACA,kBAAKkhB,cAAL;AACH;;AAED;;;;;;;;6BAMA;AACI,oBAAO,KAAKF,MAAL,CAAYhtB,CAAnB;AACH;;AAED;;;;;;2BAKWgM,C,EACX;AACI,kBAAKghB,MAAL,CAAYhtB,CAAZ,GAAgBgM,CAAhB;AACA,kBAAKkhB,cAAL;AACH;;AAED;;;;;;;;6BAMA;AACI,oBAAO,KAAKF,MAAL,CAAY/sB,CAAnB;AACH;;AAED;;;;;;2BAKW+L,C,EACX;AACI,kBAAKghB,MAAL,CAAY/sB,CAAZ,GAAgB+L,CAAhB;AACA,kBAAKkhB,cAAL;AACH;;AAED;;;;;;;;6BAMA;AACI,oBAAO,KAAKD,SAAZ;AACH;;AAED;;;;;;2BAKajhB,C,EACb;AACI,kBAAKihB,SAAL,GAAiBjhB,CAAjB;AACA,kBAAKshB,GAAL,GAAW7sB,KAAKuG,GAAL,CAASgF,CAAT,CAAX;AACA,kBAAKuhB,GAAL,GAAW9sB,KAAKsG,GAAL,CAASiF,CAAT,CAAX;AACA,kBAAKkhB,cAAL;AACH;;;;;;AAuFL;;;;;;;;;mBAnYqBT,S;AA0YrBA,WAAUsB,QAAV,GAAqB,IAAItB,SAAJ,EAArB,C;;;;;;;;;;;;mBCjZwBuB,kB;;AAFxB;;;;;;;;;;;;AAEe,UAASA,kBAAT,CAA4B51B,IAA5B,EACf;AACI;;;;AAIA;AAAA;;AAEI;;;AAGA,uBACA;AAAA;;AACyB;;AAErB;;;;;AAHJ,oDACI,kBAAS+T,SAAT,CADJ;;AAQI,aAAKxU,SAAL,GAAiB,yBAAjB;;AAEA;;;;;;AAMA,aAAKs2B,wBAAL,GAAgC,CAAC,CAAjC;AAhBJ;AAiBC;;AAvBL;AAAA,KAAqB71B,IAArB;AAyBH,E;;;;;;;;;;;;;ACjCD;;AACA;;;;;;;;;;;;AAEA;AACA;AACA;;AAEA;;;;KAIqB81B,qB;;;AAEjB;;;;;;AAMA,oCAAY51B,QAAZ,EACA;AAAA,aADsBC,QACtB,yDADiC,UAAIW,MAAJ,CAAWF,QAAX,CAAoBK,MACrD;AAAA,aAD6DZ,SAC7D,yDADyE,CACzE;;AAAA;;AAAA,iDACI,uBAAMH,QAAN,EAAgBC,QAAhB,EAA0BE,SAA1B,CADJ;AAEC;;AAED;;;;;;;;qCAMAC,I,iBAAKC,M,EACL;AACI,gBAAOA,OAAOC,YAAP,8BAAP;AACH,M;;AAED;;;;;;;qCAKAC,M,mBAAOF,M,EACP;AACIA,gBAAOhB,SAAP,CAAiBkB,MAAjB;AACH,M;;;GAhC8C,UAAIK,M;;mBAAlCg1B,qB;;;AAmCrB,cAAO30B,QAAP,CAAgBR,gBAAhB,CAAiCm1B,qBAAjC,E;;;;;;;;;;;;;;;;;;6CC5CSh2B,O;;;;;;;;;sDACAA,O;;;;;;;;;mDACAA,O;;;;;;;;;gDACAA,O;;;;;;;;;;;;;;;;;;;ACLT;;;;AACA;;AACA;;;;AACA;;;;AAEA;;;;;;AAEA;;;;;;;KAOqBi2B,O;AAEjB;;;;;;;;AAQA,sBAAYjrB,MAAZ,EACA;AAAA,aADoBkrB,KACpB,yDAD4B,IAC5B;AAAA,aADkCxgB,IAClC,yDADyC,IACzC;AAAA,aAD+CD,IAC/C,yDADsD,IACtD;AAAA,aAD4D0gB,QAC5D,yDADuE,CACvE;;AAAA;;AACI;AACA,aAAInrB,kBAAkBirB,OAAtB,EACA;AACIjrB,sBAASA,OAAOA,MAAhB;AACH,UAHD,MAIK,IAAI,EAAEA,yCAAF,CAAJ,EACL;AACIA,sBAAS,4BAAkBA,MAAlB,CAAT;AACH;;AAED,qBAAMiC,MAAN,CAAajC,yCAAb,EAA8C,kDAA9C;;AAEA;;;;;AAKA,cAAKA,MAAL,GAAcA,MAAd;;AAEA;;;;;AAKA,cAAKyK,IAAL,GAAYA,IAAZ;;AAEA;;;;;AAKA,cAAKC,IAAL,GAAYA,QAAQwgB,KAApB;;AAEA;;;;;AAKA,cAAK9B,QAAL,GAAgB,2BAAhB;;AAEA;;;;;;AAMA,cAAKgC,cAAL,GAAsB,CAAC,CAACF,KAAxB;;AAEA;;;;;;AAMA,cAAKG,MAAL,GAAc,IAAd;;AAEA;;;;;AAKA,cAAKC,IAAL,GAAY,0BAAZ;;AAEA;;;;;AAKA,cAAKvB,SAAL,GAAiBoB,aAAa,IAAb,GAAoB,CAAC5tB,KAAKqG,EAAN,GAAW,CAA/B,GAAmCunB,QAApD;;AAEA,cAAKI,sBAAL,GAA8B,IAA9B;AACA,cAAKC,qBAAL,GAA6B,IAA7B;;AAEA;AACA,aAAIxrB,OAAOwK,KAAX,EACA;AACI,iBAAI,CAAC,KAAK4gB,cAAV,EACA;AACIF,yBAAQ,sBAAc,CAAd,EAAiB,CAAjB,EAAoBlrB,OAAOlG,KAA3B,EAAkCkG,OAAOjG,MAAzC,CAAR;;AAEA,sBAAKwxB,sBAAL,GAA8BvrB,OAAOopB,QAAP,CAAgB7mB,GAAhB,CAAoB,KAAKkpB,eAAzB,EAA0C,IAA1C,CAA9B;AACH;;AAED,kBAAKP,KAAL,GAAaA,KAAb;AACH,UAVD,MAYA;AACI,kBAAKM,qBAAL,GAA6BxrB,OAAO0rB,OAAP,CAAeC,IAAf,CAAoB,KAAKC,cAAzB,EAAyC,IAAzC,CAA7B;AACH;AACJ;;AAED;;;;;;;AA8EA;;;;;uBAKAj2B,M,qBACA;AACI,cAAKqK,MAAL,CAAYrK,MAAZ;;AAEA,gBAAO,IAAP;AACH,M;;AAED;;;;;;;uBAKA2F,K,oBACA;AACI,gBAAO,IAAI2vB,OAAJ,CAAY,KAAKjrB,MAAjB,EAAyB,KAAKkrB,KAA9B,EAAqC,KAAKxgB,IAA1C,EAAgD,KAAKD,IAArD,EAA2D,KAAK0gB,QAAhE,CAAP;AACH,M;;AAED;;;;;;;;uBAMAj1B,O,sBACA;AAAA,aADQK,OACR,yDADkB,KAClB;;AACI,aAAMs1B,gBAAgB,OAAOt1B,OAAP,KAAmB,SAAnB,GAA+BA,OAA/B,GAAyCA,WAAWA,QAAQu1B,WAAlF;;AAEA,aAAI,KAAKP,sBAAT,EAAiC,KAAKA,sBAAL,CAA4BtC,MAA5B;AACjC,aAAI,KAAKuC,qBAAT,EAAgC,KAAKA,qBAAL,CAA2BvC,MAA3B;;AAEhC,cAAKsC,sBAAL,GAA8B,IAA9B;AACA,cAAKC,qBAAL,GAA6B,IAA7B;;AAEA,aAAIK,aAAJ,EACA;AACI,kBAAK7rB,MAAL,CAAY9J,OAAZ;AACH;;AAED,cAAK8J,MAAL,GAAc,IAAd;AACA,cAAKyK,IAAL,GAAY,IAAZ;AACA,cAAKC,IAAL,GAAY,IAAZ;;AAEA,cAAK0e,QAAL,CAAc1vB,SAAd;AACA,cAAK0vB,QAAL,GAAgB,IAAhB;;AAEA,cAAKiC,MAAL,GAAc,IAAd;AACA,cAAKC,IAAL,GAAY,IAAZ;AACH,M;;AAED;;;;;;;uBAKAM,c,6BACA;AACI,aAAI,KAAKR,cAAT,EACA;AACI;AACA,kBAAKF,KAAL,GAAa,KAAKG,MAAlB;AACH,UAJD,MAMA;AACI,kBAAKH,KAAL,GAAa,sBAAc,CAAd,EAAiB,CAAjB,EAAoB,KAAKlrB,MAAL,CAAYlG,KAAhC,EAAuC,KAAKkG,MAAL,CAAYjG,MAAnD,CAAb;AACH;AACJ,M;;AAED;;;;;;;uBAKA0xB,e,8BACA;AACI,cAAKJ,MAAL,CAAYvxB,KAAZ,GAAoB,KAAKkG,MAAL,CAAYlG,KAAhC;AACA,cAAKuxB,MAAL,CAAYtxB,MAAZ,GAAqB,KAAKiG,MAAL,CAAYjG,MAAjC;;AAEA,cAAKqvB,QAAL,CAAcjwB,QAAd;AACH,M;;AAED;;;;;;;uBAKA4yB,U,yBACA;AACI,cAAKT,IAAL,CAAU1wB,GAAV,CAAc,KAAKywB,MAAnB,EAA2B,KAAKrrB,MAAhC,EAAwC,KAAKmrB,QAA7C;AACH,M;;;;6BArKD;AACI,oBAAO,CAAC,EAAE,CAAC,KAAKnrB,MAAL,GAAc,KAAKA,MAAL,CAAYwK,KAA1B,GAAkC,KAAnC,KAA6C,KAAKE,IAApD,CAAR;AACH;;AAED;;;;;;;;6BAMA;AACI,oBAAO,KAAK2gB,MAAZ;AACH;;AAED;;;;2BAGUviB,C,EACV;AACI,kBAAKuiB,MAAL,GAAcviB,CAAd;AACA,kBAAKsiB,cAAL,GAAsB,IAAtB;;AAEA,yBAAMnpB,MAAN,CACI6G,EAAEhM,CAAF,IAAO,CAAP,IAAYgM,EAAE/L,CAAF,IAAO,CAAnB,IAAwB+L,EAAEhM,CAAF,GAAMgM,EAAEhP,KAAR,IAAiB,KAAKkG,MAAL,CAAYlG,KAArD,IAA8DgP,EAAE/L,CAAF,GAAM+L,EAAE/O,MAAR,IAAkB,KAAKiG,MAAL,CAAYjG,MADhG,EAEI,uDAFJ;;AAKA,iBAAI,CAAC,KAAK0Q,IAAN,IAAc,CAAC,KAAK9E,MAAxB,EACA;AACI,sBAAK+E,IAAL,GAAY5B,CAAZ;AACH;;AAED,kBAAKijB,UAAL;AACH;;AAED;;;;;;;;6BAMA;AACI,oBAAO,KAAKhC,SAAZ;AACH;;AAED;;;;2BAGajhB,C,EACb;AACI,kBAAKihB,SAAL,GAAiBjhB,CAAjB;AACA,kBAAKijB,UAAL;AACH;;AAED;;;;;;;6BAKA;AACI,oBAAO,KAAKrhB,IAAL,GAAY,KAAKA,IAAL,CAAU5Q,KAAtB,GAA8B,CAArC;AACH;;AAED;;;;;;;6BAKA;AACI,oBAAO,KAAK4Q,IAAL,GAAY,KAAKA,IAAL,CAAU3Q,MAAtB,GAA+B,CAAtC;AACH;;;;;;AAkGL;;;;;;;;;;mBArRqBkxB,O;AA6RrBA,SAAQliB,KAAR,GAAgB,IAAIkiB,OAAJ,CAAY,wBAAcliB,KAA1B,CAAhB;AACAkiB,SAAQliB,KAAR,CAAc7S,OAAd,GAAwB,SAAS81B,KAAT,GAAiB,CAAE,WAAa,CAAxD,C,CAA0D,kC;;;;;;;;;;;;;;;;;AC5S1D;;;;AACA;;;;AACA;;;;;;AAEA;;;;;;;KAOqBC,a;AAEjB;;;;;;;;AAQA,4BACIjsB,MADJ,EAMA;AAAA,aAJI/E,SAIJ,yDAJgBgxB,cAAcjyB,gBAI9B;AAAA,aAHIkyB,QAGJ,yDAHeD,cAAcE,eAG7B;AAAA,aAFItsB,MAEJ,yDAFaosB,cAAcG,aAE3B;;AAAA;;AACI;;;;;;AAMA,cAAKtyB,KAAL,GAAa,CAAb;;AAEA;;;;;;AAMA,cAAKC,MAAL,GAAc,CAAd;;AAEA;;;;;;;;;AASA,cAAKyQ,KAAL,GAAa,KAAb;;AAEA;;;;;;;;AAQA,cAAK6hB,kBAAL,GAA0B,IAA1B;;AAEA;;;;;;;AAOA,cAAKC,YAAL,GAAoB,KAApB;;AAEA;;;;;;;;;;;;AAYA,cAAKrxB,SAAL,GAAiBA,SAAjB;;AAEA;;;;;;;;;;;;;AAaA,cAAKixB,QAAL,GAAgBA,QAAhB;;AAEA;;;;;;;;;AASA,cAAKrsB,MAAL,GAAcA,MAAd;;AAEA;;;;;;;AAOA,cAAK6rB,OAAL,GAAe,2BAAf;;AAEA;;;;;;AAMA,cAAKa,OAAL,GAAe,2BAAf;;AAEA;;;;;AAKA,cAAKnD,QAAL,GAAgB,2BAAhB;;AAEA;;;;;;AAMA,cAAKoD,OAAL,GAAe,IAAf;;AAEA;;;;;;AAMA,cAAKC,WAAL,GAAmB,CAAnB;;AAEA;;;;;;AAMA,cAAKC,WAAL,GAAmB,EAAnB;AACA,cAAKC,QAAL,GAAgB,CAAhB;AACA,cAAKC,GAAL,GAAW,CAAX;;AAEA,cAAKC,kBAAL,GAA0B,KAAKC,aAAL,CAAmBr1B,IAAnB,CAAwB,IAAxB,CAA1B;AACA,cAAKs1B,mBAAL,GAA2B,KAAKC,cAAL,CAAoBv1B,IAApB,CAAyB,IAAzB,CAA3B;AACA,cAAKw1B,kBAAL,GAA0B,KAAKC,aAAL,CAAmBz1B,IAAnB,CAAwB,IAAxB,CAA1B;AACA,cAAK01B,kBAAL,GAA0B,KAAKC,aAAL,CAAmB31B,IAAnB,CAAwB,IAAxB,CAA1B;AACA,cAAK41B,qBAAL,GAA6B,KAAKC,gBAAL,CAAsB71B,IAAtB,CAA2B,IAA3B,CAA7B;;AAEA,cAAK81B,wBAAL,GAAgC,EAAhC;;AAEA;AACA,cAAKvtB,MAAL,GAAcA,MAAd;;AAEA,aAAMiE,IAAIpI,qBAAV;AACA,aAAMkK,IAAI,KAAK9K,SAAf;AACA,aAAMuyB,IAAI,KAAKtB,QAAf;;AAEA,qBAAMjqB,MAAN,CAAa8D,MAAM9B,EAAEvG,MAAR,IAAkBqI,MAAM9B,EAAEnI,OAAvC,0BAAsEiK,CAAtE,kBAAmFA,CAAnF,yCAAmFA,CAAnF;AACA,qBAAM9D,MAAN,CAAaurB,MAAMvpB,EAAExC,aAAR,IAAyB+rB,MAAMvpB,EAAErC,MAAjC,IAA2C4rB,MAAMvpB,EAAEnC,eAAhE,yBAAsG0rB,CAAtG,kBAAmHA,CAAnH,yCAAmHA,CAAnH,WAzJJ,CAyJ+H;AAC3H,qBAAMvrB,MAAN,CAAa,OAAO,KAAKpC,MAAZ,KAAuB,SAApC,6BAAwE,KAAKA,MAA7E,kBAA+F,KAAKA,MAApG;AACH;;AAED;;;;;;;AAkBA;;;;;;;6BAOAlK,M,qBACA;AAAA;;AAAA,aADOP,QACP,yDADkB,IAClB;AAAA,aADwBq4B,MACxB,yDADiC,KACjC;;AACI,cAAK3zB,KAAL,GAAa,KAAKkG,MAAL,CAAY0tB,YAAZ,IAA4B,KAAK1tB,MAAL,CAAYE,UAAxC,IAAsD,KAAKF,MAAL,CAAYlG,KAA/E;AACA,cAAKC,MAAL,GAAc,KAAKiG,MAAL,CAAY2tB,aAAZ,IAA6B,KAAK3tB,MAAL,CAAYG,WAAzC,IAAwD,KAAKH,MAAL,CAAYjG,MAAlF;;AAEA,cAAKuyB,YAAL,GAAoB,qBAAWsB,MAAX,CAAkB,KAAK9zB,KAAvB,KAAiC,qBAAW8zB,MAAX,CAAkB,KAAK7zB,MAAvB,CAArD;;AAEA,aAAI3E,QAAJ,EACA;AACI,kBAAKy4B,OAAL,CAAaz4B,SAASuB,GAAtB;AACH,UAHD,MAKA;AACI2Y,oBAAOC,IAAP,CAAY,KAAKmd,WAAjB,EAA8Bld,OAA9B,CAAsC,UAACC,CAAD;AAAA,wBAAO,MAAKoe,OAAL,CAAape,CAAb,CAAP;AAAA,cAAtC;AACH;;AAED,aAAI,KAAKzP,MAAL,CAAY8tB,WAAZ,IAA2B,CAAC,KAAK9tB,MAAL,CAAY+tB,MAAxC,IAAkD,CAAC,KAAK/tB,MAAL,CAAYguB,KAAnE,EACA;AACI,kBAAKd,aAAL;AACH;;AAED,aAAI,CAACO,MAAL,EACA;AACI,kBAAKrE,QAAL,CAAcjwB,QAAd;AACH;;AAED,gBAAO,IAAP;AACH,M;;AAED;;;;;;;6BAKA+rB,O,sBACA;AAAA;;AAAA,aADQ9vB,QACR,yDADmB,IACnB;;AACI,aAAIA,QAAJ,EACA;AACI,kBAAK64B,QAAL,CAAc74B,SAASuB,GAAvB;AACH,UAHD,MAKA;AACI2Y,oBAAOC,IAAP,CAAY,KAAKmd,WAAjB,EAA8Bld,OAA9B,CAAsC,UAACC,CAAD;AAAA,wBAAO,OAAKwe,QAAL,CAAcxe,CAAd,CAAP;AAAA,cAAtC;AACH;AACJ,M;;AAED;;;;;;;;;6BAOA4P,Y,yBAAajqB,Q,EACb;AACI,aAAI,CAAC,KAAKoV,KAAV,EAAiB,OAAO,IAAP;;AAEjB;AACA,aAAI,KAAKxK,MAAL,CAAY7E,WAAhB,EACA;AACI,iBAAI,KAAK6E,MAAL,CAAY7E,WAAZ,CAAwBY,OAA5B,EACA;AACI,wBAAO,KAAKiE,MAAL,CAAY7E,WAAZ,CAAwBY,OAA/B;AACH;;AAED,yBAAMkG,MAAN,CAAa,KAAb,EAAoB,uEAApB;;AAEA,oBAAO,IAAP;AACH;;AAED,aAAIisB,YAAY,KAAKxB,WAAL,CAAiBt3B,SAASuB,GAA1B,CAAhB;;AAEA,aAAI,CAACu3B,SAAL,EACA;AACIA,yBAAY,IAAI,aAAO3uB,SAAX,CAAqBnK,SAASoB,EAA9B,CAAZ;AACA03B,uBAAUpuB,gBAAV,GAA6B,IAA7B;;AAEA,kBAAK4sB,WAAL,CAAiBt3B,SAASuB,GAA1B,IAAiCu3B,SAAjC;;AAEA,kBAAKX,wBAAL,CAA8Bn4B,SAASuB,GAAvC,IAA8CvB,SAAS4B,eAAT,CAAyBuL,GAAzB,CAA6B,KAAKie,gBAAlC,EAAoD,IAApD,CAA9C;;AAEA;AACA,iBAAI,KAAK8L,YAAT,EACA;AACI,qBAAI,KAAKzsB,MAAT,EACA;AACIquB,+BAAU5sB,YAAV;AACH;;AAED,qBAAI,KAAK4qB,QAAL,KAAkBrwB,sBAAsB4F,aAA5C,EACA;AACIysB,+BAAUjwB,eAAV;AACH,kBAHD,MAIK,IAAI,KAAKiuB,QAAL,KAAkBrwB,sBAAsB+F,MAA5C,EACL;AACIssB,+BAAUvsB,gBAAV;AACH,kBAHI,MAKL;AACIusB,+BAAUrsB,sBAAV;AACH;AACJ,cAnBD,MAqBA;AACIqsB,2BAAUjwB,eAAV;AACH;;AAED;AACA,iBAAI,KAAKhD,SAAL,KAAmBY,sBAAsBC,OAA7C,EACA;AACIoyB,2BAAUlyB,oBAAV;AACH,cAHD,MAKA;AACIkyB,2BAAUjyB,mBAAV;AACH;;AAED,kBAAK4xB,OAAL,CAAaz4B,SAASuB,GAAtB;AACH;;AAED,gBAAOu3B,SAAP;AACH,M;;AAED;;;;;;6BAIAh4B,O,sBACA;AACI,cAAKgvB,OAAL;;AAEA,cAAKiJ,mBAAL;AACA,cAAKnuB,MAAL,GAAc,IAAd;;AAEA,cAAKopB,QAAL,CAAc1vB,SAAd;AACA,cAAK0vB,QAAL,GAAgB,IAAhB;;AAEA,cAAKsC,OAAL,CAAahyB,SAAb;AACA,cAAKgyB,OAAL,GAAe,IAAf;;AAEA,cAAKa,OAAL,CAAa7yB,SAAb;AACA,cAAK6yB,OAAL,GAAe,IAAf;AACH,M;;AAED;;;;;;;;6BAMAsB,O,oBAAQl3B,G,EACR;AACI,aAAMu3B,YAAY,KAAKxB,WAAL,CAAiB/1B,GAAjB,CAAlB;;AAEA,aAAIu3B,SAAJ,EACA;AACIA,uBAAUjuB,MAAV,CAAiB,KAAKD,MAAtB;AACH;AACJ,M;;AAED;;;;;;;;6BAMAiuB,Q,qBAASt3B,G,EACT;AACI,aAAMu3B,YAAY,KAAKxB,WAAL,CAAiB/1B,GAAjB,CAAlB;;AAEA,aAAIu3B,SAAJ,EACA;AACIA,uBAAUh4B,OAAV;;AAEA,oBAAO,KAAKw2B,WAAL,CAAiB/1B,GAAjB,CAAP;AACH;AACJ,M;;AAED;;;;;;;;6BAMAy3B,K,kBAAMpuB,M,EACN;AACI,cAAKwK,KAAL,GAAa,KAAb;AACA,cAAK2jB,mBAAL;;AAEA,cAAK3B,OAAL,GAAexsB,MAAf;;AAEA,aAAI,CAACA,MAAL,EAAa;;AAEb;AACA,aAAIA,OAAO7E,WAAX,EACA;AACI,yBAAM8G,MAAN,CAAajC,OAAOlG,KAAP,IAAgBkG,OAAOjG,MAApC,EAA4C,iDAA5C;;AAEA,kBAAK+yB,aAAL;AACH;AACD;AANA,cAOK,IAAI9sB,OAAOzF,UAAX,EACL;AACI,6BAAM0H,MAAN,CAAajC,OAAOlG,KAAP,IAAgBkG,OAAOjG,MAApC,EAA4C,2CAA5C;;AAEA,sBAAK+yB,aAAL;AACH,cALI,MAOL;AACI,sBAAKuB,iBAAL;;AAEA;AACA,qBAAI,OAAOruB,OAAOgS,GAAd,KAAsB,QAA1B,EACA;AACI;AACA;AACA,yBAAIhS,OAAOsuB,QAAP,IAAmBtuB,OAAOgS,GAA9B,EACA;AACI,8BAAK8a,aAAL;AACH;AACJ;AACD;AATA,sBAUK,IAAI9sB,OAAOsuB,QAAX,EACL;AACI,8BAAKxB,aAAL;AACH;AACJ;AACJ,M;;AAED;;;;;;;6BAKAtM,gB,6BAAiBprB,Q,EACjB;AACI,cAAK64B,QAAL,CAAc74B,SAASuB,GAAvB;AACH,M;;AAED;;;;;;;6BAKAm2B,a,4BACA;AAAA;;AACI;AACA,cAAKn3B,MAAL,CAAY,IAAZ,EAAkB,IAAlB;AACA,aAAI,CAAC,KAAKmE,KAAN,IAAe,CAAC,KAAKC,MAAzB,EACA;AACI,kBAAKizB,cAAL,CAAoB,EAAE7qB,SAAS,wBAAX,EAApB;;AAEA;AACH;;AAED;AACA,cAAKgsB,mBAAL,CAAyB,IAAzB;;AAEA;AACA,cAAK3jB,KAAL,GAAa,IAAb;AACA,cAAK7U,MAAL;;AAEA;AACA44B,oBAAW;AAAA,oBAAM,OAAK7C,OAAL,CAAavyB,QAAb,EAAN;AAAA,UAAX,EAA0C,CAA1C;AACH,M;;AAED;;;;;;;;6BAMA6zB,c,2BAAe/yB,K,EACf;AAAA;;AACI,cAAKk0B,mBAAL;;AAEA;AACAI,oBAAW;AAAA,oBAAM,OAAKhC,OAAL,CAAapzB,QAAb,CAAsB,IAAIqB,KAAJ,CAAUP,MAAMkI,OAAN,IAAiB,wBAA3B,CAAtB,CAAN;AAAA,UAAX,EAA8F,CAA9F;AACH,M;;AAED;;;;;;;6BAKA+qB,a,4BACA;AACIsB,8BAAqB,KAAK/B,WAA1B;AACA,cAAKa,gBAAL;AACH,M;;AAED;;;;;;;6BAKAF,a,4BACA;AACIoB,8BAAqB,KAAK/B,WAA1B;AACH,M;;AAED;;;;;;;6BAKAa,gB,+BACA;AACI,cAAKb,WAAL,GAAmBgC,sBAAsB,KAAKpB,qBAA3B,CAAnB;AACA,cAAK13B,MAAL,CAAY,IAAZ,EAAkB,IAAlB;AACH,M;;AAED;;;;;;;;6BAMA04B,iB,gCACA;AAAA,aADkBK,QAClB,yDAD6B,KAC7B;;AACI,aAAI,CAAC,KAAKlC,OAAV,EAAmB;;AAEnB,cAAKA,OAAL,CAAa30B,gBAAb,CAA8B,MAA9B,EAAsC,KAAKg1B,kBAA3C;AACA,cAAKL,OAAL,CAAa30B,gBAAb,CAA8B,SAA9B,EAAyC,KAAKg1B,kBAA9C;AACA,cAAKL,OAAL,CAAa30B,gBAAb,CAA8B,gBAA9B,EAAgD,KAAKg1B,kBAArD;AACA,cAAKL,OAAL,CAAa30B,gBAAb,CAA8B,OAA9B,EAAuC,KAAKk1B,mBAA5C;;AAEA,aAAI,CAAC2B,QAAL,EACA;AACI,kBAAKlC,OAAL,CAAa30B,gBAAb,CAA8B,MAA9B,EAAsC,KAAKo1B,kBAA3C;AACA,kBAAKT,OAAL,CAAa30B,gBAAb,CAA8B,OAA9B,EAAuC,KAAKs1B,kBAA5C;AACH;AACJ,M;;AAED;;;;;;;;6BAMAgB,mB,kCACA;AAAA,aADoBO,QACpB,yDAD+B,KAC/B;;AACI,aAAI,CAAC,KAAKlC,OAAV,EAAmB;;AAEnB,cAAKA,OAAL,CAAa/yB,mBAAb,CAAiC,MAAjC,EAAyC,KAAKozB,kBAA9C;AACA,cAAKL,OAAL,CAAa/yB,mBAAb,CAAiC,SAAjC,EAA4C,KAAKozB,kBAAjD;AACA,cAAKL,OAAL,CAAa/yB,mBAAb,CAAiC,gBAAjC,EAAmD,KAAKozB,kBAAxD;AACA,cAAKL,OAAL,CAAa/yB,mBAAb,CAAiC,OAAjC,EAA0C,KAAKszB,mBAA/C;;AAEA,aAAI,CAAC2B,QAAL,EACA;AACI,kBAAKlC,OAAL,CAAa/yB,mBAAb,CAAiC,MAAjC,EAAyC,KAAKwzB,kBAA9C;AACA,kBAAKT,OAAL,CAAa/yB,mBAAb,CAAiC,OAAjC,EAA0C,KAAK0zB,kBAA/C;AACH;AACJ,M;;;;6BArXD;AACI,oBAAO,KAAKX,OAAZ;AACH;;AAED;;;;2BAGW1jB,C,EACX;AACI,kBAAKslB,KAAL,CAAWtlB,CAAX;AACH;;;;;;AA8WL;;;;;;;;;;;;mBA3iBqBmjB,a;AAqjBrBA,eAAcjyB,gBAAd,GAAiC6B,sBAAsB6B,MAAvD;;AAEA;;;;;;;;;;AAUAuuB,eAAcG,aAAd,GAA8B,IAA9B;;AAEA;;;;;;;;;;AAUAH,eAAcE,eAAd,GAAgCtwB,sBAAsB4F,aAAtD;;AAEA;;;;;;;;AAQAwqB,eAAcljB,KAAd,GAAsB,IAAIkjB,aAAJ,EAAtB;AACAA,eAAcljB,KAAd,CAAoB7S,OAApB,GAA8B,SAAS81B,KAAT,GAAiB,CAAE,WAAa,CAA9D,C,CAAgE,kC;;;;;;;;;;;;;;;ACnmBhE;;;;;;KAMqB2C,U;AAEjB;;;AAGA,+BACA;AAAA;;AACI,sBAAKC,EAAL,GAAU,CAAV;AACA,sBAAKC,EAAL,GAAU,CAAV;;AAEA,sBAAKC,EAAL,GAAU,CAAV;AACA,sBAAKC,EAAL,GAAU,CAAV;;AAEA,sBAAKC,EAAL,GAAU,CAAV;AACA,sBAAKC,EAAL,GAAU,CAAV;;AAEA,sBAAKC,EAAL,GAAU,CAAV;AACA,sBAAKC,EAAL,GAAU,CAAV;;AAEA,sBAAKC,SAAL,GAAiB,IAAIvc,WAAJ,CAAgB,CAAhB,CAAjB;AACH;;AAED;;;;;;;;;;8BAQAjY,G,gBAAIswB,K,EAAOmE,S,EAAWlE,Q,EACtB;AACI,qBAAMmE,KAAKD,UAAUv1B,KAArB;AACA,qBAAMy1B,KAAKF,UAAUt1B,MAArB;;AAEA,sBAAK60B,EAAL,GAAU1D,MAAMpuB,CAAN,GAAUwyB,EAApB;AACA,sBAAKT,EAAL,GAAU3D,MAAMnuB,CAAN,GAAUwyB,EAApB;;AAEA,sBAAKT,EAAL,GAAU,CAAC5D,MAAMpuB,CAAN,GAAUouB,MAAMpxB,KAAjB,IAA0Bw1B,EAApC;AACA,sBAAKP,EAAL,GAAU7D,MAAMnuB,CAAN,GAAUwyB,EAApB;;AAEA,sBAAKP,EAAL,GAAU,CAAC9D,MAAMpuB,CAAN,GAAUouB,MAAMpxB,KAAjB,IAA0Bw1B,EAApC;AACA,sBAAKL,EAAL,GAAU,CAAC/D,MAAMnuB,CAAN,GAAUmuB,MAAMnxB,MAAjB,IAA2Bw1B,EAArC;;AAEA,sBAAKL,EAAL,GAAUhE,MAAMpuB,CAAN,GAAUwyB,EAApB;AACA,sBAAKH,EAAL,GAAU,CAACjE,MAAMnuB,CAAN,GAAUmuB,MAAMnxB,MAAjB,IAA2Bw1B,EAArC;;AAEA,qBAAIpE,QAAJ,EACA;AACI;AACA,6BAAMqE,KAAMtE,MAAMpuB,CAAN,GAAUwyB,EAAX,GAAkBpE,MAAMpxB,KAAN,GAAc,CAAd,GAAkBw1B,EAA/C;AACA,6BAAMG,KAAMvE,MAAMnuB,CAAN,GAAUwyB,EAAX,GAAkBrE,MAAMnxB,MAAN,GAAe,CAAf,GAAmBw1B,EAAhD;;AAEA;AACA,6BAAMG,KAAKnyB,KAAKuG,GAAL,CAASqnB,QAAT,CAAX;AACA,6BAAMwE,KAAKpyB,KAAKsG,GAAL,CAASsnB,QAAT,CAAX;;AAEA,8BAAKyD,EAAL,GAAUY,MAAO,CAAC,KAAKZ,EAAL,GAAUY,EAAX,IAAiBG,EAAlB,GAAyB,CAAC,KAAKd,EAAL,GAAUY,EAAX,IAAiBC,EAAhD,CAAV;AACA,8BAAKb,EAAL,GAAUY,MAAO,CAAC,KAAKb,EAAL,GAAUY,EAAX,IAAiBE,EAAlB,GAAyB,CAAC,KAAKb,EAAL,GAAUY,EAAX,IAAiBE,EAAhD,CAAV;;AAEA,8BAAKb,EAAL,GAAUU,MAAO,CAAC,KAAKV,EAAL,GAAUU,EAAX,IAAiBG,EAAlB,GAAyB,CAAC,KAAKZ,EAAL,GAAUU,EAAX,IAAiBC,EAAhD,CAAV;AACA,8BAAKX,EAAL,GAAUU,MAAO,CAAC,KAAKX,EAAL,GAAUU,EAAX,IAAiBE,EAAlB,GAAyB,CAAC,KAAKX,EAAL,GAAUU,EAAX,IAAiBE,EAAhD,CAAV;;AAEA,8BAAKX,EAAL,GAAUQ,MAAO,CAAC,KAAKR,EAAL,GAAUQ,EAAX,IAAiBG,EAAlB,GAAyB,CAAC,KAAKV,EAAL,GAAUQ,EAAX,IAAiBC,EAAhD,CAAV;AACA,8BAAKT,EAAL,GAAUQ,MAAO,CAAC,KAAKT,EAAL,GAAUQ,EAAX,IAAiBE,EAAlB,GAAyB,CAAC,KAAKT,EAAL,GAAUQ,EAAX,IAAiBE,EAAhD,CAAV;;AAEA,8BAAKT,EAAL,GAAUM,MAAO,CAAC,KAAKN,EAAL,GAAUM,EAAX,IAAiBG,EAAlB,GAAyB,CAAC,KAAKR,EAAL,GAAUM,EAAX,IAAiBC,EAAhD,CAAV;AACA,8BAAKP,EAAL,GAAUM,MAAO,CAAC,KAAKP,EAAL,GAAUM,EAAX,IAAiBE,EAAlB,GAAyB,CAAC,KAAKP,EAAL,GAAUM,EAAX,IAAiBE,EAAhD,CAAV;AACH;;AAED,sBAAKP,SAAL,CAAe,CAAf,IAAqB,CAAE,KAAKP,EAAL,GAAU,KAAX,GAAoB,MAArB,KAAgC,EAAjC,GAAyC,KAAKD,EAAL,GAAU,KAAX,GAAoB,MAAhF;AACA,sBAAKQ,SAAL,CAAe,CAAf,IAAqB,CAAE,KAAKL,EAAL,GAAU,KAAX,GAAoB,MAArB,KAAgC,EAAjC,GAAyC,KAAKD,EAAL,GAAU,KAAX,GAAoB,MAAhF;AACA,sBAAKM,SAAL,CAAe,CAAf,IAAqB,CAAE,KAAKH,EAAL,GAAU,KAAX,GAAoB,MAArB,KAAgC,EAAjC,GAAyC,KAAKD,EAAL,GAAU,KAAX,GAAoB,MAAhF;AACA,sBAAKI,SAAL,CAAe,CAAf,IAAqB,CAAE,KAAKD,EAAL,GAAU,KAAX,GAAoB,MAArB,KAAgC,EAAjC,GAAyC,KAAKD,EAAL,GAAU,KAAX,GAAoB,MAAhF;AACH,U;;;;;mBA1EgBP,U;;;;;;;;;;;;;;;mBCNGiB,gB;;;;;;;;AAAT,UAASA,gBAAT,CAA0B16B,IAA1B,EACf;AACI;;;;AAIA;AAAA;;AAEI;;;AAGA,uBACA;AAAA;;AACyB;;AAErB;;;;;;AAHJ,oDACI,kBAAS+T,SAAT,CADJ;;AASI,aAAKsB,QAAL,GAAgB,IAAhB;;AAEA;;;;;;AAMA,aAAKO,QAAL,GAAgB,CAAhB;;AAEA;;;;;;AAMA,aAAKG,QAAL,GAAgB,CAAhB;;AAEA;;;;;;AAMA,aAAK4kB,YAAL,GAAoB,IAApB;AAjCJ;AAkCC;;AAED;;;;;;;AAgEA;;;;;;AA1GJ,sBAgHI3G,gBAhHJ,+BAiHI;AACI;AACH,MAnHL;;AAAA;AAAA;AAAA,2BAgDI;AACI,gBAAO,KAAK3e,QAAZ;AACH;;AAED;;;AApDJ;AAAA,yBAuDgBzB,CAvDhB,EAwDI;AACI,aAAI,KAAKyB,QAAL,KAAkBzB,CAAtB,EAAyB;;AAEzB,cAAKyB,QAAL,GAAgBzB,CAAhB;;AAEA,cAAKogB,gBAAL;AACH;;AAED;;;;;;AAhEJ;AAAA;AAAA,2BAsEI;AACI,gBAAO,KAAKpe,QAAZ;AACH;;AAED;;;AA1EJ;AAAA,yBA6EgBhC,CA7EhB,EA8EI;AACI,aAAI,KAAKgC,QAAL,KAAkBhC,CAAtB,EAAyB;;AAEzB,cAAKgC,QAAL,GAAgBhC,CAAhB;AACA,cAAK+mB,YAAL,GAAoB,IAApB;AACH;;AAED;;;;;;AArFJ;AAAA;AAAA,2BA2FI;AACI,gBAAO,KAAK5kB,QAAZ;AACH;;AAED;;;AA/FJ;AAAA,yBAkGgBnC,CAlGhB,EAmGI;AACI,aAAI,KAAKmC,QAAL,KAAkBnC,CAAtB,EAAyB;;AAEzB,cAAKmC,QAAL,GAAgBnC,CAAhB;AACA,cAAK+mB,YAAL,GAAoB,IAApB;AACH;AAxGL;;AAAA;AAAA,KAAqB36B,IAArB;AAqHH,E;;;;;;;;;;;;mBCzHuB46B,e;;AAFxB;;;;;;;;AAEe,UAASA,eAAT,CAAyB56B,IAAzB,EACf;AACI;;;;AAIA;AAAA;;AAEI;;;AAGA,uBACA;AAAA;;AACyB;;AAErB;;;;;;;AAHJ,oDACI,kBAAS+T,SAAT,CADJ;;AAUI,aAAK+f,IAAL,GAAY,WAAK1d,KAAL,CAAW4B,KAAX,CAAiB5R,KAAjB,EAAZ;;AAEA;;;;;;AAMA,aAAKmS,SAAL,GAAiB,WAAKuF,SAAL,CAAeM,MAAhC;;AAEA;;;;;;AAMA,aAAK3I,UAAL,GAAkB,IAAIpK,YAAJ,CAAiB,CAAjB,CAAlB;;AAEA;;;;;;;AAOA,aAAKmN,MAAL,GAAc,IAAd;AAnCJ;AAoCC;;AA1CL;AAAA,KAAqBxY,IAArB;AA4CH,E;;;;;;;;;;;;;ACpDD;;;;AACA;;;;AACA;;;;;;;;;;AAEA,KAAM66B,aAAa,mBAAAvQ,CAAQ,qCAAR,CAAnB;AACA,KAAM2C,eAAe,mBAAA3C,CAAQ,qCAAR,CAArB;;AAEA,KAAIwQ,OAAO,CAAX;;AAEA;;;;;KAIqBC,c;;;AAEjB;;;AAGA,6BAAY76B,QAAZ,EACA;AAAA;;AAGI;;;;;;AAHJ,sDACI,iCAAMA,QAAN,CADJ;;AASI,eAAK86B,QAAL,GAAgB,CAAhB;;AAEA;;;;;AAKA,eAAKC,YAAL,GAAoB,MAAKD,QAAL,GAAgB,CAApC;;AAEA;;;;;AAKA,eAAK30B,IAAL,GAAY,qBAAW2kB,QAAX,CAAoB+P,eAAeG,yBAAnC,CAAZ;;AAEA;;;;;;AAMA,eAAKC,OAAL,GAAe,EAAf;;AAEA;;;;;AAKA,eAAK3a,OAAL,GAAe,aAAOJ,MAAP,CAAcK,aAAd,CAA4B,MAAKpa,IAAjC,CAAf;;AAEA;;;;;;;AAOA,eAAKmtB,OAAL,GAAe,EAAf;;AAEA;AACA,cAAK,IAAI3wB,IAAI,CAAb,EAAgBA,KAAK,MAAKwD,IAA1B,EAAgCxD,KAAK,CAArC,EACA;AACI,iBAAMu4B,WAAWv4B,IAAI,CAAJ,GAAQ,MAAKo4B,YAA9B;;AAEA,mBAAKE,OAAL,CAAal4B,IAAb,CAAkB,IAAI,WAAK8Z,MAAT,CAAgBqe,QAAhB,CAAlB;AACH;;AAED,eAAKC,YAAL,GAAoB,CAApB;AACA,eAAKC,MAAL,GAAc,EAAd;;AAEA,cAAK,IAAI/gB,IAAI,CAAb,EAAgBA,IAAI,MAAKlU,IAAzB,EAA+B,EAAEkU,CAAjC,EACA;AACI,mBAAK+gB,MAAL,CAAY/gB,CAAZ,IAAiB;AACbjb,2BAAU,EADG;AAEb+G,uBAAM,CAFO;AAGblC,wBAAO,CAHM;AAIbo3B,wBAAO,IAJM;AAKb/iB,yBAAQ;AALK,cAAjB;AAOH;;AAED,eAAKpZ,OAAL,GAAe,EAAf;;AAEA,eAAKo8B,YAAL,GAAoB,CAApB;AACA,eAAKC,aAAL,GAAqB,EAArB;AACA,eAAKC,IAAL,GAAY,EAAZ;;AAEA,eAAKC,WAAL,GAAmB,CAAC,CAApB;;AAEA,eAAKhb,WAAL,GAAmB,IAAnB;;AAEA,eAAKC,GAAL,GAAW,IAAX;;AAEA,eAAKgb,YAAL,GAAoB,CAApB;;AAEA,eAAKC,sBAAL,GAA8B37B,SAAS6B,cAAT,CAAwBsL,GAAxB,CAA4B,MAAKyuB,eAAjC,QAA9B;AACA,eAAK9S,uBAAL,GAA+B9oB,SAAS4B,eAAT,CAAyBuL,GAAzB,CAA6B,MAAKie,gBAAlC,QAA/B;;AAEA,eAAKA,gBAAL;AAxFJ;AAyFC;;AAED;;;;;;8BAIAlnB,I,mBACA;AACI,cAAK23B,KAAL;AACA,cAAKnb,GAAL,CAAS1X,MAAT;AACH,M;;AAED;;;;;;8BAIA6yB,K,oBACA;AACI,aAAI,KAAKV,YAAL,KAAsB,CAA1B,EAA6B;;AAE7B,aAAM/5B,KAAK,KAAKpB,QAAL,CAAcoB,EAAzB;;AAEA,aAAM06B,MAAM,qBAAWhR,QAAX,CAAoB,KAAKqQ,YAAzB,CAAZ;AACA,aAAMY,OAAO,qBAAWA,IAAX,CAAgBD,GAAhB,CAAb;AACA,aAAM7e,SAAS,KAAKge,OAAL,CAAac,IAAb,CAAf;;AAEA,aAAIC,QAAQ,CAAZ;AACA,aAAIC,cAAc,IAAlB;AACA,aAAIC,iBAAiB,IAArB;AACA,aAAIC,aAAa,CAAjB;AACA,aAAInS,eAAe,CAAnB;AACA,aAAIoS,eAAe,KAAKhB,MAAL,CAAY,CAAZ,CAAnB;AACA,aAAI/iB,YAAY,KAAKnZ,OAAL,CAAa,CAAb,EAAgBmZ,SAAhB,IAA6B,WAAKuF,SAAL,CAAeM,MAA5D;;AAEAke,sBAAah9B,QAAb,CAAsBwD,MAAtB,GAA+B,CAA/B;AACAw5B,sBAAan4B,KAAb,GAAqB,CAArB;AACAm4B,sBAAaf,KAAb,GAAqBhjB,SAArB;AACA+jB,sBAAa9jB,MAAb,GAAsB,IAAtB;;AAEAsiB;;AAEA,cAAK,IAAIj4B,IAAI,CAAb,EAAgBA,IAAI,KAAKw4B,YAAzB,EAAuC,EAAEx4B,CAAzC,EACA;AACI;AACA;AACA,iBAAM05B,SAAS,KAAKn9B,OAAL,CAAayD,CAAb,CAAf;;AAEAs5B,2BAAcI,OAAOlnB,QAAP,CAAgBvK,MAA9B;;AAEA;AACA,iBAAIyxB,OAAO/jB,MAAP,IAAiB,CAACD,UAAU/Q,MAAV,CAAiB+0B,OAAOhkB,SAAxB,CAAtB,EACA;AACIA,6BAAYgkB,OAAOhkB,SAAnB;;AAEA;AACA6jB,kCAAiB,IAAjB;AACAlS,gCAAe,KAAK0R,YAApB;AACAd;AACH;;AAED,iBAAIsB,mBAAmBD,WAAvB,EACA;AACIC,kCAAiBD,WAAjB;;AAEA,qBAAIA,YAAY1E,QAAZ,KAAyBqD,IAA7B,EACA;AACI,yBAAI5Q,iBAAiB,KAAK0R,YAA1B,EACA;AACId;;AAEA5Q,wCAAe,CAAf;;AAEAoS,sCAAaj2B,IAAb,GAAoBxD,IAAIy5B,aAAan4B,KAArC;;AAEAm4B,wCAAe,KAAKhB,MAAL,CAAYe,YAAZ,CAAf;AACAC,sCAAah9B,QAAb,CAAsBwD,MAAtB,GAA+B,CAA/B;AACAw5B,sCAAaf,KAAb,GAAqBhjB,SAArB;AACA+jB,sCAAan4B,KAAb,GAAqBtB,CAArB;AACAy5B,sCAAa9jB,MAAb,GAAsB+jB,OAAO/jB,MAA7B;AACH;;AAED;AACA2jB,iCAAY1E,QAAZ,GAAuBqD,IAAvB;AACAqB,iCAAYzE,GAAZ,GAAkBxN,YAAlB;;AAEA,yBAAM8O,YAAYmD,YAAYhS,YAAZ,CAAyB,KAAKjqB,QAA9B,CAAlB;;AAEA,yBAAI84B,SAAJ,EACA;AACIsD,sCAAah9B,QAAb,CAAsB2D,IAAtB,CAA2B+1B,SAA3B;AACA9O;AACH;AACJ;AACJ;;AAED;AACA,iBAAM4J,OAAOyI,OAAOzI,IAAP,CAAY0I,GAAZ,IAAmBD,OAAOpd,UAAP,GAAoB,GAApB,IAA2B,EAA9C,CAAb;AACA,iBAAMkB,MAAMkc,OAAOlnB,QAAP,CAAgB+gB,IAAhB,CAAqB8D,SAAjC;AACA,iBAAMuC,YAAYN,YAAYzE,GAA9B;AACA,iBAAMjiB,aAAa8mB,OAAO9mB,UAA1B;;AAEA;AACA0H,oBAAOM,WAAP,CAAmBye,OAAnB,IAA8BzmB,WAAW,CAAX,CAA9B;AACA0H,oBAAOM,WAAP,CAAmBye,OAAnB,IAA8BzmB,WAAW,CAAX,CAA9B;AACA0H,oBAAOO,UAAP,CAAkBwe,OAAlB,IAA6B7b,IAAI,CAAJ,CAA7B;AACAlD,oBAAOO,UAAP,CAAkBwe,OAAlB,IAA6BpI,IAA7B;AACA3W,oBAAOM,WAAP,CAAmBye,OAAnB,IAA8BO,SAA9B;;AAEA;AACAtf,oBAAOM,WAAP,CAAmBye,OAAnB,IAA8BzmB,WAAW,CAAX,CAA9B;AACA0H,oBAAOM,WAAP,CAAmBye,OAAnB,IAA8BzmB,WAAW,CAAX,CAA9B;AACA0H,oBAAOO,UAAP,CAAkBwe,OAAlB,IAA6B7b,IAAI,CAAJ,CAA7B;AACAlD,oBAAOO,UAAP,CAAkBwe,OAAlB,IAA6BpI,IAA7B;AACA3W,oBAAOM,WAAP,CAAmBye,OAAnB,IAA8BO,SAA9B;;AAEA;AACAtf,oBAAOM,WAAP,CAAmBye,OAAnB,IAA8BzmB,WAAW,CAAX,CAA9B;AACA0H,oBAAOM,WAAP,CAAmBye,OAAnB,IAA8BzmB,WAAW,CAAX,CAA9B;AACA0H,oBAAOO,UAAP,CAAkBwe,OAAlB,IAA6B7b,IAAI,CAAJ,CAA7B;AACAlD,oBAAOO,UAAP,CAAkBwe,OAAlB,IAA6BpI,IAA7B;AACA3W,oBAAOM,WAAP,CAAmBye,OAAnB,IAA8BO,SAA9B;;AAEA;AACAtf,oBAAOM,WAAP,CAAmBye,OAAnB,IAA8BzmB,WAAW,CAAX,CAA9B;AACA0H,oBAAOM,WAAP,CAAmBye,OAAnB,IAA8BzmB,WAAW,CAAX,CAA9B;AACA0H,oBAAOO,UAAP,CAAkBwe,OAAlB,IAA6B7b,IAAI,CAAJ,CAA7B;AACAlD,oBAAOO,UAAP,CAAkBwe,OAAlB,IAA6BpI,IAA7B;AACA3W,oBAAOM,WAAP,CAAmBye,OAAnB,IAA8BO,SAA9B;AACH;;AAEDH,sBAAaj2B,IAAb,GAAoB,KAAKg1B,YAAL,GAAoBiB,aAAan4B,KAArD;;AAEA,cAAKw3B,WAAL;;AAEA,aAAI,KAAKF,aAAL,CAAmB34B,MAAnB,IAA6B,KAAK64B,WAAtC,EACA;AACI,kBAAKe,UAAL,CAAgBp7B,EAAhB,EAAoB,KAAKkyB,OAAL,CAAa,CAAb,EAAgBrS,UAApC;AACH;;AAED,qBAAMpU,MAAN,CAAa,KAAK0uB,aAAL,CAAmB34B,MAAnB,GAA4B,KAAK64B,WAA9C,EAA2D,wCAA3D;;AAEA,cAAKF,aAAL,CAAmB,KAAKE,WAAxB,EAAqC5wB,MAArC,CAA4CoS,OAAOA,MAAnD,EAA2D,CAA3D;AACA,cAAKyD,GAAL,GAAW,KAAK8a,IAAL,CAAU,KAAKC,WAAf,EAA4Bp5B,IAA5B,EAAX;;AAEA;AACA,cAAK,IAAIM,KAAI,CAAb,EAAgBA,KAAIw5B,UAApB,EAAgC,EAAEx5B,EAAlC,EACA;AACI,iBAAM85B,QAAQ,KAAKrB,MAAL,CAAYz4B,EAAZ,CAAd;AACA,iBAAM+5B,oBAAoBD,MAAMr9B,QAAN,CAAewD,MAAzC;;AAEA,iBAAI,CAAC85B,iBAAL,EAAwB;;AAExB,iBAAIpkB,SAAS,IAAb;;AAEA,iBAAImkB,MAAMnkB,MAAV,EACA;AACIA,0BAASmkB,MAAMnkB,MAAf;AACH,cAHD,MAKA;AACIA,0BAAS,KAAKgb,OAAL,CAAaoJ,oBAAoB,CAAjC,CAAT;AACH;;AAED,iBAAI,CAACpkB,MAAL,EACA;AACIA,0BAASqkB,2BAA2B,KAAK38B,QAAhC,EAA0C08B,iBAA1C,CAAT;AACA,sBAAKpJ,OAAL,CAAaoJ,oBAAoB,CAAjC,IAAsCpkB,MAAtC;AACH;;AAED,kBAAKtY,QAAL,CAAciC,KAAd,CAAoB2W,SAApB,CAA8BN,MAA9B;;AAEA,kBAAK,IAAI5D,IAAI,CAAb,EAAgBA,IAAIgoB,iBAApB,EAAuC,EAAEhoB,CAAzC,EACA;AACI+nB,uBAAMr9B,QAAN,CAAesV,CAAf,EAAkBrS,IAAlB,CAAuBqS,CAAvB;AACH;;AAED;AACA,kBAAK1U,QAAL,CAAciC,KAAd,CAAoBuW,YAApB,CAAiCikB,MAAMpB,KAAvC;;AAEAj6B,gBAAGshB,YAAH,CAAgBthB,GAAGqgB,SAAnB,EAA8Bgb,MAAMt2B,IAAN,GAAa,CAA3C,EAA8C/E,GAAGuhB,cAAjD,EAAiE8Z,MAAMx4B,KAAN,GAAc,CAAd,GAAkB,CAAnF;AACH;;AAED;AACA,cAAKk3B,YAAL,GAAoB,CAApB;AACH,M;;AAED;;;;;;;8BAKA17B,M,mBAAO48B,M,EACP;AACI,aAAI,KAAKlB,YAAL,IAAqB,KAAKh1B,IAA9B,EACA;AACI,kBAAK01B,KAAL;AACH;;AAED;AACA,aAAI,CAACQ,OAAO11B,OAAP,CAAeuvB,IAApB,EACA;AACI;AACH;;AAED;AACA,cAAKh3B,OAAL,CAAa,KAAKi8B,YAAL,EAAb,IAAoCkB,MAApC;AACH,M;;AAED;;;;;;8BAIAv7B,O,sBACA;AACI;AACA,cAAK66B,sBAAL,CAA4B9H,MAA5B;AACA,cAAK8H,sBAAL,GAA8B,IAA9B;;AAEA,cAAK7S,uBAAL,CAA6B+K,MAA7B;AACA,cAAK/K,uBAAL,GAA+B,IAA/B;;AAEA,cAAK8T,iBAAL;;AAEA;AACA,cAAK,IAAIj6B,IAAI,CAAb,EAAgBA,IAAI,KAAKs4B,OAAL,CAAar4B,MAAjC,EAAyC,EAAED,CAA3C,EACA;AACI,kBAAKs4B,OAAL,CAAat4B,CAAb,EAAgB7B,OAAhB;AACH;;AAED;AACA,cAAKm6B,OAAL,GAAe,IAAf;AACA,cAAK4B,WAAL,GAAmB,IAAnB;AACA,cAAKvc,OAAL,GAAe,IAAf;AACA,cAAKgT,OAAL,GAAe,IAAf;AACA,cAAK8H,MAAL,GAAc,IAAd;AACA,cAAKl8B,OAAL,GAAe,IAAf;AACA,cAAKq8B,aAAL,GAAqB,IAArB;AACA,cAAKC,IAAL,GAAY,IAAZ;AACA,cAAK/a,WAAL,GAAmB,IAAnB;;AAEA,yCAAM3f,OAAN;AACH,M;;AAED;;;;;;;8BAKAsqB,gB,+BACA;AACI,aAAMhqB,KAAK,KAAKpB,QAAL,CAAcoB,EAAzB;;AAEA,cAAKw7B,iBAAL,CAAuB,IAAvB;;AAEA;AACA,cAAKlB,YAAL,GAAoBvzB,KAAKoF,GAAL,CAASnM,GAAGwgB,YAAH,CAAgBxgB,GAAG07B,uBAAnB,CAAT,EAAsDjC,eAAekC,iBAArE,CAApB;;AAEA;AACA,cAAKrB,YAAL,GAAoB,WAAKtgB,yBAAL,CAA+Bha,EAA/B,EAAmC,KAAKs6B,YAAxC,CAApB;;AAEA,cAAKpI,OAAL,CAAa1wB,MAAb,GAAsB,KAAK84B,YAA3B;AACA,cAAKpI,OAAL,CAAa,CAAb,IAAkB,KAAKA,OAAL,CAAa,CAAb,KAAmBqJ,2BAA2B,KAAK38B,QAAhC,EAA0C,CAA1C,CAArC;AACA,cAAKszB,OAAL,CAAa,CAAb,IAAkB,KAAKA,OAAL,CAAa,CAAb,KAAmBqJ,2BAA2B,KAAK38B,QAAhC,EAA0C,CAA1C,CAArC;;AAEA;AACA,cAAKygB,WAAL,GAAmB,aAAOpB,QAAP,CAAgBM,iBAAhB,CAAkCve,EAAlC,EAAsC,KAAKkf,OAA3C,EAAoDlf,GAAGoe,WAAvD,CAAnB;;AAEA;AACA;AACA,aAAMuD,UAAU,KAAKuQ,OAAL,CAAa,CAAb,EAAgBrS,UAAhC;AACA,aAAM+b,UAAU,KAAKzB,aAAL,CAAmB34B,MAAnB,IAA6B,KAAK04B,YAAlD;;AAEA;AACA,cAAK,IAAI34B,IAAI,CAAb,EAAgBA,IAAIq6B,OAApB,EAA6B,EAAEr6B,CAA/B,EACA;AACI,kBAAK65B,UAAL,CAAgBp7B,EAAhB,EAAoB2hB,OAApB;AACH;;AAED,cAAKrC,GAAL,GAAW,KAAK8a,IAAL,CAAU,CAAV,CAAX;AACH,M;;AAED;;;;;;;8BAKAI,e,8BACA;AACI,cAAKH,WAAL,GAAmB,CAAC,CAApB;AACH,M;;AAED;;;;;;;;;8BAOAe,U,uBAAWp7B,E,EAAI2hB,O,EACf;AACI,aAAMka,UAAU,aAAO5d,QAAP,CAAgBK,kBAAhB,CAAmCte,EAAnC,EAAuC,IAAvC,EAA6CA,GAAG87B,WAAhD,CAAhB;;AAEA,cAAK3B,aAAL,CAAmBx4B,IAAnB,CAAwBk6B,OAAxB;;AAEA;AACA,cAAKzB,IAAL,CAAUz4B,IAAV,CACI,IAAI,aAAO2e,mBAAX,CAA+B,KAAK1hB,QAAL,CAAcoB,EAA7C,EACK2f,cADL,CACoB,KAAKN,WADzB,EAEKO,YAFL,CAEkBic,OAFlB,EAE2Bla,QAAQ7B,eAFnC,EAEoD9f,GAAGiK,KAFvD,EAE8D,KAF9D,EAEqE,KAAK0vB,YAF1E,EAEwF,CAFxF,EAGK/Z,YAHL,CAGkBic,OAHlB,EAG2Bla,QAAQ5B,aAHnC,EAGkD/f,GAAGuhB,cAHrD,EAGqE,IAHrE,EAG2E,KAAKoY,YAHhF,EAG8F,IAAI,CAHlG,EAIK/Z,YAJL,CAIkBic,OAJlB,EAI2Bla,QAAQoa,MAJnC,EAI2C/7B,GAAGmJ,aAJ9C,EAI6D,IAJ7D,EAImE,KAAKwwB,YAJxE,EAIsF,IAAI,CAJ1F,EAKK/Z,YALL,CAKkBic,OALlB,EAK2Bla,QAAQqa,UALnC,EAK+Ch8B,GAAGiK,KALlD,EAKyD,KALzD,EAKgE,KAAK0vB,YALrE,EAKmF,IAAI,CALvF,CADJ;AAQH,M;;AAED;;;;;;;;8BAMA6B,iB,gCACA;AAAA,aADkBS,UAClB,yDAD+B,KAC/B;;AACI;AACA,aAAI,CAACA,UAAL,EACA;AACI,kBAAK,IAAI16B,IAAI,CAAb,EAAgBA,IAAI,KAAK2wB,OAAL,CAAa1wB,MAAjC,EAAyC,EAAED,CAA3C,EACA;AACI,qBAAI,KAAK2wB,OAAL,CAAa3wB,CAAb,CAAJ,EACA;AACI,0BAAK2wB,OAAL,CAAa3wB,CAAb,EAAgB7B,OAAhB;AACH;AACJ;AACD,kBAAKwyB,OAAL,CAAa1wB,MAAb,GAAsB,CAAtB;AACH;;AAED;AACA,cAAK,IAAID,MAAI,CAAb,EAAgBA,MAAI,KAAK64B,IAAL,CAAU54B,MAA9B,EAAsC,EAAED,GAAxC,EACA;AACI,kBAAK64B,IAAL,CAAU74B,GAAV,EAAa7B,OAAb;AACH;AACD,cAAK06B,IAAL,CAAU54B,MAAV,GAAmB,CAAnB;;AAEA;AACA,cAAK,IAAID,MAAI,CAAb,EAAgBA,MAAI,KAAK44B,aAAL,CAAmB34B,MAAvC,EAA+C,EAAED,GAAjD,EACA;AACI,kBAAK44B,aAAL,CAAmB54B,GAAnB,EAAsB7B,OAAtB;AACH;AACD,cAAKy6B,aAAL,CAAmB34B,MAAnB,GAA4B,CAA5B;;AAEA;AACA,aAAI,KAAK6d,WAAT,EACA;AACI,kBAAKA,WAAL,CAAiB3f,OAAjB;AACH;AACD,cAAK2f,WAAL,GAAmB,IAAnB;AACH,M;;;GAncuC,aAAO1F,c;;mBAA9B8f,c;;;AAscrB,UAAS8B,0BAAT,CAAoC38B,QAApC,EAA8Cs9B,WAA9C,EACA;AACI,SAAIC,aAAaxQ,YAAjB;;AAEAwQ,kBAAaA,WAAWjmB,OAAX,CAAmB,iBAAnB,EAAsCgmB,WAAtC,CAAb;AACAC,kBAAaA,WAAWjmB,OAAX,CAAmB,0BAAnB,EAA+CkmB,kBAAkBF,WAAlB,CAA/C,CAAb;;AAEA,SAAMhlB,SAAS,IAAI,aAAOsQ,MAAX,CAAkB5oB,QAAlB,EAA4B26B,UAA5B,EAAwC4C,UAAxC,CAAf;;AAEA,SAAME,eAAe,EAArB;;AAEA,UAAK,IAAI96B,IAAI,CAAb,EAAgBA,IAAI26B,WAApB,EAAiC,EAAE36B,CAAnC,EACA;AACI86B,sBAAa96B,CAAb,IAAkBA,CAAlB;AACH;;AAED2V,YAAOjW,IAAP;AACAiW,YAAOO,QAAP,CAAgB6kB,SAAhB,GAA4BD,YAA5B;;AAEA,YAAOnlB,MAAP;AACH;;AAED,UAASklB,iBAAT,CAA2BF,WAA3B,EACA;AACI,SAAI1gB,MAAM,MAAV;;AAEA,UAAK,IAAIja,IAAI,CAAb,EAAgBA,IAAI26B,WAApB,EAAiC,EAAE36B,CAAnC,EACA;AACI,aAAIA,IAAI,CAAR,EAAWia,OAAO,YAAP;;AAEX,aAAIja,IAAI26B,cAAc,CAAtB,EACA;AACI1gB,6CAA8Bja,CAA9B;AACH;;AAEDia,kEAAuDja,CAAvD;AACH;;AAEDia,YAAO,MAAP;;AAEA,YAAOA,GAAP;AACH;;AAED;;;;;;;;;AASAie,gBAAeG,yBAAf,GAA2C,IAA3C;;AAEA;;;;;;;;;AASAH,gBAAekC,iBAAf,GAAmC,qBAAOla,MAAP,IAAiB,qBAAOC,KAAxB,GAAgC,CAAhC,GAAoC,EAAvE,C;;;;;;;;;AClhBA,qEAAoE,+BAA+B,wBAAwB,6BAA6B,mCAAmC,+BAA+B,sBAAsB,2BAA2B,oBAAoB,wFAAwF,sCAAsC,8BAA8B,qDAAqD,GAAG,G;;;;;;;;;ACAnf,8DAA6D,OAAO,+BAA+B,sBAAsB,2BAA2B,+CAA+C,sBAAsB,iBAAiB,gDAAgD,UAAU,gBAAgB,sCAAsC,GAAG,G;;;;;;;;;;;;;ACA7V;;AACA;;AACA;;AACA;;;;AACA;;;;;;;;;;;;AAEA;;;;KAIqB6a,kB;;;AAEjB;;;;;;AAMA,iCAAY39B,QAAZ,EACA;AAAA,aADsBC,QACtB,yDADiC09B,mBAAmBz9B,eACpD;AAAA,aADqEC,SACrE,yDADiF,CACjF;;AAAA;;AAGI;;;;;AAHJ,sDACI,uBAAMH,QAAN,EAAgBC,QAAhB,EAA0BE,SAA1B,CADJ;;AAQI,eAAKy9B,cAAL,GAAsB,6BAAmB59B,QAAnB,CAAtB;AARJ;AASC;;AAED;;;;;;;;kCAMAI,I,iBAAKC,M,EACL;AACI,gBAAOA,OAAOw9B,aAAP,CACH,UAAI9e,mBADD,EACyB;AADzB,wCAEyB;AAFzB,qCAGyB;AAHzB,mCAIyB;AAJzB,UAAP;AAMH,M;;AAED;;;;;;;kCAKAxe,M,mBAAO87B,M,EACP;AACI,aAAI,CAACA,OAAOnnB,OAAZ,EAAqB;;AAErB,cAAKlV,QAAL,CAAcmE,uBAAd,CAAsC,KAAKy5B,cAA3C;;AAEA,aAAME,QAAQ,CAACzB,OAAO5B,YAAR,IAAwB4B,OAAO1G,wBAAP,KAAoC0G,OAAOh9B,SAAP,CAAiBw1B,cAA3F;;AAEA,aAAIwH,OAAOlnB,QAAP,CAAgBC,KAAhB,IAAyB,CAAC0oB,KAA9B,EACA;AACIC,+BAAkB1B,MAAlB;AACAA,oBAAO1G,wBAAP,GAAkC0G,OAAOh9B,SAAP,CAAiBw1B,cAAnD;AACAwH,oBAAO5B,YAAP,GAAsB,KAAtB;AACH;;AAED,cAAKmD,cAAL,CAAoBn+B,MAApB,CAA2B48B,MAA3B;AACH,M;;;GAzD2C,UAAIz7B,M;;mBAA/B+8B,kB;;;AA4DrB,cAAO18B,QAAP,CAAgBR,gBAAhB,CAAiCk9B,kBAAjC;;AAEA;;;;;;AAMA,UAASI,iBAAT,CAA2B1B,MAA3B,EACA;AACI;AACA,SAAM7mB,KAAK6mB,OAAOh9B,SAAP,CAAiBsT,cAA5B;AACA,SAAM5N,IAAIyQ,GAAGzQ,CAAb;AACA,SAAMC,IAAIwQ,GAAGxQ,CAAb;AACA,SAAM6J,IAAI2G,GAAG3G,CAAb;AACA,SAAM7G,IAAIwN,GAAGxN,CAAb;AACA,SAAMC,KAAKuN,GAAGvN,EAAd;AACA,SAAMC,KAAKsN,GAAGtN,EAAd;AACA,SAAMqN,aAAa8mB,OAAO9mB,UAA1B;AACA,SAAMF,OAAOgnB,OAAOlnB,QAAP,CAAgBE,IAA7B;AACA,SAAMC,OAAO+mB,OAAOlnB,QAAP,CAAgBG,IAA7B;;AAEA,SAAIG,WAAJ;AACA,SAAIE,WAAJ;AACA,SAAIC,WAAJ;AACA,SAAIE,WAAJ;;AAEA,SAAIT,IAAJ,EACA;AACI;AACA;AACAM,cAAKN,KAAK3N,CAAL,GAAU20B,OAAO3mB,QAAP,GAAkBJ,KAAK5Q,KAAtC;AACA+Q,cAAKE,KAAKN,KAAK3Q,KAAf;;AAEAoR,cAAKT,KAAK1N,CAAL,GAAU00B,OAAOxmB,QAAP,GAAkBP,KAAK3Q,MAAtC;AACAiR,cAAKE,KAAKT,KAAK1Q,MAAf;AACH,MATD,MAWA;AACI8Q,cAAMH,KAAK5Q,KAAN,IAAgB,IAAI23B,OAAO3mB,QAA3B,CAAL;AACAC,cAAML,KAAK5Q,KAAN,GAAe,CAAC23B,OAAO3mB,QAA5B;;AAEAE,cAAKN,KAAK3Q,MAAL,IAAe,IAAI03B,OAAOxmB,QAA1B,CAAL;AACAC,cAAKR,KAAK3Q,MAAL,GAAc,CAAC03B,OAAOxmB,QAA3B;AACH;;AAED;AACAN,gBAAW,CAAX,IAAiBxQ,IAAI4Q,EAAL,GAAY9G,IAAIiH,EAAhB,GAAsB7N,EAAtC;AACAsN,gBAAW,CAAX,IAAiBvN,IAAI8N,EAAL,GAAY9Q,IAAI2Q,EAAhB,GAAsBzN,EAAtC;;AAEA;AACAqN,gBAAW,CAAX,IAAiBxQ,IAAI0Q,EAAL,GAAY5G,IAAIiH,EAAhB,GAAsB7N,EAAtC;AACAsN,gBAAW,CAAX,IAAiBvN,IAAI8N,EAAL,GAAY9Q,IAAIyQ,EAAhB,GAAsBvN,EAAtC;;AAEA;AACAqN,gBAAW,CAAX,IAAiBxQ,IAAI0Q,EAAL,GAAY5G,IAAI+G,EAAhB,GAAsB3N,EAAtC;AACAsN,gBAAW,CAAX,IAAiBvN,IAAI4N,EAAL,GAAY5Q,IAAIyQ,EAAhB,GAAsBvN,EAAtC;;AAEA;AACAqN,gBAAW,CAAX,IAAiBxQ,IAAI4Q,EAAL,GAAY9G,IAAI+G,EAAhB,GAAsB3N,EAAtC;AACAsN,gBAAW,CAAX,IAAiBvN,IAAI4N,EAAL,GAAY5Q,IAAI2Q,EAAhB,GAAsBzN,EAAtC;AACH;;AAED;;;;;;AAMAy1B,oBAAmBz9B,eAAnB,GAAqC,UAAIU,MAAJ,CAAWF,QAAX,CAAoBC,MAAzD,C;;;;;;;;;;;;;;;;;;sDCzISf,O;;;;;;;;;qDACAA,O;;;;;;;;;;;;;;;;;ACHT;;;;;;;;AAEA;;AAEA,KAAMo+B,aAAa,YAAnB;;AAEA;;;;;KAIqBC,gB;AAEjB;;;;;;AAMA,iCACA;AAAA,aADYz7B,MACZ,yDADqB,IACrB;AAAA,aAD2B07B,QAC3B,yDADsC,CAAC17B,MACvC;;AAAA;;AACI;;;;;AAKA,cAAKA,MAAL,GAAcA,UAAUuZ,SAASC,aAAT,CAAuB,QAAvB,CAAxB;;AAEA;;;;;AAKA,cAAKkiB,QAAL,GAAgBA,QAAhB;;AAEA;;;;;;AAMA,cAAKC,QAAL,GAAgB,KAAK37B,MAAL,CAAY2C,UAAZ,CAAuB,IAAvB,CAAhB;AACH;;AAED;;;;;;;;gCAMAi5B,K,kBAAMC,I,EACN;AAAA,aADYC,KACZ,yDADoBL,iBAAiBM,YACrC;;AACI,aAAMC,MAAM,KAAKL,QAAjB;AACA,aAAMM,aAAaH,MAAMI,QAAN,GAAiB,KAAKC,SAAL,CAAeN,IAAf,CAAjB,GAAwCA,IAA3D;AACA,aAAMjV,QAAQqV,WAAW/Y,KAAX,CAAiBsY,UAAjB,CAAd;;AAEA;AACAQ,aAAII,IAAJ,GAAWN,MAAMO,aAAN,EAAX;AACAL,aAAIM,WAAJ,GAAkBR,MAAMS,MAAxB;AACAP,aAAIQ,SAAJ,GAAgBV,MAAMW,eAAtB;AACAT,aAAIU,YAAJ,GAAmBZ,MAAMY,YAAzB;AACAV,aAAIW,QAAJ,GAAeb,MAAMa,QAArB;AACAX,aAAIY,UAAJ,GAAiBd,MAAMc,UAAvB;AACAZ,aAAIa,SAAJ,GAAgBf,MAAMgB,YAAN,CAAmBlW,MAAMxmB,MAAzB,CAAhB;AACA47B,aAAIe,UAAJ,GAAiBjB,MAAMiB,UAAvB;AACAf,aAAIgB,WAAJ,GAAkBlB,MAAMkB,WAAxB;AACAhB,aAAIiB,aAAJ,GAAoBnB,MAAMmB,aAA1B;AACAjB,aAAIkB,aAAJ,GAAoBpB,MAAMoB,aAA1B;;AAEA;AACA,aAAMC,aAAa,IAAIxrB,KAAJ,CAAUiV,MAAMxmB,MAAhB,CAAnB;AACA,aAAMg9B,iBAAiB,KAAKC,wBAAL,CAA8BrB,IAAII,IAAlC,CAAvB;AACA,aAAIkB,eAAe,CAAnB;;AAEA;AACA,cAAK,IAAIn9B,IAAI,CAAb,EAAgBA,IAAIymB,MAAMxmB,MAA1B,EAAkC,EAAED,CAApC,EACA;AACI,iBAAMq8B,YAAYR,IAAIuB,WAAJ,CAAgB3W,MAAMzmB,CAAN,CAAhB,EAA0B+B,KAA1B,GAAmC,CAAC0kB,MAAMzmB,CAAN,EAASC,MAAT,GAAkB,CAAnB,IAAwB07B,MAAM0B,aAAnF;;AAEAL,wBAAWh9B,CAAX,IAAgBq8B,SAAhB;AACAc,4BAAe33B,KAAKqF,GAAL,CAASsyB,YAAT,EAAuBd,SAAvB,CAAf;AACH;;AAED,aAAMiB,SAAS3B,MAAM4B,UAAN,GAAmB5B,MAAM6B,kBAAzB,GAA8C,CAA7D;AACA,aAAMC,OAAO,CAAC9B,MAAMW,eAAN,GAAwBX,MAAM+B,OAA/B,IAA0C,CAAvD;;AAEA;AACA,aAAI,KAAKnC,QAAT,EACA;AACI,iBAAMx5B,QAAQo7B,eAAeG,MAAf,GAAwBG,IAAtC;;AAEA,kBAAK59B,MAAL,CAAYkC,KAAZ,GAAoByD,KAAKmF,IAAL,CAAU5I,KAAV,CAAgB,uBAAhB,CAApB;AACH;;AAED;AACA,aAAM47B,gBAAgBL,SAASL,eAAeW,QAAxB,GAAmCH,IAAzD;AACA,aAAMI,aAAalC,MAAMkC,UAAN,GAAmBlC,MAAMkC,UAAN,GAAmBJ,IAAtC,GAA6CE,aAAhE;;AAEA,aAAI,KAAKpC,QAAT,EACA;AACI,iBAAMv5B,SAASwD,KAAKqF,GAAL,CAASgzB,UAAT,EAAqBF,aAArB,IAAuC,CAAClX,MAAMxmB,MAAN,GAAe,CAAhB,IAAqB49B,UAA3E;;AAEA,kBAAKh+B,MAAL,CAAYmC,MAAZ,GAAqBwD,KAAKmF,IAAL,CAAU3I,MAAV,CAAiB,sBAAjB,CAArB;AACH;;AAED;AACA;AACA65B,aAAIiC,SAAJ,CAAc,CAAd,EAAiB,CAAjB,EAAoB,KAAKj+B,MAAL,CAAYkC,KAAhC,EAAuC,KAAKlC,MAAL,CAAYmC,MAAnD;;AAEA,aAAI+7B,gBAAgB,CAApB;AACA,aAAIC,gBAAgB,CAApB;;AAEA;AACA,cAAK,IAAIh+B,KAAI,CAAb,EAAgBA,KAAIymB,MAAMxmB,MAA1B,EAAkC,EAAED,EAApC,EACA;AACI+9B,6BAAgBpC,MAAMW,eAAN,GAAwB,CAAxC;AACA0B,6BAAkBrC,MAAMW,eAAN,GAAwB,CAAzB,GAA+Bt8B,KAAI69B,UAApC,GAAmDZ,eAAegB,MAAlF;;AAEA,iBAAItC,MAAMuC,KAAN,KAAgB,OAApB,EACA;AACIH,kCAAiBZ,eAAeH,WAAWh9B,EAAX,CAAhC;AACH,cAHD,MAIK,IAAI27B,MAAMuC,KAAN,KAAgB,QAApB,EACL;AACIH,kCAAiB,CAACZ,eAAeH,WAAWh9B,EAAX,CAAhB,IAAiC,CAAlD;AACH;;AAED,iBAAI27B,MAAMS,MAAN,IAAgBT,MAAMW,eAA1B,EACA;AACI,sBAAK6B,SAAL,CAAe1X,MAAMzmB,EAAN,CAAf,EAAyB+9B,gBAAgBpC,MAAM+B,OAA/C,EAAwDM,gBAAgBrC,MAAM+B,OAA9E,EAAuF,IAAvF;AACH;;AAED,iBAAI/B,MAAMe,SAAV,EACA;AACI,sBAAKyB,SAAL,CAAe1X,MAAMzmB,EAAN,CAAf,EAAyB+9B,gBAAgBpC,MAAM+B,OAA/C,EAAwDM,gBAAgBrC,MAAM+B,OAA9E;AACH;AACJ;AACJ,M;;AAED;;;;;gCAGAv/B,O,sBACA;AACI,cAAKq9B,QAAL,GAAgB,IAAhB;AACA,cAAK37B,MAAL,GAAc,IAAd;;AAEA,cAAK87B,KAAL,GAAa,IAAb;AACH,M;;AAED;;;;;;;;;gCAOAuB,wB,qCAAyBkB,S,EACzB;AACI,aAAI9C,iBAAiB+C,mBAAjB,CAAqCD,SAArC,CAAJ,EACA;AACI,oBAAO9C,iBAAiB+C,mBAAjB,CAAqCD,SAArC,CAAP;AACH;;AAED,aAAME,aAAahD,iBAAiB+C,mBAAjB,CAAqCD,SAArC,CAAnB;;AAEA;AACA,aAAI,CAAC9C,iBAAiBiD,oBAAtB,EACA;AACIjD,8BAAiBiD,oBAAjB,GAAwCnlB,SAASC,aAAT,CAAuB,QAAvB,CAAxC;AACAiiB,8BAAiBkD,qBAAjB,GAAyClD,iBAAiBiD,oBAAjB,CAAsC/7B,UAAtC,CAAiD,IAAjD,CAAzC;AACH;;AAED,aAAM3C,SAASy7B,iBAAiBiD,oBAAhC;AACA,aAAMhgC,UAAU+8B,iBAAiBkD,qBAAjC;AACA,aAAMC,WAAW,OAAjB;;AAEAlgC,iBAAQg+B,YAAR,GAAuB,YAAvB;AACAh+B,iBAAQm+B,SAAR,GAAoB,MAApB;AACAn+B,iBAAQ09B,IAAR,GAAemC,SAAf;;AAEA,aAAMr8B,QAAQyD,KAAKmF,IAAL,CAAUpM,QAAQ6+B,WAAR,CAAoBqB,QAApB,EAA8B18B,KAAxC,CAAd;AACA,aAAM28B,SAASl5B,KAAKmF,IAAL,CAAUpM,QAAQ6+B,WAAR,CAAoB,GAApB,EAAyBr7B,KAAnC,CAAf;AACA,aAAM48B,WAAWn5B,KAAKmF,IAAL,CAAU+zB,SAAS,GAAnB,CAAjB;AACA,aAAM18B,SAAS,IAAI08B,MAAnB;;AAEA7+B,gBAAOkC,KAAP,GAAeA,KAAf;AACAlC,gBAAOmC,MAAP,GAAgBA,MAAhB;;AAEAzD,iBAAQm+B,SAAR,GAAoB,MAApB;AACAn+B,iBAAQqgC,QAAR,CAAiB,CAAjB,EAAoB,CAApB,EAAuB78B,KAAvB,EAA8BC,MAA9B;AACAzD,iBAAQsgC,QAAR,CAAiBJ,QAAjB,EAA2B,CAA3B,EAA8BE,QAA9B;;AAEA,aAAMG,YAAYvgC,QAAQwgC,YAAR,CAAqB,CAArB,EAAwB,CAAxB,EAA2Bh9B,KAA3B,EAAkCC,MAAlC,EAA0CgE,IAA5D;AACA,aAAMwJ,OAAOzN,QAAQ,CAArB;;AAEA,aAAIiD,IAAI,CAAR;AACA,aAAID,IAAI,CAAR;;AAEA;AACAk5B,iBACA,KAAKj5B,IAAI,CAAT,EAAYA,IAAI25B,QAAhB,EAA0B,EAAE35B,CAA5B,EACA;AACI,kBAAKD,IAAI,CAAT,EAAYA,IAAIyK,IAAhB,EAAsBzK,KAAK,CAA3B,EACA;AACI,qBAAI+5B,UAAW95B,IAAIwK,IAAL,GAAazK,CAAvB,MAA8B,GAAlC,EACA;AACI,2BAAMk5B,MAAN;AACH;AACJ;AACJ;;AAEDK,oBAAWL,MAAX,GAAoBU,WAAW35B,CAA/B;;AAEA;AACAg6B,kBACA,KAAKh6B,IAAIhD,MAAT,EAAiBgD,IAAI25B,QAArB,EAA+B,EAAE35B,CAAjC,EACA;AACI,kBAAKD,IAAI,CAAT,EAAYA,IAAIyK,IAAhB,EAAsBzK,KAAK,CAA3B,EACA;AACI,qBAAI+5B,UAAW95B,IAAIwK,IAAL,GAAazK,CAAvB,MAA8B,GAAlC,EACA;AACI,2BAAMi6B,OAAN;AACH;AACJ;AACJ;;AAEDV,oBAAWU,OAAX,GAAqBh6B,IAAI25B,QAAzB;AACAL,oBAAWV,QAAX,GAAsBU,WAAWL,MAAX,GAAoBK,WAAWU,OAArD;;AAEA,gBAAOV,UAAP;AACH,M;;AAED;;;;;;;;;gCAOAtC,S,sBAAUN,I,EACV;AACI;AACA,aAAMjV,QAAQiV,KAAK3Y,KAAL,CAAW,IAAX,CAAd;AACA,aAAMkc,gBAAgB,KAAKtD,KAAL,CAAWsD,aAAjC;AACA,aAAIxlB,SAAS,EAAb;;AAEA,cAAK,IAAIzZ,IAAI,CAAb,EAAgBA,IAAIymB,MAAMxmB,MAA1B,EAAkCD,GAAlC,EACA;AACI,iBAAMk/B,QAAQzY,MAAMzmB,CAAN,EAAS+iB,KAAT,CAAe,GAAf,CAAd;AACA,iBAAIoc,YAAYF,aAAhB;;AAEA,kBAAK,IAAIltB,IAAI,CAAb,EAAgBA,IAAImtB,MAAMj/B,MAA1B,EAAkC8R,GAAlC,EACA;AACI,qBAAMqtB,YAAY,KAAK5D,QAAL,CAAc4B,WAAd,CAA0B8B,MAAMntB,CAAN,CAA1B,EAAoChQ,KAAtD;;AAEA,qBAAI,KAAK45B,KAAL,CAAW0D,UAAX,IAAyBD,YAAYH,aAAzC,EACA;AACI;AACA,yBAAMK,aAAaJ,MAAMntB,CAAN,EAASgR,KAAT,CAAe,EAAf,CAAnB;;AAEA,0BAAK,IAAI7W,IAAI,CAAb,EAAgBA,IAAIozB,WAAWr/B,MAA/B,EAAuCiM,GAAvC,EACA;AACI,6BAAMqzB,iBAAiB,KAAK/D,QAAL,CAAc4B,WAAd,CAA0BkC,WAAWpzB,CAAX,CAA1B,EAAyCnK,KAAhE;;AAEA,6BAAIw9B,iBAAiBJ,SAArB,EACA;AACI1lB,8CAAe6lB,WAAWpzB,CAAX,CAAf;AACAizB,yCAAYF,gBAAgBM,cAA5B;AACH,0BAJD,MAMA;AACI9lB,6CAAavN,MAAM,CAAN,GAAU,GAAV,GAAgB,EAA7B,IAAkCozB,WAAWpzB,CAAX,CAAlC;AACAizB,0CAAaI,cAAb;AACH;AACJ;AACJ,kBApBD,MAsBA;AACI,yBAAMC,qBAAqBJ,YAAY,KAAK5D,QAAL,CAAc4B,WAAd,CAA0B,GAA1B,EAA+Br7B,KAAtE;;AAEA,yBAAIgQ,MAAM,CAAN,IAAWytB,qBAAqBL,SAApC,EACA;AACI;AACA;AACA1lB,yCAAa1H,IAAI,CAAJ,GAAQ,IAAR,GAAe,EAA5B,IAAiCmtB,MAAMntB,CAAN,CAAjC;AACAotB,qCAAYF,gBAAgBG,SAA5B;AACH,sBAND,MAQA;AACI3lB,yCAAcylB,MAAMntB,CAAN,CAAd;AACAotB,sCAAaK,kBAAb;AACH;AACJ;AACJ;;AAED,iBAAIx/B,IAAIymB,MAAMxmB,MAAN,GAAe,CAAvB,EACA;AACIwZ,2BAAU,IAAV;AACH;AACJ;;AAED,gBAAOA,MAAP;AACH,M;;AAED;;;;;;;;;;;gCASA0kB,S,sBAAUzC,I,EAAM32B,C,EAAGC,C,EAAGy6B,Q,EACtB;AACI,aAAM9D,QAAQ,KAAKA,KAAnB;AACA,aAAM0B,gBAAgB1B,MAAM0B,aAA5B;;AAEA;AACA,aAAIA,kBAAkB,CAAtB,EACA;AACI,iBAAIoC,QAAJ,EACA;AACI,sBAAKjE,QAAL,CAAckE,UAAd,CAAyBhE,IAAzB,EAA+B32B,CAA/B,EAAkCC,CAAlC;AACH,cAHD,MAKA;AACI,sBAAKw2B,QAAL,CAAcqD,QAAd,CAAuBnD,IAAvB,EAA6B32B,CAA7B,EAAgCC,CAAhC;AACH;AACJ,UAVD,MAYA;AACI;AACA,iBAAMs6B,aAAa5D,KAAK3Y,KAAL,CAAW,EAAX,CAAnB;;AAEA,kBAAK,IAAI/iB,IAAI,CAAb,EAAgBA,IAAIs/B,WAAWr/B,MAA/B,EAAuC,EAAED,CAAzC,EACA;AACI,qBAAM2/B,OAAOL,WAAWt/B,CAAX,CAAb;;AAEA,qBAAIy/B,QAAJ,EACA;AACI,0BAAKjE,QAAL,CAAckE,UAAd,CAAyBC,IAAzB,EAA+B56B,CAA/B,EAAkCC,CAAlC;AACH,kBAHD,MAKA;AACI,0BAAKw2B,QAAL,CAAcqD,QAAd,CAAuBc,IAAvB,EAA6B56B,CAA7B,EAAgCC,CAAhC;AACH;;AAEDD,sBAAK,KAAKy2B,QAAL,CAAc4B,WAAd,CAA0BuC,IAA1B,EAAgC59B,KAAhC,GAAwCs7B,aAA7C;AACH;AACJ;AACJ,M;;;;;mBArVgB/B,gB;;;AAwVrBA,kBAAiBM,YAAjB,GAAgC,+BAAhC;;AAEAN,kBAAiB+C,mBAAjB,GAAuC,EAAvC;AACA/C,kBAAiBiD,oBAAjB,GAAwC,IAAxC;AACAjD,kBAAiBkD,qBAAjB,GAAyC,IAAzC,C;;;;;;;;;;;;;ACtWA;;;;;;;;AAEA;;;;KAIqBoB,e;AAEjB;;;;AAIA,oCACA;AAAA,qBADYjE,KACZ,yDADoB,EACpB;;AAAA;;AACI;;;;;;;;AAQA,sBAAKuC,KAAL,GAAa,MAAb;;AAEA;;;;;;AAMA,sBAAKmB,UAAL,GAAkB,KAAlB;;AAEA;;;;;;;;AAQA,sBAAKzC,UAAL,GAAkB,CAAlB;;AAEA;;;;;;;;AAQA,sBAAKC,WAAL,GAAmB,SAAnB;;AAEA;;;;;;;;AAQA,sBAAKC,aAAL,GAAqB,CAArB;;AAEA;;;;;;;;AAQA,sBAAKC,aAAL,GAAqB,CAArB;;AAEA;;;;;;;;;AASA,sBAAKL,SAAL,GAAiB,OAAjB;;AAEA;;;;;;;AAOA,sBAAKmD,oBAAL,GAA4B,IAA5B;;AAEA;;;;;;AAMA,sBAAKC,UAAL,GAAkB,OAAlB;;AAEA;;;;;;;AAOA,sBAAKlC,QAAL,GAAgB,EAAhB;;AAEA;;;;;;AAMA,sBAAKQ,SAAL,GAAiB,QAAjB;;AAEA;;;;;;AAMA,sBAAK2B,WAAL,GAAmB,QAAnB;;AAEA;;;;;;;AAOA,sBAAKC,UAAL,GAAkB,QAAlB;;AAEA;;;;;;AAMA,sBAAK3C,aAAL,GAAqB,CAArB;;AAEA;;;;;;AAMA,sBAAKQ,UAAL,GAAkB,CAAlB;;AAEA;;;;;;;;;AASA,sBAAKrB,QAAL,GAAgB,OAAhB;;AAEA;;;;;;;;;AASA,sBAAKC,UAAL,GAAkB,EAAlB;;AAEA;;;;;;;AAOA,sBAAKiB,OAAL,GAAe,CAAf;;AAEA;;;;;;;;AAQA,sBAAKtB,MAAL,GAAc,OAAd;;AAEA;;;;;;;;AAQA,sBAAKE,eAAL,GAAuB,CAAvB;;AAEA;;;;;;;;;AASA,sBAAKC,YAAL,GAAoB,YAApB;;AAEA;;;;;;AAMA,sBAAKR,QAAL,GAAgB,KAAhB;;AAEA;;;;;;AAMA,sBAAKkD,aAAL,GAAqB,GAArB;;AAEA;AACA,uCAAO,IAAP,EAAatD,KAAb;AACH;;AAED;;;;;;;mCAKAp4B,K,oBACA;AACI,wBAAO,IAAIq8B,eAAJ,CAAoB,IAApB,CAAP;AACH,U;;AAED;;;;;;;mCAKA1D,a,4BACA;AACI,qBAAM+D,iBAAkB,OAAO,KAAKrC,QAAZ,KAAyB,QAA1B,GAAyC,KAAKA,QAA9C,UAA6D,KAAKA,QAAzF;;AAEA,wBAAU,KAAKQ,SAAf,SAA4B,KAAK2B,WAAjC,SAAgD,KAAKC,UAArD,SAAmEC,cAAnE,SAAqF,KAAKH,UAA1F;AACH,U;;AAED;;;;;;;;mCAMAnD,Y,yBAAauD,Q,CAAS,iB,EACtB;AACI,qBAAI,CAAC1uB,MAAMC,OAAN,CAAc,KAAKirB,SAAnB,CAAL,EACA;AACI,gCAAO,KAAKA,SAAZ;AACH;;AAED;AACA;;AAEA,qBAAM36B,QAAQ,KAAKlC,MAAL,CAAYkC,KAA1B,CATJ,CASoC;AAChC,qBAAMC,SAAS,KAAKnC,MAAL,CAAYmC,MAA3B,CAVJ,CAUsC;;AAElC;AACA,qBAAIm+B,WAAW,IAAf;;AAEA,qBAAI,KAAKN,oBAAT,EACA;AACI;AACAM,oCAAW,KAAK5hC,OAAL,CAAa6hC,oBAAb,CAAkCr+B,QAAQ,CAA1C,EAA6C,CAA7C,EAAgDA,QAAQ,CAAxD,EAA2DC,MAA3D,CAAX;AACH,kBAJD,MAMA;AACIm+B,oCAAW,KAAK5hC,OAAL,CAAa6hC,oBAAb,CAAkC,CAAlC,EAAqCp+B,SAAS,CAA9C,EAAiDD,KAAjD,EAAwDC,SAAS,CAAjE,CAAX;AACH;;AAED;AACA,qBAAMq+B,WAAW,KAAK3D,SAAL,CAAez8B,MAAhC;AACA,qBAAMqgC,aAAa,CAACD,WAAW,CAAZ,KAAkB,KAAKR,oBAAL,GAA4BK,QAA5B,GAAuC,CAAzD,CAAnB;;AAEA,sBAAK,IAAIlgC,IAAI,CAAb,EAAgBA,IAAIsgC,UAApB,EAAgC,EAAEtgC,CAAlC,EACA;AACImgC,kCAASI,YAAT,CAAsB,CAACvgC,IAAI,CAAL,IAAUsgC,UAAhC,EAA4C,KAAK5D,SAAL,CAAe18B,IAAIqgC,QAAnB,CAA5C;AACH;;AAED,wBAAOF,QAAP;AACH,U;;;;;mBAlSgBP,e;;;;;;;;;ACNrB;AACA,mF;;;;;;;;;ACDA;AACA;;AAEA,2CAA0C,yDAAoC,E;;;;;;;;;ACH9E;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,sFAAqF,uBAAuB;AAC5G,oEAAmE;AACnE,iEAAgE;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAc;AACd,eAAc;AACd,eAAc;AACd,eAAc;AACd,gBAAe;AACf,gBAAe;AACf,gBAAe;AACf,iBAAgB;AAChB,0B;;;;;;;;;AC1CA;AACA;AACA;AACA,wCAAuC,gC;;;;;;;;;ACHvC,8BAA6B;AAC7B,sCAAqC,gC;;;;;;;;;ACDrC;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA,G;;;;;;;;;ACPA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG,UAAU;AACb;AACA;AACA;AACA,G;;;;;;;;;ACfA;AACA;AACA;AACA;AACA,G;;;;;;;;;ACJA;AACA;AACA,G;;;;;;;;;ACFA;AACA,2FAAsE,gBAAgB,UAAU,GAAG;AACnG,EAAC,E;;;;;;;;;ACFD;AACA;AACA,kCAAiC,QAAQ,gBAAgB,UAAU,GAAG;AACtE,EAAC,E;;;;;;;;;ACHD;AACA;AACA;AACA,IAAG;AACH;AACA;AACA,G;;;;;;;;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA,G;;;;;;;;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,G;;;;;;;;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,G;;;;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA,EAAC,E;;;;;;;;;AC/BD,wBAAuB;AACvB;AACA;AACA,G;;;;;;;;;ACHA;AACA;AACA;AACA;AACA,G;;;;;;;;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,G;;;;;;;;;ACnBA;AACA;AACA;AACA,G;;;;;;;;;ACHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAkC,UAAU,EAAE;AAC9C,oBAAmB,sCAAsC;AACzD,EAAC,oCAAoC;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH,EAAC,W;;;;;;;;;AChCD;AACA;AACA;;AAEA;AACA;AACA,G;;;;;;;;;ACNA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,G;;;;;;;;;AChBA;AACA;AACA;AACA;AACA;AACA,G;;;;;;;;;ACLA;AACA;AACA;AACA;AACA,G;;;;;;;;;ACJA,kBAAiB;;AAEjB;AACA;AACA,G;;;;;;;;;ACJA;AACA;AACA;AACA;AACA,G;;;;;;;;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK,WAAW,eAAe;AAC/B;AACA,MAAK;AACL;AACA,G;;;;;;;;;ACpBA;AACA;AACA;AACA;AACA,4DAA2D;AAC3D,G;;;;;;;;;ACLA;AACA;AACA;AACA;AACA;AACA,G;;;;;;;;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA,G;;;;;;;;;ACNA;AACA;AACA;AACA;AACA,G;;;;;;;;;ACJA;AACA;AACA,oDAAmD;AACnD;AACA,wCAAuC;AACvC,G;;;;;;;;;ACLA;AACA;AACA;AACA,c;;;;;;;;;ACHA,0C;;;;;;;;;ACAA,eAAc,sB;;;;;;;;;ACAd;AACA;AACA;AACA;AACA,G","file":"fae.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"Fae\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Fae\"] = factory();\n\telse\n\t\troot[\"Fae\"] = factory();\n})(this, function() {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 334725b5c6feccd92c81\n **/","export * from '@fae/core';\n\nimport * as filters from '@fae/filters';\nexport { filters };\n\nimport * as filters_pack from '@fae/filters-pack';\nexport { filters_pack };\n\nimport * as interaction from '@fae/interaction';\nexport { interaction };\n\nimport * as shapes from '@fae/shapes';\nexport { shapes };\n\nimport * as sprites from '@fae/sprites';\nexport { sprites };\n\nimport * as text_canvas from '@fae/text-canvas';\nexport { text_canvas };\n\nimport * as textures from '@fae/textures';\nexport { textures };\n\nimport * as transform from '@fae/transform';\nexport { transform };\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./entry-6bcc5e05e02d437da7a3a29e427fb69b66c782032c816c62c84036e96df5027d.js\n **/","// export some core modules\r\nimport * as ecs from './ecs';\r\nimport * as glutil from './gl';\r\nimport * as math from './math';\r\nimport * as render from './render';\r\nimport * as util from './util';\r\n\r\nexport { ecs, glutil, math, render, util };\r\n\r\nimport * as debug from './debug';\r\nexport { debug };\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/core/src/index.js\n **/","/** @namespace ecs */\r\n\r\nexport { default as SelfRenderComponent } from './SelfRenderComponent';\r\nexport { default as SelfRenderSystem } from './SelfRenderSystem';\r\nexport { default as VisibilityComponent } from './VisibilityComponent';\r\nexport { default as Entity } from './Entity';\r\nexport { default as System } from './System';\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/core/src/ecs/index.js\n **/","export default function SelfRenderComponent(Base)\r\n{\r\n    /**\r\n     * @class SelfRenderComponent\r\n     * @memberof ecs\r\n     */\r\n    return class extends Base\r\n    {\r\n        /**\r\n         * The method called for the object to render itself.\r\n         *\r\n         * @abstract\r\n         * @param {Renderer} renderer - The renderer to use.\r\n         */\r\n        render(/* renderer */)\r\n        {\r\n            /* empty */\r\n        }\r\n    };\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/core/src/ecs/SelfRenderComponent.js\n **/","import System from './System';\r\nimport SelfRenderComponent from './SelfRenderComponent';\r\nimport Renderer from '../render/Renderer';\r\n\r\n/**\r\n * @class\r\n * @memberof ecs\r\n */\r\nexport default class SelfRenderSystem extends System\r\n{\r\n    /**\r\n     * @param {Renderer} renderer - The renderer to use.\r\n     * @param {number} priority - The priority of the system, higher means earlier.\r\n     * @param {number} frequency - How often to run the update loop. `1` means every\r\n     *  time, `2` is every other time, etc.\r\n     */\r\n    constructor(renderer, priority = SelfRenderSystem.defaultPriority, frequency = 1)\r\n    {\r\n        super(renderer, priority, frequency);\r\n    }\r\n\r\n    /**\r\n     * Returns true if the entity is eligible to the system, false otherwise.\r\n     *\r\n     * @param {Entity} entity - The entity to test.\r\n     * @return {boolean} True if entity should be included.\r\n     */\r\n    test(entity)\r\n    {\r\n        return entity.hasComponent(SelfRenderComponent);\r\n    }\r\n\r\n    /**\r\n     * Tells the entity to render itself by calling the `render()` method with\r\n     * the renderer and elapsed time.\r\n     *\r\n     * @param {Entity} entity - The entity to update.\r\n     * @param {number} elapsed - The time elapsed since last update call.\r\n     */\r\n    update(entity, elapsed)\r\n    {\r\n        entity.render(this.renderer, elapsed);\r\n    }\r\n}\r\n\r\nRenderer.addDefaultSystem(SelfRenderSystem);\r\n\r\n/**\r\n * @static\r\n * @constant\r\n * @member {number}\r\n * @default 1000\r\n */\r\nSelfRenderSystem.defaultPriority = System.PRIORITY.RENDER;\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/core/src/ecs/SelfRenderSystem.js\n **/","import ECS from '@fae/ecs';\r\n\r\n/**\r\n * @class\r\n * @memberof ecs\r\n */\r\nexport default class System extends ECS.System {\r\n    /**\r\n     *\r\n     * @param {Renderer} renderer - The renderer this sytem belongs to.\r\n     * @param {number} priority - The priority of the system, higher means earlier.\r\n     * @param {number} frequency - How often to run the update loop. `1` means every\r\n     *  time, `2` is every other time, etc.\r\n     */\r\n    constructor(renderer, priority = System.PRIORITY.USER, frequency = 1)\r\n    {\r\n        super(frequency);\r\n\r\n        /**\r\n         * The renderer to use.\r\n         *\r\n         * @member {Renderer}\r\n         */\r\n        this.renderer = renderer;\r\n\r\n        /**\r\n         * The priority of the system. A lower number makes it run earlier.\r\n         *\r\n         * See {@link System.PRIORITY} for some common ranges. The default is {@link System.PRIORITY.USER}.\r\n         *\r\n         * If you change this value at all after adding the system to the renderer you will\r\n         * need to call {@link Renderer#sortSystems} for the change to affect the sort.\r\n         *\r\n         * @member {number}\r\n         */\r\n        this.priority = priority;\r\n    }\r\n\r\n    /**\r\n     * Destroys the system.\r\n     *\r\n     */\r\n    destroy()\r\n    {\r\n        this.renderer = null;\r\n    }\r\n}\r\n\r\n/**\r\n * Some common priority ranges. Lower priority numbers run first.\r\n * You can use any number you want for priority of your systems, these just serve as a guideline for\r\n * what the core and official plugins will try to follow.\r\n *\r\n * If you use these values directly it will run in the order:\r\n *\r\n * 1. USER\r\n * 2. PLUGIN\r\n * 3. RENDER\r\n *\r\n * @static\r\n * @constant\r\n * @property {number} USER - The start of the user range (0-2999)\r\n * @property {number} PLUGIN - The start of the plugin range (3000-5999)\r\n * @property {number} RENDER - The start of the render range (6000+)\r\n */\r\nSystem.PRIORITY = {\r\n    USER:   0,\r\n    PLUGIN: 3000,\r\n    RENDER: 6000,\r\n};\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/core/src/ecs/System.js\n **/","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"ECS\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"ECS\"] = factory();\n\telse\n\t\troot[\"ECS\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/*!**********************!*\\\n  !*** ./src/index.js ***!\n  \\**********************/\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _ecs = __webpack_require__(/*! ./ecs */ 1);\n\t\n\tvar _ecs2 = _interopRequireDefault(_ecs);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t// exports as root.\n\tmodule.exports = _ecs2.default;\n\n/***/ },\n/* 1 */\n/*!********************!*\\\n  !*** ./src/ecs.js ***!\n  \\********************/\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\texports.__esModule = true;\n\t\n\tvar _entity = __webpack_require__(/*! ./entity */ 2);\n\t\n\tvar _entity2 = _interopRequireDefault(_entity);\n\t\n\tvar _system = __webpack_require__(/*! ./system */ 57);\n\t\n\tvar _system2 = _interopRequireDefault(_system);\n\t\n\tvar _performance = __webpack_require__(/*! ./performance */ 58);\n\t\n\tvar _performance2 = _interopRequireDefault(_performance);\n\t\n\tvar _uid = __webpack_require__(/*! ./uid */ 55);\n\t\n\tvar _uid2 = _interopRequireDefault(_uid);\n\t\n\tvar _utils = __webpack_require__(/*! ./utils */ 56);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\t/**\n\t *\n\t * @class\n\t */\n\tvar ECS = function () {\n\t    /**\n\t     *\n\t     */\n\t    function ECS() {\n\t        _classCallCheck(this, ECS);\n\t\n\t        /**\n\t         * Store all entities of the ECS.\n\t         *\n\t         * @member {Entity[]}\n\t         */\n\t        this.entities = [];\n\t\n\t        /**\n\t         * Store all systems of the ECS.\n\t         *\n\t         * @member {System[]}\n\t         */\n\t        this.systems = [];\n\t\n\t        /**\n\t         * Count how many updates have been done.\n\t         *\n\t         * @member {number}\n\t         */\n\t        this.updateCounter = 0;\n\t\n\t        /**\n\t         * The last timestamp of an update call.\n\t         *\n\t         * @member\n\t         */\n\t        this.lastUpdate = _performance2.default.now();\n\t    }\n\t\n\t    /**\n\t     * Retrieve an entity by id.\n\t     *\n\t     * @param {number} id - id of the entity to retrieve\n\t     * @return {Entity} The entity if found null otherwise\n\t     */\n\t\n\t\n\t    ECS.prototype.getEntityById = function getEntityById(id) {\n\t        for (var i = 0; i < this.entities.length; ++i) {\n\t            var entity = this.entities[i];\n\t\n\t            if (entity.id === id) {\n\t                return entity;\n\t            }\n\t        }\n\t\n\t        return null;\n\t    };\n\t\n\t    /**\n\t     * Add an entity to the ecs.\n\t     *\n\t     * @param {Entity} entity - The entity to add.\n\t     */\n\t\n\t\n\t    ECS.prototype.addEntity = function addEntity(entity) {\n\t        this.entities.push(entity);\n\t\n\t        entity.ecs = this;\n\t\n\t        // iterate over all systems to setup valid systems\n\t        for (var i = 0; i < this.systems.length; ++i) {\n\t            var system = this.systems[i];\n\t\n\t            if (system.test(entity)) {\n\t                system.addEntity(entity);\n\t            }\n\t        }\n\t    };\n\t\n\t    /**\n\t     * Remove an entity from the ecs by reference.\n\t     *\n\t     * @param {Entity} entity - reference of the entity to remove\n\t     * @return {Entity} the remove entity if any\n\t     */\n\t\n\t\n\t    ECS.prototype.removeEntity = function removeEntity(entity) {\n\t        var index = this.entities.indexOf(entity);\n\t\n\t        // if the entity is not found do nothing\n\t        if (index !== -1) {\n\t            entity.dispose();\n\t\n\t            (0, _utils.fastSplice)(this.entities, index, 1);\n\t        }\n\t\n\t        return entity;\n\t    };\n\t\n\t    /**\n\t     * Add a system to the ecs.\n\t     *\n\t     * @param {System} system - system to add\n\t     */\n\t\n\t\n\t    ECS.prototype.addSystem = function addSystem(system) {\n\t        this.systems.push(system);\n\t        system.initialize();\n\t\n\t        // iterate over all entities to eventually add system\n\t        for (var i = 0; i < this.entities.length; ++i) {\n\t            var entity = this.entities[i];\n\t\n\t            if (system.test(entity)) {\n\t                system.addEntity(entity);\n\t            }\n\t        }\n\t    };\n\t\n\t    /**\n\t     * Remove a system from the ecs.\n\t     *\n\t     * @param {System} system system reference\n\t     */\n\t\n\t\n\t    ECS.prototype.removeSystem = function removeSystem(system) {\n\t        var index = this.systems.indexOf(system);\n\t\n\t        if (index !== -1) {\n\t            (0, _utils.fastSplice)(this.systems, index, 1);\n\t            system.dispose();\n\t        }\n\t    };\n\t\n\t    /**\n\t     * Update the ecs.\n\t     *\n\t     * @method update\n\t     */\n\t\n\t\n\t    ECS.prototype.update = function update() {\n\t        var now = _performance2.default.now();\n\t        var elapsed = now - this.lastUpdate;\n\t\n\t        // update each entity\n\t        for (var i = 0; i < this.entities.length; ++i) {\n\t            var entity = this.entities[i];\n\t\n\t            for (var j = 0; j < entity.systems.length; ++j) {\n\t                var system = entity.systems[j];\n\t\n\t                if (this.updateCounter % system.frequency > 0) {\n\t                    continue;\n\t                }\n\t\n\t                system.update(entity, elapsed);\n\t            }\n\t        }\n\t\n\t        this.updateCounter += 1;\n\t        this.lastUpdate = now;\n\t    };\n\t\n\t    return ECS;\n\t}();\n\t\n\t// expose!\n\t\n\t\n\texports.default = ECS;\n\tECS.Entity = _entity2.default;\n\tECS.System = _system2.default;\n\tECS.uid = _uid2.default;\n\t\n\t/**\n\t * An interface describing components.\n\t *\n\t * @interface IComponent\n\t */\n\t\n\t/**\n\t * The name of the component\n\t *\n\t * @property\n\t * @name IComponent#name\n\t * @type {string}\n\t */\n\t\n\t/**\n\t * The factory function for the data of this component.\n\t *\n\t * @function\n\t * @name IComponent#data\n\t * @returns {*} The data object for this component.\n\t */\n\n/***/ },\n/* 2 */\n/*!***********************!*\\\n  !*** ./src/entity.js ***!\n  \\***********************/\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\texports.__esModule = true;\n\t\n\tvar _symbol = __webpack_require__(/*! core-js/es6/symbol */ 3);\n\t\n\tvar _symbol2 = _interopRequireDefault(_symbol);\n\t\n\tvar _uid = __webpack_require__(/*! ./uid */ 55);\n\t\n\tvar _uid2 = _interopRequireDefault(_uid);\n\t\n\tvar _utils = __webpack_require__(/*! ./utils */ 56);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar _cachedApplicationRef = (0, _symbol2.default)('_cachedApplicationRef');\n\tvar _componentList = (0, _symbol2.default)('_componentList');\n\tvar _mixinRef = (0, _symbol2.default)('_mixinRef');\n\t\n\t/**\n\t * An entity.\n\t *\n\t * @class\n\t * @alias ECS.Entity\n\t */\n\t\n\tvar Entity = function () {\n\t    /**\n\t     *\n\t     * @param {number|UIDGenerator} idOrGenerator - The entity id if\n\t     *  a Number is passed. If an UIDGenerator is passed, the entity will use\n\t     *  it to generate a new id. If nothing is passed, the entity will use\n\t     *  the default UIDGenerator.\n\t     */\n\t    function Entity() {\n\t        var idOrGenerator = arguments.length <= 0 || arguments[0] === undefined ? _uid2.default.DefaultUIDGenerator : arguments[0];\n\t\n\t        _classCallCheck(this, Entity);\n\t\n\t        /**\n\t         * Unique identifier of the entity.\n\t         *\n\t         * @member {number}\n\t         */\n\t        this.id = typeof idOrGenerator === 'number' ? idOrGenerator : idOrGenerator.next();\n\t\n\t        /**\n\t         * Systems applied to the entity.\n\t         *\n\t         * @number {System[]}\n\t         */\n\t        this.systems = [];\n\t\n\t        /**\n\t         * A reference to parent ECS class.\n\t         *\n\t         * @member {ECS}\n\t         */\n\t        this.ecs = null;\n\t    }\n\t\n\t    /**\n\t     * Checks if an entity has all the components passed.\n\t     *\n\t     * @example\n\t     *\n\t     * ```js\n\t     * entity.hasComponents(Component1, Component2, ...);\n\t     * ```\n\t     *\n\t     * @alias hasComponent\n\t     * @param {...Component} components - The component classes to compose into a parent class.\n\t     * @return {Component} A base-class component to extend from.\n\t     */\n\t\n\t\n\t    Entity.prototype.hasComponents = function hasComponents() {\n\t        for (var _len = arguments.length, components = Array(_len), _key = 0; _key < _len; _key++) {\n\t            components[_key] = arguments[_key];\n\t        }\n\t\n\t        // Check that each passed component exists in the component list.\n\t        // If it doesn't, then immediately return false.\n\t        for (var i = 0; i < components.length; ++i) {\n\t            var comp = components[i];\n\t            var o = Object.getPrototypeOf(this);\n\t            var found = false;\n\t\n\t            while (o) {\n\t                if (Object.prototype.hasOwnProperty.call(o, _mixinRef) && o[_mixinRef] === comp) {\n\t                    found = true;\n\t                    break;\n\t                }\n\t                o = Object.getPrototypeOf(o);\n\t            }\n\t\n\t            // if we traveled the chain and never found the component we\n\t            // were looking for, then its done.\n\t            if (!found) {\n\t                return false;\n\t            }\n\t        }\n\t\n\t        return true;\n\t    };\n\t\n\t    /**\n\t     * Dispose the entity.\n\t     *\n\t     * @private\n\t     */\n\t\n\t\n\t    Entity.prototype.dispose = function dispose() {\n\t        while (this.systems.length) {\n\t            this.systems[this.systems.length - 1].removeEntity(this);\n\t        }\n\t    };\n\t\n\t    /**\n\t     * Add a system to the entity.\n\t     *\n\t     * @private\n\t     * @param {System} system - The system to add.\n\t     */\n\t\n\t\n\t    Entity.prototype._addSystem = function _addSystem(system) {\n\t        this.systems.push(system);\n\t    };\n\t\n\t    /**\n\t     * Remove a system from the entity.\n\t     *\n\t     * @private\n\t     * @param {System} system - The system reference to remove.\n\t     */\n\t\n\t\n\t    Entity.prototype._removeSystem = function _removeSystem(system) {\n\t        var index = this.systems.indexOf(system);\n\t\n\t        if (index !== -1) {\n\t            (0, _utils.fastSplice)(this.systems, index, 1);\n\t        }\n\t    };\n\t\n\t    return Entity;\n\t}();\n\t\n\texports.default = Entity;\n\t\n\t\n\tEntity.prototype.hasComponent = Entity.prototype.hasComponents;\n\t\n\t/**\n\t * Composes an entity with the given components.\n\t *\n\t * @example\n\t *\n\t * ```js\n\t * class MyEntity extends ECS.Entity.with(Component1, Component2, ...) {\n\t * }\n\t * ```\n\t *\n\t * @static\n\t * @param {...Component} components - The component classes to compose into a parent class.\n\t * @return {Component} A base-class component to extend from.\n\t */\n\tEntity.with = function entityWith() {\n\t    for (var _len2 = arguments.length, components = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n\t        components[_key2] = arguments[_key2];\n\t    }\n\t\n\t    var Clazz = components.reduce(function (base, comp) {\n\t        // Get or create a symbol used to look up a previous application of mixin\n\t        // to the class. This symbol is unique per mixin definition, so a class will have N\n\t        // applicationRefs if it has had N mixins applied to it. A mixin will have\n\t        // exactly one _cachedApplicationRef used to store its applications.\n\t        var ref = comp[_cachedApplicationRef];\n\t\n\t        if (!ref) {\n\t            ref = comp[_cachedApplicationRef] = (0, _symbol2.default)(comp.name);\n\t        }\n\t\n\t        // look up cached version of mixin/superclass\n\t        if (Object.prototype.hasOwnProperty.call(base, ref)) {\n\t            return base[ref];\n\t        }\n\t\n\t        // apply the component\n\t        var app = comp(base);\n\t\n\t        // cache it so we don't make it again\n\t        base[ref] = app;\n\t\n\t        // store the mixin we applied here.\n\t        app.prototype[_mixinRef] = comp;\n\t\n\t        return app;\n\t    }, this);\n\t\n\t    Clazz.prototype[_componentList] = components;\n\t\n\t    return Clazz;\n\t};\n\t\n\t// export some symbols\n\tEntity._cachedApplicationRef = _cachedApplicationRef;\n\tEntity._componentList = _componentList;\n\n/***/ },\n/* 3 */\n/*!*********************************!*\\\n  !*** ./~/core-js/es6/symbol.js ***!\n  \\*********************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\t__webpack_require__(/*! ../modules/es6.symbol */ 4);\n\t__webpack_require__(/*! ../modules/es6.object.to-string */ 53);\n\tmodule.exports = __webpack_require__(/*! ../modules/_core */ 10).Symbol;\n\n/***/ },\n/* 4 */\n/*!*****************************************!*\\\n  !*** ./~/core-js/modules/es6.symbol.js ***!\n  \\*****************************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t// ECMAScript 6 symbols shim\n\tvar global         = __webpack_require__(/*! ./_global */ 5)\n\t  , has            = __webpack_require__(/*! ./_has */ 6)\n\t  , DESCRIPTORS    = __webpack_require__(/*! ./_descriptors */ 7)\n\t  , $export        = __webpack_require__(/*! ./_export */ 9)\n\t  , redefine       = __webpack_require__(/*! ./_redefine */ 19)\n\t  , META           = __webpack_require__(/*! ./_meta */ 23).KEY\n\t  , $fails         = __webpack_require__(/*! ./_fails */ 8)\n\t  , shared         = __webpack_require__(/*! ./_shared */ 24)\n\t  , setToStringTag = __webpack_require__(/*! ./_set-to-string-tag */ 25)\n\t  , uid            = __webpack_require__(/*! ./_uid */ 20)\n\t  , wks            = __webpack_require__(/*! ./_wks */ 26)\n\t  , wksExt         = __webpack_require__(/*! ./_wks-ext */ 27)\n\t  , wksDefine      = __webpack_require__(/*! ./_wks-define */ 28)\n\t  , keyOf          = __webpack_require__(/*! ./_keyof */ 30)\n\t  , enumKeys       = __webpack_require__(/*! ./_enum-keys */ 43)\n\t  , isArray        = __webpack_require__(/*! ./_is-array */ 46)\n\t  , anObject       = __webpack_require__(/*! ./_an-object */ 13)\n\t  , toIObject      = __webpack_require__(/*! ./_to-iobject */ 33)\n\t  , toPrimitive    = __webpack_require__(/*! ./_to-primitive */ 17)\n\t  , createDesc     = __webpack_require__(/*! ./_property-desc */ 18)\n\t  , _create        = __webpack_require__(/*! ./_object-create */ 47)\n\t  , gOPNExt        = __webpack_require__(/*! ./_object-gopn-ext */ 50)\n\t  , $GOPD          = __webpack_require__(/*! ./_object-gopd */ 52)\n\t  , $DP            = __webpack_require__(/*! ./_object-dp */ 12)\n\t  , $keys          = __webpack_require__(/*! ./_object-keys */ 31)\n\t  , gOPD           = $GOPD.f\n\t  , dP             = $DP.f\n\t  , gOPN           = gOPNExt.f\n\t  , $Symbol        = global.Symbol\n\t  , $JSON          = global.JSON\n\t  , _stringify     = $JSON && $JSON.stringify\n\t  , PROTOTYPE      = 'prototype'\n\t  , HIDDEN         = wks('_hidden')\n\t  , TO_PRIMITIVE   = wks('toPrimitive')\n\t  , isEnum         = {}.propertyIsEnumerable\n\t  , SymbolRegistry = shared('symbol-registry')\n\t  , AllSymbols     = shared('symbols')\n\t  , OPSymbols      = shared('op-symbols')\n\t  , ObjectProto    = Object[PROTOTYPE]\n\t  , USE_NATIVE     = typeof $Symbol == 'function'\n\t  , QObject        = global.QObject;\n\t// Don't use setters in Qt Script, https://github.com/zloirock/core-js/issues/173\n\tvar setter = !QObject || !QObject[PROTOTYPE] || !QObject[PROTOTYPE].findChild;\n\t\n\t// fallback for old Android, https://code.google.com/p/v8/issues/detail?id=687\n\tvar setSymbolDesc = DESCRIPTORS && $fails(function(){\n\t  return _create(dP({}, 'a', {\n\t    get: function(){ return dP(this, 'a', {value: 7}).a; }\n\t  })).a != 7;\n\t}) ? function(it, key, D){\n\t  var protoDesc = gOPD(ObjectProto, key);\n\t  if(protoDesc)delete ObjectProto[key];\n\t  dP(it, key, D);\n\t  if(protoDesc && it !== ObjectProto)dP(ObjectProto, key, protoDesc);\n\t} : dP;\n\t\n\tvar wrap = function(tag){\n\t  var sym = AllSymbols[tag] = _create($Symbol[PROTOTYPE]);\n\t  sym._k = tag;\n\t  return sym;\n\t};\n\t\n\tvar isSymbol = USE_NATIVE && typeof $Symbol.iterator == 'symbol' ? function(it){\n\t  return typeof it == 'symbol';\n\t} : function(it){\n\t  return it instanceof $Symbol;\n\t};\n\t\n\tvar $defineProperty = function defineProperty(it, key, D){\n\t  if(it === ObjectProto)$defineProperty(OPSymbols, key, D);\n\t  anObject(it);\n\t  key = toPrimitive(key, true);\n\t  anObject(D);\n\t  if(has(AllSymbols, key)){\n\t    if(!D.enumerable){\n\t      if(!has(it, HIDDEN))dP(it, HIDDEN, createDesc(1, {}));\n\t      it[HIDDEN][key] = true;\n\t    } else {\n\t      if(has(it, HIDDEN) && it[HIDDEN][key])it[HIDDEN][key] = false;\n\t      D = _create(D, {enumerable: createDesc(0, false)});\n\t    } return setSymbolDesc(it, key, D);\n\t  } return dP(it, key, D);\n\t};\n\tvar $defineProperties = function defineProperties(it, P){\n\t  anObject(it);\n\t  var keys = enumKeys(P = toIObject(P))\n\t    , i    = 0\n\t    , l = keys.length\n\t    , key;\n\t  while(l > i)$defineProperty(it, key = keys[i++], P[key]);\n\t  return it;\n\t};\n\tvar $create = function create(it, P){\n\t  return P === undefined ? _create(it) : $defineProperties(_create(it), P);\n\t};\n\tvar $propertyIsEnumerable = function propertyIsEnumerable(key){\n\t  var E = isEnum.call(this, key = toPrimitive(key, true));\n\t  if(this === ObjectProto && has(AllSymbols, key) && !has(OPSymbols, key))return false;\n\t  return E || !has(this, key) || !has(AllSymbols, key) || has(this, HIDDEN) && this[HIDDEN][key] ? E : true;\n\t};\n\tvar $getOwnPropertyDescriptor = function getOwnPropertyDescriptor(it, key){\n\t  it  = toIObject(it);\n\t  key = toPrimitive(key, true);\n\t  if(it === ObjectProto && has(AllSymbols, key) && !has(OPSymbols, key))return;\n\t  var D = gOPD(it, key);\n\t  if(D && has(AllSymbols, key) && !(has(it, HIDDEN) && it[HIDDEN][key]))D.enumerable = true;\n\t  return D;\n\t};\n\tvar $getOwnPropertyNames = function getOwnPropertyNames(it){\n\t  var names  = gOPN(toIObject(it))\n\t    , result = []\n\t    , i      = 0\n\t    , key;\n\t  while(names.length > i){\n\t    if(!has(AllSymbols, key = names[i++]) && key != HIDDEN && key != META)result.push(key);\n\t  } return result;\n\t};\n\tvar $getOwnPropertySymbols = function getOwnPropertySymbols(it){\n\t  var IS_OP  = it === ObjectProto\n\t    , names  = gOPN(IS_OP ? OPSymbols : toIObject(it))\n\t    , result = []\n\t    , i      = 0\n\t    , key;\n\t  while(names.length > i){\n\t    if(has(AllSymbols, key = names[i++]) && (IS_OP ? has(ObjectProto, key) : true))result.push(AllSymbols[key]);\n\t  } return result;\n\t};\n\t\n\t// 19.4.1.1 Symbol([description])\n\tif(!USE_NATIVE){\n\t  $Symbol = function Symbol(){\n\t    if(this instanceof $Symbol)throw TypeError('Symbol is not a constructor!');\n\t    var tag = uid(arguments.length > 0 ? arguments[0] : undefined);\n\t    var $set = function(value){\n\t      if(this === ObjectProto)$set.call(OPSymbols, value);\n\t      if(has(this, HIDDEN) && has(this[HIDDEN], tag))this[HIDDEN][tag] = false;\n\t      setSymbolDesc(this, tag, createDesc(1, value));\n\t    };\n\t    if(DESCRIPTORS && setter)setSymbolDesc(ObjectProto, tag, {configurable: true, set: $set});\n\t    return wrap(tag);\n\t  };\n\t  redefine($Symbol[PROTOTYPE], 'toString', function toString(){\n\t    return this._k;\n\t  });\n\t\n\t  $GOPD.f = $getOwnPropertyDescriptor;\n\t  $DP.f   = $defineProperty;\n\t  __webpack_require__(/*! ./_object-gopn */ 51).f = gOPNExt.f = $getOwnPropertyNames;\n\t  __webpack_require__(/*! ./_object-pie */ 45).f  = $propertyIsEnumerable;\n\t  __webpack_require__(/*! ./_object-gops */ 44).f = $getOwnPropertySymbols;\n\t\n\t  if(DESCRIPTORS && !__webpack_require__(/*! ./_library */ 29)){\n\t    redefine(ObjectProto, 'propertyIsEnumerable', $propertyIsEnumerable, true);\n\t  }\n\t\n\t  wksExt.f = function(name){\n\t    return wrap(wks(name));\n\t  }\n\t}\n\t\n\t$export($export.G + $export.W + $export.F * !USE_NATIVE, {Symbol: $Symbol});\n\t\n\tfor(var symbols = (\n\t  // 19.4.2.2, 19.4.2.3, 19.4.2.4, 19.4.2.6, 19.4.2.8, 19.4.2.9, 19.4.2.10, 19.4.2.11, 19.4.2.12, 19.4.2.13, 19.4.2.14\n\t  'hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables'\n\t).split(','), i = 0; symbols.length > i; )wks(symbols[i++]);\n\t\n\tfor(var symbols = $keys(wks.store), i = 0; symbols.length > i; )wksDefine(symbols[i++]);\n\t\n\t$export($export.S + $export.F * !USE_NATIVE, 'Symbol', {\n\t  // 19.4.2.1 Symbol.for(key)\n\t  'for': function(key){\n\t    return has(SymbolRegistry, key += '')\n\t      ? SymbolRegistry[key]\n\t      : SymbolRegistry[key] = $Symbol(key);\n\t  },\n\t  // 19.4.2.5 Symbol.keyFor(sym)\n\t  keyFor: function keyFor(key){\n\t    if(isSymbol(key))return keyOf(SymbolRegistry, key);\n\t    throw TypeError(key + ' is not a symbol!');\n\t  },\n\t  useSetter: function(){ setter = true; },\n\t  useSimple: function(){ setter = false; }\n\t});\n\t\n\t$export($export.S + $export.F * !USE_NATIVE, 'Object', {\n\t  // 19.1.2.2 Object.create(O [, Properties])\n\t  create: $create,\n\t  // 19.1.2.4 Object.defineProperty(O, P, Attributes)\n\t  defineProperty: $defineProperty,\n\t  // 19.1.2.3 Object.defineProperties(O, Properties)\n\t  defineProperties: $defineProperties,\n\t  // 19.1.2.6 Object.getOwnPropertyDescriptor(O, P)\n\t  getOwnPropertyDescriptor: $getOwnPropertyDescriptor,\n\t  // 19.1.2.7 Object.getOwnPropertyNames(O)\n\t  getOwnPropertyNames: $getOwnPropertyNames,\n\t  // 19.1.2.8 Object.getOwnPropertySymbols(O)\n\t  getOwnPropertySymbols: $getOwnPropertySymbols\n\t});\n\t\n\t// 24.3.2 JSON.stringify(value [, replacer [, space]])\n\t$JSON && $export($export.S + $export.F * (!USE_NATIVE || $fails(function(){\n\t  var S = $Symbol();\n\t  // MS Edge converts symbol values to JSON as {}\n\t  // WebKit converts symbol values to JSON as null\n\t  // V8 throws on boxed symbols\n\t  return _stringify([S]) != '[null]' || _stringify({a: S}) != '{}' || _stringify(Object(S)) != '{}';\n\t})), 'JSON', {\n\t  stringify: function stringify(it){\n\t    if(it === undefined || isSymbol(it))return; // IE8 returns string on undefined\n\t    var args = [it]\n\t      , i    = 1\n\t      , replacer, $replacer;\n\t    while(arguments.length > i)args.push(arguments[i++]);\n\t    replacer = args[1];\n\t    if(typeof replacer == 'function')$replacer = replacer;\n\t    if($replacer || !isArray(replacer))replacer = function(key, value){\n\t      if($replacer)value = $replacer.call(this, key, value);\n\t      if(!isSymbol(value))return value;\n\t    };\n\t    args[1] = replacer;\n\t    return _stringify.apply($JSON, args);\n\t  }\n\t});\n\t\n\t// 19.4.3.4 Symbol.prototype[@@toPrimitive](hint)\n\t$Symbol[PROTOTYPE][TO_PRIMITIVE] || __webpack_require__(/*! ./_hide */ 11)($Symbol[PROTOTYPE], TO_PRIMITIVE, $Symbol[PROTOTYPE].valueOf);\n\t// 19.4.3.5 Symbol.prototype[@@toStringTag]\n\tsetToStringTag($Symbol, 'Symbol');\n\t// 20.2.1.9 Math[@@toStringTag]\n\tsetToStringTag(Math, 'Math', true);\n\t// 24.3.3 JSON[@@toStringTag]\n\tsetToStringTag(global.JSON, 'JSON', true);\n\n/***/ },\n/* 5 */\n/*!**************************************!*\\\n  !*** ./~/core-js/modules/_global.js ***!\n  \\**************************************/\n/***/ function(module, exports) {\n\n\t// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028\n\tvar global = module.exports = typeof window != 'undefined' && window.Math == Math\n\t  ? window : typeof self != 'undefined' && self.Math == Math ? self : Function('return this')();\n\tif(typeof __g == 'number')__g = global; // eslint-disable-line no-undef\n\n/***/ },\n/* 6 */\n/*!***********************************!*\\\n  !*** ./~/core-js/modules/_has.js ***!\n  \\***********************************/\n/***/ function(module, exports) {\n\n\tvar hasOwnProperty = {}.hasOwnProperty;\n\tmodule.exports = function(it, key){\n\t  return hasOwnProperty.call(it, key);\n\t};\n\n/***/ },\n/* 7 */\n/*!*******************************************!*\\\n  !*** ./~/core-js/modules/_descriptors.js ***!\n  \\*******************************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\t// Thank's IE8 for his funny defineProperty\n\tmodule.exports = !__webpack_require__(/*! ./_fails */ 8)(function(){\n\t  return Object.defineProperty({}, 'a', {get: function(){ return 7; }}).a != 7;\n\t});\n\n/***/ },\n/* 8 */\n/*!*************************************!*\\\n  !*** ./~/core-js/modules/_fails.js ***!\n  \\*************************************/\n/***/ function(module, exports) {\n\n\tmodule.exports = function(exec){\n\t  try {\n\t    return !!exec();\n\t  } catch(e){\n\t    return true;\n\t  }\n\t};\n\n/***/ },\n/* 9 */\n/*!**************************************!*\\\n  !*** ./~/core-js/modules/_export.js ***!\n  \\**************************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar global    = __webpack_require__(/*! ./_global */ 5)\n\t  , core      = __webpack_require__(/*! ./_core */ 10)\n\t  , hide      = __webpack_require__(/*! ./_hide */ 11)\n\t  , redefine  = __webpack_require__(/*! ./_redefine */ 19)\n\t  , ctx       = __webpack_require__(/*! ./_ctx */ 21)\n\t  , PROTOTYPE = 'prototype';\n\t\n\tvar $export = function(type, name, source){\n\t  var IS_FORCED = type & $export.F\n\t    , IS_GLOBAL = type & $export.G\n\t    , IS_STATIC = type & $export.S\n\t    , IS_PROTO  = type & $export.P\n\t    , IS_BIND   = type & $export.B\n\t    , target    = IS_GLOBAL ? global : IS_STATIC ? global[name] || (global[name] = {}) : (global[name] || {})[PROTOTYPE]\n\t    , exports   = IS_GLOBAL ? core : core[name] || (core[name] = {})\n\t    , expProto  = exports[PROTOTYPE] || (exports[PROTOTYPE] = {})\n\t    , key, own, out, exp;\n\t  if(IS_GLOBAL)source = name;\n\t  for(key in source){\n\t    // contains in native\n\t    own = !IS_FORCED && target && target[key] !== undefined;\n\t    // export native or passed\n\t    out = (own ? target : source)[key];\n\t    // bind timers to global for call from export context\n\t    exp = IS_BIND && own ? ctx(out, global) : IS_PROTO && typeof out == 'function' ? ctx(Function.call, out) : out;\n\t    // extend global\n\t    if(target)redefine(target, key, out, type & $export.U);\n\t    // export\n\t    if(exports[key] != out)hide(exports, key, exp);\n\t    if(IS_PROTO && expProto[key] != out)expProto[key] = out;\n\t  }\n\t};\n\tglobal.core = core;\n\t// type bitmap\n\t$export.F = 1;   // forced\n\t$export.G = 2;   // global\n\t$export.S = 4;   // static\n\t$export.P = 8;   // proto\n\t$export.B = 16;  // bind\n\t$export.W = 32;  // wrap\n\t$export.U = 64;  // safe\n\t$export.R = 128; // real proto method for `library` \n\tmodule.exports = $export;\n\n/***/ },\n/* 10 */\n/*!************************************!*\\\n  !*** ./~/core-js/modules/_core.js ***!\n  \\************************************/\n/***/ function(module, exports) {\n\n\tvar core = module.exports = {version: '2.4.0'};\n\tif(typeof __e == 'number')__e = core; // eslint-disable-line no-undef\n\n/***/ },\n/* 11 */\n/*!************************************!*\\\n  !*** ./~/core-js/modules/_hide.js ***!\n  \\************************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar dP         = __webpack_require__(/*! ./_object-dp */ 12)\n\t  , createDesc = __webpack_require__(/*! ./_property-desc */ 18);\n\tmodule.exports = __webpack_require__(/*! ./_descriptors */ 7) ? function(object, key, value){\n\t  return dP.f(object, key, createDesc(1, value));\n\t} : function(object, key, value){\n\t  object[key] = value;\n\t  return object;\n\t};\n\n/***/ },\n/* 12 */\n/*!*****************************************!*\\\n  !*** ./~/core-js/modules/_object-dp.js ***!\n  \\*****************************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar anObject       = __webpack_require__(/*! ./_an-object */ 13)\n\t  , IE8_DOM_DEFINE = __webpack_require__(/*! ./_ie8-dom-define */ 15)\n\t  , toPrimitive    = __webpack_require__(/*! ./_to-primitive */ 17)\n\t  , dP             = Object.defineProperty;\n\t\n\texports.f = __webpack_require__(/*! ./_descriptors */ 7) ? Object.defineProperty : function defineProperty(O, P, Attributes){\n\t  anObject(O);\n\t  P = toPrimitive(P, true);\n\t  anObject(Attributes);\n\t  if(IE8_DOM_DEFINE)try {\n\t    return dP(O, P, Attributes);\n\t  } catch(e){ /* empty */ }\n\t  if('get' in Attributes || 'set' in Attributes)throw TypeError('Accessors not supported!');\n\t  if('value' in Attributes)O[P] = Attributes.value;\n\t  return O;\n\t};\n\n/***/ },\n/* 13 */\n/*!*****************************************!*\\\n  !*** ./~/core-js/modules/_an-object.js ***!\n  \\*****************************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar isObject = __webpack_require__(/*! ./_is-object */ 14);\n\tmodule.exports = function(it){\n\t  if(!isObject(it))throw TypeError(it + ' is not an object!');\n\t  return it;\n\t};\n\n/***/ },\n/* 14 */\n/*!*****************************************!*\\\n  !*** ./~/core-js/modules/_is-object.js ***!\n  \\*****************************************/\n/***/ function(module, exports) {\n\n\tmodule.exports = function(it){\n\t  return typeof it === 'object' ? it !== null : typeof it === 'function';\n\t};\n\n/***/ },\n/* 15 */\n/*!**********************************************!*\\\n  !*** ./~/core-js/modules/_ie8-dom-define.js ***!\n  \\**********************************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = !__webpack_require__(/*! ./_descriptors */ 7) && !__webpack_require__(/*! ./_fails */ 8)(function(){\n\t  return Object.defineProperty(__webpack_require__(/*! ./_dom-create */ 16)('div'), 'a', {get: function(){ return 7; }}).a != 7;\n\t});\n\n/***/ },\n/* 16 */\n/*!******************************************!*\\\n  !*** ./~/core-js/modules/_dom-create.js ***!\n  \\******************************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar isObject = __webpack_require__(/*! ./_is-object */ 14)\n\t  , document = __webpack_require__(/*! ./_global */ 5).document\n\t  // in old IE typeof document.createElement is 'object'\n\t  , is = isObject(document) && isObject(document.createElement);\n\tmodule.exports = function(it){\n\t  return is ? document.createElement(it) : {};\n\t};\n\n/***/ },\n/* 17 */\n/*!********************************************!*\\\n  !*** ./~/core-js/modules/_to-primitive.js ***!\n  \\********************************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\t// 7.1.1 ToPrimitive(input [, PreferredType])\n\tvar isObject = __webpack_require__(/*! ./_is-object */ 14);\n\t// instead of the ES6 spec version, we didn't implement @@toPrimitive case\n\t// and the second argument - flag - preferred type is a string\n\tmodule.exports = function(it, S){\n\t  if(!isObject(it))return it;\n\t  var fn, val;\n\t  if(S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it)))return val;\n\t  if(typeof (fn = it.valueOf) == 'function' && !isObject(val = fn.call(it)))return val;\n\t  if(!S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it)))return val;\n\t  throw TypeError(\"Can't convert object to primitive value\");\n\t};\n\n/***/ },\n/* 18 */\n/*!*********************************************!*\\\n  !*** ./~/core-js/modules/_property-desc.js ***!\n  \\*********************************************/\n/***/ function(module, exports) {\n\n\tmodule.exports = function(bitmap, value){\n\t  return {\n\t    enumerable  : !(bitmap & 1),\n\t    configurable: !(bitmap & 2),\n\t    writable    : !(bitmap & 4),\n\t    value       : value\n\t  };\n\t};\n\n/***/ },\n/* 19 */\n/*!****************************************!*\\\n  !*** ./~/core-js/modules/_redefine.js ***!\n  \\****************************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar global    = __webpack_require__(/*! ./_global */ 5)\n\t  , hide      = __webpack_require__(/*! ./_hide */ 11)\n\t  , has       = __webpack_require__(/*! ./_has */ 6)\n\t  , SRC       = __webpack_require__(/*! ./_uid */ 20)('src')\n\t  , TO_STRING = 'toString'\n\t  , $toString = Function[TO_STRING]\n\t  , TPL       = ('' + $toString).split(TO_STRING);\n\t\n\t__webpack_require__(/*! ./_core */ 10).inspectSource = function(it){\n\t  return $toString.call(it);\n\t};\n\t\n\t(module.exports = function(O, key, val, safe){\n\t  var isFunction = typeof val == 'function';\n\t  if(isFunction)has(val, 'name') || hide(val, 'name', key);\n\t  if(O[key] === val)return;\n\t  if(isFunction)has(val, SRC) || hide(val, SRC, O[key] ? '' + O[key] : TPL.join(String(key)));\n\t  if(O === global){\n\t    O[key] = val;\n\t  } else {\n\t    if(!safe){\n\t      delete O[key];\n\t      hide(O, key, val);\n\t    } else {\n\t      if(O[key])O[key] = val;\n\t      else hide(O, key, val);\n\t    }\n\t  }\n\t// add fake Function#toString for correct work wrapped methods / constructors with methods like LoDash isNative\n\t})(Function.prototype, TO_STRING, function toString(){\n\t  return typeof this == 'function' && this[SRC] || $toString.call(this);\n\t});\n\n/***/ },\n/* 20 */\n/*!***********************************!*\\\n  !*** ./~/core-js/modules/_uid.js ***!\n  \\***********************************/\n/***/ function(module, exports) {\n\n\tvar id = 0\n\t  , px = Math.random();\n\tmodule.exports = function(key){\n\t  return 'Symbol('.concat(key === undefined ? '' : key, ')_', (++id + px).toString(36));\n\t};\n\n/***/ },\n/* 21 */\n/*!***********************************!*\\\n  !*** ./~/core-js/modules/_ctx.js ***!\n  \\***********************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\t// optional / simple context binding\n\tvar aFunction = __webpack_require__(/*! ./_a-function */ 22);\n\tmodule.exports = function(fn, that, length){\n\t  aFunction(fn);\n\t  if(that === undefined)return fn;\n\t  switch(length){\n\t    case 1: return function(a){\n\t      return fn.call(that, a);\n\t    };\n\t    case 2: return function(a, b){\n\t      return fn.call(that, a, b);\n\t    };\n\t    case 3: return function(a, b, c){\n\t      return fn.call(that, a, b, c);\n\t    };\n\t  }\n\t  return function(/* ...args */){\n\t    return fn.apply(that, arguments);\n\t  };\n\t};\n\n/***/ },\n/* 22 */\n/*!******************************************!*\\\n  !*** ./~/core-js/modules/_a-function.js ***!\n  \\******************************************/\n/***/ function(module, exports) {\n\n\tmodule.exports = function(it){\n\t  if(typeof it != 'function')throw TypeError(it + ' is not a function!');\n\t  return it;\n\t};\n\n/***/ },\n/* 23 */\n/*!************************************!*\\\n  !*** ./~/core-js/modules/_meta.js ***!\n  \\************************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar META     = __webpack_require__(/*! ./_uid */ 20)('meta')\n\t  , isObject = __webpack_require__(/*! ./_is-object */ 14)\n\t  , has      = __webpack_require__(/*! ./_has */ 6)\n\t  , setDesc  = __webpack_require__(/*! ./_object-dp */ 12).f\n\t  , id       = 0;\n\tvar isExtensible = Object.isExtensible || function(){\n\t  return true;\n\t};\n\tvar FREEZE = !__webpack_require__(/*! ./_fails */ 8)(function(){\n\t  return isExtensible(Object.preventExtensions({}));\n\t});\n\tvar setMeta = function(it){\n\t  setDesc(it, META, {value: {\n\t    i: 'O' + ++id, // object ID\n\t    w: {}          // weak collections IDs\n\t  }});\n\t};\n\tvar fastKey = function(it, create){\n\t  // return primitive with prefix\n\t  if(!isObject(it))return typeof it == 'symbol' ? it : (typeof it == 'string' ? 'S' : 'P') + it;\n\t  if(!has(it, META)){\n\t    // can't set metadata to uncaught frozen object\n\t    if(!isExtensible(it))return 'F';\n\t    // not necessary to add metadata\n\t    if(!create)return 'E';\n\t    // add missing metadata\n\t    setMeta(it);\n\t  // return object ID\n\t  } return it[META].i;\n\t};\n\tvar getWeak = function(it, create){\n\t  if(!has(it, META)){\n\t    // can't set metadata to uncaught frozen object\n\t    if(!isExtensible(it))return true;\n\t    // not necessary to add metadata\n\t    if(!create)return false;\n\t    // add missing metadata\n\t    setMeta(it);\n\t  // return hash weak collections IDs\n\t  } return it[META].w;\n\t};\n\t// add metadata on freeze-family methods calling\n\tvar onFreeze = function(it){\n\t  if(FREEZE && meta.NEED && isExtensible(it) && !has(it, META))setMeta(it);\n\t  return it;\n\t};\n\tvar meta = module.exports = {\n\t  KEY:      META,\n\t  NEED:     false,\n\t  fastKey:  fastKey,\n\t  getWeak:  getWeak,\n\t  onFreeze: onFreeze\n\t};\n\n/***/ },\n/* 24 */\n/*!**************************************!*\\\n  !*** ./~/core-js/modules/_shared.js ***!\n  \\**************************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar global = __webpack_require__(/*! ./_global */ 5)\n\t  , SHARED = '__core-js_shared__'\n\t  , store  = global[SHARED] || (global[SHARED] = {});\n\tmodule.exports = function(key){\n\t  return store[key] || (store[key] = {});\n\t};\n\n/***/ },\n/* 25 */\n/*!*************************************************!*\\\n  !*** ./~/core-js/modules/_set-to-string-tag.js ***!\n  \\*************************************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar def = __webpack_require__(/*! ./_object-dp */ 12).f\n\t  , has = __webpack_require__(/*! ./_has */ 6)\n\t  , TAG = __webpack_require__(/*! ./_wks */ 26)('toStringTag');\n\t\n\tmodule.exports = function(it, tag, stat){\n\t  if(it && !has(it = stat ? it : it.prototype, TAG))def(it, TAG, {configurable: true, value: tag});\n\t};\n\n/***/ },\n/* 26 */\n/*!***********************************!*\\\n  !*** ./~/core-js/modules/_wks.js ***!\n  \\***********************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar store      = __webpack_require__(/*! ./_shared */ 24)('wks')\n\t  , uid        = __webpack_require__(/*! ./_uid */ 20)\n\t  , Symbol     = __webpack_require__(/*! ./_global */ 5).Symbol\n\t  , USE_SYMBOL = typeof Symbol == 'function';\n\t\n\tvar $exports = module.exports = function(name){\n\t  return store[name] || (store[name] =\n\t    USE_SYMBOL && Symbol[name] || (USE_SYMBOL ? Symbol : uid)('Symbol.' + name));\n\t};\n\t\n\t$exports.store = store;\n\n/***/ },\n/* 27 */\n/*!***************************************!*\\\n  !*** ./~/core-js/modules/_wks-ext.js ***!\n  \\***************************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\texports.f = __webpack_require__(/*! ./_wks */ 26);\n\n/***/ },\n/* 28 */\n/*!******************************************!*\\\n  !*** ./~/core-js/modules/_wks-define.js ***!\n  \\******************************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar global         = __webpack_require__(/*! ./_global */ 5)\n\t  , core           = __webpack_require__(/*! ./_core */ 10)\n\t  , LIBRARY        = __webpack_require__(/*! ./_library */ 29)\n\t  , wksExt         = __webpack_require__(/*! ./_wks-ext */ 27)\n\t  , defineProperty = __webpack_require__(/*! ./_object-dp */ 12).f;\n\tmodule.exports = function(name){\n\t  var $Symbol = core.Symbol || (core.Symbol = LIBRARY ? {} : global.Symbol || {});\n\t  if(name.charAt(0) != '_' && !(name in $Symbol))defineProperty($Symbol, name, {value: wksExt.f(name)});\n\t};\n\n/***/ },\n/* 29 */\n/*!***************************************!*\\\n  !*** ./~/core-js/modules/_library.js ***!\n  \\***************************************/\n/***/ function(module, exports) {\n\n\tmodule.exports = false;\n\n/***/ },\n/* 30 */\n/*!*************************************!*\\\n  !*** ./~/core-js/modules/_keyof.js ***!\n  \\*************************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar getKeys   = __webpack_require__(/*! ./_object-keys */ 31)\n\t  , toIObject = __webpack_require__(/*! ./_to-iobject */ 33);\n\tmodule.exports = function(object, el){\n\t  var O      = toIObject(object)\n\t    , keys   = getKeys(O)\n\t    , length = keys.length\n\t    , index  = 0\n\t    , key;\n\t  while(length > index)if(O[key = keys[index++]] === el)return key;\n\t};\n\n/***/ },\n/* 31 */\n/*!*******************************************!*\\\n  !*** ./~/core-js/modules/_object-keys.js ***!\n  \\*******************************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\t// 19.1.2.14 / 15.2.3.14 Object.keys(O)\n\tvar $keys       = __webpack_require__(/*! ./_object-keys-internal */ 32)\n\t  , enumBugKeys = __webpack_require__(/*! ./_enum-bug-keys */ 42);\n\t\n\tmodule.exports = Object.keys || function keys(O){\n\t  return $keys(O, enumBugKeys);\n\t};\n\n/***/ },\n/* 32 */\n/*!****************************************************!*\\\n  !*** ./~/core-js/modules/_object-keys-internal.js ***!\n  \\****************************************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar has          = __webpack_require__(/*! ./_has */ 6)\n\t  , toIObject    = __webpack_require__(/*! ./_to-iobject */ 33)\n\t  , arrayIndexOf = __webpack_require__(/*! ./_array-includes */ 37)(false)\n\t  , IE_PROTO     = __webpack_require__(/*! ./_shared-key */ 41)('IE_PROTO');\n\t\n\tmodule.exports = function(object, names){\n\t  var O      = toIObject(object)\n\t    , i      = 0\n\t    , result = []\n\t    , key;\n\t  for(key in O)if(key != IE_PROTO)has(O, key) && result.push(key);\n\t  // Don't enum bug & hidden keys\n\t  while(names.length > i)if(has(O, key = names[i++])){\n\t    ~arrayIndexOf(result, key) || result.push(key);\n\t  }\n\t  return result;\n\t};\n\n/***/ },\n/* 33 */\n/*!******************************************!*\\\n  !*** ./~/core-js/modules/_to-iobject.js ***!\n  \\******************************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\t// to indexed object, toObject with fallback for non-array-like ES3 strings\n\tvar IObject = __webpack_require__(/*! ./_iobject */ 34)\n\t  , defined = __webpack_require__(/*! ./_defined */ 36);\n\tmodule.exports = function(it){\n\t  return IObject(defined(it));\n\t};\n\n/***/ },\n/* 34 */\n/*!***************************************!*\\\n  !*** ./~/core-js/modules/_iobject.js ***!\n  \\***************************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\t// fallback for non-array-like ES3 and non-enumerable old V8 strings\n\tvar cof = __webpack_require__(/*! ./_cof */ 35);\n\tmodule.exports = Object('z').propertyIsEnumerable(0) ? Object : function(it){\n\t  return cof(it) == 'String' ? it.split('') : Object(it);\n\t};\n\n/***/ },\n/* 35 */\n/*!***********************************!*\\\n  !*** ./~/core-js/modules/_cof.js ***!\n  \\***********************************/\n/***/ function(module, exports) {\n\n\tvar toString = {}.toString;\n\t\n\tmodule.exports = function(it){\n\t  return toString.call(it).slice(8, -1);\n\t};\n\n/***/ },\n/* 36 */\n/*!***************************************!*\\\n  !*** ./~/core-js/modules/_defined.js ***!\n  \\***************************************/\n/***/ function(module, exports) {\n\n\t// 7.2.1 RequireObjectCoercible(argument)\n\tmodule.exports = function(it){\n\t  if(it == undefined)throw TypeError(\"Can't call method on  \" + it);\n\t  return it;\n\t};\n\n/***/ },\n/* 37 */\n/*!**********************************************!*\\\n  !*** ./~/core-js/modules/_array-includes.js ***!\n  \\**********************************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\t// false -> Array#indexOf\n\t// true  -> Array#includes\n\tvar toIObject = __webpack_require__(/*! ./_to-iobject */ 33)\n\t  , toLength  = __webpack_require__(/*! ./_to-length */ 38)\n\t  , toIndex   = __webpack_require__(/*! ./_to-index */ 40);\n\tmodule.exports = function(IS_INCLUDES){\n\t  return function($this, el, fromIndex){\n\t    var O      = toIObject($this)\n\t      , length = toLength(O.length)\n\t      , index  = toIndex(fromIndex, length)\n\t      , value;\n\t    // Array#includes uses SameValueZero equality algorithm\n\t    if(IS_INCLUDES && el != el)while(length > index){\n\t      value = O[index++];\n\t      if(value != value)return true;\n\t    // Array#toIndex ignores holes, Array#includes - not\n\t    } else for(;length > index; index++)if(IS_INCLUDES || index in O){\n\t      if(O[index] === el)return IS_INCLUDES || index || 0;\n\t    } return !IS_INCLUDES && -1;\n\t  };\n\t};\n\n/***/ },\n/* 38 */\n/*!*****************************************!*\\\n  !*** ./~/core-js/modules/_to-length.js ***!\n  \\*****************************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\t// 7.1.15 ToLength\n\tvar toInteger = __webpack_require__(/*! ./_to-integer */ 39)\n\t  , min       = Math.min;\n\tmodule.exports = function(it){\n\t  return it > 0 ? min(toInteger(it), 0x1fffffffffffff) : 0; // pow(2, 53) - 1 == 9007199254740991\n\t};\n\n/***/ },\n/* 39 */\n/*!******************************************!*\\\n  !*** ./~/core-js/modules/_to-integer.js ***!\n  \\******************************************/\n/***/ function(module, exports) {\n\n\t// 7.1.4 ToInteger\n\tvar ceil  = Math.ceil\n\t  , floor = Math.floor;\n\tmodule.exports = function(it){\n\t  return isNaN(it = +it) ? 0 : (it > 0 ? floor : ceil)(it);\n\t};\n\n/***/ },\n/* 40 */\n/*!****************************************!*\\\n  !*** ./~/core-js/modules/_to-index.js ***!\n  \\****************************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar toInteger = __webpack_require__(/*! ./_to-integer */ 39)\n\t  , max       = Math.max\n\t  , min       = Math.min;\n\tmodule.exports = function(index, length){\n\t  index = toInteger(index);\n\t  return index < 0 ? max(index + length, 0) : min(index, length);\n\t};\n\n/***/ },\n/* 41 */\n/*!******************************************!*\\\n  !*** ./~/core-js/modules/_shared-key.js ***!\n  \\******************************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar shared = __webpack_require__(/*! ./_shared */ 24)('keys')\n\t  , uid    = __webpack_require__(/*! ./_uid */ 20);\n\tmodule.exports = function(key){\n\t  return shared[key] || (shared[key] = uid(key));\n\t};\n\n/***/ },\n/* 42 */\n/*!*********************************************!*\\\n  !*** ./~/core-js/modules/_enum-bug-keys.js ***!\n  \\*********************************************/\n/***/ function(module, exports) {\n\n\t// IE 8- don't enum bug keys\n\tmodule.exports = (\n\t  'constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf'\n\t).split(',');\n\n/***/ },\n/* 43 */\n/*!*****************************************!*\\\n  !*** ./~/core-js/modules/_enum-keys.js ***!\n  \\*****************************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\t// all enumerable object keys, includes symbols\n\tvar getKeys = __webpack_require__(/*! ./_object-keys */ 31)\n\t  , gOPS    = __webpack_require__(/*! ./_object-gops */ 44)\n\t  , pIE     = __webpack_require__(/*! ./_object-pie */ 45);\n\tmodule.exports = function(it){\n\t  var result     = getKeys(it)\n\t    , getSymbols = gOPS.f;\n\t  if(getSymbols){\n\t    var symbols = getSymbols(it)\n\t      , isEnum  = pIE.f\n\t      , i       = 0\n\t      , key;\n\t    while(symbols.length > i)if(isEnum.call(it, key = symbols[i++]))result.push(key);\n\t  } return result;\n\t};\n\n/***/ },\n/* 44 */\n/*!*******************************************!*\\\n  !*** ./~/core-js/modules/_object-gops.js ***!\n  \\*******************************************/\n/***/ function(module, exports) {\n\n\texports.f = Object.getOwnPropertySymbols;\n\n/***/ },\n/* 45 */\n/*!******************************************!*\\\n  !*** ./~/core-js/modules/_object-pie.js ***!\n  \\******************************************/\n/***/ function(module, exports) {\n\n\texports.f = {}.propertyIsEnumerable;\n\n/***/ },\n/* 46 */\n/*!****************************************!*\\\n  !*** ./~/core-js/modules/_is-array.js ***!\n  \\****************************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\t// 7.2.2 IsArray(argument)\n\tvar cof = __webpack_require__(/*! ./_cof */ 35);\n\tmodule.exports = Array.isArray || function isArray(arg){\n\t  return cof(arg) == 'Array';\n\t};\n\n/***/ },\n/* 47 */\n/*!*********************************************!*\\\n  !*** ./~/core-js/modules/_object-create.js ***!\n  \\*********************************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\t// 19.1.2.2 / 15.2.3.5 Object.create(O [, Properties])\n\tvar anObject    = __webpack_require__(/*! ./_an-object */ 13)\n\t  , dPs         = __webpack_require__(/*! ./_object-dps */ 48)\n\t  , enumBugKeys = __webpack_require__(/*! ./_enum-bug-keys */ 42)\n\t  , IE_PROTO    = __webpack_require__(/*! ./_shared-key */ 41)('IE_PROTO')\n\t  , Empty       = function(){ /* empty */ }\n\t  , PROTOTYPE   = 'prototype';\n\t\n\t// Create object with fake `null` prototype: use iframe Object with cleared prototype\n\tvar createDict = function(){\n\t  // Thrash, waste and sodomy: IE GC bug\n\t  var iframe = __webpack_require__(/*! ./_dom-create */ 16)('iframe')\n\t    , i      = enumBugKeys.length\n\t    , lt     = '<'\n\t    , gt     = '>'\n\t    , iframeDocument;\n\t  iframe.style.display = 'none';\n\t  __webpack_require__(/*! ./_html */ 49).appendChild(iframe);\n\t  iframe.src = 'javascript:'; // eslint-disable-line no-script-url\n\t  // createDict = iframe.contentWindow.Object;\n\t  // html.removeChild(iframe);\n\t  iframeDocument = iframe.contentWindow.document;\n\t  iframeDocument.open();\n\t  iframeDocument.write(lt + 'script' + gt + 'document.F=Object' + lt + '/script' + gt);\n\t  iframeDocument.close();\n\t  createDict = iframeDocument.F;\n\t  while(i--)delete createDict[PROTOTYPE][enumBugKeys[i]];\n\t  return createDict();\n\t};\n\t\n\tmodule.exports = Object.create || function create(O, Properties){\n\t  var result;\n\t  if(O !== null){\n\t    Empty[PROTOTYPE] = anObject(O);\n\t    result = new Empty;\n\t    Empty[PROTOTYPE] = null;\n\t    // add \"__proto__\" for Object.getPrototypeOf polyfill\n\t    result[IE_PROTO] = O;\n\t  } else result = createDict();\n\t  return Properties === undefined ? result : dPs(result, Properties);\n\t};\n\n\n/***/ },\n/* 48 */\n/*!******************************************!*\\\n  !*** ./~/core-js/modules/_object-dps.js ***!\n  \\******************************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar dP       = __webpack_require__(/*! ./_object-dp */ 12)\n\t  , anObject = __webpack_require__(/*! ./_an-object */ 13)\n\t  , getKeys  = __webpack_require__(/*! ./_object-keys */ 31);\n\t\n\tmodule.exports = __webpack_require__(/*! ./_descriptors */ 7) ? Object.defineProperties : function defineProperties(O, Properties){\n\t  anObject(O);\n\t  var keys   = getKeys(Properties)\n\t    , length = keys.length\n\t    , i = 0\n\t    , P;\n\t  while(length > i)dP.f(O, P = keys[i++], Properties[P]);\n\t  return O;\n\t};\n\n/***/ },\n/* 49 */\n/*!************************************!*\\\n  !*** ./~/core-js/modules/_html.js ***!\n  \\************************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = __webpack_require__(/*! ./_global */ 5).document && document.documentElement;\n\n/***/ },\n/* 50 */\n/*!***********************************************!*\\\n  !*** ./~/core-js/modules/_object-gopn-ext.js ***!\n  \\***********************************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\t// fallback for IE11 buggy Object.getOwnPropertyNames with iframe and window\n\tvar toIObject = __webpack_require__(/*! ./_to-iobject */ 33)\n\t  , gOPN      = __webpack_require__(/*! ./_object-gopn */ 51).f\n\t  , toString  = {}.toString;\n\t\n\tvar windowNames = typeof window == 'object' && window && Object.getOwnPropertyNames\n\t  ? Object.getOwnPropertyNames(window) : [];\n\t\n\tvar getWindowNames = function(it){\n\t  try {\n\t    return gOPN(it);\n\t  } catch(e){\n\t    return windowNames.slice();\n\t  }\n\t};\n\t\n\tmodule.exports.f = function getOwnPropertyNames(it){\n\t  return windowNames && toString.call(it) == '[object Window]' ? getWindowNames(it) : gOPN(toIObject(it));\n\t};\n\n\n/***/ },\n/* 51 */\n/*!*******************************************!*\\\n  !*** ./~/core-js/modules/_object-gopn.js ***!\n  \\*******************************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\t// 19.1.2.7 / 15.2.3.4 Object.getOwnPropertyNames(O)\n\tvar $keys      = __webpack_require__(/*! ./_object-keys-internal */ 32)\n\t  , hiddenKeys = __webpack_require__(/*! ./_enum-bug-keys */ 42).concat('length', 'prototype');\n\t\n\texports.f = Object.getOwnPropertyNames || function getOwnPropertyNames(O){\n\t  return $keys(O, hiddenKeys);\n\t};\n\n/***/ },\n/* 52 */\n/*!*******************************************!*\\\n  !*** ./~/core-js/modules/_object-gopd.js ***!\n  \\*******************************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar pIE            = __webpack_require__(/*! ./_object-pie */ 45)\n\t  , createDesc     = __webpack_require__(/*! ./_property-desc */ 18)\n\t  , toIObject      = __webpack_require__(/*! ./_to-iobject */ 33)\n\t  , toPrimitive    = __webpack_require__(/*! ./_to-primitive */ 17)\n\t  , has            = __webpack_require__(/*! ./_has */ 6)\n\t  , IE8_DOM_DEFINE = __webpack_require__(/*! ./_ie8-dom-define */ 15)\n\t  , gOPD           = Object.getOwnPropertyDescriptor;\n\t\n\texports.f = __webpack_require__(/*! ./_descriptors */ 7) ? gOPD : function getOwnPropertyDescriptor(O, P){\n\t  O = toIObject(O);\n\t  P = toPrimitive(P, true);\n\t  if(IE8_DOM_DEFINE)try {\n\t    return gOPD(O, P);\n\t  } catch(e){ /* empty */ }\n\t  if(has(O, P))return createDesc(!pIE.f.call(O, P), O[P]);\n\t};\n\n/***/ },\n/* 53 */\n/*!***************************************************!*\\\n  !*** ./~/core-js/modules/es6.object.to-string.js ***!\n  \\***************************************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t// 19.1.3.6 Object.prototype.toString()\n\tvar classof = __webpack_require__(/*! ./_classof */ 54)\n\t  , test    = {};\n\ttest[__webpack_require__(/*! ./_wks */ 26)('toStringTag')] = 'z';\n\tif(test + '' != '[object z]'){\n\t  __webpack_require__(/*! ./_redefine */ 19)(Object.prototype, 'toString', function toString(){\n\t    return '[object ' + classof(this) + ']';\n\t  }, true);\n\t}\n\n/***/ },\n/* 54 */\n/*!***************************************!*\\\n  !*** ./~/core-js/modules/_classof.js ***!\n  \\***************************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\t// getting tag from 19.1.3.6 Object.prototype.toString()\n\tvar cof = __webpack_require__(/*! ./_cof */ 35)\n\t  , TAG = __webpack_require__(/*! ./_wks */ 26)('toStringTag')\n\t  // ES3 wrong here\n\t  , ARG = cof(function(){ return arguments; }()) == 'Arguments';\n\t\n\t// fallback for IE11 Script Access Denied error\n\tvar tryGet = function(it, key){\n\t  try {\n\t    return it[key];\n\t  } catch(e){ /* empty */ }\n\t};\n\t\n\tmodule.exports = function(it){\n\t  var O, T, B;\n\t  return it === undefined ? 'Undefined' : it === null ? 'Null'\n\t    // @@toStringTag case\n\t    : typeof (T = tryGet(O = Object(it), TAG)) == 'string' ? T\n\t    // builtinTag case\n\t    : ARG ? cof(O)\n\t    // ES3 arguments fallback\n\t    : (B = cof(O)) == 'Object' && typeof O.callee == 'function' ? 'Arguments' : B;\n\t};\n\n/***/ },\n/* 55 */\n/*!********************!*\\\n  !*** ./src/uid.js ***!\n  \\********************/\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\texports.__esModule = true;\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\t/**\n\t * UIDGenerator for multi-instance Entity Component System\n\t * Generate numeric unique ids for ECS entities. The requirements are:\n\t *  * generate Numbers for fast comparaison, low storage and bandwidth usage\n\t *  * generators can be salted so you can use multiple generators with\n\t *  uniqueness guaranty\n\t *  * each salted generator can generate reasonable amount of unique ids\n\t */\n\t\n\t// maximum number of salted generators that can run concurently, once the\n\t// number of allowed generators has been reached the salt of the next\n\t// generator is silently reset to 0\n\tvar MAX_SALTS = 10000;\n\t\n\tvar MAX_ENTITY_PER_GENERATOR = Math.floor(Number.MAX_SAFE_INTEGER / MAX_SALTS) - 1;\n\tvar currentSalt = 0;\n\t\n\t/**\n\t * Generate unique sequences of Numbers. Can be salted (up to 9999 salts)\n\t * to generate differents ids.\n\t *\n\t * To work properly, ECS needs to associate an unique id with each entity. But\n\t * to preserve efficiency, the unique id must be a Number (more exactly a safe\n\t * integer).\n\t *\n\t * The basic implementation would be an incremented Number to generate a unique\n\t * sequence, but this fails when several ecs instances are running and creating\n\t * entities concurrently (e.g. in a multiplayer networked game). To work around\n\t * this problem, ecs provide UIDGenerator class which allow you to salt your\n\t * generated ids sequence. Two generators with different salts will NEVER\n\t * generate the same ids.\n\t *\n\t * Currently, there is a maxumum of 9999 salts and about 900719925473 uid per\n\t * salt. These limits are hard-coded, but I plan to expose these settings in\n\t * the future.\n\t *\n\t * @class\n\t */\n\t\n\tvar UIDGenerator = function () {\n\t  /**\n\t   *\n\t   * @param {number} [salt=0] The salt to use for this generator. Number\n\t   * between 0 and 9999 (inclusive).\n\t   */\n\t  function UIDGenerator() {\n\t    var salt = arguments.length <= 0 || arguments[0] === undefined ? 0 : arguments[0];\n\t\n\t    _classCallCheck(this, UIDGenerator);\n\t\n\t    /**\n\t     * The salt of this generator.\n\t     *\n\t     * @member {number}\n\t     */\n\t    this.salt = salt;\n\t\n\t    /**\n\t     * The counter used to generate unique sequence.\n\t     *\n\t     * @member {number}\n\t     */\n\t    this.uidCounter = 0;\n\t  }\n\t\n\t  /**\n\t   * Create a new unique id.\n\t   *\n\t   * @return {number} An unique id.\n\t   */\n\t\n\t\n\t  UIDGenerator.prototype.next = function next() {\n\t    var nextUid = this.salt + this.uidCounter * MAX_SALTS;\n\t\n\t    // if we exceed the number of maximum entities (which is\n\t    // very high) reset the counter.\n\t    if (++this.uidCounter >= MAX_ENTITY_PER_GENERATOR) {\n\t      this.uidCounter = 0;\n\t    }\n\t\n\t    return nextUid;\n\t  };\n\t\n\t  return UIDGenerator;\n\t}();\n\t\n\t/**\n\t * @namespace\n\t * @name ECS.uid\n\t */\n\t\n\t\n\tvar UID = {\n\t  /**\n\t   * A reference to UIDGenerator class.\n\t   *\n\t   * @property {class} UIDGenerator\n\t   */\n\t  UIDGenerator: UIDGenerator,\n\t\n\t  /**\n\t   * The default generator to use if an entity is created without id or generator instance.\n\t   *\n\t   * @property {UIDGenerator} DefaultUIDGenerator\n\t   */\n\t  DefaultUIDGenerator: new UIDGenerator(currentSalt++),\n\t\n\t  /**\n\t   * Return true if the entity id was salted by given salt\n\t   *\n\t   * @param {string} entityId Entity id to test\n\t   * @param {string} salt     Salt to test\n\t   * @return {boolean}         true if the id was generated by the salt, false\n\t   * otherwise\n\t   */\n\t  isSaltedBy: function isSaltedBy(entityId, salt) {\n\t    return entityId % MAX_SALTS === salt;\n\t  },\n\t\n\t  /**\n\t   * Return the next unique salt.\n\t   *\n\t   * @method  nextSalt\n\t   * @return {number} A unique salt.\n\t   */\n\t  nextSalt: function nextSalt() {\n\t    var salt = currentSalt;\n\t\n\t    // if we exceed the number of maximum salts, silently reset\n\t    // to 1 (since 0 will always be the default generator)\n\t    if (++currentSalt > MAX_SALTS - 1) {\n\t      currentSalt = 1;\n\t    }\n\t\n\t    return salt;\n\t  },\n\t\n\t  /**\n\t   * Create a new generator with unique salt.\n\t   *\n\t   * @method  nextGenerator\n\t   * @return {UIDGenerator} The created UIDGenerator.\n\t   */\n\t  nextGenerator: function nextGenerator() {\n\t    return new UIDGenerator(UID.nextSalt());\n\t  }\n\t};\n\t\n\texports.default = UID;\n\n/***/ },\n/* 56 */\n/*!**********************!*\\\n  !*** ./src/utils.js ***!\n  \\**********************/\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\texports.__esModule = true;\n\texports.fastBind = fastBind;\n\texports.fastSplice = fastSplice;\n\t/**\n\t * A faster version of bind.\n\t *\n\t * @param {*} thisArg - The context to call the function with.\n\t * @param {function} methodFunc - The function to bind.\n\t * @return {function} A bound version of the function.\n\t */\n\tfunction fastBind(thisArg, methodFunc) {\n\t    return function _boundFunction() {\n\t        methodFunc.apply(thisArg, arguments); // eslint-disable-line prefer-rest-params\n\t    };\n\t}\n\t\n\t/**\n\t * A faster version of splice.\n\t *\n\t * @param {*[]} array - The array to remove from\n\t * @param {number} startIndex - Index to start removal\n\t * @param {number} removeCount - The number of elements to remove.\n\t */\n\tfunction fastSplice(array, startIndex, removeCount) {\n\t    var len = array.length;\n\t\n\t    if (startIndex >= len || removeCount === 0) {\n\t        return;\n\t    }\n\t\n\t    removeCount = startIndex + removeCount > len ? len - startIndex : removeCount;\n\t\n\t    var removeLen = len - removeCount;\n\t\n\t    for (var i = startIndex; i < len; i += 1) {\n\t        array[i] = array[i + removeCount];\n\t    }\n\t\n\t    array.length = removeLen;\n\t}\n\n/***/ },\n/* 57 */\n/*!***********************!*\\\n  !*** ./src/system.js ***!\n  \\***********************/\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\texports.__esModule = true;\n\t\n\tvar _utils = __webpack_require__(/*! ./utils */ 56);\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\t/**\n\t * A system update all eligible entities at a given frequency.\n\t * This class is not meant to be used directly and should be sub-classed to\n\t * define specific logic.\n\t *\n\t * @class\n\t * @alias ECS.System\n\t */\n\tvar System = function () {\n\t  /**\n\t   *\n\t   * @param {number} frequency Frequency of execution.\n\t   */\n\t  function System() {\n\t    var frequency = arguments.length <= 0 || arguments[0] === undefined ? 1 : arguments[0];\n\t\n\t    _classCallCheck(this, System);\n\t\n\t    /**\n\t     * Frequency of update execution, a frequency of `1` run the system every\n\t     * update, `2` will run the system every 2 updates, ect.\n\t     *\n\t     * @member {number}\n\t     */\n\t    this.frequency = frequency;\n\t\n\t    /**\n\t     * Entities of the system.\n\t     *\n\t     * @member {Entity[]}\n\t     */\n\t    this.entities = [];\n\t  }\n\t\n\t  /**\n\t   * Add an entity to the system entities.\n\t   *\n\t   * @param {Entity} entity - The entity to add to the system.\n\t   */\n\t\n\t\n\t  System.prototype.addEntity = function addEntity(entity) {\n\t    entity._addSystem(this);\n\t    this.entities.push(entity);\n\t\n\t    this.enter(entity);\n\t  };\n\t\n\t  /**\n\t   * Remove an entity from the system entities. exit() handler is executed\n\t   * only if the entity actually exists in the system entities.\n\t   *\n\t   * @param {Entity} entity - Reference of the entity to remove.\n\t   */\n\t\n\t\n\t  System.prototype.removeEntity = function removeEntity(entity) {\n\t    var index = this.entities.indexOf(entity);\n\t\n\t    if (index !== -1) {\n\t      entity._removeSystem(this);\n\t      (0, _utils.fastSplice)(this.entities, index, 1);\n\t\n\t      this.exit(entity);\n\t    }\n\t  };\n\t\n\t  /**\n\t   * Initialize the system. This is called when the system is added\n\t   * to the ECS manager.\n\t   *\n\t   */\n\t\n\t\n\t  System.prototype.initialize = function initialize() {}; // eslint-disable-line no-empty-function\n\t\n\t  /**\n\t   * Dispose the system by exiting all the entities. This is called\n\t   * when the system is removed from the ECS manager.\n\t   *\n\t   */\n\t\n\t\n\t  System.prototype.dispose = function dispose() {\n\t    for (var i = 0; i < this.entities.length; ++i) {\n\t      this.entities[i]._removeSystem(this);\n\t      this.exit(this.entities[i]);\n\t    }\n\t  };\n\t\n\t  /**\n\t   * Abstract method to subclass. Should return true if the entity is eligible\n\t   * to the system, false otherwise.\n\t   *\n\t   * @param {Entity} entity - The entity to test.\n\t   * @return {boolean} True if entity should be included.\n\t   */\n\t\n\t\n\t  System.prototype.test = function test(entity) {\n\t    // eslint-disable-line no-unused-vars\n\t    return false;\n\t  };\n\t\n\t  /**\n\t   * Abstract method to subclass. Called when an entity is added to the system.\n\t   *\n\t   * @param {Entity} entity - The added entity.\n\t   */\n\t\n\t\n\t  System.prototype.enter = function enter(entity) {}; // eslint-disable-line no-empty-function,no-unused-vars\n\t\n\t  /**\n\t   * Abstract method to subclass. Called when an entity is removed from the system.\n\t   *\n\t   * @param {Entity} entity - The removed entity.\n\t   */\n\t\n\t\n\t  System.prototype.exit = function exit(entity) {}; // eslint-disable-line no-empty-function,no-unused-vars\n\t\n\t  /**\n\t   * Abstract method to subclass. Called for each entity to update. This is\n\t   * the only method that should actual mutate entity state.\n\t   *\n\t   * @param {Entity} entity - The entity to update.\n\t   * @param {number} elapsed - The time elapsed since last update call.\n\t   */\n\t\n\t\n\t  System.prototype.update = function update(entity, elapsed) {}; // eslint-disable-line no-empty-function,no-unused-vars\n\t\n\t\n\t  return System;\n\t}();\n\t\n\texports.default = System;\n\n/***/ },\n/* 58 */\n/*!****************************!*\\\n  !*** ./src/performance.js ***!\n  \\****************************/\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\texports.__esModule = true;\n\tvar perf = typeof window !== 'undefined' ? window.performance : null;\n\t\n\t// polyfill for browser performance module\n\tif (!perf) {\n\t    (function () {\n\t        var start = Date.now();\n\t\n\t        perf = {\n\t            now: function now() {\n\t                return Date.now() - start;\n\t            }\n\t        };\n\t    })();\n\t}\n\t\n\texports.default = perf;\n\n/***/ }\n/******/ ])\n});\n;\n//# sourceMappingURL=ecs.js.map\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/@fae/ecs/dist/ecs.js\n ** module id = 6\n ** module chunks = 0\n **/","import Signal from 'mini-signals';\r\nimport ECS from '@fae/ecs';\r\nimport GLContext from '../gl/GLContext';\r\nimport GLProgramCache from '../gl/GLProgramCache';\r\nimport RenderTarget from './RenderTarget';\r\nimport RenderState from './RenderState';\r\nimport ObjectRenderer from './ObjectRenderer';\r\nimport { uid, removeElements } from '../util';\r\n\r\nconst defaultSystems = [];\r\n\r\n/**\r\n * The Renderer is just a container for the WebGLRenderingContext, the render state,\r\n * and the current object renderer that is doing the rendering.\r\n *\r\n * @class\r\n * @memberof render\r\n */\r\nexport default class Renderer extends ECS\r\n{\r\n    /**\r\n     * Creates a new renderer.\r\n     *\r\n     * @param {HTMLCanvasElement|WebGLRenderingContext} context - The canvas to create a context from,\r\n     *  or the context to use to draw.\r\n     * @param {object} options - Options for the renderer.\r\n     * @param {boolean} options.clearBeforeRender=true - Should we clear before each render?\r\n     * @param {boolean} options.preserveDrawingBuffer=false - Enables drawing buffer preservation,\r\n     *  enable this if you need to call toDataUrl on the webgl context.\r\n     */\r\n    constructor(context, options = {})\r\n    {\r\n        super();\r\n\r\n        /**\r\n         * The main rendering context used for drawing.\r\n         *\r\n         * @member {WebGLRenderingContext}\r\n         */\r\n        this.gl = (context.nodeName ? GLContext.create(context) : context);\r\n\r\n        /**\r\n         * A unique ID for this renderer, useful for keying maps by renderer\r\n         *\r\n         * @member {number}\r\n         */\r\n        this.uid = uid();\r\n\r\n        /**\r\n         * Should we clear before each frame?\r\n         *\r\n         * @member {boolean}\r\n         */\r\n        this.clearBeforeRender = typeof options.clearBeforeRender !== 'undefined' ? options.clearBeforeRender : true;\r\n\r\n        /**\r\n         * Should we preserve the drawing buffer each frame?\r\n         *\r\n         * @member {boolean}\r\n         */\r\n        this.preserveDrawingBuffer = options.preserveDrawingBuffer || false;\r\n\r\n        /**\r\n         * Dispatched when context has been lost.\r\n         *\r\n         * @member {Signal}\r\n         */\r\n        this.onContextLost = new Signal();\r\n\r\n        /**\r\n         * Dispatched when context has been restored, but before the renderer\r\n         * has initialized for the new context.\r\n         *\r\n         * If you are wanting to know when you should reinitialize your stuff\r\n         * after a restore use {@link Renderer#onContextChange}.\r\n         *\r\n         * @member {Signal}\r\n         */\r\n        this.onContextRestored = new Signal();\r\n\r\n        /**\r\n         * Dispatched when context has changed. This happens when the renderer\r\n         * initializes and then again if the context is restored, after we initialize\r\n         * the context again.\r\n         *\r\n         * @member {Signal}\r\n         */\r\n        this.onContextChange = new Signal();\r\n\r\n        /**\r\n         * Dispatched each frame before rendering the object.\r\n         *\r\n         * @member {Signal}\r\n         */\r\n        this.onBeforeRender = new Signal();\r\n\r\n        /**\r\n         * Dispatched each frame after rendering the object.\r\n         *\r\n         * @member {Signal}\r\n         */\r\n        this.onAfterRender = new Signal();\r\n\r\n        /**\r\n         * An empty renderer.\r\n         *\r\n         * @member {ObjectRenderer}\r\n         */\r\n        this.emptyRenderer = new ObjectRenderer(this);\r\n\r\n        /**\r\n         * The currently active object renderer.\r\n         *\r\n         * @member {ObjectRenderer}\r\n         */\r\n        this.activeObjectRenderer = this.emptyRenderer;\r\n\r\n        /**\r\n         * The current state of the renderer.\r\n         *\r\n         * @member {WebGLState}\r\n         */\r\n        this.state = new RenderState(this);\r\n\r\n        /**\r\n         * The root render target, that represents the screen.\r\n         *\r\n         * @member {RenderTarget}\r\n         */\r\n        this.screen = null;\r\n\r\n        this._boundOnContextLost = this._onContextLost.bind(this);\r\n        this._boundOnContextRestored = this._onContextRestored.bind(this);\r\n\r\n        this.gl.canvas.addEventListener('webglcontextlost', this._boundOnContextLost, false);\r\n        this.gl.canvas.addEventListener('webglcontextrestored', this._boundOnContextRestored, false);\r\n\r\n        // initialize for a new context\r\n        this._initContext();\r\n\r\n        // create and add the default systems\r\n        for (let i = 0; i < defaultSystems.length; ++i)\r\n        {\r\n            const system = new defaultSystems[i](this);\r\n\r\n            this.addSystem(system);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Adds a system that will be created automatically when a renderer instance is created.\r\n     *\r\n     * Note: Calling this function registers a system to be automatically added in renderers\r\n     * that you create *after* calling this. If you call this after creating a renderer, the\r\n     * already created renderer will *not* contain this system automatically.\r\n     *\r\n     * @param {System} System - The system class to add (**not** an instance, but the class\r\n     * itself)\r\n     */\r\n    static addDefaultSystem(System)\r\n    {\r\n        defaultSystems.push(System);\r\n    }\r\n\r\n    /**\r\n     * Removes a system so that it will no longer be created automatically when a renderer\r\n     * instance is created.\r\n     *\r\n     * Note: Calling this function unregisters a system to be automatically added in renderers\r\n     * that you create *after* calling this. If you call this after creating a renderer, the\r\n     * already created renderer may contain this system automatically.\r\n     *\r\n     * @param {System} System - The system class to add (**not** an instance, but the class\r\n     * itself)\r\n     */\r\n    static removeDefaultSystem(System)\r\n    {\r\n        const idx = defaultSystems.indexOf(System);\r\n\r\n        if (idx !== -1)\r\n        {\r\n            removeElements(defaultSystems, idx, 1);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Add a system to the renderer.\r\n     *\r\n     * @param {System} system - The system to add.\r\n     * @param {boolean} skipSort - If true, will not sort the systems automatically.\r\n     *  Setting this to true requires you call {@link Renderer#sortSystems} manually. This\r\n     *  can be useful if you are adding a large batch of systems in a single frame and want\r\n     *  to delay the sorting until after they are all added.\r\n     */\r\n    addSystem(system, skipSort = false)\r\n    {\r\n        super.addSystem(system);\r\n\r\n        if (!skipSort) this.sortSystems();\r\n    }\r\n\r\n    /**\r\n     * Add an entity to the renderer.\r\n     *\r\n     * Note: Since adding an entity causes the entity list to be sorted (to ensure renderPriority\r\n     * and grouping is correct), this method can be expensive when you have a large list. As such\r\n     * it is recommended not to Add/Remove entities many times per frame.\r\n     *\r\n     * @param {Entity} entity - The entity to add.\r\n     * @param {boolean} skipSort - If true, will not sort the entities automatically.\r\n     *  Setting this to true requires you call {@link Renderer#sortEntities} manually. This\r\n     *  can be useful if you are adding a large batch of entities in a single frame and want\r\n     *  to delay the sorting until after they are all added.\r\n     */\r\n    addEntity(entity, skipSort)\r\n    {\r\n        super.addEntity(entity);\r\n\r\n        if (!skipSort) this.sortEntities();\r\n    }\r\n\r\n    /**\r\n     * Sorts the systems by priority. If you change a system's priority after adding\r\n     * it to the renderer then you will need to call this for it to be properly sorted.\r\n     *\r\n     */\r\n    sortSystems()\r\n    {\r\n        this.systems.sort(compareSystemsPriority);\r\n    }\r\n\r\n    /**\r\n     * Sorts the entities by render priority and their group hint. If you change an\r\n     * entity's priority after adding it to the renderer then you will need to call\r\n     * this for it to take effect.\r\n     *\r\n     */\r\n    sortEntities()\r\n    {\r\n        this.entities.sort(compareRenderPriority);\r\n    }\r\n\r\n    /**\r\n     * Renders a drawable object to the render target.\r\n     *\r\n     * @param {RenderTarget} target - The target to render to, defaults to the screen.\r\n     * @param {boolean} clear - Should we clear the screen before rendering?\r\n     * @param {Matrix2d} transform - An optional matrix transform to apply for this render.\r\n     */\r\n    render(target = this.screen, clear = this.clearBeforeRender, transform = null)\r\n    {\r\n        // if no context, or context is lost, just bail.\r\n        if (!this.gl || this.gl.isContextLost()) return;\r\n\r\n        // tell everyone we are updating\r\n        this.onBeforeRender.dispatch();\r\n\r\n        // set the target\r\n        target.transform = transform;\r\n        this.state.setRenderTarget(target);\r\n\r\n        // start the active object renderer\r\n        this.activeObjectRenderer.start();\r\n\r\n        // clear if we should\r\n        if (clear) this.state.target.clear();\r\n\r\n        // process all the entites and their systems\r\n        this.update();\r\n\r\n        // stop the active object renderer\r\n        this.activeObjectRenderer.stop();\r\n\r\n        // tell everyone we updated\r\n        this.onAfterRender.dispatch();\r\n    }\r\n\r\n    /**\r\n     * Sets the passed ObjectRenderer instance as the active object renderer.\r\n     *\r\n     * @param {ObjectRenderer} objectRenderer - The object renderer to use.\r\n     */\r\n    setActiveObjectRenderer(objectRenderer)\r\n    {\r\n        if (this.activeObjectRenderer !== objectRenderer)\r\n        {\r\n            this.activeObjectRenderer.stop();\r\n            this.activeObjectRenderer = objectRenderer;\r\n            this.activeObjectRenderer.start();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Destroys this renderer and the related objects.\r\n     *\r\n     */\r\n    destroy()\r\n    {\r\n        // unbind canvas events\r\n        this.gl.canvas.removeEventListener('webglcontextlost', this._boundOnContextLost, false);\r\n        this.gl.canvas.removeEventListener('webglcontextrestored', this._boundOnContextRestored, false);\r\n\r\n        this._boundOnContextLost = null;\r\n        this._boundOnContextRestored = null;\r\n\r\n        // destroy state\r\n        this.state.destroy();\r\n\r\n        // detach and lose signals\r\n        this.onContextLost.detachAll();\r\n        this.onContextLost = null;\r\n\r\n        this.onContextRestored.detachAll();\r\n        this.onContextRestored = null;\r\n\r\n        this.onContextChange.detachAll();\r\n        this.onContextChange = null;\r\n\r\n        this.onBeforeRender.detachAll();\r\n        this.onBeforeRender = null;\r\n\r\n        this.onAfterRender.detachAll();\r\n        this.onAfterRender = null;\r\n\r\n        this.activeObjectRenderer = null;\r\n\r\n        // finally lose context\r\n        if (this.gl.getExtension('WEBGL_lose_context'))\r\n        {\r\n            this.gl.getExtension('WEBGL_lose_context').loseContext();\r\n        }\r\n\r\n        this.gl = null;\r\n    }\r\n\r\n    /**\r\n     * Initializes the WebGL context.\r\n     *\r\n     * @private\r\n     */\r\n    _initContext()\r\n    {\r\n        const gl = this.gl;\r\n\r\n        this.state.reset();\r\n\r\n        if (this.screen)\r\n        {\r\n            this.screen.destroy();\r\n        }\r\n\r\n        this.screen = new RenderTarget(gl, gl.canvas.width, gl.canvas.height, RenderTarget.defaultScaleMode, true);\r\n\r\n        this.state.setRenderTarget(this.screen);\r\n\r\n        // this.resize(gl.canvas.width, gl.canvas.height);\r\n\r\n        this.onContextChange.dispatch(this);\r\n    }\r\n\r\n    /**\r\n     * Called when the underlying context is lost.\r\n     *\r\n     * @private\r\n     * @param {WebGLContextEvent} event - The DOM event about the context being lost.\r\n     */\r\n    _onContextLost(event)\r\n    {\r\n        event.preventDefault();\r\n        this.onContextLost.dispatch(this);\r\n    }\r\n\r\n    /**\r\n     * Called when the underlying context is restored.\r\n     *\r\n     * @private\r\n     */\r\n    _onContextRestored()\r\n    {\r\n        GLProgramCache.clear();\r\n        this._initContext();\r\n        this.onContextRestored.dispatch(this);\r\n    }\r\n}\r\n\r\n// lower is placed first\r\nfunction compareSystemsPriority(a, b)\r\n{\r\n    return a.priority - b.priority;\r\n}\r\n\r\n// lower is placed first, and within renderPriority they are grouped\r\n// by the renderGroupHint\r\nfunction compareRenderPriority(a, b)\r\n{\r\n    if (a.renderPriority === b.renderPriority)\r\n    {\r\n        return a.renderGroupHint === b.renderGroupHint ? 0 : 1;\r\n    }\r\n\r\n    return a.renderPriority - b.renderPriority;\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/core/src/render/Renderer.js\n **/","'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nvar MiniSignalBinding = (function () {\n  function MiniSignalBinding(fn, once, thisArg) {\n    if (once === undefined) once = false;\n\n    _classCallCheck(this, MiniSignalBinding);\n\n    this._fn = fn;\n    this._once = once;\n    this._thisArg = thisArg;\n    this._next = this._prev = this._owner = null;\n  }\n\n  _createClass(MiniSignalBinding, [{\n    key: 'detach',\n    value: function detach() {\n      if (this._owner === null) return false;\n      this._owner.detach(this);\n      return true;\n    }\n  }]);\n\n  return MiniSignalBinding;\n})();\n\nfunction _addMiniSignalBinding(self, node) {\n  if (!self._head) {\n    self._head = node;\n    self._tail = node;\n  } else {\n    self._tail._next = node;\n    node._prev = self._tail;\n    self._tail = node;\n  }\n\n  node._owner = self;\n\n  return node;\n}\n\nvar MiniSignal = (function () {\n  function MiniSignal() {\n    _classCallCheck(this, MiniSignal);\n\n    this._head = this._tail = undefined;\n  }\n\n  _createClass(MiniSignal, [{\n    key: 'handlers',\n    value: function handlers() {\n      var exists = arguments.length <= 0 || arguments[0] === undefined ? false : arguments[0];\n\n      var node = this._head;\n\n      if (exists) return !!node;\n\n      var ee = [];\n\n      while (node) {\n        ee.push(node);\n        node = node._next;\n      }\n\n      return ee;\n    }\n  }, {\n    key: 'has',\n    value: function has(node) {\n      if (!(node instanceof MiniSignalBinding)) {\n        throw new Error('MiniSignal#has(): First arg must be a MiniSignalBinding object.');\n      }\n\n      return node._owner === this;\n    }\n  }, {\n    key: 'dispatch',\n    value: function dispatch() {\n      var node = this._head;\n\n      if (!node) return false;\n\n      while (node) {\n        if (node._once) this.detach(node);\n        node._fn.apply(node._thisArg, arguments);\n        node = node._next;\n      }\n\n      return true;\n    }\n  }, {\n    key: 'add',\n    value: function add(fn) {\n      var thisArg = arguments.length <= 1 || arguments[1] === undefined ? null : arguments[1];\n\n      if (typeof fn !== 'function') {\n        throw new Error('MiniSignal#add(): First arg must be a Function.');\n      }\n      return _addMiniSignalBinding(this, new MiniSignalBinding(fn, false, thisArg));\n    }\n  }, {\n    key: 'once',\n    value: function once(fn) {\n      var thisArg = arguments.length <= 1 || arguments[1] === undefined ? null : arguments[1];\n\n      if (typeof fn !== 'function') {\n        throw new Error('MiniSignal#once(): First arg must be a Function.');\n      }\n      return _addMiniSignalBinding(this, new MiniSignalBinding(fn, true, thisArg));\n    }\n  }, {\n    key: 'detach',\n    value: function detach(node) {\n      if (!(node instanceof MiniSignalBinding)) {\n        throw new Error('MiniSignal#detach(): First arg must be a MiniSignalBinding object.');\n      }\n      if (node._owner !== this) return this;\n\n      if (node._prev) node._prev._next = node._next;\n      if (node._next) node._next._prev = node._prev;\n\n      if (node === this._head) {\n        this._head = node._next;\n        if (node._next === null) {\n          this._tail = null;\n        }\n      } else if (node === this._tail) {\n        this._tail = node._prev;\n        this._tail._next = null;\n      }\n\n      node._owner = null;\n      return this;\n    }\n  }, {\n    key: 'detachAll',\n    value: function detachAll() {\n      var node = this._head;\n      if (!node) return this;\n\n      this._head = this._tail = null;\n\n      while (node) {\n        node._owner = null;\n        node = node._next;\n      }\n      return this;\n    }\n  }]);\n\n  return MiniSignal;\n})();\n\nMiniSignal.MiniSignalBinding = MiniSignalBinding;\n\nexports['default'] = MiniSignal;\nmodule.exports = exports['default'];\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/mini-signals/lib/mini-signals.js\n ** module id = 8\n ** module chunks = 0\n **/","/**\r\n * @namespace GLContext\r\n * @memberof glutil\r\n */\r\nexport default {\r\n    /**\r\n     * Helper function to create a webGL Context.\r\n     *\r\n     * @memberof glutil.GLContext\r\n     * @param {HTMLCanvasElement} canvas - The canvas element that we will get the context from.\r\n     * @param {object} options - An options object that gets passed in to the canvas element containing\r\n     *  the context attributes, see https://developer.mozilla.org/en/docs/Web/API/HTMLCanvasElement/getContext\r\n     *  for the options available\r\n     * @return {WebGLRenderingContext} the WebGL context\r\n     */\r\n    create(canvas, options)\r\n    {\r\n        const gl = canvas.getContext('webgl2', options)\r\n            || canvas.getContext('experimental-webgl2', options)\r\n            || canvas.getContext('webgl', options)\r\n            || canvas.getContext('experimental-webgl', options);\r\n\r\n        if (!gl)\r\n        {\r\n            // fail, not able to get a context\r\n            throw new Error('This browser does not support WebGL.');\r\n        }\r\n\r\n        return gl;\r\n    },\r\n};\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/core/src/gl/GLContext.js\n **/","let PROGRAM_CACHE = {};\r\n\r\n/**\r\n * @namespace GLProgramCache\r\n * @memberof glutil\r\n */\r\nexport default {\r\n    /**\r\n     * Gets a program from the cache.\r\n     *\r\n     * @memberof glutil.GLProgramCache\r\n     * @param {string} key - The key of the program to get.\r\n     * @return {WebGLProgram} The cached program, or undefined if none found.\r\n     */\r\n    get(key)\r\n    {\r\n        return PROGRAM_CACHE[key];\r\n    },\r\n\r\n    /**\r\n     * Sets a program in the cache.\r\n     *\r\n     * @memberof glutil.GLProgramCache\r\n     * @param {string} key - The key of the program to get.\r\n     * @param {WebGLProgram} program - The program to put into the cache.\r\n     */\r\n    set(key, program)\r\n    {\r\n        PROGRAM_CACHE[key] = program;\r\n    },\r\n\r\n    /**\r\n     * Generates a cache key for a vertex/fragment source pair.\r\n     *\r\n     * @memberof glutil.GLProgramCache\r\n     * @param {string} vsrc - The vertex source of the program that will be stored.\r\n     * @param {string} fsrc - The fragment source of the program that will be stored.\r\n     * @return {string} The cache key.\r\n     */\r\n    key(vsrc, fsrc)\r\n    {\r\n        return vsrc + fsrc;\r\n    },\r\n\r\n    /**\r\n     * Clears the GLProgramCache storage.\r\n     *\r\n     * @memberof glutil.GLProgramCache\r\n     */\r\n    clear()\r\n    {\r\n        PROGRAM_CACHE = {};\r\n    },\r\n};\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/core/src/gl/GLProgramCache.js\n **/","// TODO: Remove Rectangle from this code...\r\n\r\nimport GLFramebuffer from '../gl/GLFramebuffer';\r\nimport Vector2d from '../math/Vector2d';\r\nimport Matrix2d from '../math/Matrix2d';\r\nimport { Rectangle } from '@fae/shapes';\r\nimport Color from '../util/Color';\r\n\r\n/**\r\n * A RenderTarget is a wrapper around framebuffer to be rendered to.\r\n *\r\n * @class\r\n * @memberof render\r\n */\r\nexport default class RenderTarget\r\n{\r\n    /**\r\n     * Creates a new render target.\r\n     *\r\n     * @param {WebGLContext} gl - The WebGL context to draw with.\r\n     * @param {number} width - The width of the target.\r\n     * @param {number} height - The height of the target.\r\n     * @param {number} scaleMode - The mode to scale by.\r\n     * @param {boolean} root - Whether this is the root render target or not.\r\n     */\r\n    constructor(gl, width, height, scaleMode = RenderTarget.defaultScaleMode, root = false)\r\n    {\r\n        this.gl = gl;\r\n        this.root = root;\r\n\r\n        this.framebuffer = null;\r\n\r\n        this.clearColor = Color.BLACK.clone();\r\n\r\n        this.size = new Vector2d();\r\n\r\n        this.projectionMatrix = new Matrix2d();\r\n\r\n        this.transform = null;\r\n\r\n        this.scaleMode = scaleMode;\r\n\r\n        this.defaultFrame = new Rectangle();\r\n        this.destinationFrame = null;\r\n        this.sourceFrame = null;\r\n\r\n        if (!root)\r\n        {\r\n            this.framebuffer = GLFramebuffer.createRGBA(gl, 100, 100);\r\n\r\n            if (this.scaleMode === WebGLRenderingContext.NEAREST)\r\n            {\r\n                this.framebuffer.texture.enableNearestScaling();\r\n            }\r\n            else\r\n            {\r\n                this.framebuffer.texture.enableLinearScaling();\r\n            }\r\n        }\r\n        else\r\n        {\r\n            this.framebuffer = new GLFramebuffer(gl, 100, 100);\r\n            this.framebuffer.framebuffer = null;\r\n        }\r\n\r\n        this.setFrame();\r\n        this.resize(width, height);\r\n    }\r\n\r\n    /**\r\n     * The underlying framebuffer's texture.\r\n     *\r\n     * @readonly\r\n     * @member {GLTexture}\r\n     */\r\n    get texture()\r\n    {\r\n        return this.framebuffer.texture;\r\n    }\r\n\r\n    /**\r\n     * The width of this render target. Proxy for `.size.x`.\r\n     *\r\n     * To set this, call `.resize(width, height)`\r\n     *\r\n     * @member {number}\r\n     */\r\n    get width()\r\n    {\r\n        return this.size.x;\r\n    }\r\n\r\n    /**\r\n     * The width of this render target. Proxy for `.size.x`.\r\n     *\r\n     * To set this, call `.resize(width, height)`\r\n     *\r\n     * @member {number}\r\n     */\r\n    get height()\r\n    {\r\n        return this.size.y;\r\n    }\r\n\r\n    /**\r\n     * Clears the target with a single color. Usually called each from to clear the buffer.\r\n     * If you pass an array it must be in the format: `[red, green, blue, alpha]`.\r\n     *\r\n     * @param {Color|number[]|Float32Array} color - The color to clear with.\r\n     * @return {RenderTarget} Returns itself.\r\n     */\r\n    clear(color = this.clearColor)\r\n    {\r\n        this.framebuffer.clear(color.r, color.g, color.b, color.a);\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Sets the frame of the render target.\r\n     *\r\n     * @param {Rectangle} destinationFrame - The destination frame.\r\n     * @param {Rectangle} sourceFrame - The source frame.\r\n     * @return {RenderTarget} Returns itself.\r\n     */\r\n    setFrame(destinationFrame = null, sourceFrame = null)\r\n    {\r\n        this.destinationFrame = destinationFrame || this.destinationFrame || this.defaultFrame;\r\n        this.sourceFrame = sourceFrame || this.sourceFrame || destinationFrame;\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Binds the buffers and initialises the viewport.\r\n     *\r\n     * @return {RenderTarget} Returns itself.\r\n     */\r\n    activate()\r\n    {\r\n        const gl = this.gl;\r\n\r\n        this.framebuffer.bind();\r\n\r\n        this.calculateProjection(this.destinationFrame, this.sourceFrame);\r\n\r\n        if (this.transform)\r\n        {\r\n            this.projectionMatrix.multiply(this.transform);\r\n        }\r\n\r\n        if (this.destinationFrame.equals(this.sourceFrame))\r\n        {\r\n            gl.enable(gl.SCISSOR_TEST);\r\n            gl.scissor(\r\n                this.destinationFrame.x | 0,\r\n                this.destinationFrame.y | 0,\r\n                (this.destinationFrame.width/* * this.resolution*/) | 0,\r\n                (this.destinationFrame.height/* * this.resolution*/) | 0\r\n            );\r\n        }\r\n        else\r\n        {\r\n            gl.disable(gl.SCISSOR_TEST);\r\n        }\r\n\r\n        // set viewport to this target\r\n        gl.viewport(\r\n            this.destinationFrame.x | 0,\r\n            this.destinationFrame.y | 0,\r\n            (this.destinationFrame.width/* * this.resolution*/) | 0,\r\n            (this.destinationFrame.height/* * this.resolution*/) | 0\r\n        );\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Updates the projection matrix based on the projection frame.\r\n     *\r\n     * @param {Rectangle} destinationFrame - The destination frame.\r\n     * @param {Rectangle} sourceFrame - The source frame.\r\n     * @return {RenderTarget} Returns itself.\r\n     */\r\n    calculateProjection(destinationFrame, sourceFrame = null)\r\n    {\r\n        const pm = this.projectionMatrix;\r\n\r\n        sourceFrame = sourceFrame || destinationFrame;\r\n\r\n        pm.identity();\r\n\r\n        if (!this.root)\r\n        {\r\n            pm.a = 1 / destinationFrame.width * 2;\r\n            pm.d = 1 / destinationFrame.height * 2;\r\n\r\n            pm.tx = -1 - (sourceFrame.x * pm.a);\r\n            pm.ty = -1 - (sourceFrame.y * pm.d);\r\n        }\r\n        else\r\n        {\r\n            pm.a = 1 / destinationFrame.width * 2;\r\n            pm.d = -1 / destinationFrame.height * 2;\r\n\r\n            pm.tx = -1 - (sourceFrame.x * pm.a);\r\n            pm.ty = 1 - (sourceFrame.y * pm.d);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Resizes the texture to the specified width and height.\r\n     *\r\n     * @param {number} width - the new width of the texture.\r\n     * @param {number} height - the new height of the texture.\r\n     * @return {RenderTarget} Returns itself.\r\n     */\r\n    resize(width, height)\r\n    {\r\n        width = Math.floor(width);\r\n        height = Math.floor(height);\r\n\r\n        if (this.size.x === width && this.size.y === height)\r\n        {\r\n            return this;\r\n        }\r\n\r\n        this.size.x = width;\r\n        this.size.y = height;\r\n\r\n        this.defaultFrame.width = width;\r\n        this.defaultFrame.height = height;\r\n\r\n        this.framebuffer.resize(width/* * this.resolution*/, height/* * this.resolution*/);\r\n\r\n        const projectionFrame = this.size;\r\n\r\n        this.calculateProjection(projectionFrame);\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Destroys the render target.\r\n     *\r\n     */\r\n    destroy()\r\n    {\r\n        this.framebuffer.destroy();\r\n\r\n        this.gl = null;\r\n        this.framebuffer = null;\r\n        this.clearColor = null;\r\n        this.size = null;\r\n        this.projectionMatrix = null;\r\n        this.transform = null;\r\n        this.defaultFrame = null;\r\n        this.destinationFrame = null;\r\n        this.sourceFrame = null;\r\n    }\r\n}\r\n\r\n/**\r\n * The default scale mode for a render target.\r\n *\r\n * @static\r\n * @constant\r\n * @memberof RenderTarget\r\n * @type {number}\r\n * @default WebGLRenderingContext.LINEAR\r\n */\r\nRenderTarget.defaultScaleMode = WebGLRenderingContext.LINEAR;\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/core/src/render/RenderTarget.js\n **/","import GLTexture from './GLTexture';\r\n\r\n/**\r\n * Helper class to create a WebGL framebuffer.\r\n *\r\n * Generally you do not want to create this class directly, but instead\r\n * use the static {@link GLFramebuffer#createRGBA} and {@link GLFramebuffer#createFloat32}\r\n *\r\n * @class\r\n * @memberof glutil\r\n */\r\nexport default class GLFramebuffer\r\n{\r\n    /**\r\n     * @param {WebGLRenderingContext} gl - The current WebGL rendering context\r\n     * @param {number} width - the width of the drawing area of the frame buffer\r\n     * @param {number} height - the height of the drawing area of the frame buffer\r\n     */\r\n    constructor(gl, width = 100, height = 100)\r\n    {\r\n        /**\r\n         * The current WebGL rendering context.\r\n         *\r\n         * @member {WebGLRenderingContext}\r\n         */\r\n        this.gl = gl;\r\n\r\n        /**\r\n         * The frame buffer.\r\n         *\r\n         * @member {WebGLFramebuffer}\r\n         */\r\n        this.framebuffer = gl.createFramebuffer();\r\n\r\n        /**\r\n         * The stencil buffer.\r\n         *\r\n         * @member {WebGLRenderbuffer}\r\n         */\r\n        this.stencil = null;\r\n\r\n        /**\r\n         * The stencil buffer.\r\n         *\r\n         * @member {GLTexture}\r\n         */\r\n        this.texture = null;\r\n\r\n        /**\r\n         * The width of the drawing area of the buffer.\r\n         *\r\n         * @member {number}\r\n         */\r\n        this.width = width;\r\n\r\n        /**\r\n         * The height of the drawing area of the buffer.\r\n         *\r\n         * @member {number}\r\n         */\r\n        this.height = height;\r\n    }\r\n\r\n    /**\r\n     * Creates a frame buffer with a texture containing the given data\r\n     *\r\n     * @static\r\n     * @param {WebGLRenderingContext} gl - The current WebGL rendering context\r\n     * @param {number} width - the width of the drawing area of the frame buffer\r\n     * @param {number} height - the height of the drawing area of the frame buffer\r\n     * @return {GLFramebuffer} The new framebuffer.\r\n     */\r\n    static createRGBA(gl, width, height)\r\n    {\r\n        return GLFramebuffer.createFloat32(gl, width, height, null);\r\n    }\r\n\r\n    /**\r\n     * Creates a frame buffer with a texture containing the given data\r\n     *\r\n     * @static\r\n     * @param {WebGLRenderingContext} gl - The current WebGL rendering context\r\n     * @param {number} width - the width of the drawing area of the frame buffer\r\n     * @param {number} height - the height of the drawing area of the frame buffer\r\n     * @param {ArrayBuffer|SharedArrayBuffer|ArrayBufferView} data - an array of data\r\n     * @return {GLFramebuffer} The new framebuffer.\r\n     */\r\n    static createFloat32(gl, width, height, data)\r\n    {\r\n        const texture = GLTexture.fromData(gl, data, width, height);\r\n\r\n        texture.enableNearestScaling();\r\n        texture.enableWrapClamp();\r\n\r\n        // now create the framebuffer object and attach the texture to it.\r\n        const fbo = new GLFramebuffer(gl, width, height);\r\n\r\n        fbo.enableTexture(texture);\r\n        fbo.unbind();\r\n\r\n        return fbo;\r\n    }\r\n\r\n    /**\r\n     * Adds a texture to the framebuffer.\r\n     *\r\n     * @param {GLTexture} texture - the texture to add.\r\n     */\r\n    enableTexture(texture)\r\n    {\r\n        const gl = this.gl;\r\n\r\n        this.texture = texture || new GLTexture(gl);\r\n\r\n        this.texture.bind();\r\n\r\n        this.bind();\r\n\r\n        gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, this.texture.texture, 0);\r\n    }\r\n\r\n    /**\r\n     * Initialises the stencil buffer\r\n     */\r\n    enableStencil()\r\n    {\r\n        if (this.stencil) return;\r\n\r\n        const gl = this.gl;\r\n\r\n        this.stencil = gl.createRenderbuffer();\r\n\r\n        gl.bindRenderbuffer(gl.RENDERBUFFER, this.stencil);\r\n\r\n        // TODO.. this is depth AND stencil?\r\n        gl.framebufferRenderbuffer(gl.FRAMEBUFFER, gl.DEPTH_STENCIL_ATTACHMENT, gl.RENDERBUFFER, this.stencil);\r\n        gl.renderbufferStorage(gl.RENDERBUFFER, gl.DEPTH_STENCIL, this.width, this.height);\r\n    }\r\n\r\n    /**\r\n     * Erases the drawing area and fills it with a colour\r\n     *\r\n     * @param {number} r - the red value of the clearing colour\r\n     * @param {number} g - the green value of the clearing colour\r\n     * @param {number} b - the blue value of the clearing colour\r\n     * @param {number} a - the alpha value of the clearing colour\r\n     */\r\n    clear(r = 0, g = 0, b = 0, a = 1)\r\n    {\r\n        this.bind();\r\n\r\n        const gl = this.gl;\r\n\r\n        gl.clearColor(r, g, b, a);\r\n        gl.clear(gl.COLOR_BUFFER_BIT);\r\n    }\r\n\r\n    /**\r\n     * Binds the frame buffer to the WebGL context\r\n     */\r\n    bind()\r\n    {\r\n        const gl = this.gl;\r\n\r\n        if (this.texture)\r\n        {\r\n            this.texture.unbind();\r\n        }\r\n\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, this.framebuffer);\r\n    }\r\n\r\n    /**\r\n     * Unbinds the frame buffer to the WebGL context\r\n     */\r\n    unbind()\r\n    {\r\n        this.gl.bindFramebuffer(this.gl.FRAMEBUFFER, null);\r\n    }\r\n\r\n    /**\r\n     * Resizes the drawing area of the buffer to the given width and height\r\n     *\r\n     * @param {number} width - the new width\r\n     * @param {number} height - the new height\r\n     */\r\n    resize(width, height)\r\n    {\r\n        const gl = this.gl;\r\n\r\n        this.width = width;\r\n        this.height = height;\r\n\r\n        if (this.texture)\r\n        {\r\n            this.texture.uploadData(null, width, height);\r\n        }\r\n\r\n        if (this.stencil)\r\n        {\r\n            // update the stencil buffer width and height\r\n            gl.bindRenderbuffer(gl.RENDERBUFFER, this.stencil);\r\n            gl.renderbufferStorage(gl.RENDERBUFFER, gl.DEPTH_STENCIL, width, height);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Destroys this buffer\r\n     */\r\n    destroy()\r\n    {\r\n        if (this.texture)\r\n        {\r\n            this.texture.destroy();\r\n        }\r\n\r\n        this.gl.deleteFramebuffer(this.framebuffer);\r\n\r\n        this.gl = null;\r\n        this.framebuffer = null;\r\n        this.stencil = null;\r\n        this.texture = null;\r\n    }\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/core/src/gl/GLFramebuffer.js\n **/","import { ASSERT } from '../debug';\r\n\r\nlet FLOATING_POINT_AVAILABLE = false;\r\n\r\nlet lastBoundTextureId = 0;\r\n\r\n/**\r\n * Helper class to create a WebGL texture.\r\n *\r\n * @class\r\n * @memberof glutil\r\n */\r\nexport default class GLTexture\r\n{\r\n    /**\r\n     * @param {WebGLRenderingContext} gl - The current WebGL context.\r\n     * @param {number} width - The width of the texture.\r\n     * @param {number} height - The height of the texture.\r\n     * @param {number} format - The pixel format of the texture.\r\n     * @param {number} type - The gl type of the texture.\r\n     */\r\n    constructor(gl, width = 0, height = 0, format = gl.RGBA, type = gl.UNSIGNED_BYTE)\r\n    {\r\n        /**\r\n         * The current WebGL rendering context\r\n         *\r\n         * @member {WebGLRenderingContext}\r\n         */\r\n        this.gl = gl;\r\n\r\n        /**\r\n         * The WebGL texture\r\n         *\r\n         * @member {WebGLTexture}\r\n         */\r\n        this.texture = gl.createTexture();\r\n\r\n        /**\r\n         * If mipmapping was used for this texture, enable and disable with enableMipmap()\r\n         *\r\n         * @member {boolean}\r\n         */\r\n        this.mipmap = false;\r\n\r\n        /**\r\n         * Set to true to enable pre-multiplied alpha\r\n         *\r\n         * @member {boolean}\r\n         */\r\n        this.premultiplyAlpha = false;\r\n\r\n        /**\r\n         * The width of texture\r\n         *\r\n         * @member {number}\r\n         */\r\n        this.width = width;\r\n\r\n        /**\r\n         * The height of texture\r\n         *\r\n         * @member {number}\r\n         */\r\n        this.height = height;\r\n\r\n        /**\r\n         * The pixel format of the texture. defaults to gl.RGBA\r\n         *\r\n         * @member {number}\r\n         */\r\n        this.format = format;\r\n\r\n        /**\r\n         * The gl type of the texture. defaults to gl.UNSIGNED_BYTE\r\n         *\r\n         * @member {number}\r\n         */\r\n        this.type = type;\r\n    }\r\n\r\n    /**\r\n     * @static\r\n     * @param {WebGLRenderingContext} gl - The current WebGL context\r\n     * @param {HTMLImageElement|ImageData} source - the source image of the texture\r\n     * @param {boolean} premultiplyAlpha - If we want to use pre-multiplied alpha\r\n     * @return {GLTexture} The new texture.\r\n     */\r\n    static fromSource(gl, source, premultiplyAlpha = false)\r\n    {\r\n        const texture = new GLTexture(gl);\r\n\r\n        texture.premultiplyAlpha = premultiplyAlpha;\r\n        texture.upload(source);\r\n\r\n        return texture;\r\n    }\r\n\r\n    /**\r\n     * @static\r\n     * @param {WebGLRenderingContext} gl - The current WebGL context\r\n     * @param {ArrayBuffer|SharedArrayBuffer|ArrayBufferView} data - the data to upload to the texture\r\n     * @param {number} width - the new width of the texture\r\n     * @param {number} height - the new height of the texture\r\n     * @return {GLTexture} The new texture.\r\n     */\r\n    static fromData(gl, data, width, height)\r\n    {\r\n        const texture = new GLTexture(gl);\r\n\r\n        texture.uploadData(data, width, height);\r\n\r\n        return texture;\r\n    }\r\n\r\n    /**\r\n     * Uploads this texture to the GPU\r\n     *\r\n     * @param {HTMLImageElement|ImageData|HTMLVideoElement} source - the source image of the texture\r\n     */\r\n    upload(source)\r\n    {\r\n        this.bind();\r\n\r\n        // if the source is a video, we need to use the videoWidth / videoHeight as width / height will be incorrect.\r\n        this.width = source.videoWidth || source.width;\r\n        this.height = source.videoHeight || source.height;\r\n\r\n        const gl = this.gl;\r\n\r\n        gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, this.premultiplyAlpha);\r\n        gl.texImage2D(gl.TEXTURE_2D, 0, this.format, this.format, this.type, source);\r\n    }\r\n\r\n    /**\r\n     * Use a data source and uploads this texture to the GPU\r\n     *\r\n     * @param {ArrayBuffer|SharedArrayBuffer|ArrayBufferView} data - the data to upload to the texture\r\n     * @param {number} width - the new width of the texture\r\n     * @param {number} height - the new height of the texture\r\n     */\r\n    uploadData(data, width, height)\r\n    {\r\n        this.bind();\r\n\r\n        const gl = this.gl;\r\n\r\n        this.width = width || this.width;\r\n        this.height = height || this.height;\r\n\r\n        if (data instanceof Float32Array)\r\n        {\r\n            if (!FLOATING_POINT_AVAILABLE)\r\n            {\r\n                const ext = gl.getExtension('OES_texture_float');\r\n\r\n                ASSERT(ext, 'GLTexture#uploadData: floating point textures not available.');\r\n\r\n                FLOATING_POINT_AVAILABLE = !!ext;\r\n            }\r\n\r\n            this.type = gl.FLOAT;\r\n        }\r\n        else\r\n        {\r\n            // TODO support for other types\r\n            this.type = gl.UNSIGNED_BYTE;\r\n        }\r\n\r\n        // what type of data?\r\n        gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, this.premultiplyAlpha);\r\n        gl.texImage2D(gl.TEXTURE_2D, 0, this.format, this.width, this.height, 0, this.format, this.type, data || null);\r\n    }\r\n\r\n    /**\r\n     * Binds the texture\r\n     *\r\n     * @param {number} location - The texture slot to fill.\r\n     */\r\n    bind(location = -1)\r\n    {\r\n        const gl = this.gl;\r\n\r\n        if (location > -1 && location !== lastBoundTextureId)\r\n        {\r\n            gl.activeTexture(gl.TEXTURE0 + location);\r\n            lastBoundTextureId = location;\r\n        }\r\n\r\n        gl.bindTexture(gl.TEXTURE_2D, this.texture);\r\n    }\r\n\r\n    /**\r\n     * Unbinds the texture\r\n     */\r\n    unbind()\r\n    {\r\n        const gl = this.gl;\r\n\r\n        gl.bindTexture(gl.TEXTURE_2D, null);\r\n    }\r\n\r\n    /**\r\n     * @param {boolean} linear - if we want to use linear filtering or nearest neighbour interpolation\r\n     */\r\n    minFilter(linear)\r\n    {\r\n        const gl = this.gl;\r\n\r\n        this.bind();\r\n\r\n        if (this.mipmap)\r\n        {\r\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, linear ? gl.LINEAR_MIPMAP_LINEAR : gl.NEAREST_MIPMAP_NEAREST); // eslint-disable-line max-len\r\n        }\r\n        else\r\n        {\r\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, linear ? gl.LINEAR : gl.NEAREST);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param {boolean} linear - if we want to use linear filtering or nearest neighbour interpolation\r\n     */\r\n    magFilter(linear)\r\n    {\r\n        const gl = this.gl;\r\n\r\n        this.bind();\r\n\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, linear ? gl.LINEAR : gl.NEAREST);\r\n    }\r\n\r\n    /**\r\n     * Enables mipmapping\r\n     */\r\n    enableMipmap()\r\n    {\r\n        const gl = this.gl;\r\n\r\n        this.bind();\r\n\r\n        this.mipmap = true;\r\n\r\n        gl.generateMipmap(gl.TEXTURE_2D);\r\n    }\r\n\r\n    /**\r\n     * Enables linear filtering\r\n     */\r\n    enableLinearScaling()\r\n    {\r\n        this.minFilter(true);\r\n        this.magFilter(true);\r\n    }\r\n\r\n    /**\r\n     * Enables nearest neighbour interpolation\r\n     */\r\n    enableNearestScaling()\r\n    {\r\n        this.minFilter(false);\r\n        this.magFilter(false);\r\n    }\r\n\r\n    /**\r\n     * Enables clamping on the texture so WebGL will not repeat it\r\n     */\r\n    enableWrapClamp()\r\n    {\r\n        const gl = this.gl;\r\n\r\n        this.bind();\r\n\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n    }\r\n\r\n    /**\r\n     * Enable tiling on the texture\r\n     */\r\n    enableWrapRepeat()\r\n    {\r\n        const gl = this.gl;\r\n\r\n        this.bind();\r\n\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.REPEAT);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.REPEAT);\r\n    }\r\n\r\n    /**\r\n     * Enable wrapping on the texture\r\n     */\r\n    enableWrapMirrorRepeat()\r\n    {\r\n        const gl = this.gl;\r\n\r\n        this.bind();\r\n\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.MIRRORED_REPEAT);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.MIRRORED_REPEAT);\r\n    }\r\n\r\n    /**\r\n     * Destroys this texture\r\n     */\r\n    destroy()\r\n    {\r\n        if (this.gl.isTexture(this.texture))\r\n        {\r\n            this.gl.deleteTexture(this.texture);\r\n        }\r\n\r\n        this.gl = null;\r\n        this.texture = null;\r\n    }\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/core/src/gl/GLTexture.js\n **/","/**\r\n * Note that the debug namespace is only exported in \"debug\" builds.\r\n * In production builds, this namespace is not included.\r\n *\r\n * @namespace debug\r\n */\r\n\r\n/**\r\n * @memberof debug\r\n * @param {boolean} bool - The condition to ensure is true.\r\n * @param {string} message - The message to display if the first param is not true.\r\n */\r\nexport function ASSERT(bool, message)\r\n{\r\n    if (!bool) throw new Error(`[Fae ASSERT] ${message}`);\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/core/src/debug.js\n **/","/* eslint max-params: [2, { max: 6 }] */\r\n\r\n/**\r\n * This is a modified version of Brandon Jones's Vector2d utility.\r\n *\r\n * modified by cengler\r\n */\r\n\r\n/* Copyright (c) 2015, Brandon Jones, Colin MacKenzie IV.\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE. */\r\n\r\n/**\r\n * @ignore\r\n */\r\nconst EPSILON = 0.000001;\r\n\r\n/**\r\n * A Vector2d is an object defined as:\r\n *\r\n * ```js\r\n * [x, y]\r\n * ```\r\n *\r\n * @class\r\n * @memberof math\r\n */\r\nexport default class Vector2d\r\n{\r\n    /**\r\n     * Creates a new, empty Vector2d\r\n     *\r\n     * @param {number} x - The starting x value.\r\n     * @param {number} y - The starting y value.\r\n     */\r\n    constructor(x = 0, y = 0)\r\n    {\r\n        /**\r\n         * The `x` component of the Vector2d.\r\n         *\r\n         * @member {number}\r\n         */\r\n        this.x = x;\r\n\r\n        /**\r\n         * The `y` component of the Vector2d.\r\n         *\r\n         * @member {number}\r\n         */\r\n        this.y = y;\r\n    }\r\n\r\n    /**\r\n     * Copy the values from one Vector2d to another\r\n     *\r\n     * @param {Vector2d} b - the source vector.\r\n     * @return {Vector2d} returns itself.\r\n     */\r\n    copy(b)\r\n    {\r\n        this.x = b.x;\r\n        this.y = b.y;\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Set the components of a Vector2d to the given values\r\n     *\r\n     * @param {number} x - X component.\r\n     * @param {number} y - Y component.\r\n     * @return {Vector2d} returns itself.\r\n     */\r\n    set(x, y)\r\n    {\r\n        this.x = x;\r\n        this.y = y;\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Adds a vector `b` to this one.\r\n     *\r\n     * @param {Vector2d} b - the operand to add to this vector.\r\n     * @return {Vector2d} returns itself.\r\n     */\r\n    add(b)\r\n    {\r\n        this.x += b.x;\r\n        this.y += b.y;\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Subtracts vector `b` from this one.\r\n     *\r\n     * @param {Vector2d} b - the operand to subtract from this vector.\r\n     * @return {Vector2d} returns itself.\r\n     */\r\n    subtract(b)\r\n    {\r\n        this.x -= b.x;\r\n        this.y -= b.y;\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Multiplies this vector by `b`.\r\n     *\r\n     * @param {Vector2d} b - the operand to multiply this vector by.\r\n     * @return {Vector2d} returns itself.\r\n     */\r\n    multiply(b)\r\n    {\r\n        this.x *= b.x;\r\n        this.y *= b.y;\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Divides this vector by `b`.\r\n     *\r\n     * @param {Vector2d} b - the operand to divide this vector by.\r\n     * @return {Vector2d} returns itself.\r\n     */\r\n    divide(b)\r\n    {\r\n        this.x /= b.x;\r\n        this.y /= b.y;\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Math.ceil the components of this vector.\r\n     *\r\n     * @return {Vector2d} returns itself.\r\n     */\r\n    ceil()\r\n    {\r\n        this.x = Math.ceil(this.x);\r\n        this.y = Math.ceil(this.y);\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Math.floor the components of this vector.\r\n     *\r\n     * @return {Vector2d} returns itself.\r\n     */\r\n    floor()\r\n    {\r\n        this.x = Math.floor(this.x);\r\n        this.y = Math.floor(this.y);\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Sets the components to the minimum of this vector and the passed vector.\r\n     *\r\n     * @param {Vector2d} b - the operand to check for min values.\r\n     * @return {Vector2d} returns itself.\r\n     */\r\n    min(b)\r\n    {\r\n        this.x = Math.min(this.x, b.x);\r\n        this.y = Math.min(this.y, b.y);\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Sets the components to the maximum of this vector and the passed vector.\r\n     *\r\n     * @param {Vector2d} b - the operand to check for max values.\r\n     * @return {Vector2d} returns itself.\r\n     */\r\n    max(b)\r\n    {\r\n        this.x = Math.max(this.x, b.x);\r\n        this.y = Math.max(this.y, b.y);\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Math.round the components of this vector.\r\n     *\r\n     * @return {Vector2d} returns itself.\r\n     */\r\n    round()\r\n    {\r\n        this.x = Math.round(this.x);\r\n        this.y = Math.round(this.y);\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Scales this vector by a scalar number.\r\n     *\r\n     * @param {number} b - amount to scale the vector by.\r\n     * @return {Vector2d} returns itself.\r\n     */\r\n    scale(b)\r\n    {\r\n        this.x *= b;\r\n        this.y *= b;\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Scales each component of the passed vector by the given scalar, then adds the result\r\n     * to each respective component of this vector.\r\n     *\r\n     * @param {Vector2d} b - the vector to scale before adding into this vector.\r\n     * @param {number} scale - the amount to scale b's elements by before adding.\r\n     * @return {Vector2d} returns itself.\r\n     */\r\n    scaleAndAdd(b, scale)\r\n    {\r\n        this.x += (b.x * scale);\r\n        this.y += (b.y * scale);\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Calculates the euclidian distance between the passed vector and this one.\r\n     *\r\n     * @param {Vector2d} b - the operand to calculate distance to.\r\n     * @return {number} distance between this vector and b.\r\n     */\r\n    distance(b)\r\n    {\r\n        const x = b.x - this.x;\r\n        const y = b.y - this.y;\r\n\r\n        return Math.sqrt((x * x) + (y * y));\r\n    }\r\n\r\n    /**\r\n     * Calculates the squared euclidian distance between the passed vector and this one.\r\n     *\r\n     * @param {Vector2d} b - the operand to calculate distance to.\r\n     * @return {number} squared distance between this vector and b.\r\n     */\r\n    squaredDistance(b)\r\n    {\r\n        const x = b.x - this.x;\r\n        const y = b.y - this.y;\r\n\r\n        return (x * x) + (y * y);\r\n    }\r\n\r\n    /**\r\n     * Calculates the length of the vector.\r\n     *\r\n     * @return {number} length of the vector.\r\n     */\r\n    length()\r\n    {\r\n        const x = this.x;\r\n        const y = this.y;\r\n\r\n        return Math.sqrt((x * x) + (y * y));\r\n    }\r\n\r\n    /**\r\n     * Calculates the squared length of the vector.\r\n     *\r\n     * @return {number} squared length of the vector.\r\n     */\r\n    squaredLength()\r\n    {\r\n        const x = this.x;\r\n        const y = this.y;\r\n\r\n        return (x * x) + (y * y);\r\n    }\r\n\r\n    /**\r\n     * Negates the components of the vector.\r\n     *\r\n     * @return {Vector2d} returns itself.\r\n     */\r\n    negate()\r\n    {\r\n        this.x = -this.x;\r\n        this.y = -this.y;\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Returns the inverse of the components of the vector.\r\n     *\r\n     * @return {Vector2d} returns itself.\r\n     */\r\n    inverse()\r\n    {\r\n        this.x = 1.0 / this.x;\r\n        this.y = 1.0 / this.y;\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Normalizes the vector.\r\n     *\r\n     * @return {Vector2d} returns itself.\r\n     */\r\n    normalize()\r\n    {\r\n        const x = this.x;\r\n        const y = this.y;\r\n\r\n        let len = (x * x) + (y * y);\r\n\r\n        if (len > 0)\r\n        {\r\n            // TODO: evaluate use of glm_invsqrt here?\r\n            len = 1 / Math.sqrt(len);\r\n            this.x = this.x * len;\r\n            this.y = this.y * len;\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Calculates the dot product of the vector and the passed vector.\r\n     *\r\n     * @param {Vector2d} b - the operand to dot with.\r\n     * @return {number} dot product of this vector and b.\r\n     */\r\n    dot(b)\r\n    {\r\n        return (this.x * b.x) + (this.y * b.y);\r\n    }\r\n\r\n    /**\r\n     * Linearly interpolates this vector towards the passed vector\r\n     * using the passed interpolation ammount (`t`).\r\n     *\r\n     * @param {Vector2d} b - the operand to lerp to.\r\n     * @param {number} t - interpolation amount between the two vectors.\r\n     * @return {Vector2d} returns itself.\r\n     */\r\n    lerp(b, t)\r\n    {\r\n        this.x += (t * (b.x - this.x));\r\n        this.y += (t * (b.y - this.y));\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Sets the components to random numbers with the given scale.\r\n     *\r\n     * @param {number} scale - Length of the resulting vector. If ommitted, a unit vector will be returned.\r\n     * @return {Vector2d} returns itself.\r\n     */\r\n    random(scale = 1.0)\r\n    {\r\n        const r = Math.random() * 2.0 * Math.PI;\r\n\r\n        this.x = Math.cos(r) * scale;\r\n        this.y = Math.sin(r) * scale;\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Transforms the vector with a Matrix2d\r\n     *\r\n     * @param {Matrix2d} m - matrix to transform with.\r\n     * @return {Vector2d} returns itself.\r\n     */\r\n    transformMatrix2d(m)\r\n    {\r\n        const x = this.x;\r\n        const y = this.y;\r\n\r\n        this.x = (m.a * x) + (m.c * y) + m.tx;\r\n        this.y = (m.b * x) + (m.d * y) + m.ty;\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Returns a string representation of a vector\r\n     *\r\n     * @return {string} string representation of the vector\r\n     */\r\n    toString()\r\n    {\r\n        return `Vector2d(${this.x}, ${this.y})`;\r\n    }\r\n\r\n    /**\r\n     * Returns whether or not the passed vector has exactly the same elements in\r\n     * the same position (when compared with ===) as this one.\r\n     *\r\n     * @param {Vector2d} b - The vector to check equality against.\r\n     * @return {boolean} True if the vectors are equal, false otherwise.\r\n     */\r\n    exactEquals(b)\r\n    {\r\n        return this.x === b.x && this.y === b.y;\r\n    }\r\n\r\n    /**\r\n     * Returns whether or not the passed vector has approximately the same elements in\r\n     * the same position (when compared with ===) as this one.\r\n     *\r\n     * @param {Vector2d} b - The vector to check equality against.\r\n     * @return {boolean} True if the vectors are equal, false otherwise.\r\n     */\r\n    equals(b)\r\n    {\r\n        if (!b) return false;\r\n\r\n        const a0 = this.x;\r\n        const a1 = this.y;\r\n        const b0 = b.x;\r\n        const b1 = b.y;\r\n\r\n        return (Math.abs(a0 - b0) <= EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0))\r\n            && Math.abs(a1 - b1) <= EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)));\r\n    }\r\n}\r\n\r\n/**\r\n * Returns the number of elements this vector has.\r\n *\r\n * @static\r\n * @return {number} number of elements in a Vector2d.\r\n */\r\nVector2d.LENGTH = 2;\r\n\r\n/**\r\n * Size in bytes of a Matrix2d.\r\n *\r\n * @static\r\n * @return {number} byte size of a Matrix2d.\r\n */\r\nVector2d.BYTE_SIZE = Vector2d.LENGTH * Vector2d.BYTES_PER_ELEMENT;\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/core/src/math/Vector2d.js\n **/","/* eslint max-params: [1, { \"max\": 6 }] */\r\n/**\r\n * This is a modified version of Brandon Jones's mat2d utility.\r\n *\r\n * modified by cengler\r\n */\r\n\r\n/* Copyright (c) 2015, Brandon Jones, Colin MacKenzie IV.\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE. */\r\n\r\n/**\r\n * @ignore\r\n */\r\nconst EPSILON = 0.000001;\r\n\r\n/**\r\n * A 2x3 matrix.\r\n *\r\n * A Matrix2d is an object that contains six elements defined as:\r\n *\r\n * ```js\r\n * [a, b, c, d, tx, ty]\r\n * ```\r\n *\r\n * This is a short form for a 3x3 transformation matrix:\r\n *\r\n * ```\r\n * | a  c  tx|\r\n * | b  d  ty|\r\n * | 0  0  1 |\r\n * ```\r\n *\r\n * Since the last row is ignored so the data structure is smaller and operations are faster.\r\n *\r\n * For those unfamiliar with 3x3 transformation matrices, you could say that:\r\n *\r\n * - `a` and `d` affect scale,\r\n * - `c` and `b` affect rotation, and\r\n * - `tx` and `ty` affect translation.\r\n *\r\n * It is a bit more interconnected than that, but thats basic gist.\r\n *\r\n * @class\r\n * @memberof math\r\n */\r\nexport default class Matrix2d\r\n{\r\n    /**\r\n     * Creates a new identity Matrix2d\r\n     *\r\n     * @param {number} a - The `a` component.\r\n     * @param {number} b - The `b` component.\r\n     * @param {number} c - The `c` component.\r\n     * @param {number} d - The `d` component.\r\n     * @param {number} tx - The `tx` component.\r\n     * @param {number} ty - The `ty` component.\r\n     */\r\n    constructor(a = 1, b = 0, c = 0, d = 1, tx = 0, ty = 0)\r\n    {\r\n        this._mat3 = null;\r\n\r\n        /**\r\n         * The `a` component of the Matrix2d.\r\n         *\r\n         * @member {number}\r\n         */\r\n        this.a = a;\r\n\r\n        /**\r\n         * The `b` component of the Matrix2d.\r\n         *\r\n         * @member {number}\r\n         */\r\n        this.b = b;\r\n\r\n        /**\r\n         * The `c` component of the Matrix2d.\r\n         *\r\n         * @member {number}\r\n         */\r\n        this.c = c;\r\n\r\n        /**\r\n         * The `d` component of the Matrix2d.\r\n         *\r\n         * @member {number}\r\n         */\r\n        this.d = d;\r\n\r\n        /**\r\n         * The `tx` component of the Matrix2d.\r\n         *\r\n         * @member {number}\r\n         */\r\n        this.tx = tx;\r\n\r\n        /**\r\n         * The `ty` component of the Matrix2d.\r\n         *\r\n         * @member {number}\r\n         */\r\n        this.ty = ty;\r\n    }\r\n\r\n    /**\r\n     * Converts to the full 3x3 matrix form, optionally transposing.\r\n     *\r\n     * @param {boolean} transpose - Should we transpose the matrix?\r\n     * @param {Float32Array} out - An optional array to assign values to.\r\n     * @return {Float32Array} A 9-element array representing the 3x3 Matrix.\r\n     */\r\n    toMat3Array(transpose = true, out = null)\r\n    {\r\n        if (!out && !this._mat3)\r\n        {\r\n            this._mat3 = new Float32Array(9);\r\n        }\r\n\r\n        out = out || this._mat3;\r\n\r\n        if (transpose)\r\n        {\r\n            out[0] = this.a;\r\n            out[1] = this.b;\r\n            out[2] = 0;\r\n            out[3] = this.c;\r\n            out[4] = this.d;\r\n            out[5] = 0;\r\n            out[6] = this.tx;\r\n            out[7] = this.ty;\r\n            out[8] = 1;\r\n        }\r\n        else\r\n        {\r\n            out[0] = this.a;\r\n            out[1] = this.c;\r\n            out[2] = this.tx;\r\n            out[3] = this.b;\r\n            out[4] = this.d;\r\n            out[5] = this.ty;\r\n            out[6] = 0;\r\n            out[7] = 0;\r\n            out[8] = 1;\r\n        }\r\n\r\n        return out;\r\n    }\r\n\r\n    /**\r\n     * Copy the values from a Matrix2d into this one.\r\n     *\r\n     * @param {Matrix2d} b - the source matrix.\r\n     * @return {Matrix2d} returns itself.\r\n     */\r\n    copy(b)\r\n    {\r\n        this.a = b.a;\r\n        this.b = b.b;\r\n        this.c = b.c;\r\n        this.d = b.d;\r\n        this.tx = b.tx;\r\n        this.ty = b.ty;\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Sets the matrix to the identity matrix.\r\n     *\r\n     * @return {Matrix2d} returns itself.\r\n     */\r\n    identity()\r\n    {\r\n        this.a = 1;\r\n        this.b = 0;\r\n        this.c = 0;\r\n        this.d = 1;\r\n        this.tx = 0;\r\n        this.ty = 0;\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Sets the matrix components to the given values.\r\n     *\r\n     * @param {number} a - Component A (index 0).\r\n     * @param {number} b - Component B (index 1).\r\n     * @param {number} c - Component C (index 2).\r\n     * @param {number} d - Component D (index 3).\r\n     * @param {number} tx - Component TX (index 4).\r\n     * @param {number} ty - Component TY (index 5).\r\n     * @return {Matrix2d} returns itself.\r\n     */\r\n    set(a, b, c, d, tx, ty)\r\n    {\r\n        this.a = a;\r\n        this.b = b;\r\n        this.c = c;\r\n        this.d = d;\r\n        this.tx = tx;\r\n        this.ty = ty;\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Inverts the matrix.\r\n     *\r\n     * @param {Matrix2d} a - the source matrix.\r\n     * @return {Matrix2d} returns itself.\r\n     */\r\n    invert()\r\n    {\r\n        const aa = this.a;\r\n        const ab = this.b;\r\n        const ac = this.c;\r\n        const ad = this.d;\r\n        const atx = this.tx;\r\n        const aty = this.ty;\r\n\r\n        let det = (aa * ad) - (ab * ac);\r\n\r\n        if (!det) return null;\r\n\r\n        det = 1.0 / det;\r\n\r\n        this.a = ad * det;\r\n        this.b = -ab * det;\r\n        this.c = -ac * det;\r\n        this.d = aa * det;\r\n        this.tx = ((ac * aty) - (ad * atx)) * det;\r\n        this.ty = ((ab * atx) - (aa * aty)) * det;\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Calculates the determinant of this matrix.\r\n     *\r\n     * @return {number} determinant of this matrix.\r\n     */\r\n    determinant()\r\n    {\r\n        return (this.a * this.d) - (this.b * this.c);\r\n    }\r\n\r\n    /**\r\n     * Multiplies this matrix by another Matrix2d.\r\n     *\r\n     * @param {Matrix2d} o - The other matrix to multiply this matrix by.\r\n     * @return {Matrix2d} returns itself.\r\n     */\r\n    multiply(o)\r\n    {\r\n        const a = this.a;\r\n        const b = this.b;\r\n        const c = this.c;\r\n        const d = this.d;\r\n\r\n        this.a = (a * o.a) + (c * o.b);\r\n        this.b = (b * o.a) + (d * o.b);\r\n        this.c = (a * o.c) + (c * o.d);\r\n        this.d = (b * o.c) + (d * o.d);\r\n        this.tx = (a * o.tx) + (c * o.ty) + this.tx;\r\n        this.ty = (b * o.tx) + (d * o.ty) + this.ty;\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Rotates a this matrix by the given angle.\r\n     *\r\n     * @param {number} rad - the angle to rotate the matrix by.\r\n     * @return {Matrix2d} returns itself.\r\n     */\r\n    rotate(rad)\r\n    {\r\n        const a0 = this.a;\r\n        const a1 = this.b;\r\n        const a2 = this.c;\r\n        const a3 = this.d;\r\n        const s = Math.sin(rad);\r\n        const c = Math.cos(rad);\r\n\r\n        this.a = (a0 * c) + (a2 * s);\r\n        this.b = (a1 * c) + (a3 * s);\r\n        this.c = (a0 * -s) + (a2 * c);\r\n        this.d = (a1 * -s) + (a3 * c);\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Scales the matrix by the dimensions in the given coords.\r\n     *\r\n     * @param {number} x - The X amount to scale by.\r\n     * @param {number} y - The Y amount to scale by.\r\n     * @return {Matrix2d} returns itself.\r\n     **/\r\n    scale(x, y)\r\n    {\r\n        this.a *= x;\r\n        this.b *= x;\r\n        this.c *= y;\r\n        this.d *= y;\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Translates the matrix by the dimensions in the given coords.\r\n     *\r\n     * @param {number} x - The X amount to translate by.\r\n     * @param {number} y - The Y amount to translate by.\r\n     * @return {Matrix2d} returns itself.\r\n     **/\r\n    translate(x, y)\r\n    {\r\n        this.tx = (this.a * x) + (this.c * y) + this.tx;\r\n        this.ty = (this.b * x) + (this.d * y) + this.ty;\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Returns a string representation of the matrix.\r\n     *\r\n     * @return {string} string representation of the matrix.\r\n     */\r\n    toString()\r\n    {\r\n        return `Matrix2d(${this.a}, ${this.b}, ${this.c}, ${this.d}, ${this.tx}, ${this.ty})`;\r\n    }\r\n\r\n    /**\r\n     * Returns Frobenius norm of the matrix.\r\n     *\r\n     * @return {number} Frobenius norm.\r\n     */\r\n    frob()\r\n    {\r\n        return (\r\n            Math.sqrt(\r\n                Math.pow(this.a, 2)\r\n                + Math.pow(this.b, 2)\r\n                + Math.pow(this.c, 2)\r\n                + Math.pow(this.d, 2)\r\n                + Math.pow(this.tx, 2)\r\n                + Math.pow(this.ty, 2)\r\n                + 1\r\n            )\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Adds the pass matrix to this one.\r\n     *\r\n     * @param {Matrix2d} b - the operand to add to this matrix.\r\n     * @return {Matrix2d} returns itself.\r\n     */\r\n    add(b)\r\n    {\r\n        this.a += b.a;\r\n        this.b += b.b;\r\n        this.c += b.c;\r\n        this.d += b.d;\r\n        this.tx += b.tx;\r\n        this.ty += b.ty;\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Subtracts the passed matrix from this one.\r\n     *\r\n     * @param {Matrix2d} b - the operand to subtract from this matrix.\r\n     * @return {Matrix2d} returns itself.\r\n     */\r\n    subtract(b)\r\n    {\r\n        this.a -= b.a;\r\n        this.b -= b.b;\r\n        this.c -= b.c;\r\n        this.d -= b.d;\r\n        this.tx -= b.tx;\r\n        this.ty -= b.ty;\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Multiply each element of the matrix by a scalar.\r\n     *\r\n     * @param {number} b - amount to scale the matrix's elements by.\r\n     * @return {Matrix2d} returns itself.\r\n     */\r\n    multiplyScalar(b)\r\n    {\r\n        this.a *= b;\r\n        this.b *= b;\r\n        this.c *= b;\r\n        this.d *= b;\r\n        this.tx *= b;\r\n        this.ty *= b;\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Scales each component of the passed matrix by the given scalar, then adds the result\r\n     * to each respective component of this matrix.\r\n     *\r\n     * @param {Matrix2d} b - the matrix to scale before adding into this matrix.\r\n     * @param {number} scale - the amount to scale b's elements by before adding.\r\n     * @return {Matrix2d} returns itself.\r\n     */\r\n    multiplyScalarAndAdd(b, scale)\r\n    {\r\n        this.a += (b.a * scale);\r\n        this.b += (b.b * scale);\r\n        this.c += (b.c * scale);\r\n        this.d += (b.d * scale);\r\n        this.tx += (b.tx * scale);\r\n        this.ty += (b.ty * scale);\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Returns whether or not the passed matrix has exactly the same elements in the\r\n     * same position (when compared with ===) as this one.\r\n     *\r\n     * @param {Matrix2d} b - The matrix to check equality against.\r\n     * @return {boolean} True if the matrices are equal, false otherwise.\r\n     */\r\n    exactEquals(b)\r\n    {\r\n        return this.a === b.a\r\n            && this.b === b.b\r\n            && this.c === b.c\r\n            && this.d === b.d\r\n            && this.tx === b.tx\r\n            && this.ty === b.ty;\r\n    }\r\n\r\n    /**\r\n     * Returns whether or not the passed matrix has approximately the same elements in the\r\n     * same position as this one.\r\n     *\r\n     * @param {Matrix2d} b - The matrix to check equality against.\r\n     * @return {boolean} True if the matrices are equal, false otherwise.\r\n     */\r\n    equals(b)\r\n    {\r\n        if (!b) return false;\r\n\r\n        const a0 = this.a;\r\n        const a1 = this.b;\r\n        const a2 = this.c;\r\n        const a3 = this.d;\r\n        const a4 = this.tx;\r\n        const a5 = this.ty;\r\n        const b0 = b.a;\r\n        const b1 = b.b;\r\n        const b2 = b.c;\r\n        const b3 = b.d;\r\n        const b4 = b.tx;\r\n        const b5 = b.ty;\r\n\r\n        return (Math.abs(a0 - b0) <= EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0))\r\n            && Math.abs(a1 - b1) <= EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1))\r\n            && Math.abs(a2 - b2) <= EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2))\r\n            && Math.abs(a3 - b3) <= EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3))\r\n            && Math.abs(a4 - b4) <= EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4))\r\n            && Math.abs(a5 - b5) <= EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)));\r\n    }\r\n\r\n    /**\r\n     * Checks if the matrix has NaN or Infinity anywhere.\r\n     *\r\n     * @return {boolean} True if the matrix is valid, false otherwise.\r\n     */\r\n    valid()\r\n    {\r\n        return !isNaN(this.a) && this.a !== Infinity\r\n            && !isNaN(this.b) && this.b !== Infinity\r\n            && !isNaN(this.c) && this.c !== Infinity\r\n            && !isNaN(this.d) && this.d !== Infinity\r\n            && !isNaN(this.tx) && this.tx !== Infinity\r\n            && !isNaN(this.ty) && this.ty !== Infinity;\r\n    }\r\n}\r\n\r\n/**\r\n * Returns the number of elements this matrix has.\r\n *\r\n * @static\r\n * @return {number} number of elements in a Matrix2d.\r\n */\r\nMatrix2d.LENGTH = 6;\r\n\r\n/**\r\n * Size in bytes of a Matrix2d.\r\n *\r\n * @static\r\n * @return {number} byte size of a Matrix2d.\r\n */\r\nMatrix2d.BYTE_SIZE = Matrix2d.LENGTH * Matrix2d.BYTES_PER_ELEMENT;\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/core/src/math/Matrix2d.js\n **/","/** @namespace shapes */\r\n\r\nexport { default as BoundingBox } from './BoundingBox';\r\nexport { default as BoundsComponent } from './BoundsComponent';\r\nexport { default as Polygon } from './Polygon';\r\nexport { default as Rectangle } from './Rectangle';\r\nexport { default as SpriteBoundsComponent } from './SpriteBoundsComponent';\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/shapes/src/index.js\n **/","import Rectangle from './Rectangle';\r\n\r\n/**\r\n * BoundingBox is an axis-aligned bounding box for an owning object.\r\n *\r\n * @class\r\n * @memberof shapes\r\n */\r\nexport default class BoundingBox extends Rectangle\r\n{\r\n    /**\r\n     *\r\n     */\r\n    constructor()\r\n    {\r\n        super();\r\n\r\n        /**\r\n         * Tracks the \"empty\" bounds state so we always have a valid rectangle.\r\n         *\r\n         * @member {boolean}\r\n         */\r\n        this._empty = true;\r\n    }\r\n\r\n    /**\r\n     * Resets the bounding box to a default empty box.\r\n     *\r\n     */\r\n    clear()\r\n    {\r\n        this.x = this.y = this.width = this.height = 0;\r\n        this._empty = true;\r\n    }\r\n\r\n    /**\r\n     * Adds the child bounds object to the size of this bounding box.\r\n     *\r\n     * @param {BoundingBox} bounds - The child bounds to include.\r\n     * @return {BoundingBox} Returns itself.\r\n     */\r\n    addChild(bounds)\r\n    {\r\n        if (bounds._empty) return this;\r\n\r\n        if (this._empty)\r\n        {\r\n            this.copy(bounds);\r\n            this._empty = false;\r\n        }\r\n        else\r\n        {\r\n            this.union(bounds);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Adds the vertices of a quad to the size of this bounding box. This\r\n     * has the effect of extending the bounding box to include this quad.\r\n     *\r\n     * @param {Float32Array|number[]} vertices - The vertices of the quad.\r\n     * @return {BoundingBox} Returns itself.\r\n     */\r\n    addQuad(vertices)\r\n    {\r\n        let minX = this._empty ? Infinity : this.x;\r\n        let minY = this._empty ? Infinity : this.y;\r\n        let maxX = this._empty ? -Infinity : this.right;\r\n        let maxY = this._empty ? -Infinity : this.bottom;\r\n\r\n        let x = 0;\r\n        let y = 0;\r\n\r\n        x = vertices[0];\r\n        y = vertices[1];\r\n        minX = x < minX ? x : minX;\r\n        minY = y < minY ? y : minY;\r\n        maxX = x > maxX ? x : maxX;\r\n        maxY = y > maxY ? y : maxY;\r\n\r\n        x = vertices[2];\r\n        y = vertices[3];\r\n        minX = x < minX ? x : minX;\r\n        minY = y < minY ? y : minY;\r\n        maxX = x > maxX ? x : maxX;\r\n        maxY = y > maxY ? y : maxY;\r\n\r\n        x = vertices[4];\r\n        y = vertices[5];\r\n        minX = x < minX ? x : minX;\r\n        minY = y < minY ? y : minY;\r\n        maxX = x > maxX ? x : maxX;\r\n        maxY = y > maxY ? y : maxY;\r\n\r\n        x = vertices[6];\r\n        y = vertices[7];\r\n        minX = x < minX ? x : minX;\r\n        minY = y < minY ? y : minY;\r\n        maxX = x > maxX ? x : maxX;\r\n        maxY = y > maxY ? y : maxY;\r\n\r\n        this.x = minX;\r\n        this.y = minY;\r\n        this.width = maxX - this.x;\r\n        this.height = maxY - this.y;\r\n\r\n        this._empty = false;\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Adds an arbitrary array of vertices to the size of the bounding box.\r\n     *\r\n     * @param {Transform} transform - The transform to consider.\r\n     * @param {Float32Array|number[]} vertices - The vertices to consider.\r\n     * @param {number} offset - offset into the vertices array to start at.\r\n     * @param {number} endOffset - The end of the vertices at which to stop.\r\n     * @return {BoundingBox} Returns itself.\r\n     */\r\n    addVertices(transform, vertices, offset = 0, endOffset = vertices.length)\r\n    {\r\n        const matrix = transform.worldTransform;\r\n\r\n        const a = matrix.a;\r\n        const b = matrix.b;\r\n        const c = matrix.c;\r\n        const d = matrix.d;\r\n        const tx = matrix.tx;\r\n        const ty = matrix.ty;\r\n\r\n        let minX = this._empty ? Infinity : this.x;\r\n        let minY = this._empty ? Infinity : this.y;\r\n        let maxX = this._empty ? -Infinity : this.right;\r\n        let maxY = this._empty ? -Infinity : this.bottom;\r\n\r\n        for (let i = offset; i < endOffset; i += 2)\r\n        {\r\n            const rawX = vertices[i];\r\n            const rawY = vertices[i + 1];\r\n\r\n            const x = (a * rawX) + (c * rawY) + tx;\r\n            const y = (d * rawY) + (b * rawX) + ty;\r\n\r\n            minX = Math.min(x, minX);\r\n            minY = Math.min(y, minY);\r\n            maxX = Math.max(x, maxX);\r\n            maxY = Math.max(y, maxY);\r\n        }\r\n\r\n        this.x = minX;\r\n        this.y = minY;\r\n        this.wight = maxX - this.x;\r\n        this.height = maxY - this.y;\r\n\r\n        this._empty = false;\r\n\r\n        return this;\r\n    }\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/shapes/src/BoundingBox.js\n **/","/**\r\n * A simple class representing a rectangle. A Rectangle is defined by its position,\r\n * as indicated by its top-left corner point (x, y) and by its width and its height.\r\n *\r\n * @class\r\n * @memberof shapes\r\n */\r\nexport default class Rectangle\r\n{\r\n\r\n    /**\r\n     * @param {number} x - The X coordinate of the upper-left corner of the rectangle\r\n     * @param {number} y - The Y coordinate of the upper-left corner of the rectangle\r\n     * @param {number} width - The overall width of this rectangle\r\n     * @param {number} height - The overall height of this rectangle\r\n     */\r\n    constructor(x = 0, y = 0, width = 0, height = 0)\r\n    {\r\n        /**\r\n         * The X position of the top-left of the rectangle.\r\n         *\r\n         * @member {number}\r\n         */\r\n        this.x = x;\r\n\r\n        /**\r\n         * The Y position of the top-left of the rectangle.\r\n         *\r\n         * @member {number}\r\n         */\r\n        this.y = y;\r\n\r\n        /**\r\n         * The width of the rectangle.\r\n         *\r\n         * @member {number}\r\n         */\r\n        this.width = width;\r\n\r\n        /**\r\n         * The height of the rectangle.\r\n         *\r\n         * @member {number}\r\n         */\r\n        this.height = height;\r\n    }\r\n\r\n    /**\r\n     * The left-most X coord of this rectangle.\r\n     *\r\n     * @member {number}\r\n     */\r\n    get left()\r\n    {\r\n        return this.x;\r\n    }\r\n\r\n    /**\r\n     * Sets the left-most X coord of this rectangle. This is the same\r\n     * as setting the X coord and will move the rectangle.\r\n     *\r\n     * @param {number} v - The position for the left of this rectangle.\r\n     */\r\n    set left(v)\r\n    {\r\n        this.x = v;\r\n    }\r\n\r\n    /**\r\n     * The right-most X coord of this rectangle.\r\n     *\r\n     * @member {number}\r\n     */\r\n    get right()\r\n    {\r\n        return this.x + this.width;\r\n    }\r\n\r\n    /**\r\n     * Sets the right-most X coord of this rectangle. This has the effect\r\n     * of modifying the width.\r\n     *\r\n     * @param {number} v - The position for the right of this rectangle.\r\n     */\r\n    set right(v)\r\n    {\r\n        this.width = (v - this.x);\r\n    }\r\n\r\n    /**\r\n     * The top-most Y coord of this rectangle.\r\n     *\r\n     * @member {number}\r\n     */\r\n    get top()\r\n    {\r\n        return this.y;\r\n    }\r\n\r\n    /**\r\n     * Sets the top-most Y coord of this rectangle. This is the same\r\n     * as setting the Y coord and will move the rectangle.\r\n     *\r\n     * @param {number} v - The position for the top of this rectangle.\r\n     */\r\n    set top(v)\r\n    {\r\n        this.y = v;\r\n    }\r\n\r\n    /**\r\n     * The bottom-most Y coord of this rectangle.\r\n     *\r\n     * @member {number}\r\n     */\r\n    get bottom()\r\n    {\r\n        return this.y + this.height;\r\n    }\r\n\r\n    /**\r\n     * Sets the bottom-most Y coord of this rectangle. This has the effect\r\n     * of modifying the height.\r\n     *\r\n     * @param {number} v - The position for the bottom of this rectangle.\r\n     */\r\n    set bottom(v)\r\n    {\r\n        this.height = (v - this.y);\r\n    }\r\n\r\n    /**\r\n     * Is this rectangle empty?\r\n     *\r\n     * @return {boolean} True if empty.\r\n     */\r\n    isEmpty()\r\n    {\r\n        return this.width === 0 && this.height === 0;\r\n    }\r\n\r\n    /**\r\n     * Creates a clone of this Rectangle\r\n     *\r\n     * @return {Rectangle} a copy of the rectangle.\r\n     */\r\n    clone()\r\n    {\r\n        return new Rectangle(this.x, this.y, this.width, this.height);\r\n    }\r\n\r\n    /**\r\n     * Copies the passed rectangle into this one.\r\n     *\r\n     * @param {Rectangle} rectangle - The rectangle to copy from.\r\n     * @return {Rectangle} returns itself.\r\n     */\r\n    copy(rectangle)\r\n    {\r\n        this.x = rectangle.x;\r\n        this.y = rectangle.y;\r\n        this.width = rectangle.width;\r\n        this.height = rectangle.height;\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Checks whether the x and y coordinates given are contained within this Rectangle\r\n     *\r\n     * @param {number} x - The X coordinate of the point to test.\r\n     * @param {number} y - The Y coordinate of the point to test.\r\n     * @return {boolean} Whether the x/y coordinates are within this Rectangle.\r\n     */\r\n    contains(x, y)\r\n    {\r\n        if (this.width <= 0 || this.height <= 0)\r\n        {\r\n            return false;\r\n        }\r\n\r\n        if (x >= this.x && x < this.x + this.width)\r\n        {\r\n            if (y >= this.y && y < this.y + this.height)\r\n            {\r\n                return true;\r\n            }\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Grows the rectangle to contain the passed rectangle. Expanding size\r\n     * and reducing position as necessary.\r\n     *\r\n     * For example, given these rectangles:\r\n     *\r\n     * ```\r\n     * -----------------\r\n     * | 1 ----------  |\r\n     * |   | 2      |  |\r\n     * ----|--------|--\r\n     *     ----------\r\n     * ```\r\n     *\r\n     * If we call `rect1.union(rect2)` we get this rectangle:\r\n     *\r\n     * ```\r\n     * -----------------\r\n     * | 1             |\r\n     * |               |\r\n     * |               |\r\n     * ----------------\r\n     * ```\r\n     *\r\n     * This happens even if they do not intersect.\r\n     *\r\n     * @param {Rectangle} rect -The rectangle to union with.\r\n     * @return {Rectangle} Returns itself.\r\n     */\r\n    union(rect)\r\n    {\r\n        const x = this.x;\r\n        const y = this.y;\r\n\r\n        this.x = Math.min(rect.x, this.x);\r\n        this.y = Math.min(rect.y, this.y);\r\n\r\n        this.width = Math.max(rect.x + rect.width, x + this.width) - this.x;\r\n        this.height = Math.max(rect.y + rect.height, y + this.height) - this.y;\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Sets this rectangle to the intersection of this rectangle and the passed one.\r\n     *\r\n     * For example, given these rectangles:\r\n     *\r\n     * ```\r\n     * -----------------\r\n     * | 1 ----------  |\r\n     * |   | 2      |  |\r\n     * ----|--------|--\r\n     *     ----------\r\n     * ```\r\n     *\r\n     * If we call `rect1.intersection(rect2)` we get this rectangle:\r\n     *\r\n     * ```\r\n     *\r\n     *     ----------\r\n     *     | 1      |\r\n     *     ---------\r\n     *\r\n     * ```\r\n     *\r\n     * This happens even if they do not intersect.\r\n     *\r\n     * @param {Rectangle} rect -The rectangle to union with.\r\n     * @return {Rectangle} Returns itself.\r\n     */\r\n    intersection(rect)\r\n    {\r\n        const x = this.x;\r\n        const y = this.y;\r\n\r\n        this.x = Math.max(rect.x, this.x);\r\n        this.y = Math.max(rect.y, this.y);\r\n\r\n        this.width = Math.min(rect.x + rect.width, x + this.widthR) - this.x;\r\n        this.height = Math.min(rect.y + rect.height, y + this.height) - this.y;\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Grows the rectangle on all sides. The center stays constant.\r\n     *\r\n     * For example, this rectangle:\r\n     *\r\n     * ```\r\n     *     ----------\r\n     *     |        |\r\n     *     |        |\r\n     *     ----------\r\n     * ```\r\n     *\r\n     * After a call to `inflate(5, 5)` becomes something like:\r\n     *\r\n     * ```\r\n     *    ---------------\r\n     *    |             |\r\n     *    |             |\r\n     *    |             |\r\n     *    ---------------\r\n     * ```\r\n     *\r\n     * Notice that the position (top-left) doesn't stay in the same\r\n     * place, it moved back slightly.\r\n     *\r\n     * @param {number} dx - The amount to \"grow\" in the X direction.\r\n     * @param {number} dy - The amount to \"grow\" in the Y direction.\r\n     * @return {Rectangle} returns itself.\r\n     */\r\n    inflate(dx = 0, dy = 0)\r\n    {\r\n        this.x -= dx;\r\n        this.y -= dy;\r\n        this.width += dx * 2;\r\n        this.height += dy * 2;\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Manipulates this rectangle so that becomes the same size as the passed rectangle.\r\n     * The big difference between this method and just copying the values of the other\r\n     * rectangle is that this ensures that the width/height never goes below 0.\r\n     *\r\n     * @param {Rectangle} rectangle - The rectangle to grow to encompass.\r\n     * @return {Rectangle} returns itself.\r\n     */\r\n    fit(rectangle)\r\n    {\r\n        if (this.x < rectangle.x)\r\n        {\r\n            this.width += this.x;\r\n\r\n            if (this.width < 0) this.width = 0;\r\n\r\n            this.x = rectangle.x;\r\n        }\r\n\r\n        if (this.y < rectangle.y)\r\n        {\r\n            this.height += this.y;\r\n\r\n            if (this.height < 0) this.height = 0;\r\n\r\n            this.y = rectangle.y;\r\n        }\r\n\r\n        if (this.x + this.width > rectangle.x + rectangle.width)\r\n        {\r\n            this.width = rectangle.width - this.x;\r\n\r\n            if (this.width < 0) this.width = 0;\r\n        }\r\n\r\n        if (this.y + this.height > rectangle.y + rectangle.height)\r\n        {\r\n            this.height = rectangle.height - this.y;\r\n\r\n            if (this.height < 0) this.height = 0;\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Checks if the passed rectangle is equal to this one (has the same points).\r\n     *\r\n     * @param {Rectangle} rectangle - The rectangle to check for equality.\r\n     * @return {boolean} Whether rectangle are equal.\r\n     */\r\n    equals(rectangle)\r\n    {\r\n        return !!rectangle\r\n            && rectangle.x === this.x\r\n            && rectangle.y === this.y\r\n            && rectangle.width === this.width\r\n            && rectangle.height === this.height;\r\n    }\r\n}\r\n\r\n/**\r\n * A constant empty rectangle.\r\n *\r\n * @static\r\n * @constant\r\n */\r\nRectangle.EMPTY = new Rectangle();\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/shapes/src/Rectangle.js\n **/","import BoundingBox from './BoundingBox';\r\n\r\nexport default function BoundsComponent(Base)\r\n{\r\n    /**\r\n     * @class BoundsComponent\r\n     * @memberof shapes\r\n     */\r\n    return class extends Base\r\n    {\r\n        /**\r\n         *\r\n         */\r\n        constructor()\r\n        {\r\n            super(...arguments); // eslint-disable-line prefer-rest-params\r\n\r\n            /**\r\n             * The bounding box of this scene object.\r\n             *\r\n             * @private\r\n             * @member {BoundingBox}\r\n             */\r\n            this._bounds = new BoundingBox();\r\n        }\r\n\r\n        /**\r\n         * Returns the bounding box of this scene object.\r\n         *\r\n         * @return {BoundingBox} The object's bounding box.\r\n         */\r\n        getBounds()\r\n        {\r\n            this._updateBounds();\r\n\r\n            return this._bounds;\r\n        }\r\n\r\n        /**\r\n         * Updates the bounds of this object.\r\n         *\r\n         * @protected\r\n         */\r\n        _updateBounds()\r\n        {\r\n            this._bounds.clear();\r\n        }\r\n    };\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/shapes/src/BoundsComponent.js\n **/","import { math } from '@fae/core';\r\n\r\n/**\r\n * A simple class representing a polygon.\r\n *\r\n * @class\r\n * @memberof shapes\r\n */\r\nexport default class Polygon\r\n{\r\n    /**\r\n     * Constructs a polygon.\r\n     *\r\n     * @param {Vector2d[]|number[]} points - This can be an array of `Vector2d`s that\r\n     *  form the polygon, a flat array of numbers that will be interpreted as [x,y, x,y, ...], or the arguments\r\n     *  passed can be all the points of the polygon e.g. `new Polygon(new Vector2d(), new Vector2d(), ...)`,\r\n     *  or the arguments passed can be flat x,y values e.g. `new Polygon(x,y, x,y, x,y, ...)` where `x`\r\n     *  and `y` are Numbers.\r\n     */\r\n    constructor(...points)\r\n    {\r\n        // if the first param is an array, ignore the rest.\r\n        if (Array.isArray(points[0])) points = points[0];\r\n\r\n        // if this is an array of Vector2d, convert it to a flat array of numbers\r\n        if (points[0] instanceof math.Vector2d)\r\n        {\r\n            const p = [];\r\n\r\n            for (let i = 0; i < points.length; ++i)\r\n            {\r\n                p.push(points[i].x, points[i].y);\r\n            }\r\n\r\n            points = p;\r\n        }\r\n\r\n        /**\r\n         * Whether or not this polygon is a \"closed\" polygon.\r\n         *\r\n         * @member {boolean}\r\n         */\r\n        this.closed = true;\r\n\r\n        /**\r\n         * An array of the points of this polygon\r\n         *\r\n         * @member {number[]}\r\n         */\r\n        this.points = points;\r\n    }\r\n\r\n    /**\r\n     * Creates a clone of this polygon\r\n     *\r\n     * @return {Polygon} a copy of the polygon\r\n     */\r\n    clone()\r\n    {\r\n        return new Polygon(this.points.slice());\r\n    }\r\n\r\n    /**\r\n     * Closes the polygon, adding points if necessary.\r\n     */\r\n    close()\r\n    {\r\n        const points = this.points;\r\n\r\n        // close the poly if the value is true!\r\n        if (points[0] !== points[points.length - 2] || points[1] !== points[points.length - 1])\r\n        {\r\n            points.push(points[0], points[1]);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Checks whether the x and y coordinates passed to this function are contained within this polygon\r\n     *\r\n     * @param {number} x - The X coordinate of the point to test\r\n     * @param {number} y - The Y coordinate of the point to test\r\n     * @return {boolean} Whether the x/y coordinates are within this polygon\r\n     */\r\n    contains(x, y)\r\n    {\r\n        let inside = false;\r\n\r\n        // use some raycasting to test hits\r\n        // https://github.com/substack/point-in-polygon/blob/master/index.js\r\n        const length = this.points.length / 2;\r\n\r\n        for (let i = 0, j = length - 1; i < length; j = i++)\r\n        {\r\n            const xi = this.points[i * 2];\r\n            const yi = this.points[(i * 2) + 1];\r\n            const xj = this.points[j * 2];\r\n            const yj = this.points[(j * 2) + 1];\r\n\r\n            const intersect = ((yi > y) !== (yj > y))\r\n                && (x < (((xj - xi) * (y - yi)) / (yj - yi)) + xi);\r\n\r\n            if (intersect)\r\n            {\r\n                inside = !inside;\r\n            }\r\n        }\r\n\r\n        return inside;\r\n    }\r\n\r\n    /**\r\n     * Checks if the passed polygon is equal to this one (has the same points).\r\n     *\r\n     * @param {Polygon} polygon - The polygon to check for equality.\r\n     * @return {boolean} Whether polygons are equal.\r\n     */\r\n    equals(polygon)\r\n    {\r\n        if (!polygon || this.points.length !== polygon.points.length)\r\n        {\r\n            return false;\r\n        }\r\n\r\n        for (let i = 0; i < this.points.length; ++i)\r\n        {\r\n            if (this.points[i] !== polygon.points[i])\r\n            {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        return true;\r\n    }\r\n}\r\n\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/shapes/src/Polygon.js\n **/","import BoundsComponent from './BoundsComponent';\r\n\r\nexport default function SpriteBoundsComponent(Base)\r\n{\r\n    /**\r\n     * Component that adds sprite bounds calculations for sprite assemblages that also\r\n     * want to include the BoundsComponent.\r\n     *\r\n     * @class SpriteBoundsComponent\r\n     * @memberof sprites\r\n     */\r\n    return class extends BoundsComponent(Base)\r\n    {\r\n        /**\r\n         * Updates the bounds of this sprite.\r\n         *\r\n         * @private\r\n         */\r\n        _updateBounds()\r\n        {\r\n            this._bounds.clear();\r\n\r\n            if (!this.visible || !this._texture || !this._texture.ready) return;\r\n\r\n            const trim = this._texture.trim;\r\n            const orig = this._texture.orig;\r\n\r\n            if (!trim || (trim.width === orig.width && trim.height === orig.height))\r\n            {\r\n                this._bounds.addQuad(this.vertexData);\r\n            }\r\n            else\r\n            {\r\n                const wt = this.transform.worldTransform;\r\n                const a = wt.a;\r\n                const b = wt.b;\r\n                const c = wt.c;\r\n                const d = wt.d;\r\n                const tx = wt.tx;\r\n                const ty = wt.ty;\r\n\r\n                const w0 = (orig.width) * (1 - this._anchorX);\r\n                const w1 = (orig.width) * -this._anchorX;\r\n\r\n                const h0 = orig.height * (1 - this._anchorY);\r\n                const h1 = orig.height * -this._anchorY;\r\n\r\n                this._bounds.addQuad([\r\n                    (a * w1) + (c * h1) + tx,\r\n                    (d * h1) + (b * w1) + ty,\r\n\r\n                    (a * w0) + (c * h1) + tx,\r\n                    (d * h1) + (b * w0) + ty,\r\n\r\n                    (a * w0) + (c * h0) + tx,\r\n                    (d * h0) + (b * w0) + ty,\r\n\r\n                    (a * w1) + (c * h0) + tx,\r\n                    (d * h0) + (b * w1) + ty,\r\n                ]);\r\n            }\r\n        }\r\n    };\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/shapes/src/SpriteBoundsComponent.js\n **/","import { ASSERT } from '../debug';\r\n\r\nconst rgxRgbString = /^rgba?\\(([\\d\\.]+), ?([\\d\\.]+), ?([\\d\\.]+)(?:, ?([\\d\\.]+))\\);?$/i;\r\nconst rgxHexShortString = /^(?:#|0x)?([a-f\\d])([a-f\\d])([a-f\\d])$/i;\r\nconst rgxHexFullString = /^(?:#|0x)?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i;\r\n\r\n/**\r\n * Color container. Helps with constructing, converting, manipulating, and just\r\n * overall dealing with colors. Each component (r/g/b/a) are numbers in the range\r\n * [0...255].\r\n *\r\n * @class\r\n * @memberof util\r\n */\r\nexport default class Color\r\n{\r\n    /**\r\n     * Creates a new color.\r\n     *\r\n     * @param {number} r - The red component.\r\n     * @param {number} g - The green component.\r\n     * @param {number} b - The blue component.\r\n     * @param {boolean} normalized - Whether the values are normalized or not.\r\n     */\r\n    constructor(r = 0, g = 0, b = 0, normalized = false)\r\n    {\r\n        this.normalized = normalized;\r\n\r\n        this._red = r;\r\n        this._green = g;\r\n        this._blue = b;\r\n    }\r\n\r\n    /**\r\n     * Creates a color from a value in the form 0xRRGGBB.\r\n     *\r\n     * @param {number} num - The color value as a number.\r\n     * @return {Color} The new color.\r\n     */\r\n    static fromRgb(num)\r\n    {\r\n        const c = new Color();\r\n\r\n        c.rgb = num;\r\n\r\n        return c;\r\n    }\r\n\r\n    /**\r\n     * Creates a color from an array of RGB values.\r\n     *\r\n     * @param {number[]} components - The color components.\r\n     * @param {boolean} normalized - Whether the values are normalized or not.\r\n     * @return {Color} The new color.\r\n     */\r\n    static fromArray(components, normalized = false)\r\n    {\r\n        ASSERT(components.length > 2, 'Component array passed to Color.fromArray() is too short.');\r\n        const out = new Color(0, 0, 0, normalized);\r\n\r\n        out.red = components[0];\r\n        out.green = components[1];\r\n        out.blue = components[2];\r\n\r\n        return out;\r\n    }\r\n\r\n    /**\r\n     * Creates a color from a string.\r\n     *\r\n     * @param {string} str - The string representation of this color. e.g. \"#AABBCC\" or \"rgb(255, 255, 255)\"\r\n     * @return {Color} The new color.\r\n     */\r\n    static fromString(str)\r\n    {\r\n        const out = new Color();\r\n\r\n        if (!str) return out;\r\n\r\n        const firstChars = str.substring(0, 3);\r\n\r\n        // assume \"rgb()\" or \"rgba()\" form\r\n        if (firstChars === 'rgb')\r\n        {\r\n            const values = rgxRgbString.exec(str);\r\n\r\n            if (values)\r\n            {\r\n                out.red = parseFloat(values[1], 10);\r\n                out.green = parseFloat(values[2], 10);\r\n                out.blue = parseFloat(values[3], 10);\r\n            }\r\n        }\r\n        // assume hex form.\r\n        else\r\n        {\r\n            // Expand shorthand form (e.g. \"03F\") to full form (e.g. \"0033FF\")\r\n            str = str.replace(rgxHexShortString, (m, r, g, b) => (r + r + g + g + b + b));\r\n\r\n            const values = rgxHexFullString.exec(str);\r\n\r\n            if (values)\r\n            {\r\n                out.red = parseInt(values[1], 16);\r\n                out.green = parseInt(values[2], 16);\r\n                out.blue = parseInt(values[3], 16);\r\n            }\r\n        }\r\n\r\n        return out;\r\n    }\r\n\r\n    /**\r\n     * Creates a random color.\r\n     *\r\n     * @return {Color} The new color.\r\n     */\r\n    static randomColor()\r\n    {\r\n        const out = new Color();\r\n\r\n        out.randomize();\r\n\r\n        return out;\r\n    }\r\n\r\n    /**\r\n     * The maximum value of a component.\r\n     */\r\n    get max()\r\n    {\r\n        return this.normalized ? 1 : 255;\r\n    }\r\n\r\n    /**\r\n     * Value of the color as a number in 0xBBGGRR format.\r\n     *\r\n     * @member {number}\r\n     */\r\n    get bgr()\r\n    {\r\n        return this._red + (this._green << 8) + (this._blue << 16);\r\n    }\r\n\r\n    /**\r\n     * Value of the color as a number in 0xRRGGBB format.\r\n     *\r\n     * @member {number}\r\n     */\r\n    get rgb()\r\n    {\r\n        return this.blue + (this.green << 8) + (this.red << 16);\r\n    }\r\n\r\n    /**\r\n     * Set the value of the color from a number.\r\n     *\r\n     * @param {number} v - The value to set to.\r\n     */\r\n    set rgb(v)\r\n    {\r\n        ASSERT(v >= 0 && v <= 0xffffff, `Value out of range for color: 0x${v.toString(16)} (min: 0, max: 0xffffff).`);\r\n\r\n        const factor = this.normalized ? 255 : 1;\r\n\r\n        this._red = (v >> 16) / factor;\r\n        this._green = ((v & 0x00ff00) >> 8) / factor;\r\n        this._blue = ((v & 0x0000ff)) / factor;\r\n    }\r\n\r\n    /**\r\n     * Value of the red component of this color.\r\n     *\r\n     * @member {number}\r\n     */\r\n    get red()\r\n    {\r\n        return this._red;\r\n    }\r\n\r\n    /**\r\n     * Set the value of the red component of this color.\r\n     *\r\n     * @param {number} v - The value to set to.\r\n     */\r\n    set red(v)\r\n    {\r\n        ASSERT(v >= 0 && v <= this.max, `Value out of range for RED component: ${v} (min: 0, max: ${this.max}).`);\r\n        this._red = v;\r\n    }\r\n\r\n    /**\r\n     * Value of the green component of this color.\r\n     *\r\n     * @member {number}\r\n     */\r\n    get green()\r\n    {\r\n        return this._green;\r\n    }\r\n\r\n    /**\r\n     * Set the value of the green component of this color.\r\n     *\r\n     * @param {number} v - The value to set to.\r\n     */\r\n    set green(v)\r\n    {\r\n        ASSERT(v >= 0 && v <= this.max, `Value out of range for GREEN component: ${v} (min: 0, max: ${this.max}).`);\r\n        this._green = v;\r\n    }\r\n\r\n    /**\r\n     * Value of the blue component of this color.\r\n     *\r\n     * @member {number}\r\n     */\r\n    get blue()\r\n    {\r\n        return this._blue;\r\n    }\r\n\r\n    /**\r\n     * Set the value of the blue component of this color.\r\n     *\r\n     * @param {number} v - The value to set to.\r\n     */\r\n    set blue(v)\r\n    {\r\n        ASSERT(v >= 0 && v <= this.max, `Value out of range for BLUE component: ${v} (min: 0, max: ${this.max}).`);\r\n        this._blue = v;\r\n    }\r\n\r\n    /**\r\n     * Mixes this color with the passed one.\r\n     *\r\n     * @param {Color} color - The color to mix with.\r\n     * @return {Color} returns itself.\r\n     */\r\n    mix(color)\r\n    {\r\n        this.red = (this.red + color.red) / 2;\r\n        this.green = (this.green + color.green) / 2;\r\n        this.blue = (this.blue + color.blue) / 2;\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Randomizes the color components to create a random color.\r\n     *\r\n     * @param {number} alpha - An override for the alpha value, if set the color will use\r\n     * this instead of a random value.\r\n     * @return {Color} returns itself.\r\n     */\r\n    randomize()\r\n    {\r\n        this.red = Math.floor(Math.random() * (this.max + 1));\r\n        this.green = Math.floor(Math.random() * (this.max + 1));\r\n        this.blue = Math.floor(Math.random() * (this.max + 1));\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Normalizes the color components.\r\n     *\r\n     * @return {Color} returns itself.\r\n     */\r\n    normalize()\r\n    {\r\n        if (!this.normalized)\r\n        {\r\n            this.red /= this.max;\r\n            this.green /= this.max;\r\n            this.blue /= this.max;\r\n\r\n            this.normalized = true;\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Denormalizes the color components.\r\n     *\r\n     * @return {Color} returns itself.\r\n     */\r\n    denormalize()\r\n    {\r\n        if (this.normalized)\r\n        {\r\n            this.normalized = false;\r\n\r\n            this.red *= this.max;\r\n            this.green *= this.max;\r\n            this.blue *= this.max;\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Creates a new color with the same values.\r\n     *\r\n     * @return {Color} The cloned color.\r\n     */\r\n    clone()\r\n    {\r\n        return new Color(this.red, this.green, this.blue, this.normalized);\r\n    }\r\n\r\n    /**\r\n     * Copies another color's values into this one.\r\n     *\r\n     * @param {Color} color - The color to copy.\r\n     * @return {Color} returns itself.\r\n     */\r\n    copy(color)\r\n    {\r\n        this.red = color.red;\r\n        this.green = color.green;\r\n        this.blue = color.blue;\r\n        this.normalized = color.normalized;\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Checks for equality with another color.\r\n     *\r\n     * @param {Color} color - The color to check equality against.\r\n     * @param {boolean} ignoreAlpha -\r\n     * @return {boolean} True if they are equal.\r\n     */\r\n    equals(color)\r\n    {\r\n        if (!color) return false;\r\n\r\n        if (this.normalized !== color.normalized)\r\n        {\r\n            Color._tempColor.copy(color);\r\n            color = Color._tempColor;\r\n\r\n            if (this.normalized)\r\n            {\r\n                color.normalize();\r\n            }\r\n            else\r\n            {\r\n                color.denormalize();\r\n            }\r\n        }\r\n\r\n        return this.red === color.red\r\n            && this.green === color.green\r\n            && this.blue === color.blue;\r\n    }\r\n}\r\n\r\nColor.BLACK = new Color(0, 0, 0);\r\nColor.WHITE = new Color(255, 255, 255);\r\n\r\nColor.RED = new Color(255, 0, 0);\r\nColor.GREEN = new Color(0, 255, 0);\r\nColor.BLUE = new Color(0, 0, 255);\r\n\r\nColor._tempColor = new Color();\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/core/src/util/Color.js\n **/","import Flags from '../util/Flags';\r\n\r\n/**\r\n * @class\r\n * @memberof render\r\n */\r\nexport default class RenderState\r\n{\r\n    /**\r\n     * @param {Renderer} renderer - The renderer this object holds state for.\r\n     */\r\n    constructor(renderer)\r\n    {\r\n        /**\r\n         * The renderer this object holds state for.\r\n         *\r\n         * @member {Renderer}\r\n         */\r\n        this.renderer = renderer;\r\n\r\n        /**\r\n         * Set of flags determining which features are active.\r\n         *\r\n         * @member {Flags}\r\n         */\r\n        this.stateFlags = RenderState.defaultStateFlags.clone();\r\n\r\n        /**\r\n         * The currently active blend mode.\r\n         *\r\n         * @member {BlendMode}\r\n         */\r\n        this.blendMode = null;\r\n\r\n        /**\r\n         * The currently active shader.\r\n         *\r\n         * @member {Shader}\r\n         */\r\n        this.shader = null;\r\n\r\n        /**\r\n         * The currently active render target.\r\n         *\r\n         * @member {RenderTarget}\r\n         */\r\n        this.target = null;\r\n\r\n        /**\r\n         * The native VAO Extension if this context supports it.\r\n         *\r\n         * @member {*}\r\n         */\r\n        this.nativeVaoExtension = (\r\n            this.renderer.gl.getExtension('OES_vertex_array_object')\r\n            || this.renderer.gl.getExtension('MOZ_OES_vertex_array_object')\r\n            || this.renderer.gl.getExtension('WEBKIT_OES_vertex_array_object')\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Sets the given BlendMode as the active blend mode.\r\n     *\r\n     * @param {BlendMode} mode - A BlendMode instance to enable.\r\n     * @param {boolean} force - Skip checks and always set value.\r\n     * @return {boolean} True if the blend mode changed, false otherwise.\r\n     */\r\n    setBlendMode(mode, force = false)\r\n    {\r\n        const equal = this.blendMode ? this.blendMode.equals(mode) : this.blendMode === mode;\r\n\r\n        if (!force && equal) return false;\r\n\r\n        this.blendMode = mode;\r\n\r\n        if (mode)\r\n        {\r\n            mode.enable(this.renderer.gl);\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * Sets the given Shader as the active shader.\r\n     *\r\n     * @param {Shader} shader - A Shader instance to enable.\r\n     * @param {boolean} force - Skip checks and always set value.\r\n     * @return {boolean} True if the blend mode changed, false otherwise.\r\n     */\r\n    setShader(shader, force = false)\r\n    {\r\n        if (!force && this.shader === shader) return false;\r\n\r\n        this.shader = shader;\r\n\r\n        if (shader)\r\n        {\r\n            shader.bind();\r\n\r\n            // automatically set the projection matrix\r\n            if (this.target && shader.uniforms.uProjectionMatrix)\r\n            {\r\n                shader.uniforms.uProjectionMatrix = this.target.projectionMatrix.toMat3Array();\r\n            }\r\n        }\r\n        else\r\n        {\r\n            this.renderer.gl.useProgram(null);\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * Sets the given RenderTarget as the active target.\r\n     *\r\n     * @param {RenderTarget} target - A RenderTarget instance to enable.\r\n     * @param {boolean} force - Skip checks and always set value.\r\n     * @return {boolean} True if the blend mode changed, false otherwise.\r\n     */\r\n    setRenderTarget(target, force = false)\r\n    {\r\n        if (!force && this.target === target) return false;\r\n\r\n        this.target = target;\r\n\r\n        if (target)\r\n        {\r\n            target.activate();\r\n\r\n            if (this.shader && this.shader.uniforms.uProjectionMatrix)\r\n            {\r\n                this.shader.uniforms.uProjectionMatrix = target.projectionMatrix.toMat3Array();\r\n            }\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * Sets whether gl.BLEND is enabled or not.\r\n     *\r\n     * @param {boolean} enabled - Whether or not to enable.\r\n     * @return {boolean} True if the value changed, false otherwise.\r\n     */\r\n    enableBlend(enabled = true)\r\n    {\r\n        return this.enable(RenderState.FLAG.BLEND, enabled);\r\n    }\r\n\r\n    /**\r\n     * Sets whether gl.DEPTH_TEST is enabled or not.\r\n     *\r\n     * @param {boolean} enabled - Whether or not to enable.\r\n     * @return {boolean} True if the value changed, false otherwise.\r\n     */\r\n    enableDepthTest(enabled = true)\r\n    {\r\n        return this.enable(RenderState.FLAG.DEPTH_TEST, enabled);\r\n    }\r\n\r\n    /**\r\n     * Sets whether gl.CULL_FACE is enabled or not.\r\n     *\r\n     * @param {boolean} enabled - Whether or not to enable.\r\n     * @return {boolean} True if the value changed, false otherwise.\r\n     */\r\n    enableCullFace(enabled = true)\r\n    {\r\n        return this.enable(RenderState.FLAG.CULL_FACE, enabled);\r\n    }\r\n\r\n    /**\r\n     * Sets whether gl.FRONT_FACE is enabled or not.\r\n     *\r\n     * @param {boolean} enabled - Whether or not to enable.\r\n     * @return {boolean} True if the value changed, false otherwise.\r\n     */\r\n    enableFrontFace(enabled = true)\r\n    {\r\n        return this.enable(RenderState.FLAG.FRONT_FACE, enabled);\r\n    }\r\n\r\n    /**\r\n     * Sets whether a feature is enabled or not.\r\n     *\r\n     * @param {number} flag - The flag to enable/disable.\r\n     * @param {boolean} enabled - Whether or not to enable.\r\n     * @param {boolean} force - Skip checks and always set value.\r\n     * @return {boolean} True if the value changed, false otherwise.\r\n     */\r\n    enable(flag, enabled = true, force = false)\r\n    {\r\n        if (!force && this.stateFlags.is(flag, enabled))\r\n        {\r\n            return false;\r\n        }\r\n\r\n        this.stateFlags.set(flag, enabled);\r\n\r\n        if (flag === RenderState.FLAG.FRONT_FACE)\r\n        {\r\n            if (enabled)\r\n            {\r\n                this.renderer.gl.frontFace(WebGLRenderingContext.CW);\r\n            }\r\n            else\r\n            {\r\n                this.renderer.gl.frontFace(WebGLRenderingContext.CCW);\r\n            }\r\n        }\r\n        else if (enabled)\r\n        {\r\n            this.renderer.gl.enable(RenderState.FLAG_GL_MAP[flag]);\r\n        }\r\n        else\r\n        {\r\n            this.renderer.gl.disable(RenderState.FLAG_GL_MAP[flag]);\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * Resets the state and disables the VAOs.\r\n     *\r\n     */\r\n    reset()\r\n    {\r\n        // unbind any VAO if they exist..\r\n        if (this.nativeVaoExtension)\r\n        {\r\n            this.nativeVaoExtension.bindVertexArrayOES(null);\r\n        }\r\n\r\n        // reset flipY\r\n        this.renderer.gl.pixelStorei(this.renderer.gl.UNPACK_FLIP_Y_WEBGL, false);\r\n\r\n        // force setting each state flag to default values\r\n        Object.keys(RenderState.FLAG).forEach((k) =>\r\n        {\r\n            this.enable(RenderState.FLAG[k], RenderState.defaultStateFlags.isSet(RenderState.FLAG[k]), true);\r\n        });\r\n\r\n        // this.setBlendMode(BlendMode.NORMAL, true);\r\n        this.setShader(null, true);\r\n        this.setRenderTarget(null, true);\r\n    }\r\n\r\n    /**\r\n     * Destroys the state data.\r\n     */\r\n    destroy()\r\n    {\r\n        this.reset();\r\n\r\n        this.renderer = null;\r\n        this.stateFlags = null;\r\n        this.blendMode = null;\r\n        this.shader = null;\r\n        this.target = null;\r\n        this.nativeVaoExtension = null;\r\n    }\r\n}\r\n\r\n/**\r\n * Flags on state that enable/disable features\r\n *\r\n * @static\r\n * @constant\r\n * @memberof RenderState\r\n * @type {object}\r\n * @property {number} BLEND\r\n * @property {number} DEPTH_TEST\r\n * @property {number} FRONT_FACE\r\n * @property {number} CULL_FACE\r\n */\r\nRenderState.FLAG = {\r\n    BLEND:      Flags.F(0),\r\n    DEPTH_TEST: Flags.F(1),\r\n    FRONT_FACE: Flags.F(2),\r\n    CULL_FACE:  Flags.F(3),\r\n};\r\n\r\n/**\r\n * Maps feature flags to the GL constant it represents.\r\n *\r\n * @static\r\n * @constant\r\n * @memberof RenderState\r\n * @type {object<number, number>}\r\n */\r\nRenderState.FLAG_GL_MAP = {\r\n    [RenderState.FLAG.BLEND]:       WebGLRenderingContext.BLEND,\r\n    [RenderState.FLAG.DEPTH_TEST]:  WebGLRenderingContext.DEPTH_TEST,\r\n    [RenderState.FLAG.FRONT_FACE]:  WebGLRenderingContext.FRONT_FACE,\r\n    [RenderState.FLAG.CULL_FACE]:   WebGLRenderingContext.CULL_FACE,\r\n};\r\n\r\nRenderState.defaultStateFlags = new Flags(RenderState.FLAG.BLEND);\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/core/src/render/RenderState.js\n **/","/**\r\n * A helper class for managing a bitset of flags.\r\n *\r\n * @class\r\n * @memberof util\r\n */\r\nexport default class Flags\r\n{\r\n    /**\r\n     * @param {number} initialValue - The starting value of the data.\r\n     */\r\n    constructor(initialValue = 0)\r\n    {\r\n        /**\r\n         * The value of the flags underlying number.\r\n         *\r\n         * @member {number}\r\n         */\r\n        this.value = initialValue | 0;\r\n    }\r\n\r\n    /**\r\n     * Sets the bits masked by `flag`.\r\n     *\r\n     * @param {number} flag - The bits to set.\r\n     * @param {boolean} on - Whether to set or clear the bits.\r\n     */\r\n    set(flag, on = true)\r\n    {\r\n        if (on) this.value |= flag;\r\n        else this.clear(flag);\r\n    }\r\n\r\n    /**\r\n     * Clears the bits masked by `flag`.\r\n     *\r\n     * @param {number} flag - The bits to clear.\r\n     */\r\n    clear(flag)\r\n    {\r\n        this.value &= ~flag;\r\n    }\r\n\r\n    /**\r\n     * Checks if the flag is set to the value.\r\n     *\r\n     * @param {number} flag - The bits to check.\r\n     * @param {boolean} on - Whether to check on or off.\r\n     * @return {boolean} True if it is the pased value, false otherwise.\r\n     */\r\n    is(flag, on)\r\n    {\r\n        return on ? this.isSet(flag) : this.isUnset(flag);\r\n    }\r\n\r\n    /**\r\n     * Checks if the flag is set.\r\n     *\r\n     * @param {number} flag - The bits to check.\r\n     * @return {boolean} True if it is set, false otherwise.\r\n     */\r\n    isSet(flag)\r\n    {\r\n        return (this.value & flag) !== 0;\r\n    }\r\n\r\n    /**\r\n     * Checks if the flag is unset.\r\n     *\r\n     * @param {number} flag - The bits to check.\r\n     * @return {boolean} True if it is unset, false otherwise.\r\n     */\r\n    isUnset(flag)\r\n    {\r\n        return (this.value & flag) === 0;\r\n    }\r\n\r\n    /**\r\n     * Copies the values from another Flags object into this one.\r\n     *\r\n     * @param {Flags} flags - The object to copy from.\r\n     * @return {Flags} Returns itself.\r\n     */\r\n    copy(flags)\r\n    {\r\n        this.value = flags.value;\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Creates a new flags helper from a default value.\r\n     *\r\n     * @return {Flags} The new object.\r\n     */\r\n    clone()\r\n    {\r\n        return new Flags(this.value);\r\n    }\r\n}\r\n\r\n/**\r\n * Helper to create a bit-shifted flag.\r\n *\r\n * @static\r\n * @method\r\n * @memberof Flags\r\n * @param {number} n - The index of the flag.\r\n * @return {number} The flag value.\r\n */\r\nFlags.F = (n) => (1 << n);\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/core/src/util/Flags.js\n **/","/**\r\n * An ObjectRenderer is any renderer that is capable of rendering a single entity, or\r\n * a batch of similar entities.\r\n *\r\n * @class\r\n * @abstract\r\n * @memberof render\r\n */\r\nexport default class ObjectRenderer\r\n{\r\n    /**\r\n     * @param {Renderer} renderer - The renderer this manager works for.\r\n     */\r\n    constructor(renderer)\r\n    {\r\n        /**\r\n         * The renderer this manager works for.\r\n         *\r\n         * @member {Renderer}\r\n         */\r\n        this.renderer = renderer;\r\n    }\r\n\r\n    /**\r\n     * Starts the renderer, called when this becomes the active object renderer.\r\n     *\r\n     */\r\n    start()\r\n    {\r\n        // no base implementation\r\n    }\r\n\r\n    /**\r\n     * Stops the renderer, called when this is no longer the active object renderer.\r\n     *\r\n     */\r\n    stop()\r\n    {\r\n        // no base implementation\r\n    }\r\n\r\n    /**\r\n     * Renders an object, usually called by a system in the update loop.\r\n     *\r\n     * @param {*} object - The object to render.\r\n     */\r\n    render(object) // eslint-disable-line no-unused-vars\r\n    {\r\n        // no base implementation\r\n    }\r\n\r\n    /**\r\n     * Destroys the object renderer instance.\r\n     *\r\n     */\r\n    destroy()\r\n    {\r\n        this.renderer = null;\r\n    }\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/core/src/render/ObjectRenderer.js\n **/","/** @namespace util */\r\n\r\nimport GLContext from '../gl/GLContext';\r\n\r\nimport { ASSERT } from '../debug';\r\n\r\nlet nextUid = 0;\r\n\r\n// reexport some utils\r\nexport { default as Color } from './Color';\r\nexport { default as Buffer } from './Buffer';\r\nexport { default as BlendMode } from './BlendMode';\r\nexport { default as Flags } from './Flags';\r\n\r\n/**\r\n * Logs an error to the console.\r\n *\r\n * @memberof util\r\n * @param {...*} things to pass into `console.error`.\r\n */\r\nexport function error(...args)\r\n{\r\n    args[0] = `[Fae Error] ${args[0]}`;\r\n\r\n    console.error(...args); // eslint-disable-line no-console\r\n}\r\n\r\n/**\r\n * Logs a message to the console.\r\n *\r\n * @memberof util\r\n * @param {...*} things to pass into `console.log`.\r\n */\r\nexport function log(...args)\r\n{\r\n    args[0] = `[Fae] ${args[0]}`;\r\n\r\n    console.log(...args); // eslint-disable-line no-console\r\n}\r\n\r\n/**\r\n * Gets the next unique id.\r\n *\r\n * @memberof util\r\n * @return {number} The nexst unique id.\r\n */\r\nexport function uid()\r\n{\r\n    return nextUid++;\r\n}\r\n\r\n/**\r\n * Fast replacement for splice that quickly removes elements from an array.\r\n *\r\n * @memberof util\r\n * @param {Array<*>} array - The array to manipulate.\r\n * @param {number} startIdx - The starting index.\r\n * @param {number} removeCount - The number of elements to remove.\r\n */\r\nexport function removeElements(array, startIdx = 0, removeCount = 1)\r\n{\r\n    const length = array.length;\r\n\r\n    ASSERT(startIdx < length, 'removeElements: index out of range.');\r\n    ASSERT(removeCount !== 0, 'removeElements: remove count must be non-zero.');\r\n\r\n    removeCount = startIdx + removeCount > length ? (length - startIdx) : removeCount;\r\n    const newLength = length - removeCount;\r\n\r\n    for (let i = startIdx; i < newLength; ++i)\r\n    {\r\n        array[i] = array[i + removeCount];\r\n    }\r\n\r\n    array.length = newLength;\r\n}\r\n\r\nconst ifCheckShaderTemplate = `\r\nprecision mediump float;\r\nvoid main(void)\r\n{\r\n    float test = 0.1;\r\n    {{if_statements}}\r\n    gl_FragColor = vec4(0.0);\r\n}\r\n`;\r\n\r\n/**\r\n * Calculate the max number of if statements supported in a shader, up to\r\n * a maximum cap.\r\n *\r\n * @memberof util\r\n * @param {WebGLRenderingContext} gl - The rendering context\r\n * @param {number} maxIfs - cap for the if checks.\r\n * @return {number} The max ifs supported\r\n */\r\nexport function getMaxIfStatmentsInShader(gl, maxIfs)\r\n{\r\n    const createTempContext = !gl;\r\n\r\n    if (createTempContext)\r\n    {\r\n        const tinyCanvas = document.createElement('canvas');\r\n\r\n        tinyCanvas.width = 1;\r\n        tinyCanvas.height = 1;\r\n\r\n        gl = GLContext.create(tinyCanvas);\r\n    }\r\n\r\n    const shader = gl.createShader(gl.FRAGMENT_SHADER);\r\n    let max = typeof maxIfs === 'number' ? maxIfs : 50;\r\n    let guess = max;\r\n\r\n    // binary search for max ifs, optimistically.\r\n    // - assumes higher will work most of the time.\r\n    // - best case is even numbers, which this should be most of the time.\r\n    while (guess)\r\n    {\r\n        const result = testMaxIf(shader, gl, guess);\r\n\r\n        // failed, lower expectations.\r\n        if (!result)\r\n        {\r\n            max = guess;\r\n            guess = max >> 1;\r\n        }\r\n        // succeeded, raise expectations.\r\n        else\r\n        {\r\n            if (max - guess <= 1) break;\r\n\r\n            guess += (max - guess) >> 1;\r\n        }\r\n    }\r\n\r\n    if (createTempContext)\r\n    {\r\n        // get rid of context\r\n        if (gl.getExtension('WEBGL_lose_context'))\r\n        {\r\n            gl.getExtension('WEBGL_lose_context').loseContext();\r\n        }\r\n    }\r\n\r\n    return guess;\r\n}\r\n\r\n/**\r\n * Builds and tried to compile a shader with the specified number of if-statements.\r\n *\r\n * @ignore\r\n * @param {WebGLShader} shader - The shader program to use.\r\n * @param {WebGLRenderingContext} gl - The rendering context.\r\n * @param {number} max - Number of ifs to generate.\r\n * @return {number} The compilation status.\r\n */\r\nfunction testMaxIf(shader, gl, max)\r\n{\r\n    const fragmentSrc = ifCheckShaderTemplate.replace(/\\{\\{if_statements\\}\\}/gi, generateIfTestSrc(max));\r\n\r\n    gl.shaderSource(shader, fragmentSrc);\r\n    gl.compileShader(shader);\r\n\r\n    return gl.getShaderParameter(shader, gl.COMPILE_STATUS);\r\n}\r\n\r\n/**\r\n * Generates a shader source with the specified number of if-statements.\r\n *\r\n * @ignore\r\n * @param {number} max - Number of ifs to generate.\r\n * @return {string} The shader source.\r\n */\r\nfunction generateIfTestSrc(max)\r\n{\r\n    let src = '';\r\n\r\n    for (let i = 0; i < max; ++i)\r\n    {\r\n        if (i > 0)\r\n        {\r\n            src += '\\nelse ';\r\n        }\r\n\r\n        if (i < max - 1)\r\n        {\r\n            src += `if(test == ${i}.0) {}`;\r\n        }\r\n    }\r\n\r\n    return src;\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/core/src/util/index.js\n **/","import { ASSERT } from '../debug';\r\n\r\n/**\r\n * Simple ArrayBuffer wrapper that manages offsets and views into that buffer.\r\n *\r\n * @class\r\n * @memberof util\r\n */\r\nexport default class Buffer\r\n {\r\n    /**\r\n     * @param {Buffer|ArrayBuffer|SharedArrayBuffer|ArrayBufferView|number} parentBufferOrSize - A parent\r\n     *  buffer to have views into, or a size to create a new buffer. If a number is passed\r\n     *  as the first argument it is assumed to be size, and other arguments are ignored.\r\n     * @param {number} offset - Offset in bytes this buffer starts at in the parent buffer.\r\n     * @param {number} length - Length in bytes of this buffer.\r\n     */\r\n    constructor(parentBufferOrSize, offset = 0, length = -1)\r\n    {\r\n        ASSERT(offset >= 0, 'Invalid offset, must be negative.');\r\n\r\n        let _buffer = null;\r\n\r\n        if (typeof parentBufferOrSize === 'number')\r\n        {\r\n            _buffer = new ArrayBuffer(parentBufferOrSize);\r\n        }\r\n        else if (parentBufferOrSize instanceof ArrayBuffer)\r\n        {\r\n            _buffer = parentBufferOrSize;\r\n        }\r\n        else\r\n        {\r\n            ASSERT(parentBufferOrSize.buffer, 'No buffer in object passed as parent.');\r\n            _buffer = parentBufferOrSize.buffer;\r\n        }\r\n\r\n        const bytesLength = length !== -1 ? length : (_buffer.byteLength - offset);\r\n        const view32Length = length !== -1 ? length / 4 : ((_buffer.byteLength / 4) - (offset / 4));\r\n\r\n        ASSERT(offset + bytesLength <= _buffer.byteLength, 'Offset + length > size of memory buffer.');\r\n\r\n        /**\r\n         * Raw underlying ArrayBuffer. This is all the memory of the buffer,\r\n         * NOT just the view it has (based on offset/length).\r\n         *\r\n         * @member {ArrayBuffer}\r\n         */\r\n        this.buffer = _buffer;\r\n\r\n        /**\r\n         * View on the data as a Uint8Array.\r\n         *\r\n         * @member {Uint8Array}\r\n         */\r\n        this.bytes = new Uint8Array(_buffer, offset, bytesLength);\r\n\r\n        /**\r\n         * View on the data as a Float32Array.\r\n         *\r\n         * @member {Float32Array}\r\n         */\r\n        this.float32View = new Float32Array(_buffer, offset, view32Length);\r\n\r\n        /**\r\n         * View on the data as a Uint32Array.\r\n         *\r\n         * @member {Uint32Array}\r\n         */\r\n        this.uint32View = new Uint32Array(_buffer, offset, view32Length);\r\n\r\n        // for duck-typing\r\n        this.__isBuffer = true;\r\n    }\r\n\r\n    /**\r\n     * Determines if the passed object is a buffer.\r\n     *\r\n     * @param {*} b - Object to check.\r\n     * @return {boolean} True if the object is Buffer, false otherwise.\r\n     */\r\n    static isBuffer(b)\r\n    {\r\n        return !!b.__isBuffer;\r\n    }\r\n\r\n    /**\r\n     * Destroys the buffer.\r\n     */\r\n    destroy()\r\n    {\r\n        this.buffer = null;\r\n        this.bytes = null;\r\n        this.float32View = null;\r\n        this.uint32View = null;\r\n    }\r\n }\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/core/src/util/Buffer.js\n **/","/* eslint max-params: [2, { max: 7 }] */\r\n\r\n/**\r\n * @class\r\n * @memberof util\r\n */\r\nexport default class BlendMode\r\n{\r\n    /**\r\n     * @param {number} sfactor - The source factor (for glBlendFunc).\r\n     * @param {number} dfactor - The destination factor (for glBlendFunc).\r\n     * @param {number} equation - The Alpha blend function to use (for glBlendEquation).\r\n     * @param {number} id - The preset blend mode this object represents.\r\n     */\r\n    constructor(sfactor, dfactor, equation)\r\n    {\r\n        this.sfactor = sfactor;\r\n        this.dfactor = dfactor;\r\n        this.equation = equation;\r\n    }\r\n\r\n    /**\r\n     * @param {WebGLRenderingContext} gl - The rendering context to set on.\r\n     */\r\n    enable(gl)\r\n    {\r\n        gl.blendFunc(this.sfactor, this.dfactor);\r\n        gl.blendEquation(this.equation);\r\n    }\r\n\r\n    /**\r\n     * Checks for equality with another blend mode.\r\n     *\r\n     * @param {BlendMode} mode - The mode to check equality against.\r\n     * @return {boolean} True if they are equal.\r\n     */\r\n    equals(mode)\r\n    {\r\n        return !!mode\r\n            && this.sfactor === mode.sfactor\r\n            && this.dfactor === mode.dfactor\r\n            && this.equation === mode.equation;\r\n    }\r\n}\r\n\r\n// short name, I'm lazy.\r\nconst c = WebGLRenderingContext;\r\n\r\n/* eslint-disable no-multi-spaces */\r\nBlendMode.NORMAL       = new BlendMode(c.ONE, c.ONE_MINUS_SRC_ALPHA, c.FUNC_ADD);\r\nBlendMode.ADD          = new BlendMode(c.ONE, c.DST_ALPHA, c.FUNC_ADD);\r\nBlendMode.SUBTRACT     = new BlendMode(c.ONE, c.DST_ALPHA, c.FUNC_SUBTRACT);\r\nBlendMode.MULTIPLY     = new BlendMode(c.DST_COLOR, c.ONE_MINUS_SRC_ALPHA, c.FUNC_ADD);\r\nBlendMode.EXCLUSION    = new BlendMode(c.ONE_MINUS_DST_COLOR, c.ONE_MINUS_SRC_COLOR, c.FUNC_ADD);\r\n/* eslint-enable no-multi-spaces */\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/core/src/util/BlendMode.js\n **/","// TODO: World Alpha needs updates...\r\n\r\nexport default function VisibilityComponent(Base)\r\n{\r\n    /**\r\n     * @class VisibilityComponent\r\n     * @memberof ecs\r\n     */\r\n    return class extends Base\r\n    {\r\n        /**\r\n         *\r\n         */\r\n        constructor()\r\n        {\r\n            super(...arguments); // eslint-disable-line prefer-rest-params\r\n\r\n            /**\r\n             * Controls the visibility of the object. If false, not rendered.\r\n             *\r\n             * @member {boolean}\r\n             * @default true\r\n             */\r\n            this.visible = true;\r\n\r\n            /**\r\n             * The alpha of the object when rendered.\r\n             * 0 = transparent, 1 = opaque.\r\n             *\r\n             * @member {number}\r\n             * @default 1\r\n             */\r\n            this.alpha = 1;\r\n\r\n            /**\r\n             * The world alpha of the object (local alpha * parent alpha).\r\n             * 0 = transparent, 1 = opaque.\r\n             *\r\n             * @member {number}\r\n             * @default 1\r\n             */\r\n            this.worldAlpha = 1;\r\n        }\r\n    };\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/core/src/ecs/VisibilityComponent.js\n **/","import ECS from '@fae/ecs';\r\n\r\n/**\r\n * @class\r\n * @memberof ecs\r\n */\r\nexport default class Entity extends ECS.Entity {\r\n    /**\r\n     *\r\n     */\r\n    constructor()\r\n    {\r\n        super();\r\n\r\n        /**\r\n         * The render priority of this entity. A lower number will make it render\r\n         * first. Think of this like a \"z-index\" the higher number will render on top.\r\n         *\r\n         * If you change this value at all after adding the entity to the renderer you will\r\n         * need to call {@link Renderer#sortEntities} for the change to affect the sort.\r\n         *\r\n         * @member {number}\r\n         * @default 0\r\n         */\r\n        this.renderPriority = 0;\r\n\r\n        /**\r\n         * An value that hints to the renderer how to group this entity to try and\r\n         * improve batching. If this is set the renderer can group entities with the\r\n         * same `priority` and `renderGroupHint` together, which may improve batching.\r\n         *\r\n         * While you can assign this value to anything you want, a good idea is to set\r\n         * this to the ObjectRenderer class you know that entity will use. That way that\r\n         * renderer can operate on those objects in sequence and potentially batch them.\r\n         * If you don't know what to assign this to, leaving it as `null` is fine.\r\n         *\r\n         * If you change this value at all after adding the entity to the renderer you will\r\n         * need to call {@link Renderer#sortEntities} for the change to affect the sort.\r\n         *\r\n         * @example\r\n         *\r\n         * ```js\r\n         * import { ecs } from '@fae/core';\r\n         * import { SpriteRenderer } from '@fae/sprites';\r\n         *\r\n         * class MySprite extends ecs.Entity.with(...)\r\n         * {\r\n         *     constructor()\r\n         *     {\r\n         *         super();\r\n         *\r\n         *         // When added to the renderer all `MySprite` instances with the same\r\n         *         // priority will now be grouped together, improving the SpriteRenderer's\r\n         *         // ability to batch them!\r\n         *         this.renderGroupHint = SpriteRenderer;\r\n         *     }\r\n         * }\r\n         * ```\r\n         *\r\n         * @member {*}\r\n         * @default null\r\n         */\r\n        this.renderGroupHint = null;\r\n    }\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/core/src/ecs/Entity.js\n **/","/** @namespace glutil */\r\n\r\nexport { default as GLBuffer } from './GLBuffer';\r\nexport { default as GLContext } from './GLContext';\r\nexport { default as GLFramebuffer } from './GLFramebuffer';\r\nexport { default as GLProgramCache } from './GLProgramCache';\r\nexport { default as GLQuad } from './GLQuad';\r\nexport { default as GLShader } from './GLShader';\r\nexport { default as GLTexture } from './GLTexture';\r\nexport { default as GLVertexArrayObject } from './GLVertexArrayObject';\r\n\r\nimport * as GLData from './GLData';\r\nexport { GLData };\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/core/src/gl/index.js\n **/","const EMPTY_ARRAY_BUFFER = new ArrayBuffer(0);\r\n\r\n/**\r\n * Helper class to create a WebGL buffer.\r\n *\r\n * @class\r\n * @memberof glutil\r\n */\r\nexport default class GLBuffer\r\n{\r\n    /**\r\n     * Creates a new GLBuffer.\r\n     *\r\n     * @param {WebGLRenderingContext} gl - The current WebGL rendering context\r\n     * @param {gl.ARRAY_BUFFER|gl.ELEMENT_ARRAY_BUFFER} type - Array type\r\n     * @param {ArrayBuffer|SharedArrayBuffer|ArrayBufferView} data - an array of data\r\n     * @param {gl.STATIC_DRAW|gl.DYNAMIC_DRAW|gl.STREAM_DRAW} drawType - Type of draw\r\n     */\r\n    constructor(gl, type = gl.ARRAY_BUFFER, data = EMPTY_ARRAY_BUFFER, drawType = gl.STATIC_DRAW)\r\n    {\r\n        /**\r\n         * The current WebGL rendering context\r\n         *\r\n         * @member {WebGLRenderingContext}\r\n         */\r\n        this.gl = gl;\r\n\r\n        /**\r\n         * The WebGL buffer, created upon instantiation\r\n         *\r\n         * @member {WebGLBuffer}\r\n         */\r\n        this.buffer = gl.createBuffer();\r\n\r\n        /**\r\n         * The type of the buffer\r\n         *\r\n         * @member {gl.ARRAY_BUFFER|gl.ELEMENT_ARRAY_BUFFER}\r\n         */\r\n        this.type = type;\r\n\r\n        /**\r\n         * The draw type of the buffer\r\n         *\r\n         * @member {gl.STATIC_DRAW|gl.DYNAMIC_DRAW|gl.STREAM_DRAW}\r\n         */\r\n        this.drawType = drawType;\r\n\r\n        /**\r\n         * The data in the buffer, as a typed array\r\n         *\r\n         * @member {ArrayBuffer|SharedArrayBuffer|ArrayBufferView}\r\n         */\r\n        this.data = EMPTY_ARRAY_BUFFER;\r\n\r\n        // uplaod data if there is some\r\n        if (data && data !== EMPTY_ARRAY_BUFFER)\r\n        {\r\n            this.upload(data);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Creates a new GLBuffer, using `gl.ARRAY_BUFFER` as the type.\r\n     *\r\n     * @static\r\n     * @param {WebGLRenderingContext} gl - The current WebGL rendering context\r\n     * @param {ArrayBuffer|SharedArrayBuffer|ArrayBufferView} data - an array of data\r\n     * @param {gl.STATIC_DRAW|gl.DYNAMIC_DRAW|gl.STREAM_DRAW} drawType - Type of draw\r\n     * @return {GLBuffer} New buffer, using `gl.ARRAY_BUFFER` as the type\r\n     */\r\n    static createVertexBuffer(gl, data, drawType)\r\n    {\r\n        return new GLBuffer(gl, gl.ARRAY_BUFFER, data, drawType);\r\n    }\r\n\r\n    /**\r\n     * Creates a new GLBuffer, using `gl.ELEMENT_ARRAY_BUFFER` as the type.\r\n     *\r\n     * @static\r\n     * @param {WebGLRenderingContext} gl - The current WebGL rendering context\r\n     * @param {ArrayBuffer|SharedArrayBuffer|ArrayBufferView} data - an array of data\r\n     * @param {gl.STATIC_DRAW|gl.DYNAMIC_DRAW|gl.STREAM_DRAW} drawType - Type of draw\r\n     * @return {GLBuffer} New buffer, using `gl.ELEMENT_ARRAY_BUFFER` as the type\r\n     */\r\n    static createIndexBuffer(gl, data, drawType)\r\n    {\r\n        return new GLBuffer(gl, gl.ELEMENT_ARRAY_BUFFER, data, drawType);\r\n    }\r\n\r\n    /**\r\n     * Uploads the buffer to the GPU\r\n     *\r\n     * @param {ArrayBuffer|SharedArrayBuffer|ArrayBufferView} data - an array of data to upload\r\n     * @param {number} offset - if only a subset of the data should be uploaded, this is the amount of data to subtract\r\n     * @param {boolean} dontBind - whether to bind the buffer before uploading it\r\n     */\r\n    upload(data = this.data, offset = 0, dontBind = false)\r\n    {\r\n        // todo - needed?\r\n        if (!dontBind) this.bind();\r\n\r\n        const gl = this.gl;\r\n\r\n        if (this.data.byteLength >= data.byteLength)\r\n        {\r\n            gl.bufferSubData(this.type, offset, data);\r\n        }\r\n        else\r\n        {\r\n            gl.bufferData(this.type, data, this.drawType);\r\n        }\r\n\r\n        this.data = data;\r\n    }\r\n\r\n    /**\r\n     * Binds the buffer\r\n     *\r\n     */\r\n    bind()\r\n    {\r\n        this.gl.bindBuffer(this.type, this.buffer);\r\n    }\r\n\r\n    /**\r\n     * Destroys the buffer\r\n     *\r\n     */\r\n    destroy()\r\n    {\r\n        if (this.gl.isBuffer(this.buffer))\r\n        {\r\n            this.gl.deleteBuffer(this.buffer);\r\n        }\r\n\r\n        this.gl = null;\r\n        this.buffer = null;\r\n        this.data = null;\r\n    }\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/core/src/gl/GLBuffer.js\n **/","import GLBuffer from './GLBuffer';\r\nimport GLVertexArrayObject from './GLVertexArrayObject';\r\n\r\n/**\r\n * Helper class to create a quad\r\n *\r\n * @class\r\n * @memberof glutil\r\n */\r\nexport default class GLQuad\r\n{\r\n    /**\r\n     * @param {WebGLRenderingContext} gl - The gl context for this quad to use.\r\n     */\r\n    constructor(gl)\r\n    {\r\n        /**\r\n         * the current WebGL drawing context\r\n         *\r\n         * @member {WebGLRenderingContext}\r\n         */\r\n        this.gl = gl;\r\n\r\n        /**\r\n         * An array of vertices\r\n         *\r\n         * @member {Float32Array}\r\n         */\r\n        this.vertices = new Float32Array([\r\n            -1, -1,\r\n            1, -1,\r\n            1, 1,\r\n            -1, 1,\r\n        ]);\r\n\r\n        /**\r\n         * The Uvs of the quad\r\n         *\r\n         * @member {Float32Array}\r\n         */\r\n        this.uvs = new Float32Array([\r\n            0, 0,\r\n            1, 0,\r\n            1, 1,\r\n            0, 1,\r\n        ]);\r\n\r\n        /**\r\n         * The array of data that actually gets uploaded.\r\n         *\r\n         * @member {Float32Array}\r\n         */\r\n        this.interleaved = new Float32Array(8 * 2);\r\n\r\n        this.syncData();\r\n\r\n        /**\r\n         * An array containing the indices of the vertices\r\n         *\r\n         * @member {Uint16Array}\r\n         */\r\n        this.indices = GLQuad.createIndices(1);\r\n\r\n        /**\r\n         * The vertex buffer\r\n         *\r\n         * @member {GLBuffer}\r\n         */\r\n        this.vertexBuffer = GLBuffer.createVertexBuffer(gl, this.interleaved, gl.STATIC_DRAW);\r\n\r\n        /**\r\n         * The index buffer\r\n         *\r\n         * @member {GLBuffer}\r\n         */\r\n        this.indexBuffer = GLBuffer.createIndexBuffer(gl, this.indices, gl.STATIC_DRAW);\r\n\r\n        /**\r\n         * The vertex array object that manages the buffers.\r\n         *\r\n         * @member {GLVertexArrayObject}\r\n         */\r\n        this.vao = new GLVertexArrayObject(gl);\r\n    }\r\n\r\n    /**\r\n     * Utility to quickly create the indicies for a series of quads.\r\n     *\r\n     * @memberof util\r\n     * @param {number} numQuads - Number of quads to create indices for.\r\n     * @return {Uint16Array} The indices for the quad.\r\n     */\r\n    static createIndices(numQuads)\r\n    {\r\n        // the total number of indices in our array, there are 6 points per quad.\r\n        const totalIndices = numQuads * 6;\r\n        const indices = new Uint16Array(totalIndices);\r\n\r\n        // fill the indices with the quads to draw\r\n        for (let i = 0, j = 0; i < totalIndices; i += 6, j += 4)\r\n        {\r\n            indices[i + 0] = j + 0;\r\n            indices[i + 1] = j + 1;\r\n            indices[i + 2] = j + 2;\r\n            indices[i + 3] = j + 0;\r\n            indices[i + 4] = j + 2;\r\n            indices[i + 5] = j + 3;\r\n        }\r\n\r\n        return indices;\r\n    }\r\n\r\n    /**\r\n     * Initialises the vaos and uses the shader\r\n     *\r\n     * @param {GLShader} shader - The shader to use.\r\n     */\r\n    initVao(shader)\r\n    {\r\n        // TODO: https://github.com/pixijs/pixi.js/issues/2842\r\n        // Dont try to deal with attributes the filter doesn't actually have\r\n        this.vao.clear()\r\n            .setIndexBuffer(this.indexBuffer)\r\n            .addAttribute(this.vertexBuffer, shader.attributes.aVertexPosition, this.gl.FLOAT, false, 4 * 4, 0)\r\n            .addAttribute(this.vertexBuffer, shader.attributes.aTextureCoord, this.gl.FLOAT, false, 4 * 4, 2 * 4);\r\n    }\r\n\r\n    /**\r\n     * Synchronizes the data into the interleaved array.\r\n     *\r\n     */\r\n    syncData()\r\n    {\r\n        for (let i = 0; i < 4; ++i)\r\n        {\r\n            const ix = i * 4;\r\n            const vx = i * 2;\r\n\r\n            this.interleaved[ix] = this.vertices[vx];\r\n            this.interleaved[ix + 1] = this.vertices[vx + 1];\r\n            this.interleaved[ix + 2] = this.uvs[vx];\r\n            this.interleaved[ix + 3] = this.uvs[vx + 1];\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Maps two Rectangle to the quad\r\n     *\r\n     * @param {Rectangle} targetTextureFrame - The first rectangle.\r\n     * @param {Rectangle} destinationFrame - The second rectangle.\r\n     * @return {GLQuad} Returns itself.\r\n     */\r\n    map(targetTextureFrame, destinationFrame)\r\n    {\r\n        let x = 0; // destinationFrame.x / targetTextureFrame.width;\r\n        let y = 0; // destinationFrame.y / targetTextureFrame.height;\r\n\r\n        this.uvs[0] = x;\r\n        this.uvs[1] = y;\r\n\r\n        this.uvs[2] = x + (destinationFrame.width / targetTextureFrame.width);\r\n        this.uvs[3] = y;\r\n\r\n        this.uvs[4] = x + (destinationFrame.width / targetTextureFrame.width);\r\n        this.uvs[5] = y + (destinationFrame.height / targetTextureFrame.height);\r\n\r\n        this.uvs[6] = x;\r\n        this.uvs[7] = y + (destinationFrame.height / targetTextureFrame.height);\r\n\r\n        x = destinationFrame.x;\r\n        y = destinationFrame.y;\r\n\r\n        this.vertices[0] = x;\r\n        this.vertices[1] = y;\r\n\r\n        this.vertices[2] = x + destinationFrame.width;\r\n        this.vertices[3] = y;\r\n\r\n        this.vertices[4] = x + destinationFrame.width;\r\n        this.vertices[5] = y + destinationFrame.height;\r\n\r\n        this.vertices[6] = x;\r\n        this.vertices[7] = y + destinationFrame.height;\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Draws the quad\r\n     *\r\n     * @return {GLQuad} Returns itself.\r\n     */\r\n    draw()\r\n    {\r\n        this.vao.bind()\r\n            .draw(this.gl.TRIANGLES, 6, 0)\r\n            .unbind();\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Binds the buffer and uploads the data\r\n     *\r\n     * @return {GLQuad} Returns itself.\r\n     */\r\n    upload()\r\n    {\r\n        this.syncData();\r\n\r\n        this.vertexBuffer.upload(this.interleaved);\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Removes this quad from WebGL.\r\n     *\r\n     */\r\n    destroy()\r\n    {\r\n        this.vertexBuffer.destroy();\r\n        this.indexBuffer.destroy();\r\n        this.vao.destroy();\r\n\r\n        this.gl = null;\r\n        this.vertices = null;\r\n        this.uvs = null;\r\n        this.interleaved = null;\r\n        this.indices = null;\r\n    }\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/core/src/gl/GLQuad.js\n **/","/* eslint max-params: [2, 6] */\r\nimport Device from 'ismobilejs';\r\n\r\n/**\r\n * Helper class to work with WebGL GLVertexArrayObjects (vaos)\r\n * Only works if WebGL extensions are enabled (they usually are)\r\n *\r\n * @class\r\n * @memberof glutil\r\n */\r\nexport default class GLVertexArrayObject\r\n{\r\n    /**\r\n     * @param {WebGLRenderingContext} gl - The current WebGL rendering context\r\n     * @param {object} state - ??\r\n     */\r\n    constructor(gl)\r\n    {\r\n        const maxAttribs = gl.getParameter(gl.MAX_VERTEX_ATTRIBS);\r\n\r\n        /**\r\n         * The current WebGL rendering context\r\n         *\r\n         * @member {WebGLRenderingContext}\r\n         */\r\n        this.gl = gl;\r\n\r\n        /**\r\n         * The native VAO extension to use.\r\n         *\r\n         * @member {*}\r\n         */\r\n        this.nativeVaoExtension = null;\r\n\r\n        /**\r\n         * The actual native Vertex Array Object to use.\r\n         *\r\n         * @member {*}\r\n         */\r\n        this.nativeVao = null;\r\n\r\n        /**\r\n         * The attribute state.\r\n         *\r\n         * @member {object}\r\n         * @property {boolean[]} tempAttribState - Temp store for attrib state\r\n         * @property {boolean[]} attribState - The attrib state\r\n         */\r\n        this.state = {\r\n            tempAttribState: new Array(maxAttribs),\r\n            attribState: new Array(maxAttribs),\r\n        };\r\n\r\n        /**\r\n         * An array of attributes\r\n         *\r\n         * @member {Array}\r\n         */\r\n        this.attributes = [];\r\n\r\n        /**\r\n         * @member {Array}\r\n         */\r\n        this.indexBuffer = null;\r\n\r\n        /**\r\n         * A boolean flag\r\n         *\r\n         * @member {Boolean}\r\n         */\r\n        this.dirty = false;\r\n\r\n        if (!GLVertexArrayObject.FORCE_NO_NATIVE)\r\n        {\r\n            this.nativeVaoExtension = gl.getExtension('OES_vertex_array_object')\r\n                                    || gl.getExtension('MOZ_OES_vertex_array_object')\r\n                                    || gl.getExtension('WEBKIT_OES_vertex_array_object');\r\n\r\n            if (this.nativeVaoExtension)\r\n            {\r\n                this.nativeVao = this.nativeVaoExtension.createVertexArrayOES();\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Binds the buffer\r\n     *\r\n     * @return {GLVertexArrayObject} Returns self.\r\n     */\r\n    bind()\r\n    {\r\n        if (this.nativeVao)\r\n        {\r\n            this.nativeVaoExtension.bindVertexArrayOES(this.nativeVao);\r\n\r\n            if (this.dirty)\r\n            {\r\n                this.dirty = false;\r\n                this.activate();\r\n            }\r\n        }\r\n        else\r\n        {\r\n            this.activate();\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Unbinds the buffer\r\n     *\r\n     * @return {GLVertexArrayObject} Returns self.\r\n     */\r\n    unbind()\r\n    {\r\n        if (this.nativeVao)\r\n        {\r\n            this.nativeVaoExtension.bindVertexArrayOES(null);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Uses this vao\r\n     *\r\n     * @return {GLVertexArrayObject} Returns self.\r\n     */\r\n    activate()\r\n    {\r\n        const gl = this.gl;\r\n        let lastBuffer = null;\r\n\r\n        for (let i = 0; i < this.attributes.length; ++i)\r\n        {\r\n            const attrib = this.attributes[i];\r\n\r\n            if (lastBuffer !== attrib.buffer)\r\n            {\r\n                attrib.buffer.bind();\r\n                lastBuffer = attrib.buffer;\r\n            }\r\n\r\n            attrib.attribute.setup(gl, attrib);\r\n        }\r\n\r\n        setVertexAttribArrays(gl, this.attributes, this.state);\r\n\r\n        this.indexBuffer.bind();\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Add an attribute to the VAO\r\n     *\r\n     * @param {WebGLBuffer} buffer - The buffer for the attribute.\r\n     * @param {object} attribute - The attribute descriptor from the shader.\r\n     * @param {number} type - The GLEnum type of this attribute.\r\n     * @param {boolean} normalized - Whether the value is normalized.\r\n     * @param {number} stride - The size of a single element.\r\n     * @param {number} start - The index in the buffer this attribute starts at.\r\n     * @return {GLVertexArrayObject} Returns self.\r\n     */\r\n    addAttribute(buffer, attribute, type, normalized = false, stride = 0, start = 0)\r\n    {\r\n        this.attributes.push({\r\n            buffer,\r\n            attribute,\r\n            type,\r\n            normalized,\r\n            stride,\r\n            start,\r\n        });\r\n\r\n        this.dirty = true;\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Adds an index into the VAO.\r\n     *\r\n     * @param {WebGLBuffer} buffer - The buffer to set as the index buffer.\r\n     * @return {GLVertexArrayObject} Returns self.\r\n     */\r\n    setIndexBuffer(buffer)\r\n    {\r\n        this.indexBuffer = buffer;\r\n        this.dirty = true;\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Unbinds this vao and disables it\r\n     *\r\n     * @return {GLVertexArrayObject} Returns self.\r\n     */\r\n    clear()\r\n    {\r\n        // TODO - should this function unbind after clear?\r\n        // for now, no but lets see what happens in the real world!\r\n        if (this.nativeVao)\r\n        {\r\n            this.nativeVaoExtension.bindVertexArrayOES(this.nativeVao);\r\n        }\r\n\r\n        this.attributes.length = 0;\r\n        this.indexBuffer = null;\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Draws the VAO.\r\n     *\r\n     * @param {number} type - The draw type to use. Usually gl.TRIANGLES or gl.TRIANGLE_STRIP\r\n     * @param {number} size - Size of the buffer to draw.\r\n     * @param {number} start - Index to start.\r\n     * @return {GLVertexArrayObject} Returns self.\r\n     */\r\n    draw(type, size, start = 0)\r\n    {\r\n        const gl = this.gl;\r\n\r\n        gl.drawElements(type, size, gl.UNSIGNED_SHORT, start);\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Destroy this vao\r\n     */\r\n    destroy()\r\n    {\r\n        // lose references\r\n        this.gl = null;\r\n        this.indexBuffer = null;\r\n        this.attributes = null;\r\n        this.state = null;\r\n\r\n        if (this.nativeVao)\r\n        {\r\n            this.nativeVaoExtension.deleteVertexArrayOES(this.nativeVao);\r\n        }\r\n\r\n        this.nativeVaoExtension = null;\r\n        this.nativeVao = null;\r\n    }\r\n}\r\n\r\n/**\r\n * Lets the VAO know if you should use the WebGL extension or the js methods.\r\n * Some devices behave a bit funny when using the newer extensions (im looking at you ipad 2!)\r\n * If you find on older devices that things have gone a bit weird then set this to true.\r\n *\r\n * This defaults to `true` for mobile devices and `false` for desktop.\r\n *\r\n * @static\r\n * @constant\r\n * @memberof GLVertexArrayObject\r\n * @type {boolean}\r\n * @default false\r\n */\r\nGLVertexArrayObject.FORCE_NO_NATIVE = Device.tablet || Device.phone;\r\n\r\n/**\r\n * @ignore\r\n * @param {WebGLRenderingContext} gl - The current WebGL context\r\n * @param {object[]} attribs - attributes\r\n * @param {object} state - state\r\n */\r\nfunction setVertexAttribArrays(gl, attribs, state)\r\n{\r\n    if (state)\r\n    {\r\n        const tempAttribState = state.tempAttribState;\r\n        const attribState = state.attribState;\r\n\r\n        for (let i = 0; i < tempAttribState.length; ++i)\r\n        {\r\n            tempAttribState[i] = false;\r\n        }\r\n\r\n        // set the new attribs\r\n        for (let i = 0; i < attribs.length; ++i)\r\n        {\r\n            tempAttribState[attribs[i].attribute.location] = true;\r\n        }\r\n\r\n        for (let i = 0; i < attribState.length; ++i)\r\n        {\r\n            if (attribState[i] !== tempAttribState[i])\r\n            {\r\n                attribState[i] = tempAttribState[i];\r\n\r\n                if (state.attribState[i])\r\n                {\r\n                    gl.enableVertexAttribArray(i);\r\n                }\r\n                else\r\n                {\r\n                    gl.disableVertexAttribArray(i);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    else\r\n    {\r\n        for (let i = 0; i < attribs.length; ++i)\r\n        {\r\n            gl.enableVertexAttribArray(attribs[i].attribute.location);\r\n        }\r\n    }\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/core/src/gl/GLVertexArrayObject.js\n **/","/**\n * isMobile.js v0.4.0\n *\n * A simple library to detect Apple phones and tablets,\n * Android phones and tablets, other mobile devices (like blackberry, mini-opera and windows phone),\n * and any kind of seven inch device, via user agent sniffing.\n *\n * @author: Kai Mallea (kmallea@gmail.com)\n *\n * @license: http://creativecommons.org/publicdomain/zero/1.0/\n */\n(function (global) {\n\n    var apple_phone         = /iPhone/i,\n        apple_ipod          = /iPod/i,\n        apple_tablet        = /iPad/i,\n        android_phone       = /(?=.*\\bAndroid\\b)(?=.*\\bMobile\\b)/i, // Match 'Android' AND 'Mobile'\n        android_tablet      = /Android/i,\n        amazon_phone        = /(?=.*\\bAndroid\\b)(?=.*\\bSD4930UR\\b)/i,\n        amazon_tablet       = /(?=.*\\bAndroid\\b)(?=.*\\b(?:KFOT|KFTT|KFJWI|KFJWA|KFSOWI|KFTHWI|KFTHWA|KFAPWI|KFAPWA|KFARWI|KFASWI|KFSAWI|KFSAWA)\\b)/i,\n        windows_phone       = /IEMobile/i,\n        windows_tablet      = /(?=.*\\bWindows\\b)(?=.*\\bARM\\b)/i, // Match 'Windows' AND 'ARM'\n        other_blackberry    = /BlackBerry/i,\n        other_blackberry_10 = /BB10/i,\n        other_opera         = /Opera Mini/i,\n        other_chrome        = /(CriOS|Chrome)(?=.*\\bMobile\\b)/i,\n        other_firefox       = /(?=.*\\bFirefox\\b)(?=.*\\bMobile\\b)/i, // Match 'Firefox' AND 'Mobile'\n        seven_inch = new RegExp(\n            '(?:' +         // Non-capturing group\n\n            'Nexus 7' +     // Nexus 7\n\n            '|' +           // OR\n\n            'BNTV250' +     // B&N Nook Tablet 7 inch\n\n            '|' +           // OR\n\n            'Kindle Fire' + // Kindle Fire\n\n            '|' +           // OR\n\n            'Silk' +        // Kindle Fire, Silk Accelerated\n\n            '|' +           // OR\n\n            'GT-P1000' +    // Galaxy Tab 7 inch\n\n            ')',            // End non-capturing group\n\n            'i');           // Case-insensitive matching\n\n    var match = function(regex, userAgent) {\n        return regex.test(userAgent);\n    };\n\n    var IsMobileClass = function(userAgent) {\n        var ua = userAgent || navigator.userAgent;\n\n        // Facebook mobile app's integrated browser adds a bunch of strings that\n        // match everything. Strip it out if it exists.\n        var tmp = ua.split('[FBAN');\n        if (typeof tmp[1] !== 'undefined') {\n            ua = tmp[0];\n        }\n\n        // Twitter mobile app's integrated browser on iPad adds a \"Twitter for\n        // iPhone\" string. Same probable happens on other tablet platforms.\n        // This will confuse detection so strip it out if it exists.\n        tmp = ua.split('Twitter');\n        if (typeof tmp[1] !== 'undefined') {\n            ua = tmp[0];\n        }\n\n        this.apple = {\n            phone:  match(apple_phone, ua),\n            ipod:   match(apple_ipod, ua),\n            tablet: !match(apple_phone, ua) && match(apple_tablet, ua),\n            device: match(apple_phone, ua) || match(apple_ipod, ua) || match(apple_tablet, ua)\n        };\n        this.amazon = {\n            phone:  match(amazon_phone, ua),\n            tablet: !match(amazon_phone, ua) && match(amazon_tablet, ua),\n            device: match(amazon_phone, ua) || match(amazon_tablet, ua)\n        };\n        this.android = {\n            phone:  match(amazon_phone, ua) || match(android_phone, ua),\n            tablet: !match(amazon_phone, ua) && !match(android_phone, ua) && (match(amazon_tablet, ua) || match(android_tablet, ua)),\n            device: match(amazon_phone, ua) || match(amazon_tablet, ua) || match(android_phone, ua) || match(android_tablet, ua)\n        };\n        this.windows = {\n            phone:  match(windows_phone, ua),\n            tablet: match(windows_tablet, ua),\n            device: match(windows_phone, ua) || match(windows_tablet, ua)\n        };\n        this.other = {\n            blackberry:   match(other_blackberry, ua),\n            blackberry10: match(other_blackberry_10, ua),\n            opera:        match(other_opera, ua),\n            firefox:      match(other_firefox, ua),\n            chrome:       match(other_chrome, ua),\n            device:       match(other_blackberry, ua) || match(other_blackberry_10, ua) || match(other_opera, ua) || match(other_firefox, ua) || match(other_chrome, ua)\n        };\n        this.seven_inch = match(seven_inch, ua);\n        this.any = this.apple.device || this.android.device || this.windows.device || this.other.device || this.seven_inch;\n\n        // excludes 'other' devices and ipods, targeting touchscreen phones\n        this.phone = this.apple.phone || this.android.phone || this.windows.phone;\n\n        // excludes 7 inch devices, classifying as phone or tablet is left to the user\n        this.tablet = this.apple.tablet || this.android.tablet || this.windows.tablet;\n\n        if (typeof window === 'undefined') {\n            return this;\n        }\n    };\n\n    var instantiate = function() {\n        var IM = new IsMobileClass();\n        IM.Class = IsMobileClass;\n        return IM;\n    };\n\n    if (typeof module !== 'undefined' && module.exports && typeof window === 'undefined') {\n        //node\n        module.exports = IsMobileClass;\n    } else if (typeof module !== 'undefined' && module.exports && typeof window !== 'undefined') {\n        //browserify\n        module.exports = instantiate();\n    } else if (typeof define === 'function' && define.amd) {\n        //AMD\n        define('isMobile', [], global.isMobile = instantiate());\n    } else {\n        global.isMobile = instantiate();\n    }\n\n})(this);\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/ismobilejs/isMobile.js\n ** module id = 36\n ** module chunks = 0\n **/","import { GL_SIZE_MAP, GL_SETTER, GL_ARRAY_SETTER, getUniformDefault } from './GLData';\r\nimport GLProgramCache from './GLProgramCache';\r\n\r\nimport { ASSERT } from '../debug';\r\n\r\n/**\r\n * Helper class to create a webGL Shader\r\n *\r\n * @class\r\n * @memberof glutil\r\n */\r\nexport default class GLShader\r\n{\r\n    /**\r\n     * @param {WebGLRenderingContext} gl - The rendering context.\r\n     * @param {string|string[]} vertexSrc - The vertex shader source as an array of strings.\r\n     * @param {string|string[]} fragmentSrc - The fragment shader source as an array of strings.\r\n     */\r\n    constructor(gl, vertexSrc, fragmentSrc)\r\n    {\r\n        /**\r\n         * The current WebGL rendering context\r\n         *\r\n         * @member {WebGLRenderingContext}\r\n         */\r\n        this.gl = gl;\r\n\r\n        /**\r\n         * The vertex shader source of the program.\r\n         *\r\n         * @member {string}\r\n         */\r\n        this.vertexSrc = vertexSrc;\r\n\r\n        /**\r\n         * The fragment shader source of the program.\r\n         *\r\n         * @member {string}\r\n         */\r\n        this.fragmentSrc = fragmentSrc;\r\n\r\n        /**\r\n         * The shader program\r\n         *\r\n         * @member {WebGLProgram}\r\n         */\r\n        this.program = null;\r\n\r\n        /**\r\n         * The attributes of the shader as an object containing the following properties\r\n         * {\r\n         * \ttype,\r\n         * \tsize,\r\n         * \tlocation,\r\n         * \tpointer\r\n         * }\r\n         * @member {Object}\r\n         */\r\n        this.attributes = null;\r\n\r\n        /**\r\n         * The uniforms of the shader as an object containing the following properties\r\n         * {\r\n         * \tgl,\r\n         * \tdata\r\n         * }\r\n         * @member {Object}\r\n         */\r\n        this.uniforms = null;\r\n\r\n        // initialize\r\n        this.recompile();\r\n    }\r\n\r\n    /**\r\n     * Compiles source into a program.\r\n     *\r\n     * @static\r\n     * @param {WebGLRenderingContext} gl - The rendering context.\r\n     * @param {string} vertexSrc - The vertex shader source as an array of strings.\r\n     * @param {string} fragmentSrc - The fragment shader source as an array of strings.\r\n     * @param {boolean} forceCompile - When set to true this will always compile,\r\n     *  skipping the cache checks\r\n     * @return {WebGLProgram} the shader program\r\n     */\r\n    static compileProgram(gl, vertexSrc, fragmentSrc, forceCompile = false)\r\n    {\r\n        const cacheKey = GLProgramCache.key(vertexSrc, fragmentSrc);\r\n        const cachedProgram = GLProgramCache.get(cacheKey);\r\n\r\n        if (!forceCompile && cachedProgram)\r\n        {\r\n            return cachedProgram;\r\n        }\r\n\r\n        const glVertShader = GLShader.compileShader(gl, gl.VERTEX_SHADER, vertexSrc);\r\n        const glFragShader = GLShader.compileShader(gl, gl.FRAGMENT_SHADER, fragmentSrc);\r\n\r\n        let program = gl.createProgram();\r\n\r\n        gl.attachShader(program, glVertShader);\r\n        gl.attachShader(program, glFragShader);\r\n        gl.linkProgram(program);\r\n\r\n        // if linking fails, then log and cleanup\r\n        if (!gl.getProgramParameter(program, gl.LINK_STATUS))\r\n        {\r\n            ASSERT(false, `Could not initialize shader.\r\ngl.VALIDATE_STATUS: ${gl.getProgramParameter(program, gl.VALIDATE_STATUS)}\r\ngl.getError(): ${gl.getError()}\r\ngl.getProgramInfoLog(): ${gl.getProgramInfoLog(program)}\r\n            `);\r\n\r\n            gl.deleteProgram(program);\r\n\r\n            program = null;\r\n        }\r\n\r\n\r\n        // clean up some shaders\r\n        gl.deleteShader(glVertShader);\r\n        gl.deleteShader(glFragShader);\r\n\r\n        if (program)\r\n        {\r\n            GLProgramCache.set(cacheKey, program);\r\n        }\r\n\r\n        return program;\r\n    }\r\n\r\n    /**\r\n     * Compiles source into a program.\r\n     *\r\n     * @static\r\n     * @param {WebGLRenderingContext} gl - The rendering context.\r\n     * @param {number} type - The type, can be either gl.VERTEX_SHADER or gl.FRAGMENT_SHADER.\r\n     * @param {string} source - The fragment shader source as an array of strings.\r\n     * @return {WebGLShader} the shader\r\n     */\r\n    static compileShader(gl, type, source)\r\n    {\r\n        const shader = gl.createShader(type);\r\n\r\n        gl.shaderSource(shader, source);\r\n        gl.compileShader(shader);\r\n\r\n        if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS))\r\n        {\r\n            ASSERT(false, `Failed to compile shader.\r\ngl.COMPILE_STATUS: ${gl.getShaderParameter(shader, gl.COMPILE_STATUS)}\r\ngl.getShaderInfoLog(): ${gl.getShaderInfoLog(shader)}\r\n            `);\r\n\r\n            return null;\r\n        }\r\n\r\n\r\n        return shader;\r\n    }\r\n\r\n    /**\r\n     * Extracts the attributes\r\n     *\r\n     * @static\r\n     * @param {WebGLRenderingContext} gl - The rendering context.\r\n     * @param {WebGLProgram} program - The shader program to get the attributes from\r\n     * @return {object} attributes\r\n     */\r\n    static extractAttributes(gl, program)\r\n    {\r\n        const attributes = {};\r\n\r\n        const totalAttributes = gl.getProgramParameter(program, gl.ACTIVE_ATTRIBUTES);\r\n\r\n        for (let i = 0; i < totalAttributes; ++i)\r\n        {\r\n            const attribData = gl.getActiveAttrib(program, i);\r\n\r\n            ASSERT(GL_SIZE_MAP[attribData.type], 'Unknown attribute type, unable to determine size.');\r\n\r\n            attributes[attribData.name] = {\r\n                type: attribData.type,\r\n                size: GL_SIZE_MAP[attribData.type],\r\n                location: gl.getAttribLocation(program, attribData.name),\r\n                setup: attributeSetupFunction,\r\n            };\r\n        }\r\n\r\n        return attributes;\r\n    }\r\n\r\n    /**\r\n     * Extracts the uniforms\r\n     *\r\n     * @static\r\n     * @param {WebGLRenderingContext} gl - The rendering context.\r\n     * @param {WebGLProgram} program - The shader program to get the uniforms from\r\n     * @return {object} uniforms\r\n     */\r\n    static extractUniforms(gl, program)\r\n    {\r\n        const uniforms = {};\r\n\r\n        const totalUniforms = gl.getProgramParameter(program, gl.ACTIVE_UNIFORMS);\r\n\r\n        for (let i = 0; i < totalUniforms; ++i)\r\n        {\r\n            const uniformData = gl.getActiveUniform(program, i);\r\n            const name = uniformData.name.replace(/\\[.*?\\]/, '');\r\n\r\n            uniforms[name] = {\r\n                type: uniformData.type,\r\n                size: uniformData.size,\r\n                location: gl.getUniformLocation(program, name),\r\n                value: getUniformDefault(uniformData),\r\n            };\r\n        }\r\n\r\n        return uniforms;\r\n    }\r\n\r\n    /**\r\n     * Extracts the uniforms\r\n     *\r\n     * @static\r\n     * @param {WebGLRenderingContext} gl - The rendering context.\r\n     * @param {object} uniformData - The uniform data to create an access object for.\r\n     * @return {object} uniform access object.\r\n     */\r\n    static generateUniformAccessObject(gl, uniformData)\r\n    {\r\n        // this is the object we will be sending back.\r\n        // an object hierachy will be created for structs\r\n        const uniforms = {\r\n            __data: {},\r\n        };\r\n\r\n        const uniformKeys = Object.keys(uniformData);\r\n\r\n        for (let i = 0; i < uniformKeys.length; ++i)\r\n        {\r\n            const fullName = uniformKeys[i];\r\n\r\n            const nameTokens = fullName.split('.');\r\n            const name = nameTokens[nameTokens.length - 1];\r\n\r\n            const uniformGroup = getUniformGroup(nameTokens, uniforms);\r\n            const uniform = uniformData[fullName];\r\n\r\n            uniformGroup.__data[name] = uniform;\r\n\r\n            Reflect.defineProperty(uniformGroup, name, {\r\n                enumerable: true,\r\n                get: () => uniform.value,\r\n                set: (value) =>\r\n                {\r\n                    uniform.value = value;\r\n\r\n                    const loc = uniform.location;\r\n\r\n                    if (uniform.size === 1)\r\n                    {\r\n                        GL_SETTER[uniform.type](gl, loc, value);\r\n                    }\r\n                    else\r\n                    {\r\n                        GL_ARRAY_SETTER[uniform.type](gl, loc, value);\r\n                    }\r\n                },\r\n            });\r\n        }\r\n\r\n        return uniforms;\r\n    }\r\n\r\n    /**\r\n     * Recompiles the shader program.\r\n     *\r\n     * @param {boolean} forceCompile - When set to true this will always compile,\r\n     *  skipping the cache checks.\r\n     */\r\n    recompile(forceCompile = false)\r\n    {\r\n        if (!this.vertexSrc || !this.fragmentSrc) return;\r\n\r\n        this.program = GLShader.compileProgram(this.gl, this.vertexSrc, this.fragmentSrc, forceCompile);\r\n        this.attributes = GLShader.extractAttributes(this.gl, this.program);\r\n        this.uniforms = GLShader.generateUniformAccessObject(this.gl, GLShader.extractUniforms(this.gl, this.program));\r\n    }\r\n\r\n    /**\r\n     * Uses this shader\r\n     */\r\n    bind()\r\n    {\r\n        this.gl.useProgram(this.program);\r\n    }\r\n\r\n    /**\r\n     * Destroys this shader\r\n     * TODO\r\n     */\r\n    destroy()\r\n    {\r\n        // var gl = this.gl;\r\n    }\r\n}\r\n\r\nfunction attributeSetupFunction(gl, attrib)\r\n{\r\n    return gl.vertexAttribPointer(\r\n        this.location,\r\n        this.size,\r\n        attrib.type || this.type,\r\n        attrib.normalized || false,\r\n        attrib.stride || 0,\r\n        attrib.start || 0\r\n    );\r\n}\r\n\r\nfunction getUniformGroup(nameTokens, uniform)\r\n{\r\n    let cur = uniform;\r\n\r\n    for (let i = 0; i < nameTokens.length - 1; ++i)\r\n    {\r\n        const o = cur[nameTokens[i]] || { __data: {} };\r\n\r\n        cur[nameTokens[i]] = o;\r\n        cur = o;\r\n    }\r\n\r\n    return cur;\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/core/src/gl/GLShader.js\n **/","import { ASSERT } from '../debug';\r\n\r\n/**\r\n * @namespace GLData\r\n * @memberof glutil\r\n */\r\n\r\n/**\r\n * Map of WebGL types to their respective sizes.\r\n *\r\n * @memberof glutil.GLData\r\n */\r\nexport const GL_SIZE_MAP = {\r\n    [WebGLRenderingContext.FLOAT]:      1,\r\n    [WebGLRenderingContext.FLOAT_VEC2]: 2,\r\n    [WebGLRenderingContext.FLOAT_VEC3]: 3,\r\n    [WebGLRenderingContext.FLOAT_VEC4]: 4,\r\n\r\n    [WebGLRenderingContext.INT]:        1,\r\n    [WebGLRenderingContext.INT_VEC2]:   2,\r\n    [WebGLRenderingContext.INT_VEC3]:   3,\r\n    [WebGLRenderingContext.INT_VEC4]:   4,\r\n\r\n    [WebGLRenderingContext.BOOL]:       1,\r\n    [WebGLRenderingContext.BOOL_VEC2]:  2,\r\n    [WebGLRenderingContext.BOOL_VEC3]:  3,\r\n    [WebGLRenderingContext.BOOL_VEC4]:  4,\r\n\r\n    [WebGLRenderingContext.FLOAT_MAT2]: 4,\r\n    [WebGLRenderingContext.FLOAT_MAT3]: 9,\r\n    [WebGLRenderingContext.FLOAT_MAT4]: 16,\r\n\r\n    [WebGLRenderingContext.SAMPLER_2D]: 1,\r\n};\r\n\r\n/**\r\n * Map of WebGL types to setter functions to upload the values of that type.\r\n * This map is for single values of the types.\r\n *\r\n * @memberof glutil.GLData\r\n */\r\nexport const GL_SETTER = {\r\n    [WebGLRenderingContext.FLOAT]:      (gl, loc, value) => gl.uniform1f(loc, value),\r\n    [WebGLRenderingContext.FLOAT_VEC2]: (gl, loc, value) => gl.uniform2f(loc, value[0], value[1]),\r\n    [WebGLRenderingContext.FLOAT_VEC3]: (gl, loc, value) => gl.uniform3f(loc, value[0], value[1], value[2]),\r\n    [WebGLRenderingContext.FLOAT_VEC4]: (gl, loc, value) => gl.uniform4f(loc, value[0], value[1], value[2], value[3]),\r\n\r\n    [WebGLRenderingContext.INT]:        (gl, loc, value) => gl.uniform1i(loc, value),\r\n    [WebGLRenderingContext.INT_VEC2]:   (gl, loc, value) => gl.uniform2i(loc, value[0], value[1]),\r\n    [WebGLRenderingContext.INT_VEC3]:   (gl, loc, value) => gl.uniform3i(loc, value[0], value[1], value[2]),\r\n    [WebGLRenderingContext.INT_VEC4]:   (gl, loc, value) => gl.uniform4i(loc, value[0], value[1], value[2], value[3]),\r\n\r\n    [WebGLRenderingContext.BOOL]:       (gl, loc, value) => gl.uniform1i(loc, value),\r\n    [WebGLRenderingContext.BOOL_VEC2]:  (gl, loc, value) => gl.uniform2i(loc, value[0], value[1]),\r\n    [WebGLRenderingContext.BOOL_VEC3]:  (gl, loc, value) => gl.uniform3i(loc, value[0], value[1], value[2]),\r\n    [WebGLRenderingContext.BOOL_VEC4]:  (gl, loc, value) => gl.uniform4i(loc, value[0], value[1], value[2], value[3]),\r\n\r\n    [WebGLRenderingContext.FLOAT_MAT2]: (gl, loc, value) => gl.uniformMatrix2fv(loc, false, value),\r\n    [WebGLRenderingContext.FLOAT_MAT3]: (gl, loc, value) => gl.uniformMatrix3fv(loc, false, value),\r\n    [WebGLRenderingContext.FLOAT_MAT4]: (gl, loc, value) => gl.uniformMatrix4fv(loc, false, value),\r\n\r\n    [WebGLRenderingContext.SAMPLER_2D]: (gl, loc, value) => gl.uniform1i(loc, value),\r\n};\r\n\r\n/**\r\n * Map of WebGL types to setter functions to upload the values of that type.\r\n * This map is for arrays of the types.\r\n *\r\n * @memberof glutil.GLData\r\n */\r\nexport const GL_ARRAY_SETTER = {\r\n    [WebGLRenderingContext.FLOAT]:      (gl, loc, value) => gl.uniform1fv(loc, value),\r\n    [WebGLRenderingContext.FLOAT_VEC2]: (gl, loc, value) => gl.uniform2fv(loc, value[0], value[1]),\r\n    [WebGLRenderingContext.FLOAT_VEC3]: (gl, loc, value) => gl.uniform3fv(loc, value[0], value[1], value[2]),\r\n    [WebGLRenderingContext.FLOAT_VEC4]: (gl, loc, value) => gl.uniform4fv(loc, value[0], value[1], value[2], value[3]),\r\n\r\n    [WebGLRenderingContext.INT]:        (gl, loc, value) => gl.uniform1iv(loc, value),\r\n    [WebGLRenderingContext.INT_VEC2]:   (gl, loc, value) => gl.uniform2iv(loc, value[0], value[1]),\r\n    [WebGLRenderingContext.INT_VEC3]:   (gl, loc, value) => gl.uniform3iv(loc, value[0], value[1], value[2]),\r\n    [WebGLRenderingContext.INT_VEC4]:   (gl, loc, value) => gl.uniform4iv(loc, value[0], value[1], value[2], value[3]),\r\n\r\n    [WebGLRenderingContext.BOOL]:       (gl, loc, value) => gl.uniform1iv(loc, value),\r\n    [WebGLRenderingContext.BOOL_VEC2]:  (gl, loc, value) => gl.uniform2iv(loc, value[0], value[1]),\r\n    [WebGLRenderingContext.BOOL_VEC3]:  (gl, loc, value) => gl.uniform3iv(loc, value[0], value[1], value[2]),\r\n    [WebGLRenderingContext.BOOL_VEC4]:  (gl, loc, value) => gl.uniform4iv(loc, value[0], value[1], value[2], value[3]),\r\n\r\n    [WebGLRenderingContext.FLOAT_MAT2]: (gl, loc, value) => gl.uniformMatrix2fv(loc, false, value),\r\n    [WebGLRenderingContext.FLOAT_MAT3]: (gl, loc, value) => gl.uniformMatrix3fv(loc, false, value),\r\n    [WebGLRenderingContext.FLOAT_MAT4]: (gl, loc, value) => gl.uniformMatrix4fv(loc, false, value),\r\n\r\n    [WebGLRenderingContext.SAMPLER_2D]: (gl, loc, value) => gl.uniform1iv(loc, value),\r\n};\r\n\r\n/**\r\n * Maps a uniform data type and size to an instance of the default value.\r\n *\r\n * @memberof glutil.GLData\r\n * @param {object} uniformData - The data to use to determine the default value.\r\n * @return {*} The default value.\r\n */\r\nexport function getUniformDefault(uniformData)\r\n{\r\n    const size = uniformData.size;\r\n\r\n    switch (uniformData.type)\r\n    {\r\n        case WebGLRenderingContext.FLOAT:\r\n            return 0;\r\n\r\n        case WebGLRenderingContext.FLOAT_VEC2:\r\n            return new Float32Array(2 * size);\r\n\r\n        case WebGLRenderingContext.FLOAT_VEC3:\r\n            return new Float32Array(3 * size);\r\n\r\n        case WebGLRenderingContext.FLOAT_VEC4:\r\n            return new Float32Array(4 * size);\r\n\r\n        case WebGLRenderingContext.INT:\r\n        case WebGLRenderingContext.SAMPLER_2D:\r\n            return 0;\r\n\r\n        case WebGLRenderingContext.INT_VEC2:\r\n            return new Int32Array(2 * size);\r\n\r\n        case WebGLRenderingContext.INT_VEC3:\r\n            return new Int32Array(3 * size);\r\n\r\n        case WebGLRenderingContext.INT_VEC4:\r\n            return new Int32Array(4 * size);\r\n\r\n        case WebGLRenderingContext.BOOL:\r\n            return false;\r\n\r\n        case WebGLRenderingContext.BOOL_VEC2:\r\n            return booleanArray(2 * size);\r\n\r\n        case WebGLRenderingContext.BOOL_VEC3:\r\n            return booleanArray(3 * size);\r\n\r\n        case WebGLRenderingContext.BOOL_VEC4:\r\n            return booleanArray(4 * size);\r\n\r\n        case WebGLRenderingContext.FLOAT_MAT2:\r\n            return new Float32Array([1, 0,\r\n                                     0, 1]);\r\n\r\n        case WebGLRenderingContext.FLOAT_MAT3:\r\n            return new Float32Array([1, 0, 0,\r\n                                     0, 1, 0,\r\n                                     0, 0, 1]);\r\n\r\n        case WebGLRenderingContext.FLOAT_MAT4:\r\n            return new Float32Array([1, 0, 0, 0,\r\n                                     0, 1, 0, 0,\r\n                                     0, 0, 1, 0,\r\n                                     0, 0, 0, 1]);\r\n    }\r\n\r\n    ASSERT(false, 'Unknown uniform type, unable to determine default value.');\r\n\r\n    return 0;\r\n}\r\n\r\nfunction booleanArray(size)\r\n{\r\n    const array = new Array(size);\r\n\r\n    for (let i = 0; i < array.length; ++i)\r\n    {\r\n        array[i] = false;\r\n    }\r\n\r\n    return array;\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/core/src/gl/GLData.js\n **/","/** @namespace math */\r\n\r\nexport { default as Matrix2d } from './Matrix2d';\r\nexport { default as Vector2d } from './Vector2d';\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/core/src/math/index.js\n **/","/** @namespace render */\r\n\r\nexport { default as ObjectRenderer } from './ObjectRenderer';\r\nexport { default as Renderer } from './Renderer';\r\nexport { default as RenderState } from './RenderState';\r\nexport { default as RenderTarget } from './RenderTarget';\r\nexport { default as Shader } from './Shader';\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/core/src/render/index.js\n **/","import GLShader from '../gl/GLShader';\r\n\r\n/**\r\n * Shader wrapper.\r\n *\r\n * @class\r\n * @memberof render\r\n */\r\nexport default class Shader extends GLShader\r\n{\r\n    /**\r\n     * Constructs a new Shader.\r\n     *\r\n     * @param {Renderer} renderer - The Renderer to use for this shader.\r\n     * @param {string} vertexSrc - The vertex shader source as an array of strings.\r\n     * @param {string} fragmentSrc - The fragment shader source as an array of strings.\r\n     */\r\n    constructor(renderer, vertexSrc, fragmentSrc)\r\n    {\r\n        super(renderer.gl, checkPrecision(vertexSrc), checkPrecision(fragmentSrc));\r\n\r\n        /**\r\n         * Parent Renderer instance.\r\n         *\r\n         * @member {Renderer}\r\n         */\r\n        this.renderer = renderer;\r\n\r\n        /**\r\n         * Binding for when context is restored.\r\n         *\r\n         * @member {SignalBinding}\r\n         */\r\n        this._onContextChangeBinding = renderer.onContextChange.add(this.recompile, this);\r\n    }\r\n\r\n    /**\r\n     *\r\n     */\r\n    destroy()\r\n    {\r\n        this._onContextChangeBinding.detachAll();\r\n        this._onContextChangeBinding = null;\r\n\r\n        this.renderer = null;\r\n    }\r\n}\r\n\r\n/**\r\n * Value that specifies float precision in shaders.\r\n *\r\n * @static\r\n * @constant\r\n * @type {object}\r\n * @property {string} DEFAULT=MEDIUM - The default precision to use.\r\n * @property {string} LOW - The low precision header.\r\n * @property {string} MEDIUM - The medium precision header.\r\n * @property {string} HIGH - The high precision header.\r\n */\r\nShader.PRECISION = {\r\n    DEFAULT:    'highp',\r\n    LOW:        'lowp',\r\n    MEDIUM:     'mediump',\r\n    HIGH:       'highp',\r\n};\r\n\r\n/**\r\n * Ensures that the source of the program has precision specified.\r\n *\r\n * @ignore\r\n * @param {string} source - The source to check.\r\n * @return {string} The potentially modified source.\r\n */\r\nfunction checkPrecision(source)\r\n{\r\n    if (!source) return '';\r\n\r\n    const lines = source.split('\\n');\r\n\r\n    let commentOpen = false;\r\n\r\n    for (let i = 0; i < lines.length; ++i)\r\n    {\r\n        const line = lines[i].trim();\r\n        const firstChars = line.substring(0, 2);\r\n\r\n        // line comment, ignore\r\n        if (firstChars === '//') continue;\r\n\r\n        // start of block comment, set flag\r\n        if (firstChars === '/*')\r\n        {\r\n            commentOpen = true;\r\n        }\r\n\r\n        // if comment open, check if this line ends it. If not continue\r\n        if (commentOpen)\r\n        {\r\n            if (line.indexOf('*/') !== -1)\r\n            {\r\n                commentOpen = false;\r\n            }\r\n\r\n            continue;\r\n        }\r\n\r\n        // not in a comment, check if precision is set\r\n        if (line.substring(0, 9) !== 'precision')\r\n        {\r\n            return `precision ${Shader.PRECISION.DEFAULT} float;\\n\\n${source}`;\r\n        }\r\n    }\r\n\r\n    return source;\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/core/src/render/Shader.js\n **/","/** @namespace filters */\r\n\r\nexport { default as Filter } from './Filter';\r\nexport { default as FilterComponent } from './FilterComponent';\r\nexport { default as FilterPrepareSystem } from './FilterPrepareSystem';\r\nexport { default as FilterRenderSystem } from './FilterRenderSystem';\r\nexport { default as FilterUtils } from './FilterUtils';\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/filters/src/index.js\n **/","import { render, util } from '@fae/core';\r\n\r\nconst reservedUniforms = [\r\n    '__data',               // reserved key from the parsing of uniforms in the GLShader\r\n    'uSampler',             // reserved key as the input texture to a filter\r\n    'uProjectionMatrix',    // reserved key as the precalculated projection matrix\r\n];\r\n\r\n/**\r\n * @class\r\n * @memberof filters\r\n */\r\nexport default class Filter extends render.Shader\r\n{\r\n    /**\r\n     * @param {Renderer} renderer - The renderer instance of the filter.\r\n     * @param {string} fragmentSrc - The source of the fragment shader for this filter.\r\n     * @param {string} vertexSrc - The source of the vertex shader for this filter.\r\n     */\r\n    constructor(renderer, fragmentSrc, vertexSrc = Filter.defaultVertexSrc)\r\n    {\r\n        super(renderer, vertexSrc, fragmentSrc);\r\n\r\n        /**\r\n         * Whether or not this filter is currently enabled. This is useful\r\n         * if you need to turn on/off a filter often and don't want to change\r\n         * an Entity's `filters` array.\r\n         *\r\n         * @member {boolean}\r\n         * @default true\r\n         */\r\n        this.enable = true;\r\n\r\n        /**\r\n         * The blend mode to be applied to the filter pass.\r\n         *\r\n         * @member {BlendMode}\r\n         * @default BlendMode.NORMAL\r\n         */\r\n        this.blendMode = util.BlendMode.NORMAL;\r\n\r\n        /**\r\n         * The values for the uniforms of this filter. This object will contain a property\r\n         * for each uniform, automatically detected from the shader source.\r\n         *\r\n         * Use this to set uniform values. *Do not* set values with\r\n         * `filter.uniforms.<name> = ` as that will cause unexpected results.\r\n         *\r\n         * @member {*}\r\n         */\r\n        this.values = Filter.generateValueProperties(this.uniforms);\r\n    }\r\n\r\n    /**\r\n     * Generates the values object with a key for each uniform.\r\n     *\r\n     * @param {*} uniforms - The uniforms to create a values object for.\r\n     * @return {*} The values object.\r\n     */\r\n    static generateValueProperties(uniforms)\r\n    {\r\n        // TODO: Structs....\r\n\r\n        const values = {};\r\n\r\n        for (const k in uniforms)\r\n        {\r\n            // skip reserved names\r\n            if (reservedUniforms.indexOf(k) !== -1) continue;\r\n\r\n            values[k] = uniforms[k];\r\n        }\r\n\r\n        return values;\r\n    }\r\n\r\n    /**\r\n     * Runs the filter, performing the post-processing passes the filter defines.\r\n     *\r\n     * @param {FilterRenderSystem} system - The render system.\r\n     * @param {RenderTarget} input - The render target to use as input.\r\n     * @param {RenderTarget} output - The render target to use as output.\r\n     * @param {boolean} clear - Should the output buffer be cleared before use?\r\n     */\r\n    run(system, input, output, clear)\r\n    {\r\n        system.drawFilter(this, input, output, clear);\r\n    }\r\n\r\n    /**\r\n     * Should only be called after the filter has been set as the bound shader.\r\n     * Since the FilterRenderSystem calls this for you, there should be almost\r\n     * no situation where you should call this yourself.\r\n     *\r\n     */\r\n    syncUniforms()\r\n    {\r\n        // TODO: Structs....\r\n\r\n        // slot 0 is the main texture, additional textures start at 1\r\n        let textureCount = 1;\r\n\r\n        const values = this.values;\r\n        const uniforms = this.uniforms;\r\n        const uniformData = this.uniforms.__data;\r\n\r\n        for (const k in values)\r\n        {\r\n            if (!uniformData[k]) continue;\r\n\r\n            if (uniformData[k].type === 'sampler2D')\r\n            {\r\n                uniforms[k] = textureCount;\r\n\r\n                // TextureSource object from the textures plugin\r\n                // or anything that can give me a gl texture really.\r\n                if (values[k].getGlTexture)\r\n                {\r\n                    const tx = values[k].getGlTexture(this.renderer);\r\n\r\n                    if (tx) tx.bind(textureCount);\r\n                }\r\n                // Texture object from the textures plugin.\r\n                else if (values[k].source && values[k].source.getGlTexture)\r\n                {\r\n                    const tx = values[k].source.getGlTexture(this.renderer);\r\n\r\n                    if (tx) tx.bind(textureCount);\r\n                }\r\n                // RenderTarget, GLFramebuffer, or anything with a GLTexture property.\r\n                else if (values[k].texture)\r\n                {\r\n                    values[k].texture.bind(textureCount);\r\n                }\r\n\r\n                textureCount++;\r\n            }\r\n            else if (uniformData[k].type === 'mat3')\r\n            {\r\n                // check if its a matrix object\r\n                if (typeof values[k].a !== 'undefined')\r\n                {\r\n                    uniforms[k] = values[k].toArray(true);\r\n                }\r\n                else\r\n                {\r\n                    uniforms[k] = values[k];\r\n                }\r\n            }\r\n            else if (uniformData[k].type === 'vec2')\r\n            {\r\n                // check if its a vector object\r\n                if (typeof values[k].x !== 'undefined')\r\n                {\r\n                    const val = uniforms[k] || new Float32Array(2);\r\n\r\n                    val[0] = values[k].x;\r\n                    val[1] = values[k].y;\r\n\r\n                    uniforms[k] = val;\r\n                }\r\n                else\r\n                {\r\n                    uniforms[k] = values[k];\r\n                }\r\n            }\r\n            else\r\n            {\r\n                uniforms[k] = values[k];\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * @static\r\n * @constant\r\n * @memberof Filter\r\n * @type {string}\r\n */\r\nFilter.defaultVertexSrc = require('./default.vert');\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/filters/src/Filter.js\n **/","module.exports = \"#define GLSLIFY 1\\nattribute vec2 aVertexPosition;\\nattribute vec2 aTextureCoord;\\n\\nuniform mat3 uProjectionMatrix;\\n\\nvarying vec2 vTextureCoord;\\n\\nvoid main(void) {\\n    gl_Position = vec4((uProjectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\\n    vTextureCoord = aTextureCoord;\\n}\\n\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./plugins/filters/src/default.vert\n ** module id = 44\n ** module chunks = 0\n **/","export default function FilterComponent(Base)\r\n{\r\n    /**\r\n     * @class FilterComponent\r\n     * @memberof filters\r\n     */\r\n    return class extends Base\r\n    {\r\n        /**\r\n         *\r\n         */\r\n        constructor()\r\n        {\r\n            super(...arguments); // eslint-disable-line prefer-rest-params\r\n\r\n            /**\r\n             * The filters to apply to this object.\r\n             *\r\n             * @member {Filter[]}\r\n             */\r\n            this.filters = [];\r\n\r\n            /**\r\n             * The area to use to filter, relative to the object's frame. Either this\r\n             * rectangle must exist, or the entity needs to have the bounds component.\r\n             *\r\n             * When rendering filters the system tries to get this value, and if it\r\n             * doesn't exist calls `getBounds()` instead.\r\n             *\r\n             * @member {Rectangle}\r\n             */\r\n            this.filterArea = null;\r\n        }\r\n    };\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/filters/src/FilterComponent.js\n **/","import { ecs, render } from '@fae/core';\r\nimport FilterComponent from './FilterComponent';\r\nimport FilterUtils from './FilterUtils';\r\n\r\n/**\r\n * @class\r\n * @memberof filters\r\n */\r\nexport default class FilterPrepareSystem extends ecs.System\r\n{\r\n    /**\r\n     * @param {Renderer} renderer - The renderer to use.\r\n     * @param {number} priority - The priority of the system, higher means earlier.\r\n     * @param {number} frequency - How often to run the update loop. `1` means every\r\n     *  time, `2` is every other time, etc.\r\n     */\r\n    constructor(renderer, priority = (ecs.System.PRIORITY.PLUGIN + 500), frequency = 1)\r\n    {\r\n        super(renderer, priority, frequency);\r\n    }\r\n\r\n    /**\r\n     * Returns true if the entity is eligible to the system, false otherwise.\r\n     *\r\n     * @param {Entity} entity - The entity to test.\r\n     * @return {boolean} True if entity should be included.\r\n     */\r\n    test(entity)\r\n    {\r\n        return entity.hasComponent(FilterComponent);\r\n    }\r\n\r\n    /**\r\n     * Prepare the entity for filtered rendering.\r\n     *\r\n     * @param {Entity} entity - The entity to update\r\n     */\r\n    update(entity)\r\n    {\r\n        if (entity.filters.length === 0) return;\r\n\r\n        // stop obj renderer\r\n        this.renderer.activeObjectRenderer.stop();\r\n\r\n        // reassign target and setup filter state\r\n        FilterUtils.setup(entity, this.renderer);\r\n\r\n        // start obj renderer\r\n        this.renderer.activeObjectRenderer.start();\r\n    }\r\n}\r\n\r\nrender.Renderer.addDefaultSystem(FilterPrepareSystem);\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/filters/src/FilterPrepareSystem.js\n **/","import { render } from '@fae/core';\r\nimport { Rectangle } from '@fae/shapes';\r\nimport bitTwiddle from 'bit-twiddle';\r\n\r\n/**\r\n * @namespace FilterUtils\r\n * @memberof filters\r\n */\r\nexport default {\r\n    initialRenderTarget: null,\r\n    activeRenderTarget: null,\r\n    activeBounds: new Rectangle(),\r\n    activeSize: new Rectangle(),\r\n    _renderTargetPool: [],\r\n\r\n    /**\r\n     * Sets up the render targets and bounds for a filter render pass.\r\n     * This is called by the FilterPrepareSystem when we encounter an\r\n     * entity that has filters.\r\n     *\r\n     * @memberof filters.FilterUtils\r\n     * @param {Entity} entity - The entity to setup for.\r\n     * @param {Renderer} renderer - The renderer to setup for.\r\n     */\r\n    setup(entity, renderer /* , resolution*/)\r\n    {\r\n        this.initialRenderTarget = renderer.state.target;\r\n\r\n        if (this.activeRenderTarget)\r\n        {\r\n            this.freeRenderTarget(this.activeRenderTarget);\r\n        }\r\n\r\n        // prepare state\r\n        const bounds = entity.filterArea || entity.getBounds();\r\n        const width = bitTwiddle.nextPow2(bounds.width);\r\n        const height = bitTwiddle.nextPow2(bounds.height);\r\n\r\n        this.activeBounds.copy(bounds);\r\n        this.activeSize.width = bounds.width;\r\n        this.activeSize.height = bounds.height;\r\n\r\n        this.activeRenderTarget = this.getRenderTarget(renderer.gl, width, height);\r\n\r\n        renderer.state.setRenderTarget(this.activeRenderTarget);\r\n    },\r\n\r\n    /**\r\n     * Gets a render target that a filter can use.\r\n     *\r\n     * @memberof filters.FilterUtils\r\n     * @param {WebGLRenderingContext} gl - The context to create it for.\r\n     * @param {number} width - The width of the render target to set.\r\n     * @param {number} height - The height of the render target to set.\r\n     * @return {RenderTarget} The render target.\r\n     */\r\n    getRenderTarget(gl, width = this.activeBounds.width, height = this.activeBounds.height /* , resolution */)\r\n    {\r\n        width = bitTwiddle.nextPow2(width /* * resolution */);\r\n        height = bitTwiddle.nextPow2(height /* * resolution */);\r\n\r\n        const renderTarget = this._renderTargetPool.pop() || new render.RenderTarget(gl, width, height);\r\n\r\n        renderTarget\r\n            .resize(width, height)\r\n            .setFrame(this.activeSize, this.activeBounds);\r\n\r\n        return renderTarget;\r\n    },\r\n\r\n    /**\r\n     * Returns a render target to the pool for use later.\r\n     *\r\n     * @memberof filters.FilterUtils\r\n     * @param {RenderTarget} renderTarget - The render target.\r\n     */\r\n    freeRenderTarget(renderTarget)\r\n    {\r\n        this._renderTargetPool.push(renderTarget);\r\n    },\r\n};\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/filters/src/FilterUtils.js\n **/","/**\n * Bit twiddling hacks for JavaScript.\n *\n * Author: Mikola Lysenko\n *\n * Ported from Stanford bit twiddling hack library:\n *    http://graphics.stanford.edu/~seander/bithacks.html\n */\n\n\"use strict\"; \"use restrict\";\n\n//Number of bits in an integer\nvar INT_BITS = 32;\n\n//Constants\nexports.INT_BITS  = INT_BITS;\nexports.INT_MAX   =  0x7fffffff;\nexports.INT_MIN   = -1<<(INT_BITS-1);\n\n//Returns -1, 0, +1 depending on sign of x\nexports.sign = function(v) {\n  return (v > 0) - (v < 0);\n}\n\n//Computes absolute value of integer\nexports.abs = function(v) {\n  var mask = v >> (INT_BITS-1);\n  return (v ^ mask) - mask;\n}\n\n//Computes minimum of integers x and y\nexports.min = function(x, y) {\n  return y ^ ((x ^ y) & -(x < y));\n}\n\n//Computes maximum of integers x and y\nexports.max = function(x, y) {\n  return x ^ ((x ^ y) & -(x < y));\n}\n\n//Checks if a number is a power of two\nexports.isPow2 = function(v) {\n  return !(v & (v-1)) && (!!v);\n}\n\n//Computes log base 2 of v\nexports.log2 = function(v) {\n  var r, shift;\n  r =     (v > 0xFFFF) << 4; v >>>= r;\n  shift = (v > 0xFF  ) << 3; v >>>= shift; r |= shift;\n  shift = (v > 0xF   ) << 2; v >>>= shift; r |= shift;\n  shift = (v > 0x3   ) << 1; v >>>= shift; r |= shift;\n  return r | (v >> 1);\n}\n\n//Computes log base 10 of v\nexports.log10 = function(v) {\n  return  (v >= 1000000000) ? 9 : (v >= 100000000) ? 8 : (v >= 10000000) ? 7 :\n          (v >= 1000000) ? 6 : (v >= 100000) ? 5 : (v >= 10000) ? 4 :\n          (v >= 1000) ? 3 : (v >= 100) ? 2 : (v >= 10) ? 1 : 0;\n}\n\n//Counts number of bits\nexports.popCount = function(v) {\n  v = v - ((v >>> 1) & 0x55555555);\n  v = (v & 0x33333333) + ((v >>> 2) & 0x33333333);\n  return ((v + (v >>> 4) & 0xF0F0F0F) * 0x1010101) >>> 24;\n}\n\n//Counts number of trailing zeros\nfunction countTrailingZeros(v) {\n  var c = 32;\n  v &= -v;\n  if (v) c--;\n  if (v & 0x0000FFFF) c -= 16;\n  if (v & 0x00FF00FF) c -= 8;\n  if (v & 0x0F0F0F0F) c -= 4;\n  if (v & 0x33333333) c -= 2;\n  if (v & 0x55555555) c -= 1;\n  return c;\n}\nexports.countTrailingZeros = countTrailingZeros;\n\n//Rounds to next power of 2\nexports.nextPow2 = function(v) {\n  v += v === 0;\n  --v;\n  v |= v >>> 1;\n  v |= v >>> 2;\n  v |= v >>> 4;\n  v |= v >>> 8;\n  v |= v >>> 16;\n  return v + 1;\n}\n\n//Rounds down to previous power of 2\nexports.prevPow2 = function(v) {\n  v |= v >>> 1;\n  v |= v >>> 2;\n  v |= v >>> 4;\n  v |= v >>> 8;\n  v |= v >>> 16;\n  return v - (v>>>1);\n}\n\n//Computes parity of word\nexports.parity = function(v) {\n  v ^= v >>> 16;\n  v ^= v >>> 8;\n  v ^= v >>> 4;\n  v &= 0xf;\n  return (0x6996 >>> v) & 1;\n}\n\nvar REVERSE_TABLE = new Array(256);\n\n(function(tab) {\n  for(var i=0; i<256; ++i) {\n    var v = i, r = i, s = 7;\n    for (v >>>= 1; v; v >>>= 1) {\n      r <<= 1;\n      r |= v & 1;\n      --s;\n    }\n    tab[i] = (r << s) & 0xff;\n  }\n})(REVERSE_TABLE);\n\n//Reverse bits in a 32 bit word\nexports.reverse = function(v) {\n  return  (REVERSE_TABLE[ v         & 0xff] << 24) |\n          (REVERSE_TABLE[(v >>> 8)  & 0xff] << 16) |\n          (REVERSE_TABLE[(v >>> 16) & 0xff] << 8)  |\n           REVERSE_TABLE[(v >>> 24) & 0xff];\n}\n\n//Interleave bits of 2 coordinates with 16 bits.  Useful for fast quadtree codes\nexports.interleave2 = function(x, y) {\n  x &= 0xFFFF;\n  x = (x | (x << 8)) & 0x00FF00FF;\n  x = (x | (x << 4)) & 0x0F0F0F0F;\n  x = (x | (x << 2)) & 0x33333333;\n  x = (x | (x << 1)) & 0x55555555;\n\n  y &= 0xFFFF;\n  y = (y | (y << 8)) & 0x00FF00FF;\n  y = (y | (y << 4)) & 0x0F0F0F0F;\n  y = (y | (y << 2)) & 0x33333333;\n  y = (y | (y << 1)) & 0x55555555;\n\n  return x | (y << 1);\n}\n\n//Extracts the nth interleaved component\nexports.deinterleave2 = function(v, n) {\n  v = (v >>> n) & 0x55555555;\n  v = (v | (v >>> 1))  & 0x33333333;\n  v = (v | (v >>> 2))  & 0x0F0F0F0F;\n  v = (v | (v >>> 4))  & 0x00FF00FF;\n  v = (v | (v >>> 16)) & 0x000FFFF;\n  return (v << 16) >> 16;\n}\n\n\n//Interleave bits of 3 coordinates, each with 10 bits.  Useful for fast octree codes\nexports.interleave3 = function(x, y, z) {\n  x &= 0x3FF;\n  x  = (x | (x<<16)) & 4278190335;\n  x  = (x | (x<<8))  & 251719695;\n  x  = (x | (x<<4))  & 3272356035;\n  x  = (x | (x<<2))  & 1227133513;\n\n  y &= 0x3FF;\n  y  = (y | (y<<16)) & 4278190335;\n  y  = (y | (y<<8))  & 251719695;\n  y  = (y | (y<<4))  & 3272356035;\n  y  = (y | (y<<2))  & 1227133513;\n  x |= (y << 1);\n  \n  z &= 0x3FF;\n  z  = (z | (z<<16)) & 4278190335;\n  z  = (z | (z<<8))  & 251719695;\n  z  = (z | (z<<4))  & 3272356035;\n  z  = (z | (z<<2))  & 1227133513;\n  \n  return x | (z << 2);\n}\n\n//Extracts nth interleaved component of a 3-tuple\nexports.deinterleave3 = function(v, n) {\n  v = (v >>> n)       & 1227133513;\n  v = (v | (v>>>2))   & 3272356035;\n  v = (v | (v>>>4))   & 251719695;\n  v = (v | (v>>>8))   & 4278190335;\n  v = (v | (v>>>16))  & 0x3FF;\n  return (v<<22)>>22;\n}\n\n//Computes next combination in colexicographic order (this is mistakenly called nextPermutation on the bit twiddling hacks page)\nexports.nextCombination = function(v) {\n  var t = v | (v - 1);\n  return (t + 1) | (((~t & -~t) - 1) >>> (countTrailingZeros(v) + 1));\n}\n\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/bit-twiddle/twiddle.js\n ** module id = 48\n ** module chunks = 0\n **/","import { ecs, render, glutil } from '@fae/core';\r\nimport FilterComponent from './FilterComponent';\r\nimport FilterUtils from './FilterUtils';\r\n\r\n/**\r\n * @class\r\n * @memberof filters\r\n */\r\nexport default class FilterRenderSystem extends ecs.System\r\n{\r\n    /**\r\n     * @param {Renderer} renderer - The renderer to use.\r\n     * @param {number} priority - The priority of the system, higher means earlier.\r\n     * @param {number} frequency - How often to run the update loop. `1` means every\r\n     *  time, `2` is every other time, etc.\r\n     */\r\n    constructor(renderer, priority = (ecs.System.PRIORITY.RENDER + 500), frequency = 1)\r\n    {\r\n        super(renderer, priority, frequency);\r\n\r\n        this.quad = null;\r\n\r\n        this._onContextChangeBinding = renderer.onContextChange.add(this._onContextChange, this);\r\n\r\n        this._onContextChange();\r\n    }\r\n\r\n    /**\r\n     * Called by base Manager class when there is a WebGL context change.\r\n     *\r\n     * @private\r\n     */\r\n    _onContextChange()\r\n    {\r\n        if (this.quad) this.quad.destroy();\r\n\r\n        this.quad = new glutil.GLQuad(this.renderer.gl);\r\n\r\n        // TODO: clear and reset FilterUtils renderTargets\r\n    }\r\n\r\n    /**\r\n     * Returns true if the entity is eligible to the system, false otherwise.\r\n     *\r\n     * @param {Entity} entity - The entity to test.\r\n     * @return {boolean} True if entity should be included.\r\n     */\r\n    test(entity)\r\n    {\r\n        return entity.hasComponent(FilterComponent);\r\n    }\r\n\r\n    /**\r\n     * Render the entity using filtered rendering.\r\n     *\r\n     * @param {Entity} entity - The entity to update\r\n     */\r\n    update(entity)\r\n    {\r\n        if (entity.filters.length === 0) return;\r\n\r\n        // stop obj renderer\r\n        this.renderer.activeObjectRenderer.stop();\r\n\r\n        // process the filters\r\n        this.quad.map(FilterUtils.activeRenderTarget, FilterUtils.activeBounds).upload();\r\n\r\n        if (entity.filters.length === 1)\r\n        {\r\n            const filter = entity.filters[0];\r\n\r\n            if (filter.enable)\r\n            {\r\n                filter.run(this, FilterUtils.activeRenderTarget, FilterUtils.initialRenderTarget, false);\r\n            }\r\n        }\r\n        else\r\n        {\r\n            const activeFilters = [];\r\n            let flip = FilterUtils.activeRenderTarget;\r\n            let flop = FilterUtils.getRenderTarget(this.renderer.gl);\r\n            let i = 0;\r\n\r\n            for (i = 0; i < entity.filters.length - 1; ++i)\r\n            {\r\n                if (entity.filters[i].enable)\r\n                {\r\n                    activeFilters.push(entity.filters[i]);\r\n                }\r\n            }\r\n\r\n            for (i = 0; i < activeFilters.length - 1; ++i)\r\n            {\r\n                const filter = activeFilters[i];\r\n\r\n                filter.run(this, flip, flop, true);\r\n\r\n                const t = flip;\r\n\r\n                flip = flop;\r\n                flop = t;\r\n            }\r\n\r\n            activeFilters[i].run(this, flip, FilterUtils.initialRenderTarget, false);\r\n\r\n            FilterUtils.freeRenderTarget(flop);\r\n        }\r\n\r\n        // start obj renderer\r\n        this.renderer.activeObjectRenderer.start();\r\n    }\r\n\r\n    /**\r\n     * Draws a filter.\r\n     *\r\n     * @param {Filter} filter - The filter to draw.\r\n     * @param {RenderTarget} input - The render target to use as input.\r\n     * @param {RenderTarget} output - The render target to use as output.\r\n     * @param {boolean} clear - Should the output buffer be cleared before use?\r\n     */\r\n    drawFilter(filter, input, output, clear)\r\n    {\r\n        const gl = this.renderer.gl;\r\n        const state = this.renderer.state;\r\n\r\n        this.quad.initVao(filter);\r\n\r\n        state.setRenderTarget(output);\r\n\r\n        if (clear)\r\n        {\r\n            gl.disable(gl.SCISSOR_TEST);\r\n            output.clear();\r\n            gl.enable(gl.SCISSOR_TEST);\r\n        }\r\n\r\n        state.setShader(filter);\r\n\r\n        this._setAutomaticUniforms(filter);\r\n\r\n        filter.syncUniforms();\r\n\r\n        input.framebuffer.texture.bind(0);\r\n\r\n        state.setBlendMode(filter.blendMode);\r\n\r\n        this.quad.draw();\r\n    }\r\n\r\n    /**\r\n     * Sets some uniforms (if they exist) automatically for the user.\r\n     *\r\n     * @private\r\n     * @param {Filter} filter - The filter to setup.\r\n     */\r\n    _setAutomaticUniforms(filter)\r\n    {\r\n        if (filter.values.uFilterArea)\r\n        {\r\n            const area = filter.values.uFilterArea;\r\n\r\n            area[0] = FilterUtils.activeRenderTarget.size.x;\r\n            area[1] = FilterUtils.activeRenderTarget.size.y;\r\n            area[2] = FilterUtils.activeBounds.x;\r\n            area[3] = FilterUtils.activeBounds.y;\r\n        }\r\n\r\n        if (filter.values.uFilterClamp)\r\n        {\r\n            const clamp = filter.values.uFilterClamp;\r\n\r\n            clamp[0] = 0.5 / FilterUtils.activeRenderTarget.size.x;\r\n            clamp[1] = 0.5 / FilterUtils.activeRenderTarget.size.y;\r\n            clamp[2] = (FilterUtils.activeBounds.width - 0.5) / FilterUtils.activeRenderTarget.size.x;\r\n            clamp[3] = (FilterUtils.activeBounds.height - 0.5) / FilterUtils.activeRenderTarget.size.y;\r\n        }\r\n    }\r\n}\r\n\r\nrender.Renderer.addDefaultSystem(FilterRenderSystem);\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/filters/src/FilterRenderSystem.js\n **/","/** @namespace filters-pack */\r\n\r\nexport { default as NoiseFilter } from './noise/NoiseFilter';\r\nexport { default as BlurFilter } from './blur/BlurFilter';\r\nexport { default as BlurXFilter } from './blur/BlurXFilter';\r\nexport { default as BlurYFilter } from './blur/BlurYFilter';\r\nexport { default as FXAAFilter } from './fxaa/FXAAFilter';\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/filters-pack/src/index.js\n **/","import { Filter } from '@fae/filters';\r\n\r\nconst fragSrc = require('./noise.frag');\r\n\r\n/**\r\n * A Noise effect filter.\r\n *\r\n * @class\r\n * @memberof filters-pack\r\n */\r\nexport default class NoiseFilter extends Filter\r\n{\r\n    /**\r\n     * @param {Renderer} renderer - The renderer this filter runs in.\r\n     */\r\n    constructor(renderer)\r\n    {\r\n        super(renderer, fragSrc);\r\n\r\n        this.values.uNoise = 0.5;\r\n    }\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/filters-pack/src/noise/NoiseFilter.js\n **/","module.exports = \"precision highp float;\\n#define GLSLIFY 1\\n\\n// 1 \\\"Standard\\\" fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\\n// 2 One-Dimension fract( mod( 12345678., 256. * p.x) );\\n#define RANDOM_TYPE 1\\n\\nvarying vec2 vTextureCoord;\\n\\nuniform sampler2D uSampler;\\nuniform float uNoise;\\n\\n// http://stackoverflow.com/questions/4200224/random-noise-functions-for-glsl\\n// http://stackoverflow.com/questions/12964279/whats-the-origin-of-this-glsl-rand-one-liner\\nfloat rand(vec2 co)\\n{\\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\\n}\\n\\nvoid main()\\n{\\n    vec4 color = texture2D(uSampler, vTextureCoord);\\n\\n    color *= rand(gl_FragCoord.xy * uNoise);\\n\\n    gl_FragColor = color;\\n}\\n\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./plugins/filters-pack/src/noise/noise.frag\n ** module id = 52\n ** module chunks = 0\n **/","import { Filter, FilterUtils } from '@fae/filters';\r\nimport BlurXFilter from './BlurXFilter';\r\nimport BlurYFilter from './BlurYFilter';\r\n\r\n/**\r\n * @class\r\n */\r\nexport default class BlurFilter extends Filter\r\n{\r\n    /**\r\n     * @param {Renderer} renderer - The renderer to use.\r\n     */\r\n    constructor(renderer)\r\n    {\r\n        super(renderer);\r\n\r\n        this.blurXFilter = new BlurXFilter(renderer);\r\n        this.blurYFilter = new BlurYFilter(renderer);\r\n    }\r\n\r\n    /**\r\n     * Runs the filter, performing the post-processing passes the filter defines.\r\n     *\r\n     * @param {FilterRenderSystem} system - The render system.\r\n     * @param {RenderTarget} input - The render target to use as input.\r\n     * @param {RenderTarget} output - The render target to use as output.\r\n     * @param {boolean} clear - Should the output buffer be cleared before use?\r\n     */\r\n    run(system, input, output /* , clear */)\r\n    {\r\n        const renderTarget = FilterUtils.getRenderTarget(this.renderer.gl);\r\n\r\n        this.blurXFilter.run(system, input, renderTarget, true);\r\n        this.blurYFilter.run(system, renderTarget, output, false);\r\n\r\n        FilterUtils.freeRenderTarget(renderTarget);\r\n    }\r\n\r\n    /**\r\n     * Number of passes for the blur. Higher number produices a higher\r\n     * quality blur, but is less performant.\r\n     *\r\n     * @member {number}\r\n     * @default 1\r\n     */\r\n    get numPasses()\r\n    {\r\n        return this.blurXFilter.numPasses;\r\n    }\r\n\r\n    /**\r\n     * Number of passes for the blur. Higher number produices a higher\r\n     * quality blur, but is less performant.\r\n     *\r\n     * @param {number} v - The value to set to.\r\n     */\r\n    set numPasses(v)\r\n    {\r\n        this.blurXFilter.numPasses = v;\r\n        this.blurYFilter.numPasses = v;\r\n    }\r\n\r\n    /**\r\n     * Number of passes for the blur. Higher number produices a higher\r\n     * quality blur, but is less performant.\r\n     *\r\n     * @member {number}\r\n     * @default 1\r\n     */\r\n    get strength()\r\n    {\r\n        return this.blurXFilter.strength;\r\n    }\r\n\r\n    /**\r\n     * Number of passes for the blur. Higher number produices a higher\r\n     * quality blur, but is less performant.\r\n     *\r\n     * @param {number} v - The value to set to.\r\n     */\r\n    set strength(v)\r\n    {\r\n        this.blurXFilter.strength = v;\r\n        this.blurYFilter.strength = v;\r\n    }\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/filters-pack/src/blur/BlurFilter.js\n **/","import { Filter, FilterUtils } from '@fae/filters';\r\nimport { GAUSSIAN_VALUES, getFragSource, getVertSource, getMaxKernelSize } from './blurUtil';\r\n\r\n/**\r\n * @class\r\n */\r\nexport default class BlurXFilter extends Filter\r\n{\r\n    /**\r\n     * @param {Renderer} renderer - The renderer to use.\r\n     */\r\n    constructor(renderer)\r\n    {\r\n        const kernelSize = getMaxKernelSize(renderer.gl);\r\n\r\n        super(renderer, getFragSource(kernelSize), getVertSource(kernelSize, true));\r\n\r\n        // set default values\r\n        this.values.uBlurValues = GAUSSIAN_VALUES[kernelSize];\r\n\r\n        /**\r\n         * Number of passes for the blur. Higher number produices a higher\r\n         * quality blur, but is less performant.\r\n         *\r\n         * @member {number}\r\n         * @default 1\r\n         */\r\n        this.numPasses = 1;\r\n\r\n        /**\r\n         * The strength of the blur.\r\n         *\r\n         * @member {number}\r\n         * @default 1\r\n         */\r\n        this.strength = 1;\r\n    }\r\n\r\n    /**\r\n     * Runs the filter, performing the post-processing passes the filter defines.\r\n     *\r\n     * @param {FilterRenderSystem} system - The render system.\r\n     * @param {RenderTarget} input - The render target to use as input.\r\n     * @param {RenderTarget} output - The render target to use as output.\r\n     * @param {boolean} clear - Should the output buffer be cleared before use?\r\n     */\r\n    run(system, input, output, clear)\r\n    {\r\n        this.values.uStrength = (1 / output.size.x) * (output.size.x / input.size.y);\r\n        this.values.uStrength *= Math.abs(this.strength);\r\n        this.values.uStrength /= this.numPasses;\r\n\r\n        if (this.numPasses === 1)\r\n        {\r\n            system.drawFilter(this, input, output, clear);\r\n        }\r\n        else\r\n        {\r\n            const renderTarget = FilterUtils.getRenderTarget(this.renderer.gl);\r\n            let flip = input;\r\n            let flop = renderTarget;\r\n\r\n            for (let i = 0; i < this.numPasses - 1; ++i)\r\n            {\r\n                system.drawFilter(this, flip, flop, true);\r\n\r\n                const t = flip;\r\n\r\n                flip = flop;\r\n                flop = t;\r\n            }\r\n\r\n            system.drawFilter(this, flip, output, clear);\r\n            FilterUtils.freeRenderTarget(renderTarget);\r\n        }\r\n    }\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/filters-pack/src/blur/BlurXFilter.js\n **/","/* eslint-disable max-len */\r\nexport const GAUSSIAN_VALUES = {\r\n    5:  [0.153388, 0.221461, 0.250301, 0.221461, 0.153388],\r\n    7:  [0.071303, 0.131514, 0.189879, 0.214607, 0.189879, 0.131514, 0.071303],\r\n    9:  [0.028532, 0.067234, 0.124009, 0.179044, 0.202360, 0.179044, 0.124009, 0.067234, 0.028532],\r\n    11: [0.009300, 0.028002, 0.065984, 0.121703, 0.175713, 0.198596, 0.175713, 0.121703, 0.065984, 0.028002, 0.0093],\r\n    13: [0.002406, 0.009255, 0.027867, 0.065666, 0.121117, 0.174868, 0.197641, 0.174868, 0.121117, 0.065666, 0.027867, 0.009255, 0.002406],\r\n    15: [0.000489, 0.002403, 0.009246, 0.027840, 0.065602, 0.120999, 0.174697, 0.197448, 0.174697, 0.120999, 0.065602, 0.027840, 0.009246, 0.002403, 0.000489],\r\n};\r\n/* eslint-enable max-len */\r\n\r\nconst vertTemplate = require('./blur.vert');\r\nconst fragTemplate = require('./blur.frag');\r\n\r\nexport function getFragSource(kernelSize)\r\n{\r\n    return fragTemplate\r\n        .replace('{{size}}', kernelSize);\r\n}\r\n\r\nexport function getVertSource(kernelSize, isHorizontal)\r\n{\r\n    return vertTemplate\r\n        .replace('{{size}}', kernelSize)\r\n        .replace('{{halfLength}}', Math.ceil(kernelSize / 2))\r\n        .replace('{{horizontal}}', isHorizontal ? 1 : 0);\r\n}\r\n\r\nexport function getMaxKernelSize(gl)\r\n{\r\n    const maxVaryings = gl.getParameter(gl.MAX_VARYING_VECTORS);\r\n    let kernelSize = 15;\r\n\r\n    while (kernelSize > maxVaryings)\r\n    {\r\n        kernelSize -= 2;\r\n    }\r\n\r\n    return kernelSize;\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/filters-pack/src/blur/blurUtil.js\n **/","module.exports = \"#define GLSLIFY 1\\n#define BLUR_KERNEL_SIZE {{size}}\\n#define BLUR_KERNAL_HALF_LENGTH {{halfLength}}.0\\n#define BLUR_HORIZONTAL {{horizontal}}\\n\\n#define SAMPLE_INDEX(i) (float(i) - (BLUR_KERNAL_HALF_LENGTH - 1.0))\\n\\nattribute vec2 aVertexPosition;\\nattribute vec2 aTextureCoord;\\n\\nuniform mat3 uProjectionMatrix;\\nuniform float uStrength;\\n\\nvarying vec2 vBlurTexCoords[BLUR_KERNEL_SIZE];\\n\\nvoid main(void)\\n{\\n    gl_Position = vec4((uProjectionMatrix * vec3((aVertexPosition), 1.0)).xy, 0.0, 1.0);\\n\\n    // this loop will get unrolled\\n    for (int i = 0; i < BLUR_KERNEL_SIZE; ++i)\\n    {\\n        #if BLUR_HORIZONTAL == 1\\n        vBlurTexCoords[i] = aTextureCoord + vec2(SAMPLE_INDEX(i) * uStrength, 0.0);\\n        #else\\n        vBlurTexCoords[i] = aTextureCoord + vec2(0.0, SAMPLE_INDEX(i) * uStrength);\\n        #endif\\n    }\\n}\\n\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./plugins/filters-pack/src/blur/blur.vert\n ** module id = 56\n ** module chunks = 0\n **/","module.exports = \"#define GLSLIFY 1\\n#define BLUR_KERNEL_SIZE {{size}}\\n\\nvarying vec2 vBlurTexCoords[BLUR_KERNEL_SIZE];\\n\\nuniform sampler2D uSampler;\\nuniform float uBlurValues[BLUR_KERNEL_SIZE];\\n\\nvoid main(void)\\n{\\n    gl_FragColor = vec4(0.0);\\n\\n    // this loop will get unrolled\\n    for (int i = 0; i < BLUR_KERNEL_SIZE; ++i)\\n    {\\n        gl_FragColor += texture2D(uSampler, vBlurTexCoords[i]) * uBlurValues[i];\\n    }\\n}\\n\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./plugins/filters-pack/src/blur/blur.frag\n ** module id = 57\n ** module chunks = 0\n **/","import { Filter, FilterUtils } from '@fae/filters';\r\nimport { GAUSSIAN_VALUES, getFragSource, getVertSource } from './blurUtil';\r\n\r\nimport { debug } from '@fae/core';\r\n\r\n/**\r\n * @class\r\n */\r\nexport default class BlurYFilter extends Filter\r\n{\r\n    /**\r\n     * @param {Renderer} renderer - The renderer to use.\r\n     * @param {number} tapLevel - The guasian tap level to use. 5, 7, 9, 11, 13, or 15.\r\n     */\r\n    constructor(renderer, tapLevel = 5)\r\n    {\r\n        debug.ASSERT(GAUSSIAN_VALUES[tapLevel],\r\n            `Unknown tap level: ${tapLevel}, looking for one of: ${Object.keys(GAUSSIAN_VALUES)}`);\r\n\r\n        super(renderer, getFragSource(tapLevel), getVertSource(tapLevel, false));\r\n\r\n        // set default values\r\n        this.values.uBlurValues = GAUSSIAN_VALUES[tapLevel];\r\n\r\n        /**\r\n         * Number of passes for the blur. Higher number produices a higher\r\n         * quality blur, but is less performant.\r\n         *\r\n         * @member {number}\r\n         * @default 1\r\n         */\r\n        this.numPasses = 1;\r\n\r\n        /**\r\n         * The strength of the blur.\r\n         *\r\n         * @member {number}\r\n         * @default 1\r\n         */\r\n        this.strength = 1;\r\n    }\r\n\r\n    /**\r\n     * Runs the filter, performing the post-processing passes the filter defines.\r\n     *\r\n     * @param {FilterRenderSystem} system - The render system.\r\n     * @param {RenderTarget} input - The render target to use as input.\r\n     * @param {RenderTarget} output - The render target to use as output.\r\n     * @param {boolean} clear - Should the output buffer be cleared before use?\r\n     */\r\n    run(system, input, output, clear)\r\n    {\r\n        this.values.uStrength = (1 / output.size.y) * (output.size.y / input.size.y);\r\n        this.values.uStrength *= Math.abs(this.strength);\r\n        this.values.uStrength /= this.numPasses;\r\n\r\n        if (this.numPasses === 1)\r\n        {\r\n            system.drawFilter(this, input, output, clear);\r\n        }\r\n        else\r\n        {\r\n            const renderTarget = FilterUtils.getRenderTarget(this.renderer.gl);\r\n            let flip = input;\r\n            let flop = renderTarget;\r\n\r\n            for (let i = 0; i < this.numPasses - 1; ++i)\r\n            {\r\n                system.drawFilter(this, flip, flop, true);\r\n\r\n                const t = flip;\r\n\r\n                flip = flop;\r\n                flop = t;\r\n            }\r\n\r\n            system.drawFilter(this, flip, output, clear);\r\n            FilterUtils.freeRenderTarget(renderTarget);\r\n        }\r\n    }\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/filters-pack/src/blur/BlurYFilter.js\n **/","import { Filter } from '@fae/filters';\r\n\r\nconst vertSrc = require('./fxaa.vert');\r\nconst fragSrc = require('./fxaa.frag');\r\n\r\n/**\r\n * Basic FXAA implementation based on the code on geeks3d.com with the\r\n * modification that the texture2DLod stuff was removed since it's\r\n * unsupported by WebGL.\r\n *\r\n * @see https://github.com/mitsuhiko/webgl-meincraft\r\n *\r\n * @class\r\n */\r\nexport default class FXAAFilter extends Filter\r\n{\r\n    /**\r\n     * @param {Renderer} renderer - The renderer to use.\r\n     */\r\n    constructor(renderer)\r\n    {\r\n        super(renderer, fragSrc, vertSrc);\r\n    }\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/filters-pack/src/fxaa/FXAAFilter.js\n **/","module.exports = \"#define GLSLIFY 1\\nattribute vec2 aVertexPosition;\\nattribute vec2 aTextureCoord;\\n\\nvarying vec2 vRgbNW;\\nvarying vec2 vRgbNE;\\nvarying vec2 vRgbSW;\\nvarying vec2 vRgbSE;\\nvarying vec2 vRgbM;\\n\\nvarying vec2 vTextureCoord;\\n\\nuniform mat3 uProjectionMatrix;\\nuniform vec4 uFilterArea;\\n\\nvec2 mapCoord(vec2 coord)\\n{\\n    coord *= uFilterArea.xy;\\n    coord += uFilterArea.zw;\\n\\n    return coord;\\n}\\n\\nvec2 unmapCoord(vec2 coord)\\n{\\n    coord -= uFilterArea.zw;\\n    coord /= uFilterArea.xy;\\n\\n    return coord;\\n}\\n\\nvoid texcoords(vec2 fragCoord, vec2 resolution,\\n               out vec2 vRgbNW, out vec2 vRgbNE,\\n               out vec2 vRgbSW, out vec2 vRgbSE,\\n               out vec2 vRgbM) {\\n    vec2 inverseVP = 1.0 / resolution.xy;\\n    vRgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\\n    vRgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\\n    vRgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\\n    vRgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\\n    vRgbM = vec2(fragCoord * inverseVP);\\n}\\n\\nvoid main(void) {\\n\\n   gl_Position = vec4((uProjectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\\n\\n   vTextureCoord = aTextureCoord;\\n\\n   vec2 fragCoord = vTextureCoord * uFilterArea.xy;\\n\\n   texcoords(fragCoord, uFilterArea.xy, vRgbNW, vRgbNE, vRgbSW, vRgbSE, vRgbM);\\n}\\n\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./plugins/filters-pack/src/fxaa/fxaa.vert\n ** module id = 60\n ** module chunks = 0\n **/","module.exports = \"#define GLSLIFY 1\\nvarying vec2 vRgbNW;\\nvarying vec2 vRgbNE;\\nvarying vec2 vRgbSW;\\nvarying vec2 vRgbSE;\\nvarying vec2 vRgbM;\\n\\nvarying vec2 vTextureCoord;\\n\\nuniform sampler2D uSampler;\\nuniform vec4 uFilterArea;\\n\\n/**\\n Basic FXAA implementation based on the code on geeks3d.com with the\\n modification that the texture2DLod stuff was removed since it's\\n unsupported by WebGL.\\n\\n --\\n\\n From:\\n https://github.com/mitsuhiko/webgl-meincraft\\n\\n Copyright (c) 2011 by Armin Ronacher.\\n\\n Some rights reserved.\\n\\n Redistribution and use in source and binary forms, with or without\\n modification, are permitted provided that the following conditions are\\n met:\\n\\n * Redistributions of source code must retain the above copyright\\n notice, this list of conditions and the following disclaimer.\\n\\n * Redistributions in binary form must reproduce the above\\n copyright notice, this list of conditions and the following\\n disclaimer in the documentation and/or other materials provided\\n with the distribution.\\n\\n * The names of the contributors may not be used to endorse or\\n promote products derived from this software without specific\\n prior written permission.\\n\\n THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\\n \\\"AS IS\\\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\\n LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\\n A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\\n OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\\n SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\\n DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\\n THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\\n (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\\n OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\\n */\\n\\n#ifndef FXAA_REDUCE_MIN\\n#define FXAA_REDUCE_MIN   (1.0/ 128.0)\\n#endif\\n#ifndef FXAA_REDUCE_MUL\\n#define FXAA_REDUCE_MUL   (1.0 / 8.0)\\n#endif\\n#ifndef FXAA_SPAN_MAX\\n#define FXAA_SPAN_MAX     8.0\\n#endif\\n\\n//optimized version for mobile, where dependent\\n//texture reads can be a bottleneck\\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 resolution,\\n          vec2 v_rgbNW, vec2 v_rgbNE,\\n          vec2 v_rgbSW, vec2 v_rgbSE,\\n          vec2 v_rgbM) {\\n    vec4 color;\\n    mediump vec2 inverseVP = vec2(1.0 / resolution.x, 1.0 / resolution.y);\\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\\n    vec4 texColor = texture2D(tex, v_rgbM);\\n    vec3 rgbM  = texColor.xyz;\\n    vec3 luma = vec3(0.299, 0.587, 0.114);\\n    float lumaNW = dot(rgbNW, luma);\\n    float lumaNE = dot(rgbNE, luma);\\n    float lumaSW = dot(rgbSW, luma);\\n    float lumaSE = dot(rgbSE, luma);\\n    float lumaM  = dot(rgbM,  luma);\\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\\n\\n    mediump vec2 dir;\\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\\n\\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\\n\\n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\\n                  dir * rcpDirMin)) * inverseVP;\\n\\n    vec3 rgbA = 0.5 * (\\n                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\\n                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\\n                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\\n                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\\n\\n    float lumaB = dot(rgbB, luma);\\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\\n        color = vec4(rgbA, texColor.a);\\n    else\\n        color = vec4(rgbB, texColor.a);\\n    return color;\\n}\\n\\nvoid main() {\\n\\n  \\tvec2 fragCoord = vTextureCoord * uFilterArea.xy;\\n\\n  \\tvec4 color;\\n\\n    color = fxaa(uSampler, fragCoord, uFilterArea.xy, vRgbNW, vRgbNE, vRgbSW, vRgbSE, vRgbM);\\n\\n  \\tgl_FragColor = color;\\n}\\n\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./plugins/filters-pack/src/fxaa/fxaa.frag\n ** module id = 61\n ** module chunks = 0\n **/","/** @namespace interaction */\r\n\r\nexport { default as InteractionComponent } from './InteractionComponent';\r\nexport { default as InteractionSystem } from './InteractionSystem';\r\nexport { default as Pointer } from './Pointer';\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/interaction/src/index.js\n **/","import Signal from 'mini-signals';\r\nimport { BoundsComponent } from '@fae/shapes';\r\n\r\nexport default function InteractionComponent(Base)\r\n{\r\n    /**\r\n     * @class InteractionComponent\r\n     * @mixes BoundsComponent\r\n     * @memberof interaction\r\n     */\r\n    return class extends BoundsComponent(Base)\r\n    {\r\n        /**\r\n         *\r\n         */\r\n        constructor()\r\n        {\r\n            super(...arguments); // eslint-disable-line prefer-rest-params\r\n\r\n            /**\r\n             * Dispatched when a pointer starts an interaction (mousedown, pointerdown, touchstart).\r\n             *\r\n             * The callback looks like {@link InteractionComponent.OnInteractionCallback}\r\n             *\r\n             * @member {Signal}\r\n             */\r\n            this.onDown = new Signal();\r\n\r\n            /**\r\n             * Dispatched when a pointer ends an interaction (mouseup, pointerup, touchend).\r\n             *\r\n             * The callback looks like {@link InteractionComponent.OnInteractionCallback}\r\n             *\r\n             * @member {Signal}\r\n             */\r\n            this.onUp = new Signal();\r\n\r\n            /**\r\n             * Dispatched when a pointer ends an interaction (mouseup, pointerup, touchend)\r\n             * but is outside of the current target.\r\n             *\r\n             * The callback looks like {@link InteractionComponent.OnInteractionCallback}\r\n             *\r\n             * @member {Signal}\r\n             */\r\n            this.onUpOutside = new Signal();\r\n\r\n            /**\r\n             * Dispatched when a pointer moves (mousemove, pointermove, touchmove).\r\n             *\r\n             * The callback looks like {@link InteractionComponent.OnInteractionCallback}\r\n             *\r\n             * @member {Signal}\r\n             */\r\n            this.onMove = new Signal();\r\n\r\n            /**\r\n             * Dispatched when a pointer cancels interaction (mouseout, pointerout, touchcancel).\r\n             *\r\n             * The callback looks like {@link InteractionComponent.OnInteractionCallback}\r\n             *\r\n             * @member {Signal}\r\n             */\r\n            this.onCancel = new Signal();\r\n\r\n            /**\r\n             * Dispatched when a pointer has a scroll interaction (wheel).\r\n             *\r\n             * The callback looks like {@link InteractionComponent.OnInteractionCallback}\r\n             *\r\n             * @member {Signal}\r\n             */\r\n            this.onScroll = new Signal();\r\n\r\n            /**\r\n             * Dispatched when a click occurs on an object.\r\n             *\r\n             * The callback looks like {@link InteractionComponent.OnInteractionCallback}\r\n             *\r\n             * @member {Signal}\r\n             */\r\n            this.onClick = new Signal();\r\n\r\n            /**\r\n             * Dispatched when a hover begins on an object.\r\n             *\r\n             * The callback looks like {@link InteractionComponent.OnInteractionCallback}\r\n             *\r\n             * @member {Signal}\r\n             */\r\n            this.onHoverStart = new Signal();\r\n\r\n            /**\r\n             * Dispatched when a hover begins on an object.\r\n             *\r\n             * The callback looks like {@link InteractionComponent.OnInteractionCallback}\r\n             *\r\n             * @member {Signal}\r\n             */\r\n            this.onHoverEnd = new Signal();\r\n\r\n            /**\r\n             * When an interaction occurs the interaction object is passed to the callback.\r\n             *\r\n             * @memberof InteractionComponent\r\n             * @callback OnInteractionCallback\r\n             * @param {Pointer} pointer - The pointer the interaction happened on.\r\n             * @param {InteractableObject} target - The target of the interaction.\r\n             */\r\n        }\r\n        /**\r\n         * Called to test if this object contains the passed in point.\r\n         *\r\n         * @param {number} x - The x coord to check.\r\n         * @param {number} y - The y coord to check.\r\n         * @return {SceneObject} The SceneObject that was hit, or null if nothing was.\r\n         */\r\n        hitTest(x, y)\r\n        {\r\n            if (this.getBounds().contains(x, y))\r\n            {\r\n                return this;\r\n            }\r\n\r\n            return null;\r\n        }\r\n    };\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/interaction/src/InteractionComponent.js\n **/","import Pointer from './Pointer';\r\nimport InteractionComponent from './InteractionComponent';\r\nimport { ecs, render, debug } from '@fae/core';\r\n\r\nconst tempCoords = { x: 0, y: 0 };\r\n\r\n/**\r\n * @class\r\n * @memberof interaction\r\n */\r\nexport default class InteractionSystem extends ecs.System\r\n{\r\n    /**\r\n     * @param {Renderer} renderer - The renderer to handle interactions on.\r\n     */\r\n    constructor(renderer)\r\n    {\r\n        super(renderer, 0, Number.MAX_SAFE_INTEGER);\r\n\r\n        /**\r\n         * The currently active pointers.\r\n         *\r\n         * @member {Pointer[]}\r\n         */\r\n        this.pointers = [];\r\n\r\n        /**\r\n         * Context-bound version of the handleEvent function.\r\n         *\r\n         * @private\r\n         * @member {function}\r\n         */\r\n        this._boundHandleEvent = this.handleEvent.bind(this);\r\n\r\n        this._eventsBound = false;\r\n    }\r\n\r\n    /**\r\n     * Return true if the entity is eligible to the system, false otherwise.\r\n     *\r\n     * @param {Entity} entity - The entity to test.\r\n     * @return {boolean} True if entity should be included.\r\n     */\r\n    test(entity)\r\n    {\r\n        return entity.hasComponent(InteractionComponent);\r\n    }\r\n\r\n    /**\r\n     * Converts client coords to world coords.\r\n     *\r\n     * @param {number} x - The x coord, in client space, to convert.\r\n     * @param {number} y - The y coord, in client space, to convert.\r\n     * @param {object} out - The out object to assign values to.\r\n     * @param {number} out.x - The out X coord.\r\n     * @param {number} out.y - The out Y coord.\r\n     * @return {object} An object with x/y properties.\r\n     */\r\n    convertClientToWorld(x, y, out = { x: 0, y: 0 })\r\n    {\r\n        const dom = this.renderer.gl.canvas;\r\n        const rect = dom.getBoundingClientRect();\r\n\r\n        out.x = ((x - rect.left) * (dom.width / rect.width));\r\n        out.y = ((y - rect.top) * (dom.height / rect.height));\r\n\r\n        return out;\r\n    }\r\n\r\n    /**\r\n     * Hit tests the interactable objects and returns the first hit object. Takes\r\n     * world-space coords.\r\n     *\r\n     * @param {number} x - The x coord, in world space, to test.\r\n     * @param {number} y - The y coord, in world space, to test.\r\n     * @return {InteractableObject} The object that was interacted with, null if nothing hits.\r\n     */\r\n    hitTest(x, y)\r\n    {\r\n        for (let i = 0; i < this.entities.length; ++i)\r\n        {\r\n            const pass = this.entities[i].hitTest(x, y);\r\n\r\n            if (pass) return pass;\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * Binds all the DOM events to the view passed in, defaulting to the renderer view.\r\n     * If you don't want to manager DOM events on your own, this is a good option to\r\n     * let the manager do it for you.\r\n     *\r\n     * @param {HTMLElement} view - The element to use as the root view.\r\n     */\r\n    bindEvents()\r\n    {\r\n        debug.ASSERT(!this._eventsBound, 'bindEvents called again after events were already bound.');\r\n\r\n        this._eventsBound = true;\r\n\r\n        const dom = this.renderer.gl.canvas;\r\n\r\n        if (window.PointerEvent)\r\n        {\r\n            dom.addEventListener('pointerdown', this._boundHandleEvent);\r\n            dom.addEventListener('pointermove', this._boundHandleEvent);\r\n            dom.addEventListener('pointerout', this._boundHandleEvent);\r\n            window.addEventListener('pointerup', this._boundHandleEvent);\r\n        }\r\n        else\r\n        {\r\n            dom.addEventListener('mousedown', this._boundHandleEvent);\r\n            dom.addEventListener('mousemove', this._boundHandleEvent);\r\n            dom.addEventListener('mouseout', this._boundHandleEvent);\r\n            window.addEventListener('mouseup', this._boundHandleEvent);\r\n\r\n            dom.addEventListener('touchstart', this._boundHandleEvent);\r\n            dom.addEventListener('touchmove', this._boundHandleEvent);\r\n            dom.addEventListener('touchcancel', this._boundHandleEvent);\r\n            window.addEventListener('touchend', this._boundHandleEvent);\r\n        }\r\n\r\n        dom.addEventListener('wheel', this._boundHandleEvent);\r\n    }\r\n\r\n    /**\r\n     * Unbinds all the DOM events.\r\n     *\r\n     */\r\n    unbindEvents()\r\n    {\r\n        debug.ASSERT(this._eventsBound, 'unbindEvents called when events were not bound.');\r\n\r\n        this._eventsBound = false;\r\n\r\n        const dom = this.renderer.gl.canvas;\r\n\r\n        if (window.PointerEvent)\r\n        {\r\n            dom.removeEventListener('pointerdown', this._boundHandleEvent);\r\n            dom.removeEventListener('pointermove', this._boundHandleEvent);\r\n            dom.removeEventListener('pointerout', this._boundHandleEvent);\r\n            window.removeEventListener('pointerup', this._boundHandleEvent);\r\n        }\r\n        else\r\n        {\r\n            dom.removeEventListener('mousedown', this._boundHandleEvent);\r\n            dom.removeEventListener('mousemove', this._boundHandleEvent);\r\n            dom.removeEventListener('mouseout', this._boundHandleEvent);\r\n            window.removeEventListener('mouseup', this._boundHandleEvent);\r\n\r\n            dom.removeEventListener('touchstart', this._boundHandleEvent);\r\n            dom.removeEventListener('touchmove', this._boundHandleEvent);\r\n            dom.removeEventListener('touchcancel', this._boundHandleEvent);\r\n            window.removeEventListener('touchend', this._boundHandleEvent);\r\n        }\r\n\r\n        dom.removeEventListener('wheel', this._boundHandleEvent);\r\n    }\r\n\r\n    /**\r\n     * Handles an interaction event, usually this is passed a DOM Event.\r\n     *\r\n     * @param {Event} event - The start event.\r\n     */\r\n    handleEvent(event)\r\n    {\r\n        // add contacts from the event to the interaction\r\n        if (event.changedTouches)\r\n        {\r\n            for (let i = 0; i < event.changedTouches.length; ++i)\r\n            {\r\n                const touch = event.changedTouches;\r\n                const pointer = this._getPointer(touch);\r\n                const worldCoords = this.convertClientToWorld(touch.clientX, touch.clientY, tempCoords);\r\n                const hitObject = this.hitTest(worldCoords.x, worldCoords.y);\r\n\r\n                pointer[Pointer.EVENT_CALL_MAP[event.type]](touch, hitObject, worldCoords.x, worldCoords.y);\r\n            }\r\n        }\r\n        else\r\n        {\r\n            const pointer = this._getPointer(event);\r\n            const worldCoords = this.convertClientToWorld(event.clientX, event.clientY, tempCoords);\r\n            const hitObject = this.hitTest(worldCoords.x, worldCoords.y);\r\n\r\n            pointer[Pointer.EVENT_CALL_MAP[event.type]](event, hitObject, worldCoords.x, worldCoords.y);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Called when the system is added to the renderer.\r\n     *\r\n     */\r\n    initialize()\r\n    {\r\n        super.initialize();\r\n\r\n        this.bindEvents();\r\n    }\r\n\r\n    /**\r\n     * Disposes of the system, called when removed from the renderer.\r\n     *\r\n     */\r\n    dispose()\r\n    {\r\n        super.dispose();\r\n\r\n        this.unbindEvents();\r\n    }\r\n\r\n    /**\r\n     * Destroys this interaction manager.\r\n     *\r\n     */\r\n    destroy()\r\n    {\r\n        super.destroy();\r\n\r\n        this.interactions = null;\r\n\r\n        this.onInteraction.detachAll();\r\n        this.onInteraction = null;\r\n    }\r\n\r\n    /**\r\n     * Gets or creates a pointer of ID/Type\r\n     *\r\n     * @private\r\n     * @param {MouseEvent|PointerEvent|Touch} data - The event data of the contact.\r\n     * @return {Pointer} The pointer to use.\r\n     */\r\n    _getPointer(data)\r\n    {\r\n        let pointerId = 0;\r\n\r\n        if (typeof data.pointerId === 'number') pointerId = data.pointerId;\r\n        else if (typeof data.identifier === 'number') pointerId = data.identifier;\r\n\r\n        for (let i = 0; i < this.pointers.length; ++i)\r\n        {\r\n            if (this.pointers[i].id === pointerId)\r\n            {\r\n                return this.pointers[i];\r\n            }\r\n        }\r\n\r\n        const pointer = new Pointer(pointerId);\r\n\r\n        this.pointers.push(pointer);\r\n\r\n        return pointer;\r\n    }\r\n}\r\n\r\nrender.Renderer.addDefaultSystem(InteractionSystem);\r\n\r\n/**\r\n * The interface for an object that can be added to the interaction manager.\r\n *\r\n * @interface InteractableObject\r\n */\r\n\r\n/**\r\n * Checks if the object is \"hit\" by a point. It should return the \"hit\" object,\r\n * generally that is itself. If `true` is returned, then it is assumed the object\r\n * meant that it was hit itself. If a falsey values (`false`, `null`, etc) is\r\n * returned it is assumed that the object is not hit at all.\r\n *\r\n * @method\r\n * @name InteractableObject#hitTest\r\n * @param {number} x - The x coord to test.\r\n * @param {number} y - The y coord to test.\r\n * @return {InteractableObject} The hit object, or null if nothing hit.\r\n */\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/interaction/src/InteractionSystem.js\n **/","import { debug } from '@fae/core';\r\n\r\nconst EMPTY_ARRAY = [];\r\n\r\n/**\r\n * @class\r\n * @memberof interaction\r\n */\r\nexport default class Pointer\r\n{\r\n    /**\r\n     * @param {number} id - The id of the pointer.\r\n     */\r\n    constructor(id)\r\n    {\r\n        /**\r\n         * The ID of this pointer.\r\n         *\r\n         * @readonly\r\n         * @member {number}\r\n         */\r\n        this.id = id;\r\n\r\n        /**\r\n         * The type of this pointer.\r\n         *\r\n         * @readonly\r\n         * @member {Pointer.TYPE}\r\n         */\r\n        this.type = Pointer.TYPE.UNKNOWN;\r\n\r\n        /**\r\n         * The target of this pointer when it was pressed down.\r\n         *\r\n         * @readonly\r\n         * @member {InteractableObject}\r\n         */\r\n        this.target = null;\r\n\r\n        /**\r\n         * The target of this pointer when it hovered over an object.\r\n         *\r\n         * @readonly\r\n         * @member {InteractableObject}\r\n         */\r\n        this.hoverTarget = null;\r\n\r\n        /**\r\n         * The target of this pointer when scroll events happened.\r\n         *\r\n         * @readonly\r\n         * @member {InteractableObject}\r\n         */\r\n        this.scrollTarget = null;\r\n\r\n        /**\r\n         * The unique identifier of the most recently pressed button.\r\n         *\r\n         * A value of `0` is also used for touch and \"uninitialized\" states.\r\n         * For example, during a hover nothing is pressed. In this case this\r\n         * value is `0`.\r\n         *\r\n         * @readonly\r\n         * @member {number}\r\n         */\r\n        this.button = 0;\r\n\r\n        /**\r\n         * The unique identifiers of all the actively pressed buttons.\r\n         *\r\n         * @readonly\r\n         * @member {number[]}\r\n         */\r\n        this.buttons = EMPTY_ARRAY;\r\n\r\n        /**\r\n         * A Boolean value indicating whether or not the alt key is pressed.\r\n         *\r\n         * @readonly\r\n         * @member {boolean}\r\n         */\r\n        this.altKey = false;\r\n\r\n        /**\r\n         * A Boolean value indicating whether or not the control key is pressed.\r\n         *\r\n         * @readonly\r\n         * @member {boolean}\r\n         */\r\n        this.ctrlKey = false;\r\n\r\n        /**\r\n         * A Boolean value indicating whether or not the meta key is pressed.\r\n         *\r\n         * @readonly\r\n         * @member {boolean}\r\n         */\r\n        this.metaKey = false;\r\n\r\n        /**\r\n         * A Boolean value indicating whether or not the shift key is pressed.\r\n         *\r\n         * @readonly\r\n         * @member {boolean}\r\n         */\r\n        this.shiftKey = false;\r\n\r\n        /**\r\n         * The width of the interaction of the pointer with the screen.\r\n         * For touch interactions, this is how much finger is on the screen.\r\n         *\r\n         * @readonly\r\n         * @member {number}\r\n         */\r\n        this.width = 1;\r\n\r\n        /**\r\n         * The height of the interaction of the pointer with the screen.\r\n         * For touch interactions, this is how much finger is on the screen.\r\n         *\r\n         * @readonly\r\n         * @member {number}\r\n         */\r\n        this.height = 1;\r\n\r\n        /**\r\n         * The pressure or force of the interaction of the pointer with the screen.\r\n         * This value is a normalized value between 0.0 and 1.0\r\n         *\r\n         * @readonly\r\n         * @member {number}\r\n         */\r\n        this.pressure = 1.0;\r\n\r\n        /**\r\n         * The client-space coord of the pointer interaction.\r\n         *\r\n         * @readonly\r\n         * @member {number}\r\n         */\r\n        this.clientX = 0;\r\n\r\n        /**\r\n         * The client-space coord of the pointer interaction.\r\n         *\r\n         * @readonly\r\n         * @member {number}\r\n         */\r\n        this.clientY = 0;\r\n\r\n        /**\r\n         * How much the pointer has moved since last time it was updated,\r\n         * in world-space coords.\r\n         *\r\n         * @readonly\r\n         * @member {number}\r\n         */\r\n        this.deltaX = 0;\r\n\r\n        /**\r\n         * How much the pointer has moved since last time it was updated,\r\n         * in world-space coords.\r\n         *\r\n         * @readonly\r\n         * @member {number}\r\n         */\r\n        this.deltaY = 0;\r\n\r\n        /**\r\n         * The world-space coord of the pointer interaction.\r\n         *\r\n         * @readonly\r\n         * @member {number}\r\n         */\r\n        this.worldX = 0;\r\n\r\n        /**\r\n         * The world-space coord of the pointer interaction.\r\n         *\r\n         * @readonly\r\n         * @member {number}\r\n         */\r\n        this.worldY = 0;\r\n\r\n        /**\r\n         * The delta X of the scroll when doing a scroll event.\r\n         *\r\n         * @readonly\r\n         * @member {number}\r\n         */\r\n        this.scrollDeltaX = 0;\r\n\r\n        /**\r\n         * The delta Y of the scroll when doing a scroll event.\r\n         *\r\n         * @readonly\r\n         * @member {number}\r\n         */\r\n        this.scrollDeltaY = 0;\r\n\r\n        /**\r\n         * The delta Z of the scroll when doing a scroll event.\r\n         *\r\n         * @readonly\r\n         * @member {number}\r\n         */\r\n        this.scrollDeltaZ = 0;\r\n\r\n        /**\r\n         * Is this pointer down pressed down?\r\n         *\r\n         * @readonly\r\n         * @member {boolean}\r\n         */\r\n        this.isDown = false;\r\n\r\n        /**\r\n         * Is this pointer hovering over the target?\r\n         *\r\n         * @readonly\r\n         * @member {boolean}\r\n         */\r\n        this.isHovering = false;\r\n    }\r\n\r\n    /**\r\n     * Called on a start event.\r\n     *\r\n     * @param {MouseEvent|PointerEvent|Touch} data - The contact data.\r\n     * @param {InteractableObject} target - The object this interaction hits.\r\n     * @param {number} worldX - The world X coord of the interaction.\r\n     * @param {number} worldY - The world Y coord of the interaction.\r\n     */\r\n    start(data, target, worldX, worldY)\r\n    {\r\n        debug.ASSERT(!this.isDown, 'Start called for pointer without ending first.');\r\n\r\n        this.isDown = true;\r\n        this.target = target;\r\n\r\n        this.button = data.button || 0;\r\n        this.buttons = data.buttons || EMPTY_ARRAY;\r\n\r\n        this._set(data, worldX, worldY);\r\n\r\n        if (target)\r\n        {\r\n            target.onDown.dispatch(this, target);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Called on an end event.\r\n     *\r\n     * @param {MouseEvent|PointerEvent|Touch} data - The contact data.\r\n     * @param {InteractableObject} target - The object this interaction hits.\r\n     * @param {number} worldX - The world X coord of the interaction.\r\n     * @param {number} worldY - The world Y coord of the interaction.\r\n     */\r\n    end(data, target, worldX, worldY)\r\n    {\r\n        // ignore end events when we haven't even started yet\r\n        if (!this.isDown) return;\r\n\r\n        this.isDown = false;\r\n\r\n        this._set(data, worldX, worldY);\r\n\r\n        // click!\r\n        if (this.target)\r\n        {\r\n            if (this.target === target)\r\n            {\r\n                this.target.onClick.dispatch(this, this.target);\r\n            }\r\n\r\n            if (!target)\r\n            {\r\n                this.target.onUpOutside.dispatch(this, this.target);\r\n            }\r\n        }\r\n\r\n        this.target = target;\r\n\r\n        if (target)\r\n        {\r\n            target.onUp.dispatch(this, target);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Called on a move event.\r\n     *\r\n     * @param {MouseEvent|PointerEvent|Touch} data - The contact data.\r\n     * @param {InteractableObject} target - The object this interaction hits.\r\n     * @param {number} worldX - The world X coord of the interaction.\r\n     * @param {number} worldY - The world Y coord of the interaction.\r\n     */\r\n    move(data, target, worldX, worldY)\r\n    {\r\n        this._set(data, worldX, worldY, this.isDown || this.isHovering);\r\n\r\n        // target has changed, so hover state has changed\r\n        if (this.hoverTarget !== target)\r\n        {\r\n            if (this.isHovering && this.hoverTarget)\r\n            {\r\n                this.isHovering = false;\r\n                this.hoverTarget.onHoverEnd.dispatch(this, this.hoverTarget);\r\n                this.hoverTarget = null;\r\n            }\r\n\r\n            if (target)\r\n            {\r\n                this.isHovering = true;\r\n                this.hoverTarget = target;\r\n                target.onHoverStart.dispatch(this, target);\r\n            }\r\n        }\r\n\r\n        // TODO: Drag-and-drop, if you move mouse fast enough target changes. May\r\n        // cause issues when people try to do dragging.\r\n\r\n        this.hoverTarget = target;\r\n\r\n        if (target)\r\n        {\r\n            target.onMove.dispatch(this, target);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Called on a cancel event.\r\n     *\r\n     * @param {MouseEvent|PointerEvent|Touch} data - The contact data.\r\n     * @param {InteractableObject} target - The object this interaction hits.\r\n     * @param {number} worldX - The world X coord of the interaction.\r\n     * @param {number} worldY - The world Y coord of the interaction.\r\n     */\r\n    cancel(data, target, worldX, worldY)\r\n    {\r\n        const wasDown = this.isDown;\r\n        const wasHovering = this.isHovering;\r\n\r\n        this.isDown = false;\r\n        this.isHovering = false;\r\n\r\n        this._set(data, worldX, worldY);\r\n\r\n        if (this.target)\r\n        {\r\n            this.target.onCancel.dispatch(this.target || this.hoverTarget, this);\r\n\r\n            if (wasDown)\r\n            {\r\n                this.target.onUpOutside.dispatch(this, this.target);\r\n            }\r\n        }\r\n\r\n        if (wasHovering && this.hoverTarget)\r\n        {\r\n            this.hoverTarget.onHoverEnd.dispatch(this, this.hoverTarget);\r\n        }\r\n\r\n        this.target = null;\r\n        this.hoverTarget = null;\r\n        this.scrollTarget = null;\r\n    }\r\n\r\n    /**\r\n     * Called on a scroll event.\r\n     *\r\n     * @param {MouseEvent|PointerEvent|Touch} data - The contact data.\r\n     * @param {InteractableObject} target - The object this interaction hits.\r\n     * @param {number} worldX - The world X coord of the interaction.\r\n     * @param {number} worldY - The world Y coord of the interaction.\r\n     */\r\n    scroll(data, target, worldX, worldY)\r\n    {\r\n        this._set(data, worldX, worldY);\r\n\r\n        this.scrollDeltaX = data.deltaX;\r\n        this.scrollDeltaY = data.deltaY;\r\n        this.scrollDeltaZ = data.deltaZ;\r\n\r\n        this.scrollTarget = target;\r\n\r\n        if (target)\r\n        {\r\n            target.onScroll.dispatch(this, target);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Sets the members based on a DOM event.\r\n     *\r\n     * @param {PointerEvent|MouseEvent|Touch} data - The event data to set from.\r\n     * @param {number} worldX - The world X coord of this event.\r\n     * @param {number} worldY - The world Y coord of this event.\r\n     * @param {boolean} calcDelta - Should we calculate the delta movement?\r\n     */\r\n    _set(data, worldX, worldY, calcDelta = false)\r\n    {\r\n        // set type\r\n        if (data.pointerType)\r\n        {\r\n            this.type = data.pointerType;\r\n        }\r\n        else if (data.type && data.type[0] === 'm')\r\n        {\r\n            this.type = Pointer.TYPE.MOUSE;\r\n        }\r\n        else\r\n        {\r\n            this.type = Pointer.TYPE.TOUCH;\r\n        }\r\n\r\n        // set pressure\r\n        if (typeof data.pressure === 'number')\r\n        {\r\n            this.pressure = data.pressure;\r\n        }\r\n        else if (typeof data.force === 'number')\r\n        {\r\n            this.pressure = data.force;\r\n        }\r\n        else\r\n        {\r\n            this.pressure = 1.0;\r\n        }\r\n\r\n        // set button state\r\n        this.button = data.button || 0;\r\n        this.buttons = data.buttons || EMPTY_ARRAY;\r\n\r\n        // set key states\r\n        this.altKey = data.altKey || false;\r\n        this.ctrlKey = data.ctrlKey || false;\r\n        this.metaKey = data.metaKey || false;\r\n        this.shiftKey = data.shiftKey || false;\r\n\r\n        // set size\r\n        this.width = data.width || (typeof data.radiusX === 'number' ? data.radiusX * 2 : 1);\r\n        this.height = data.height || (typeof data.radiusY === 'number' ? data.radiusY * 2 : 1);\r\n\r\n        // set client x/y coords\r\n        this.clientX = data.clientX;\r\n        this.clientY = data.clientY;\r\n\r\n        // calculate delta (maybe)\r\n        this.deltaX = calcDelta ? (worldX - this.worldX) : 0;\r\n        this.deltaY = calcDelta ? (worldY - this.worldY) : 0;\r\n\r\n        // set world x/y coords\r\n        this.worldX = worldX;\r\n        this.worldY = worldY;\r\n    }\r\n}\r\n\r\n/**\r\n * The pointer type.\r\n *\r\n * @static\r\n * @readonly\r\n * @enum {string}\r\n */\r\nPointer.TYPE = {\r\n    /** Unknown type */\r\n    UNKNOWN: '',\r\n    /** The pointer is a mouse */\r\n    MOUSE: 'mouse',\r\n    /** The pointer is a touch */\r\n    TOUCH: 'touch',\r\n    /** The pointer is a pen device */\r\n    PEN: 'pen',\r\n};\r\n\r\n/**\r\n * Map of interaction events to the state they represent.\r\n *\r\n * @static\r\n * @readonly\r\n * @enum {string}\r\n */\r\nPointer.EVENT_CALL_MAP = {\r\n    mousedown:      'start',\r\n    touchstart:     'start',\r\n    pointerdown:    'start',\r\n\r\n    mouseup:        'end',\r\n    touchend:       'end',\r\n    pointerup:      'end',\r\n\r\n    mousemove:      'move',\r\n    touchmove:      'move',\r\n    pointermove:    'move',\r\n\r\n    mouseout:       'cancel',\r\n    touchcancel:    'cancel',\r\n    pointerout:     'cancel',\r\n\r\n    wheel:          'scroll',\r\n};\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/interaction/src/Pointer.js\n **/","/* eslint global-require: 0 */\r\n/** @namespace sprites */\r\n\r\nexport { default as Sprite } from './Sprite';\r\nexport { default as SpriteRenderer } from './SpriteRenderer';\r\nexport { default as SpriteComponent } from './SpriteComponent';\r\nexport { default as SpriteRenderSystem } from './SpriteRenderSystem';\r\n\r\nexport const shaders = {\r\n    texture: {\r\n        vert: require('./shader/multi-texture.vert'),\r\n        frag: require('./shader/multi-texture.frag'),\r\n    },\r\n};\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/sprites/src/index.js\n **/","import { ecs } from '@fae/core';\r\nimport { TransformComponent } from '@fae/transform';\r\nimport { Texture, TextureComponent } from '@fae/textures';\r\nimport SpriteComponent from './SpriteComponent';\r\nimport SpriteRenderer from './SpriteRenderer';\r\n\r\n/**\r\n * A Sprite is a textured entity. It is implemented as a quad\r\n * with a texture drawn on it.\r\n *\r\n * @class\r\n * @mixes VisibilityComponent\r\n * @mixes TransformComponent\r\n * @mixes SpriteComponent\r\n * @memberof sprites\r\n */\r\nexport default class Sprite extends ecs.Entity.with(\r\n    ecs.VisibilityComponent,    // whether or not to render\r\n    TransformComponent,         // where to render\r\n    TextureComponent,           // what to render\r\n    SpriteComponent             // how to render\r\n)\r\n{\r\n    /**\r\n     *\r\n     * @param {Texture} texture - The texture to use.\r\n     */\r\n    constructor(texture = Texture.EMPTY)\r\n    {\r\n        super();\r\n\r\n        this.renderGroupHint = SpriteRenderer;\r\n\r\n        this._onTextureUpdateBinding = null;\r\n\r\n        // run texture component setter\r\n        this.texture = texture;\r\n    }\r\n\r\n    /**\r\n     * Destroys the sprite.\r\n     *\r\n     * @param {object|boolean} options - A boolean value will act as if all options are set to that value.\r\n     * @param {boolean} options.texture=false - If true the texture is also destroyed.\r\n     * @param {boolean} options.baseTexture=false - If true the texture's base texture is also destroyed.\r\n     */\r\n    destroy(options = false)\r\n    {\r\n        super.destroy(options);\r\n\r\n        const destroyTexture = typeof options === 'boolean' ? options : options && options.texture;\r\n\r\n        if (destroyTexture)\r\n        {\r\n            this.texture.destroy(options);\r\n        }\r\n\r\n        this.tint = null;\r\n        this.blendMode = null;\r\n        this.shader = null;\r\n        this.vertexData = null;\r\n\r\n        this._texture = null;\r\n\r\n        if (this._onTextureUpdateBinding)\r\n        {\r\n            this._onTextureUpdateBinding.detach();\r\n            this._onTextureUpdateBinding = null;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Called by the texture component when the texture changes.\r\n     *\r\n     * @protected\r\n     */\r\n    _onTextureChange()\r\n    {\r\n        if (this._onTextureUpdateBinding)\r\n        {\r\n            this._onTextureUpdateBinding.detach();\r\n            this._onTextureUpdateBinding = null;\r\n        }\r\n\r\n        this._vertsDirty = true;\r\n\r\n        if (this._texture)\r\n        {\r\n            this._onTextureUpdateBinding = this._texture.onUpdate.add(this._onTextureUpdate, this);\r\n\r\n            if (this._texture.ready)\r\n            {\r\n                this._onTextureUpdate();\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Called when the underlying texture updates.\r\n     *\r\n     * @private\r\n     */\r\n    _onTextureUpdate()\r\n    {\r\n        this._vertsDirty = true;\r\n    }\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/sprites/src/Sprite.js\n **/","/** @namespace transform */\r\n\r\nexport { default as Transform } from './Transform';\r\nexport { default as TransformComponent } from './TransformComponent';\r\nexport { default as TransformUpdateSystem } from './TransformUpdateSystem';\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/transform/src/index.js\n **/","import { math, debug } from '@fae/core';\r\n\r\n/**\r\n * Generic class to deal with traditional 2D matrix transforms\r\n * This will be reworked in v4.1, please do not use it yet unless you know what are you doing!\r\n *\r\n * @class\r\n * @memberof transform\r\n */\r\nexport default class Transform\r\n{\r\n    /**\r\n     * Constructs a new Transform object.\r\n     *\r\n     */\r\n    constructor()\r\n    {\r\n        /**\r\n         * The parent transform to update against.\r\n         *\r\n         * @member {Transform}\r\n         * @default null\r\n         */\r\n        this.parent = null;\r\n\r\n        /**\r\n         * The global matrix transform, it is written to the passed in output buffer.\r\n         *\r\n         * @private\r\n         * @member {Matrix2d}\r\n         */\r\n        this._wt = new math.Matrix2d();\r\n\r\n        /**\r\n         * The local matrix transform.\r\n         *\r\n         * @private\r\n         * @member {Matrix2d}\r\n         */\r\n        this._lt = new math.Matrix2d();\r\n\r\n        /**\r\n         * Position component of transform.\r\n         *\r\n         * @private\r\n         * @member {Vector2d}\r\n         */\r\n        this._position = new math.Vector2d();\r\n\r\n        /**\r\n         * Scale component of transform.\r\n         *\r\n         * @private\r\n         * @member {Vector2d}\r\n         */\r\n        this._scale = new math.Vector2d(1, 1);\r\n\r\n        /**\r\n         * Skew component of transform.\r\n         *\r\n         * @private\r\n         * @member {Vector2d}\r\n         */\r\n        this._skew = new math.Vector2d();\r\n\r\n        /**\r\n         * Pivot component of transform.\r\n         *\r\n         * @private\r\n         * @member {Vector2d}\r\n         */\r\n        this._pivot = new math.Vector2d();\r\n\r\n        /**\r\n         * Rotation component of transform.\r\n         *\r\n         * @private\r\n         * @member {number}\r\n         */\r\n        this._rotation = 0;\r\n\r\n        // dirty trackers when updates are made to matrices\r\n        this._localUpdateId = 0;\r\n        this._worldUpdateId = 0;\r\n        this._cachedLocalUpdateId = -1;\r\n        this._cachedWorldUpdateId = -1;\r\n\r\n        // cache vars for expensive trig functions\r\n        this._sr = Math.sin(0);\r\n        this._cr = Math.cos(0);\r\n        this._cy = Math.cos(0); // skewY\r\n        this._sy = Math.sin(0); // skewY\r\n        this._sx = Math.sin(0); // skewX\r\n        this._cx = Math.cos(0); // skewX\r\n    }\r\n\r\n    /**\r\n     * The local transformation matrix.\r\n     *\r\n     * @member {Matrix2d}\r\n     */\r\n    get localTransform()\r\n    {\r\n        return this._lt;\r\n    }\r\n\r\n    /**\r\n     * The world transformation matrix.\r\n     *\r\n     * @member {Matrix2d}\r\n     */\r\n    get worldTransform()\r\n    {\r\n        return this._wt;\r\n    }\r\n\r\n    /**\r\n     * The X position.\r\n     *\r\n     * @member {number}\r\n     */\r\n    get x()\r\n    {\r\n        return this._position.x;\r\n    }\r\n\r\n    /**\r\n     * Sets X position of the transform.\r\n     *\r\n     * @param {number} v - The value to set to.\r\n     */\r\n    set x(v)\r\n    {\r\n        this._position.x = v;\r\n        this._localUpdateId++;\r\n    }\r\n\r\n    /**\r\n     * The Y position.\r\n     *\r\n     * @member {number}\r\n     */\r\n    get y()\r\n    {\r\n        return this._position.y;\r\n    }\r\n\r\n    /**\r\n     * Sets Y position of the transform.\r\n     *\r\n     * @param {number} v - The value to set to.\r\n     */\r\n    set y(v)\r\n    {\r\n        this._position.y = v;\r\n        this._localUpdateId++;\r\n    }\r\n\r\n    /**\r\n     * The X scale.\r\n     *\r\n     * @member {number}\r\n     */\r\n    get scaleX()\r\n    {\r\n        return this._scale.x;\r\n    }\r\n\r\n    /**\r\n     * Sets X scale of the transform.\r\n     *\r\n     * @param {number} v - The value to set to.\r\n     */\r\n    set scaleX(v)\r\n    {\r\n        this._scale.x = v;\r\n        this._localUpdateId++;\r\n    }\r\n\r\n    /**\r\n     * The Y scale.\r\n     *\r\n     * @member {number}\r\n     */\r\n    get scaleY()\r\n    {\r\n        return this._scale.y;\r\n    }\r\n\r\n    /**\r\n     * Sets Y scale of the transform.\r\n     *\r\n     * @param {number} v - The value to set to.\r\n     */\r\n    set scaleY(v)\r\n    {\r\n        this._scale.y = v;\r\n        this._localUpdateId++;\r\n    }\r\n\r\n    /**\r\n     * The X skew.\r\n     *\r\n     * @member {number}\r\n     */\r\n    get skewX()\r\n    {\r\n        return this._skew.x;\r\n    }\r\n\r\n    /**\r\n     * Sets X skew of the transform.\r\n     *\r\n     * @param {number} v - The value to set to.\r\n     */\r\n    set skewX(v)\r\n    {\r\n        this._skew.x = v;\r\n        this._sx = Math.sin(v);\r\n        this._cx = Math.cos(v);\r\n        this._localUpdateId++;\r\n    }\r\n\r\n    /**\r\n     * The Y skew.\r\n     *\r\n     * @member {number}\r\n     */\r\n    get skewY()\r\n    {\r\n        return this._skew.y;\r\n    }\r\n\r\n    /**\r\n     * Sets Y skew of the transform.\r\n     *\r\n     * @param {number} v - The value to set to.\r\n     */\r\n    set skewY(v)\r\n    {\r\n        this._skew.y = v;\r\n        this._cy = Math.cos(v);\r\n        this._sy = Math.sin(v);\r\n        this._localUpdateId++;\r\n    }\r\n\r\n    /**\r\n     * The X pivot.\r\n     *\r\n     * @member {number}\r\n     */\r\n    get pivotX()\r\n    {\r\n        return this._pivot.x;\r\n    }\r\n\r\n    /**\r\n     * Sets X pivot of the transform.\r\n     *\r\n     * @param {number} v - The value to set to.\r\n     */\r\n    set pivotX(v)\r\n    {\r\n        this._pivot.x = v;\r\n        this._localUpdateId++;\r\n    }\r\n\r\n    /**\r\n     * The Y pivot.\r\n     *\r\n     * @member {number}\r\n     */\r\n    get pivotY()\r\n    {\r\n        return this._pivot.y;\r\n    }\r\n\r\n    /**\r\n     * Sets Y pivot of the transform.\r\n     *\r\n     * @param {number} v - The value to set to.\r\n     */\r\n    set pivotY(v)\r\n    {\r\n        this._pivot.y = v;\r\n        this._localUpdateId++;\r\n    }\r\n\r\n    /**\r\n     * The rotation.\r\n     *\r\n     * @member {number}\r\n     */\r\n    get rotation()\r\n    {\r\n        return this._rotation;\r\n    }\r\n\r\n    /**\r\n     * Sets rotation of the transform.\r\n     *\r\n     * @param {number} v - The value to set to.\r\n     */\r\n    set rotation(v)\r\n    {\r\n        this._rotation = v;\r\n        this._sr = Math.sin(v);\r\n        this._cr = Math.cos(v);\r\n        this._localUpdateId++;\r\n    }\r\n\r\n    /**\r\n     * Invalidates the cached parent transform which forces an update next time.\r\n     *\r\n     */\r\n    invalidate()\r\n    {\r\n        this._cachedWorldUpdateId = -1;\r\n    }\r\n\r\n    /**\r\n     * Updates the world transform based on the passed transform.\r\n     *\r\n     */\r\n    update()\r\n    {\r\n        this.dirty = true;\r\n\r\n        const wt = this._wt;\r\n        const lt = this._lt;\r\n\r\n        if (this._localUpdateId !== this._cachedLocalUpdateId)\r\n        {\r\n            const a =  this._cr * this._scale.x;\r\n            const b =  this._sr * this._scale.x;\r\n            const c = -this._sr * this._scale.y;\r\n            const d =  this._cr * this._scale.y;\r\n\r\n            // skew\r\n            lt.a = (this._cy * a) + (this._sy * c);\r\n            lt.b = (this._cy * b) + (this._sy * d);\r\n            lt.c = (this._sx * a) + (this._cx * c);\r\n            lt.d = (this._sx * b) + (this._cx * d);\r\n\r\n            // translation\r\n            lt.tx = this._position.x - ((this._pivot.x * lt.a) + (this._pivot.y * lt.c));\r\n            lt.ty = this._position.y - ((this._pivot.x * lt.b) + (this._pivot.y * lt.d));\r\n\r\n            this._cachedLocalUpdateId = this._localUpdateId;\r\n            this._cachedWorldUpdateId = -1;\r\n        }\r\n\r\n        debug.ASSERT(this._lt.valid(), 'Invalid local transform, property is set incorrectly somewhere...');\r\n\r\n        if (this.parent)\r\n        {\r\n            if (this._cachedWorldUpdateId !== this.parent._worldUpdateId)\r\n            {\r\n                const pt = this.parent._wt;\r\n\r\n                // multiply the parent matrix with the objects transform.\r\n                wt.a = (lt.a * pt.a) + (lt.b * pt.c);\r\n                wt.b = (lt.a * pt.b) + (lt.b * pt.d);\r\n                wt.c = (lt.c * pt.a) + (lt.d * pt.c);\r\n                wt.d = (lt.c * pt.b) + (lt.d * pt.d);\r\n                wt.tx = (lt.tx * pt.a) + (lt.ty * pt.c) + pt.tx;\r\n                wt.ty = (lt.tx * pt.b) + (lt.ty * pt.d) + pt.ty;\r\n\r\n                this._cachedWorldUpdateId = this.parent._worldUpdateId;\r\n                this._worldUpdateId++;\r\n            }\r\n        }\r\n        else if (this._cachedWorldUpdateId !== this._worldUpdateId)\r\n        {\r\n            wt.copy(this._lt);\r\n            this._worldUpdateId++;\r\n            this._cachedWorldUpdateId = this._worldUpdateId;\r\n        }\r\n\r\n        debug.ASSERT(this._wt.valid(), 'Invalid world transform, property is set incorrectly somewhere...');\r\n    }\r\n\r\n    /**\r\n     * Destroys this transform object.\r\n     */\r\n    destroy()\r\n    {\r\n        this._wt = null;\r\n        this._lt = null;\r\n        this._position = null;\r\n        this._scale = null;\r\n        this._skew = null;\r\n        this._pivot = null;\r\n    }\r\n}\r\n\r\n/**\r\n * The identity transform.\r\n *\r\n * @static\r\n * @constant\r\n * @type {Transform}\r\n */\r\nTransform.IDENTITY = new Transform();\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/transform/src/Transform.js\n **/","import Transform from './Transform';\r\n\r\nexport default function TransformComponent(Base)\r\n{\r\n    /**\r\n     * @class TransformComponent\r\n     * @memberof transform\r\n     */\r\n    return class extends Base\r\n    {\r\n        /**\r\n         *\r\n         */\r\n        constructor()\r\n        {\r\n            super(...arguments); // eslint-disable-line prefer-rest-params\r\n\r\n            /**\r\n             * The transformation of the object.\r\n             *\r\n             * @member {Transform}\r\n             */\r\n            this.transform = new Transform();\r\n\r\n            /**\r\n             * The last transform update ID that this object has seen.\r\n             *\r\n             * @private\r\n             * @member {number}\r\n             */\r\n            this._cachedTransformUpdateId = -1;\r\n        }\r\n    };\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/transform/src/TransformComponent.js\n **/","import { ecs, render } from '@fae/core';\r\nimport TransformComponent from './TransformComponent';\r\n\r\n// TODO: Transforms can have parents, but it is possible here to have\r\n// a child's update() called first before the parent updates.\r\n// Need to sort by parents in some efficient way.\r\n\r\n/**\r\n * @class\r\n * @memberof transform\r\n */\r\nexport default class TransformUpdateSystem extends ecs.System\r\n{\r\n    /**\r\n     * @param {Renderer} renderer - The renderer to use.\r\n     * @param {number} priority - The priority of the system, higher means earlier.\r\n     * @param {number} frequency - How often to run the update loop. `1` means every\r\n     *  time, `2` is every other time, etc.\r\n     */\r\n    constructor(renderer, priority = ecs.System.PRIORITY.PLUGIN, frequency = 1)\r\n    {\r\n        super(renderer, priority, frequency);\r\n    }\r\n\r\n    /**\r\n     * Returns true if the entity is eligible to the system, false otherwise.\r\n     *\r\n     * @param {Entity} entity - The entity to test.\r\n     * @return {boolean} True if entity should be included.\r\n     */\r\n    test(entity)\r\n    {\r\n        return entity.hasComponent(TransformComponent);\r\n    }\r\n\r\n    /**\r\n     * Update the entity's transform matrix.\r\n     *\r\n     * @param {Entity} entity - The entity to update\r\n     */\r\n    update(entity)\r\n    {\r\n        entity.transform.update();\r\n    }\r\n}\r\n\r\nrender.Renderer.addDefaultSystem(TransformUpdateSystem);\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/transform/src/TransformUpdateSystem.js\n **/","/** @namespace textures */\r\n\r\nexport { default as Texture } from './Texture';\r\nexport { default as TextureComponent } from './TextureComponent';\r\nexport { default as TextureSource } from './TextureSource';\r\nexport { default as TextureUVs } from './TextureUVs';\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/textures/src/index.js\n **/","import Signal from 'mini-signals';\r\nimport { Rectangle } from '@fae/shapes';\r\nimport TextureSource from './TextureSource';\r\nimport TextureUVs from './TextureUVs';\r\n\r\nimport { debug } from '@fae/core';\r\n\r\n/**\r\n * A Texture is a wrapper around a TextureSource. It represents the frame of the\r\n * source to actually draw.\r\n *\r\n * @class\r\n * @memberof textures\r\n */\r\nexport default class Texture\r\n{\r\n    /**\r\n     * @param {TextureSource|CanvasImageSource|Texture} source - The source to wrap.\r\n     * @param {Rectangle} frame - The portion of the source to operate with.\r\n     * @param {Rectangle} orig - The original area of this frame, before it was put in an atlas (if it was).\r\n     * @param {Rectangle} trim - The trimmed area of this frame, after it was put in an atlas (if it was).\r\n     * @param {number} rotation - The rotation of the frame (in radians), after it was put in an atlas (if it was).\r\n     *  This rotation is counteracted to draw an \"unrotated\" version of the frame.\r\n     */\r\n    constructor(source, frame = null, orig = null, trim = null, rotation = 0)\r\n    {\r\n        // massage source into a TextureSource instance.\r\n        if (source instanceof Texture)\r\n        {\r\n            source = source.source;\r\n        }\r\n        else if (!(source instanceof TextureSource))\r\n        {\r\n            source = new TextureSource(source);\r\n        }\r\n\r\n        debug.ASSERT(source instanceof TextureSource, 'Source passed to Texture is not a TextureSource.');\r\n\r\n        /**\r\n         * The source for this texture to represent.\r\n         *\r\n         * @member {TextureSource}\r\n         */\r\n        this.source = source;\r\n\r\n        /**\r\n         * The trimmed area of the frame after it was packed into an atlas (if it was).\r\n         *\r\n         * @member {Rectangle}\r\n         */\r\n        this.trim = trim;\r\n\r\n        /**\r\n         * The original area of the frame before it was packed into an atlas (if it was).\r\n         *\r\n         * @member {Rectangle}\r\n         */\r\n        this.orig = orig || frame;\r\n\r\n        /**\r\n         * Dispatched when the texture is updated.\r\n         *\r\n         * @member {Signal}\r\n         */\r\n        this.onUpdate = new Signal();\r\n\r\n        /**\r\n         * Does this texture have an explicit frame, or do we use the whole image?\r\n         *\r\n         * @private\r\n         * @member {boolean}\r\n         */\r\n        this._explicitFrame = !!frame;\r\n\r\n        /**\r\n         * The frame of the source to represent.\r\n         *\r\n         * @private\r\n         * @member {Rectangle}\r\n         */\r\n        this._frame = null;\r\n\r\n        /**\r\n         * The uvs to draw with.\r\n         *\r\n         * @member {UVs}\r\n         */\r\n        this._uvs = new TextureUVs();\r\n\r\n        /**\r\n         * The rotation of the texture, after it was packed into an atlas (if it was).\r\n         *\r\n         * @member {number}\r\n         */\r\n        this._rotation = rotation === true ? -Math.PI / 2 : rotation;\r\n\r\n        this._onSourceUpdateBinding = null;\r\n        this._onSourceReadyBinding = null;\r\n\r\n        // setup frame\r\n        if (source.ready)\r\n        {\r\n            if (!this._explicitFrame)\r\n            {\r\n                frame = new Rectangle(0, 0, source.width, source.height);\r\n\r\n                this._onSourceUpdateBinding = source.onUpdate.add(this._onSourceUpdate, this);\r\n            }\r\n\r\n            this.frame = frame;\r\n        }\r\n        else\r\n        {\r\n            this._onSourceReadyBinding = source.onReady.once(this._onSourceReady, this);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Is the source loaded and ready to go?\r\n     *\r\n     * @member {boolean}\r\n     */\r\n    get ready()\r\n    {\r\n        return !!((this.source ? this.source.ready : false) && this.orig);\r\n    }\r\n\r\n    /**\r\n     * The frame of the source to represent.\r\n     *\r\n     * @member {Rectangle}\r\n     */\r\n    get frame()\r\n    {\r\n        return this._frame;\r\n    }\r\n\r\n    /**\r\n     * @param {Rectangle} v - The new frame.\r\n     */\r\n    set frame(v)\r\n    {\r\n        this._frame = v;\r\n        this._explicitFrame = true;\r\n\r\n        debug.ASSERT(\r\n            v.x >= 0 && v.y >= 0 && v.x + v.width <= this.source.width && v.y + v.height <= this.source.height,\r\n            'Frame for texture doesn\\'t fit within the source size'\r\n        );\r\n\r\n        if (!this.trim && !this.rotate)\r\n        {\r\n            this.orig = v;\r\n        }\r\n\r\n        this._updateUVs();\r\n    }\r\n\r\n    /**\r\n     * The rotation of the texture frame, after it was packed into an atlas (if it was).\r\n     *\r\n     * @member {number}\r\n     */\r\n    get rotation()\r\n    {\r\n        return this._rotation;\r\n    }\r\n\r\n    /**\r\n     * @param {number} v - The rotation in radians.\r\n     */\r\n    set rotation(v)\r\n    {\r\n        this._rotation = v;\r\n        this._updateUVs();\r\n    }\r\n\r\n    /**\r\n     * Width of the texture in pixels.\r\n     *\r\n     */\r\n    get width()\r\n    {\r\n        return this.orig ? this.orig.width : 0;\r\n    }\r\n\r\n    /**\r\n     * Height of the texture in pixels.\r\n     *\r\n     */\r\n    get height()\r\n    {\r\n        return this.orig ? this.orig.height : 0;\r\n    }\r\n\r\n    /**\r\n     * Updates the texture on the GPU.\r\n     *\r\n     * @return {Texture} Returns itself.\r\n     */\r\n    update()\r\n    {\r\n        this.source.update();\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Creates a new texture that represents the same region as this one.\r\n     *\r\n     * @return {Texture} The clone.\r\n     */\r\n    clone()\r\n    {\r\n        return new Texture(this.source, this.frame, this.orig, this.trim, this.rotation);\r\n    }\r\n\r\n    /**\r\n     * Destroys this texture.\r\n     *\r\n     * @param {object|boolean} options - A boolean value will act as if all options are set to that value.\r\n     * @param {boolean} options.destroySource=false - Whether to destroy the texture source as well.\r\n     */\r\n    destroy(options = false)\r\n    {\r\n        const destroySource = typeof options === 'boolean' ? options : options && options.baseTexture;\r\n\r\n        if (this._onSourceUpdateBinding) this._onSourceUpdateBinding.detach();\r\n        if (this._onSourceReadyBinding) this._onSourceReadyBinding.detach();\r\n\r\n        this._onSourceUpdateBinding = null;\r\n        this._onSourceReadyBinding = null;\r\n\r\n        if (destroySource)\r\n        {\r\n            this.source.destroy();\r\n        }\r\n\r\n        this.source = null;\r\n        this.trim = null;\r\n        this.orig = null;\r\n\r\n        this.onUpdate.detachAll();\r\n        this.onUpdate = null;\r\n\r\n        this._frame = null;\r\n        this._uvs = null;\r\n    }\r\n\r\n    /**\r\n     * Called when the source is ready.\r\n     *\r\n     * @private\r\n     */\r\n    _onSourceReady()\r\n    {\r\n        if (this._explicitFrame)\r\n        {\r\n            // validate and update frame properties by calling setter\r\n            this.frame = this._frame;\r\n        }\r\n        else\r\n        {\r\n            this.frame = new Rectangle(0, 0, this.source.width, this.source.height);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Called when the source is updated.\r\n     *\r\n     * @private\r\n     */\r\n    _onSourceUpdate()\r\n    {\r\n        this._frame.width = this.source.width;\r\n        this._frame.height = this.source.height;\r\n\r\n        this.onUpdate.dispatch();\r\n    }\r\n\r\n    /**\r\n     * Updates the UV coords of this texture.\r\n     *\r\n     * @private\r\n     */\r\n    _updateUVs()\r\n    {\r\n        this._uvs.set(this._frame, this.source, this.rotation);\r\n    }\r\n}\r\n\r\n/**\r\n * An empty texture instance.\r\n *\r\n * @static\r\n * @constant\r\n * @memberof Texture\r\n * @type {Texture}\r\n */\r\nTexture.EMPTY = new Texture(TextureSource.EMPTY);\r\nTexture.EMPTY.destroy = function _noop() { /* empty */ }; // eslint-disable-line brace-style\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/textures/src/Texture.js\n **/","import Signal from 'mini-signals';\r\nimport bitTwiddle from 'bit-twiddle';\r\nimport { debug, glutil } from '@fae/core';\r\n\r\n/**\r\n * A TextureSource is a wrapper around a raw object that can be drawn with the\r\n * WebGL API. It contains information necessary for managing that source.\r\n *\r\n * @class\r\n * @memberof textures\r\n */\r\nexport default class TextureSource\r\n{\r\n    /**\r\n     * @param {CanvasImageSource|RenderTarget} source - The drawable source.\r\n     * @param {number} scaleMode - How to scale the texture source. Either `WebGLRenderingContext.LINEAR`\r\n     *  or `WebGLRenderingContext.NEAREST`.\r\n     * @param {number} wrapMode - How to scale the texture source. Either `WebGLRenderingContext.CLAMP_TO_EDGE`,\r\n     *  `WebGLRenderingContext.REPEAT`, or `WebGLRenderingContext.MIRRORED_REPEAT`.\r\n     * @param {boolean} mipmap - Whether a mipmap should be generated for this texture.\r\n     */\r\n    constructor(\r\n        source,\r\n        scaleMode = TextureSource.defaultScaleMode,\r\n        wrapMode = TextureSource.defaultWrapMode,\r\n        mipmap = TextureSource.defaultMipMap\r\n    )\r\n    {\r\n        /**\r\n         * The width of the source, set when the source has loaded\r\n         *\r\n         * @member {number}\r\n         * @readonly\r\n         */\r\n        this.width = 0;\r\n\r\n        /**\r\n         * The height of the source, set when the source has loaded\r\n         *\r\n         * @member {number}\r\n         * @readonly\r\n         */\r\n        this.height = 0;\r\n\r\n        /**\r\n         * Set to true once the source has successfully loaded.\r\n         *\r\n         * This is never true if the underlying source fails to load or has no\r\n         * texture data.\r\n         *\r\n         * @member {boolean}\r\n         * @readonly\r\n         */\r\n        this.ready = false;\r\n\r\n        /**\r\n         * Controls if RGB channels should be pre-multiplied by Alpha  (WebGL only)\r\n         * Built-in blend modes, and shaders written for default value. Change it on\r\n         * your own risk.\r\n         *\r\n         * @member {boolean}\r\n         * @default true\r\n         */\r\n        this.premultipliedAlpha = true;\r\n\r\n        /**\r\n         * Wether or not the texture is a power of two, try to use power of two\r\n         * textures as much as you can.\r\n         *\r\n         * @private\r\n         * @member {boolean}\r\n         */\r\n        this.isPowerOfTwo = false;\r\n\r\n        /**\r\n         * The scale mode to apply when scaling this texture\r\n         *\r\n         * Valid values are:\r\n         *\r\n         * - `WebGLRenderingContext.NEAREST`\r\n         * - `WebGLRenderingContext.LINEAR`\r\n         *\r\n         * You can change the default used with {@link TextureSource.defaultScaleMode}.\r\n         *\r\n         * @member {number}\r\n         */\r\n        this.scaleMode = scaleMode;\r\n\r\n        /**\r\n         * WebGL Texture wrap mode.\r\n         *\r\n         * Valid values are:\r\n         *\r\n         * - `WebGLRenderingContext.CLAMP_TO_EDGE`\r\n         * - `WebGLRenderingContext.REPEAT`\r\n         * - `WebGLRenderingContext.MIRRORED_REPEAT`\r\n         *\r\n         * You can change the default used with {@link TextureSource.defaultWrapMode}.\r\n         *\r\n         * @member {number}\r\n         */\r\n        this.wrapMode = wrapMode;\r\n\r\n        /**\r\n         * Set this to true if a mipmap of this texture needs to be generated. This\r\n         * value needs to be set before the texture is used.\r\n         * Also the texture must be a power of two size to work\r\n         *\r\n         * You can change the default used with {@link TextureSource.defaultMipMap}.\r\n         *\r\n         * @member {boolean}\r\n         */\r\n        this.mipmap = mipmap;\r\n\r\n        /**\r\n         * Dispatched when the source has loaded, if the source is already\r\n         * loaded when this object is created, this will be dispatched 1 tick\r\n         * after creation.\r\n         *\r\n         * @member {Signal}\r\n         */\r\n        this.onReady = new Signal();\r\n\r\n        /**\r\n         * Dispatched if a source fails to load. This usually only happens\r\n         * for sources that are not yet loaded when this object is created.\r\n         *\r\n         * @member {Signal}\r\n         */\r\n        this.onError = new Signal();\r\n\r\n        /**\r\n         * Dispatched when this source is updated.\r\n         *\r\n         * @member {Signal}\r\n         */\r\n        this.onUpdate = new Signal();\r\n\r\n        /**\r\n         * The source element to draw.\r\n         *\r\n         * @private\r\n         * @member {CanvasImageSource}\r\n         */\r\n        this._source = null;\r\n\r\n        /**\r\n         * The tracker for the video update loop if needed.\r\n         *\r\n         * @private\r\n         * @member {number}\r\n         */\r\n        this._updateLoop = 0;\r\n\r\n        /**\r\n         * A map of renderer IDs to GLTexture instances.\r\n         *\r\n         * @member {object<number, WebGLTexture>}\r\n         * @private\r\n         */\r\n        this._glTextures = {};\r\n        this._enabled = 0;\r\n        this._id = 0;\r\n\r\n        this._boundOnSourceLoad = this._onSourceLoad.bind(this);\r\n        this._boundOnSourceError = this._onSourceError.bind(this);\r\n        this._boundOnSourcePlay = this._onSourcePlay.bind(this);\r\n        this._boundOnSourceStop = this._onSourceStop.bind(this);\r\n        this._boundVideoUpdateLoop = this._videoUpdateLoop.bind(this);\r\n\r\n        this._onContextChangeBindings = {};\r\n\r\n        // run source setter\r\n        this.source = source;\r\n\r\n        const c = WebGLRenderingContext;\r\n        const s = this.scaleMode;\r\n        const w = this.wrapMode;\r\n\r\n        debug.ASSERT(s === c.LINEAR || s === c.NEAREST, `Invalid scaleMode: ${s} (${typeof s}).`);\r\n        debug.ASSERT(w === c.CLAMP_TO_EDGE || w === c.REPEAT || w === c.MIRRORED_REPEAT, `Invalid warpMode: ${w} (${typeof w}).`); // eslint-disable-line max-len\r\n        debug.ASSERT(typeof this.mipmap === 'boolean', `Invalid mipmap value: ${this.mipmap} (${typeof this.mipmap}).`);\r\n    }\r\n\r\n    /**\r\n     * The source element to draw.\r\n     *\r\n     * @member {CanvasImageSource}\r\n     */\r\n    get source()\r\n    {\r\n        return this._source;\r\n    }\r\n\r\n    /**\r\n     * @param {CanvasImageSource} v - new source.\r\n     */\r\n    set source(v)\r\n    {\r\n        this._load(v);\r\n    }\r\n\r\n    /**\r\n     * Updates the texture properties based on the source.\r\n     *\r\n     * @param {Renderer} renderer - The renderer to update on. If not passed, all are updated.\r\n     * @param {boolean} silent - Should we skip dispatching the update event?\r\n     * @return {TextureSource} Returns itself.\r\n     */\r\n    update(renderer = null, silent = false)\r\n    {\r\n        this.width = this.source.naturalWidth || this.source.videoWidth || this.source.width;\r\n        this.height = this.source.naturalHeight || this.source.videoHeight || this.source.height;\r\n\r\n        this.isPowerOfTwo = bitTwiddle.isPow2(this.width) && bitTwiddle.isPow2(this.height);\r\n\r\n        if (renderer)\r\n        {\r\n            this._update(renderer.uid);\r\n        }\r\n        else\r\n        {\r\n            Object.keys(this._glTextures).forEach((k) => this._update(k));\r\n        }\r\n\r\n        if (this.source.currentTime && !this.source.paused && !this.source.ended)\r\n        {\r\n            this._onSourcePlay();\r\n        }\r\n\r\n        if (!silent)\r\n        {\r\n            this.onUpdate.dispatch();\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Disposes of all GLTexture instances and clears them from the GPU for all renderers.\r\n     *\r\n     * @param {Renderer} renderer - The renderer to dispose on. If not passed, all are disposed.\r\n     */\r\n    dispose(renderer = null)\r\n    {\r\n        if (renderer)\r\n        {\r\n            this._dispose(renderer.uid);\r\n        }\r\n        else\r\n        {\r\n            Object.keys(this._glTextures).forEach((k) => this._dispose(k));\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Gets the underlying GLTexture instance for a particular renderer, creating\r\n     * one if necessary.\r\n     *\r\n     * @param {Renderer} renderer - The renderer to get a GLTexture for.\r\n     * @return {GLTexture} The GLTexture to use, or `null` if it hasn't loaded yet.\r\n     */\r\n    getGlTexture(renderer)\r\n    {\r\n        if (!this.ready) return null;\r\n\r\n        // support for RenderTarget as source.\r\n        if (this.source.framebuffer)\r\n        {\r\n            if (this.source.framebuffer.texture)\r\n            {\r\n                return this.source.framebuffer.texture;\r\n            }\r\n\r\n            debug.ASSERT(false, 'Tried to render a RenderTexture source that has no GLTexture created.');\r\n\r\n            return null;\r\n        }\r\n\r\n        let glTexture = this._glTextures[renderer.uid];\r\n\r\n        if (!glTexture)\r\n        {\r\n            glTexture = new glutil.GLTexture(renderer.gl);\r\n            glTexture.premultiplyAlpha = true;\r\n\r\n            this._glTextures[renderer.uid] = glTexture;\r\n\r\n            this._onContextChangeBindings[renderer.uid] = renderer.onContextChange.add(this._onContextChange, this);\r\n\r\n            // wrap mode\r\n            if (this.isPowerOfTwo)\r\n            {\r\n                if (this.mipmap)\r\n                {\r\n                    glTexture.enableMipmap();\r\n                }\r\n\r\n                if (this.wrapMode === WebGLRenderingContext.CLAMP_TO_EDGE)\r\n                {\r\n                    glTexture.enableWrapClamp();\r\n                }\r\n                else if (this.wrapMode === WebGLRenderingContext.REPEAT)\r\n                {\r\n                    glTexture.enableWrapRepeat();\r\n                }\r\n                else\r\n                {\r\n                    glTexture.enableWrapMirrorRepeat();\r\n                }\r\n            }\r\n            else\r\n            {\r\n                glTexture.enableWrapClamp();\r\n            }\r\n\r\n            // scale mode\r\n            if (this.scaleMode === WebGLRenderingContext.NEAREST)\r\n            {\r\n                glTexture.enableNearestScaling();\r\n            }\r\n            else\r\n            {\r\n                glTexture.enableLinearScaling();\r\n            }\r\n\r\n            this._update(renderer.uid);\r\n        }\r\n\r\n        return glTexture;\r\n    }\r\n\r\n    /**\r\n     * Destroys this texture source.\r\n     *\r\n     */\r\n    destroy()\r\n    {\r\n        this.dispose();\r\n\r\n        this._unbindSourceEvents();\r\n        this.source = null;\r\n\r\n        this.onUpdate.detachAll();\r\n        this.onUpdate = null;\r\n\r\n        this.onReady.detachAll();\r\n        this.onReady = null;\r\n\r\n        this.onError.detachAll();\r\n        this.onError = null;\r\n    }\r\n\r\n    /**\r\n     * Updates an internal texture.\r\n     *\r\n     * @private\r\n     * @param {number} uid - The renderer uid to update for.\r\n     */\r\n    _update(uid)\r\n    {\r\n        const glTexture = this._glTextures[uid];\r\n\r\n        if (glTexture)\r\n        {\r\n            glTexture.upload(this.source);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Disposes of an internal texture.\r\n     *\r\n     * @private\r\n     * @param {number} uid - The renderer uid to dispose for.\r\n     */\r\n    _dispose(uid)\r\n    {\r\n        const glTexture = this._glTextures[uid];\r\n\r\n        if (glTexture)\r\n        {\r\n            glTexture.destroy();\r\n\r\n            delete this._glTextures[uid];\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Loads a new source.\r\n     *\r\n     * @private\r\n     * @param {CanvasImageSource} source - The source to load.\r\n     */\r\n    _load(source)\r\n    {\r\n        this.ready = false;\r\n        this._unbindSourceEvents();\r\n\r\n        this._source = source;\r\n\r\n        if (!source) return;\r\n\r\n        // handle RenderTarget\r\n        if (source.framebuffer)\r\n        {\r\n            debug.ASSERT(source.width && source.height, 'RenderTarget source is missing width or height.');\r\n\r\n            this._onSourceLoad();\r\n        }\r\n        // handle canvas\r\n        else if (source.getContext)\r\n        {\r\n            debug.ASSERT(source.width && source.height, 'Canvas source is missing width or height.');\r\n\r\n            this._onSourceLoad();\r\n        }\r\n        else\r\n        {\r\n            this._bindSourceEvents();\r\n\r\n            // handle image\r\n            if (typeof source.src === 'string')\r\n            {\r\n                // complete is marked as true if the src is empty, so need to check both.\r\n                // if `src` is empty, we assume they will assign one later, and our events will catch it.\r\n                if (source.complete && source.src)\r\n                {\r\n                    this._onSourceLoad();\r\n                }\r\n            }\r\n            // handle video\r\n            else if (source.complete)\r\n            {\r\n                this._onSourceLoad();\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Called when the context changes.\r\n     *\r\n     * @param {Renderer} renderer - The renderer that had it's context restored.\r\n     */\r\n    _onContextChange(renderer)\r\n    {\r\n        this._dispose(renderer.uid);\r\n    }\r\n\r\n    /**\r\n     * Called when the underlying source is loaded and ready to be used.\r\n     *\r\n     * @private\r\n     */\r\n    _onSourceLoad()\r\n    {\r\n        // if we have no width/height, consider the load a failure.\r\n        this.update(null, true);\r\n        if (!this.width || !this.height)\r\n        {\r\n            this._onSourceError({ message: 'Source failed to load.' });\r\n\r\n            return;\r\n        }\r\n\r\n        // unbind events related to loading, but keep non-loading related ones.\r\n        this._unbindSourceEvents(true);\r\n\r\n        // update\r\n        this.ready = true;\r\n        this.update();\r\n\r\n        // since _onSourceLoad can be called synchronously, wait a tick before dispatching.\r\n        setTimeout(() => this.onReady.dispatch(), 0);\r\n    }\r\n\r\n    /**\r\n     * Called if the underlying source has an error during loading.\r\n     *\r\n     * @private\r\n     * @param {object} event - The error event.\r\n     */\r\n    _onSourceError(event)\r\n    {\r\n        this._unbindSourceEvents();\r\n\r\n        // since _onSourceError can be called synchronously, wait a tick before dispatching.\r\n        setTimeout(() => this.onError.dispatch(new Error(event.message || 'Unable to load source.')), 0);\r\n    }\r\n\r\n    /**\r\n     * Runs the update loop when the video is ready to play\r\n     *\r\n     * @private\r\n     */\r\n    _onSourcePlay()\r\n    {\r\n        cancelAnimationFrame(this._updateLoop);\r\n        this._videoUpdateLoop();\r\n    }\r\n\r\n    /**\r\n     * Stops the update loop when the video is paused\r\n     *\r\n     * @private\r\n     */\r\n    _onSourceStop()\r\n    {\r\n        cancelAnimationFrame(this._updateLoop);\r\n    }\r\n\r\n    /**\r\n     * Updates the texture for the video element.\r\n     *\r\n     * @private\r\n     */\r\n    _videoUpdateLoop()\r\n    {\r\n        this._updateLoop = requestAnimationFrame(this._boundVideoUpdateLoop);\r\n        this.update(null, true);\r\n    }\r\n\r\n    /**\r\n     * Binds listeners to a source image or video.\r\n     *\r\n     * @private\r\n     * @param {boolean} loadOnly - Only manage events related to loading.\r\n     */\r\n    _bindSourceEvents(loadOnly = false)\r\n    {\r\n        if (!this._source) return;\r\n\r\n        this._source.addEventListener('load', this._boundOnSourceLoad);\r\n        this._source.addEventListener('canplay', this._boundOnSourceLoad);\r\n        this._source.addEventListener('canplaythrough', this._boundOnSourceLoad);\r\n        this._source.addEventListener('error', this._boundOnSourceError);\r\n\r\n        if (!loadOnly)\r\n        {\r\n            this._source.addEventListener('play', this._boundOnSourcePlay);\r\n            this._source.addEventListener('pause', this._boundOnSourceStop);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Unbinds listeners from a source image or video.\r\n     *\r\n     * @private\r\n     * @param {boolean} loadOnly - Only manage events related to loading.\r\n     */\r\n    _unbindSourceEvents(loadOnly = false)\r\n    {\r\n        if (!this._source) return;\r\n\r\n        this._source.removeEventListener('load', this._boundOnSourceLoad);\r\n        this._source.removeEventListener('canplay', this._boundOnSourceLoad);\r\n        this._source.removeEventListener('canplaythrough', this._boundOnSourceLoad);\r\n        this._source.removeEventListener('error', this._boundOnSourceError);\r\n\r\n        if (!loadOnly)\r\n        {\r\n            this._source.removeEventListener('play', this._boundOnSourcePlay);\r\n            this._source.removeEventListener('pause', this._boundOnSourceStop);\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * The default scale mode to use when a new source is created, and no\r\n * scale mode is specified.\r\n *\r\n * @static\r\n * @constant\r\n * @memberof TextureSource\r\n * @type {number}\r\n * @default WebGLRenderingContext.LINEAR\r\n */\r\nTextureSource.defaultScaleMode = WebGLRenderingContext.LINEAR;\r\n\r\n/**\r\n * The default mipmap mode to use when a new source is created, and no\r\n * mipmap mode is specified.\r\n *\r\n * @static\r\n * @constant\r\n * @memberof TextureSource\r\n * @type {boolean}\r\n * @default true\r\n */\r\nTextureSource.defaultMipMap = true;\r\n\r\n/**\r\n * The default wrapping mode to use when a new source is created, and no\r\n * wrapping mode is specified.\r\n *\r\n * @static\r\n * @constant\r\n * @memberof TextureSource\r\n * @type {number}\r\n * @default WebGLRenderingContext.CLAMP_TO_EDGE\r\n */\r\nTextureSource.defaultWrapMode = WebGLRenderingContext.CLAMP_TO_EDGE;\r\n\r\n/**\r\n * An empty texture source instance.\r\n *\r\n * @static\r\n * @constant\r\n * @memberof TextureSource\r\n * @type {TextureSource}\r\n */\r\nTextureSource.EMPTY = new TextureSource();\r\nTextureSource.EMPTY.destroy = function _noop() { /* empty */ }; // eslint-disable-line brace-style\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/textures/src/TextureSource.js\n **/","/**\r\n * Helper to store and calculate the UVs of a texture.\r\n *\r\n * @class\r\n * @memberof textures\r\n */\r\nexport default class TextureUVs\r\n{\r\n    /**\r\n     *\r\n     */\r\n    constructor()\r\n    {\r\n        this.x0 = 0;\r\n        this.y0 = 0;\r\n\r\n        this.x1 = 1;\r\n        this.y1 = 0;\r\n\r\n        this.x2 = 1;\r\n        this.y2 = 1;\r\n\r\n        this.x3 = 0;\r\n        this.y3 = 1;\r\n\r\n        this.uvsUint32 = new Uint32Array(4);\r\n    }\r\n\r\n    /**\r\n     * Calculates the UVs based on the given frames.\r\n     *\r\n     * @param {Rectangle} frame - The frame of the region in the texture.\r\n     * @param {Rectangle} baseFrame - The frame of the full texture.\r\n     * @param {number} rotation - Rotation of frame, in radians.\r\n     * @private\r\n     */\r\n    set(frame, baseFrame, rotation)\r\n    {\r\n        const tw = baseFrame.width;\r\n        const th = baseFrame.height;\r\n\r\n        this.x0 = frame.x / tw;\r\n        this.y0 = frame.y / th;\r\n\r\n        this.x1 = (frame.x + frame.width) / tw;\r\n        this.y1 = frame.y / th;\r\n\r\n        this.x2 = (frame.x + frame.width) / tw;\r\n        this.y2 = (frame.y + frame.height) / th;\r\n\r\n        this.x3 = frame.x / tw;\r\n        this.y3 = (frame.y + frame.height) / th;\r\n\r\n        if (rotation)\r\n        {\r\n            // coordinates of center\r\n            const cx = (frame.x / tw) + (frame.width / 2 / tw);\r\n            const cy = (frame.y / th) + (frame.height / 2 / th);\r\n\r\n            // rotation values\r\n            const sr = Math.sin(rotation);\r\n            const cr = Math.cos(rotation);\r\n\r\n            this.x0 = cx + (((this.x0 - cx) * cr) - ((this.y0 - cy) * sr));\r\n            this.y0 = cy + (((this.x0 - cx) * sr) + ((this.y0 - cy) * cr));\r\n\r\n            this.x1 = cx + (((this.x1 - cx) * cr) - ((this.y1 - cy) * sr));\r\n            this.y1 = cy + (((this.x1 - cx) * sr) + ((this.y1 - cy) * cr));\r\n\r\n            this.x2 = cx + (((this.x2 - cx) * cr) - ((this.y2 - cy) * sr));\r\n            this.y2 = cy + (((this.x2 - cx) * sr) + ((this.y2 - cy) * cr));\r\n\r\n            this.x3 = cx + (((this.x3 - cx) * cr) - ((this.y3 - cy) * sr));\r\n            this.y3 = cy + (((this.x3 - cx) * sr) + ((this.y3 - cy) * cr));\r\n        }\r\n\r\n        this.uvsUint32[0] = (((this.y0 * 65535) & 0xFFFF) << 16) | ((this.x0 * 65535) & 0xFFFF);\r\n        this.uvsUint32[1] = (((this.y1 * 65535) & 0xFFFF) << 16) | ((this.x1 * 65535) & 0xFFFF);\r\n        this.uvsUint32[2] = (((this.y2 * 65535) & 0xFFFF) << 16) | ((this.x2 * 65535) & 0xFFFF);\r\n        this.uvsUint32[3] = (((this.y3 * 65535) & 0xFFFF) << 16) | ((this.x3 * 65535) & 0xFFFF);\r\n    }\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/textures/src/TextureUVs.js\n **/","export default function TextureComponent(Base)\r\n{\r\n    /**\r\n     * @class TextureComponent\r\n     * @memberof textures\r\n     */\r\n    return class extends Base\r\n    {\r\n        /**\r\n         * @memberof TextureComponent\r\n         */\r\n        constructor()\r\n        {\r\n            super(...arguments); // eslint-disable-line prefer-rest-params\r\n\r\n            /**\r\n             * The texture object.\r\n             *\r\n             * @private\r\n             * @member {Texture}\r\n             */\r\n            this._texture = null;\r\n\r\n            /**\r\n             * The X coord of the attachment point of the texture.\r\n             *\r\n             * @private\r\n             * @member {number}\r\n             */\r\n            this._anchorX = 0;\r\n\r\n            /**\r\n             * The Y coord of the attachment point of the texture.\r\n             *\r\n             * @private\r\n             * @member {number}\r\n             */\r\n            this._anchorY = 0;\r\n\r\n            /**\r\n             * Tracker for if the vertices are dirty.\r\n             *\r\n             * @private\r\n             * @member {number}\r\n             */\r\n            this._anchorDirty = true;\r\n        }\r\n\r\n        /**\r\n         * The texture to use.\r\n         *\r\n         * @member {Texture}\r\n         */\r\n        get texture()\r\n        {\r\n            return this._texture;\r\n        }\r\n\r\n        /**\r\n         * @param {Texture} v - The new texture.\r\n         */\r\n        set texture(v)\r\n        {\r\n            if (this._texture === v) return;\r\n\r\n            this._texture = v;\r\n\r\n            this._onTextureChange();\r\n        }\r\n\r\n        /**\r\n         * The X coord of the attachment point of the texture.\r\n         *\r\n         * @member {number}\r\n         */\r\n        get anchorX()\r\n        {\r\n            return this._anchorX;\r\n        }\r\n\r\n        /**\r\n         * @param {number} v - The new anchor.\r\n         */\r\n        set anchorX(v)\r\n        {\r\n            if (this._anchorX === v) return;\r\n\r\n            this._anchorX = v;\r\n            this._anchorDirty = true;\r\n        }\r\n\r\n        /**\r\n         * The Y coord of the attachment point of the texture.\r\n         *\r\n         * @member {number}\r\n         */\r\n        get anchorY()\r\n        {\r\n            return this._anchorY;\r\n        }\r\n\r\n        /**\r\n         * @param {number} v - The new anchor.\r\n         */\r\n        set anchorY(v)\r\n        {\r\n            if (this._anchorY === v) return;\r\n\r\n            this._anchorY = v;\r\n            this._anchorDirty = true;\r\n        }\r\n\r\n        /**\r\n         * Called when the underlying texture changes.\r\n         *\r\n         * @protected\r\n         * @abstract\r\n         */\r\n        _onTextureChange()\r\n        {\r\n            /* empty */\r\n        }\r\n    };\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/textures/src/TextureComponent.js\n **/","import { util } from '@fae/core';\r\n\r\nexport default function SpriteComponent(Base)\r\n{\r\n    /**\r\n     * @class SpriteComponent\r\n     * @memberof sprites\r\n     */\r\n    return class extends Base\r\n    {\r\n        /**\r\n         *\r\n         */\r\n        constructor()\r\n        {\r\n            super(...arguments); // eslint-disable-line prefer-rest-params\r\n\r\n            /**\r\n             * The tint to apply to the sprite. A value of white will render without\r\n             * any tinting. This works because this color value is multiplied against\r\n             * the actual color value in the texture (per pixel).\r\n             *\r\n             * @member {Color}\r\n             */\r\n            this.tint = util.Color.WHITE.clone();\r\n\r\n            /**\r\n             * The blend mode to be applied to the sprite.\r\n             *\r\n             * @member {BlendMode}\r\n             * @default BlendMode.NORMAL\r\n             */\r\n            this.blendMode = util.BlendMode.NORMAL;\r\n\r\n            /**\r\n             * The vertex data used to draw the sprite.\r\n             *\r\n             * @readonly\r\n             * @member {Float32Array}\r\n             */\r\n            this.vertexData = new Float32Array(8);\r\n\r\n            /**\r\n             * Custom shader to use for drawing instead of the built-in batched shader.\r\n             * Warning: Setting this property will break the batch of sprites as it\r\n             * will need to be drawn in isolation.\r\n             *\r\n             * @member {Shader|GLShader}\r\n             */\r\n            this.shader = null;\r\n        }\r\n    };\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/sprites/src/SpriteComponent.js\n **/","import Device from 'ismobilejs';\r\nimport bitTwiddle from 'bit-twiddle';\r\nimport { render, glutil, util, debug } from '@fae/core';\r\n\r\nconst vertSource = require('./shader/multi-texture.vert');\r\nconst fragTemplate = require('./shader/multi-texture.frag');\r\n\r\nlet TICK = 0;\r\n\r\n/**\r\n * @class\r\n * @memberof sprites\r\n */\r\nexport default class SpriteRenderer extends render.ObjectRenderer\r\n{\r\n    /**\r\n     * @param {Renderer} renderer - The renderer this filter runs in.\r\n     */\r\n    constructor(renderer)\r\n    {\r\n        super(renderer);\r\n\r\n        /**\r\n         * Number of values sent in the vertex buffer.\r\n         * positionX, positionY, colorR, colorG, colorB = 5\r\n         *\r\n         * @member {number}\r\n         */\r\n        this.vertSize = 5;\r\n\r\n        /**\r\n         * The size of the vertex information in bytes.\r\n         *\r\n         * @member {number}\r\n         */\r\n        this.vertByteSize = this.vertSize * 4;\r\n\r\n        /**\r\n         * The number of images in the SpriteBatch before it flushes.\r\n         *\r\n         * @member {number}\r\n         */\r\n        this.size = bitTwiddle.nextPow2(SpriteRenderer.DEFAULT_SPRITE_BATCH_SIZE);\r\n\r\n        /**\r\n         * Buffer views used to upload smaller portions of the data size when the\r\n         * batch is small. This removes the need for `.subarray()`.\r\n         *\r\n         * @member {Buffer[]}\r\n         */\r\n        this.buffers = [];\r\n\r\n        /**\r\n         * Holds the indices of the geometry (quads) to draw\r\n         *\r\n         * @member {Uint16Array}\r\n         */\r\n        this.indices = glutil.GLQuad.createIndices(this.size);\r\n\r\n        /**\r\n         * The default shaders that is used if a sprite doesn't have a more specific one.\r\n         * there is a shader for each number of textures that can be rendererd.\r\n         * These shaders will also be generated on the fly as required.\r\n         *\r\n         * @member {Shader[]}\r\n         */\r\n        this.shaders = [];\r\n\r\n        // create buffer views\r\n        for (let i = 1; i <= this.size; i *= 2)\r\n        {\r\n            const viewSize = i * 4 * this.vertByteSize;\r\n\r\n            this.buffers.push(new util.Buffer(viewSize));\r\n        }\r\n\r\n        this.currentIndex = 0;\r\n        this.groups = [];\r\n\r\n        for (let k = 0; k < this.size; ++k)\r\n        {\r\n            this.groups[k] = {\r\n                textures: [],\r\n                size: 0,\r\n                start: 0,\r\n                blend: null,\r\n                shader: null,\r\n            };\r\n        }\r\n\r\n        this.sprites = [];\r\n\r\n        this.startNumVaos = 2;\r\n        this.vertexBuffers = [];\r\n        this.vaos = [];\r\n\r\n        this.vertexCount = -1;\r\n\r\n        this.indexBuffer = null;\r\n\r\n        this.vao = null;\r\n\r\n        this._maxTextures = 0;\r\n\r\n        this._onBeforeRenderBinding = renderer.onBeforeRender.add(this._onBeforeRender, this);\r\n        this._onContextChangeBinding = renderer.onContextChange.add(this._onContextChange, this);\r\n\r\n        this._onContextChange();\r\n    }\r\n\r\n    /**\r\n     * Stops the sprite batch.\r\n     *\r\n     */\r\n    stop()\r\n    {\r\n        this.flush();\r\n        this.vao.unbind();\r\n    }\r\n\r\n    /**\r\n     * Renders the content and empties the current batch.\r\n     *\r\n     */\r\n    flush()\r\n    {\r\n        if (this.currentIndex === 0) return;\r\n\r\n        const gl = this.renderer.gl;\r\n\r\n        const np2 = bitTwiddle.nextPow2(this.currentIndex);\r\n        const log2 = bitTwiddle.log2(np2);\r\n        const buffer = this.buffers[log2];\r\n\r\n        let index = 0;\r\n        let nextTexture = null;\r\n        let currentTexture = null;\r\n        let groupCount = 1;\r\n        let textureCount = 0;\r\n        let currentGroup = this.groups[0];\r\n        let blendMode = this.sprites[0].blendMode || util.BlendMode.NORMAL;\r\n\r\n        currentGroup.textures.length = 0;\r\n        currentGroup.start = 0;\r\n        currentGroup.blend = blendMode;\r\n        currentGroup.shader = null;\r\n\r\n        TICK++;\r\n\r\n        for (let i = 0; i < this.currentIndex; ++i)\r\n        {\r\n            // upload the sprite elemetns...\r\n            // they have all ready been calculated so we just need to push them into the buffer.\r\n            const sprite = this.sprites[i];\r\n\r\n            nextTexture = sprite._texture.source;\r\n\r\n            // a couple things should break the batch\r\n            if (sprite.shader || !blendMode.equals(sprite.blendMode))\r\n            {\r\n                blendMode = sprite.blendMode;\r\n\r\n                // force the batch to break!\r\n                currentTexture = null;\r\n                textureCount = this._maxTextures;\r\n                TICK++;\r\n            }\r\n\r\n            if (currentTexture !== nextTexture)\r\n            {\r\n                currentTexture = nextTexture;\r\n\r\n                if (nextTexture._enabled !== TICK)\r\n                {\r\n                    if (textureCount === this._maxTextures)\r\n                    {\r\n                        TICK++;\r\n\r\n                        textureCount = 0;\r\n\r\n                        currentGroup.size = i - currentGroup.start;\r\n\r\n                        currentGroup = this.groups[groupCount++];\r\n                        currentGroup.textures.length = 0;\r\n                        currentGroup.blend = blendMode;\r\n                        currentGroup.start = i;\r\n                        currentGroup.shader = sprite.shader;\r\n                    }\r\n\r\n                    // TODO: I don't like this, change this to not add properties to texture\r\n                    nextTexture._enabled = TICK;\r\n                    nextTexture._id = textureCount;\r\n\r\n                    const glTexture = nextTexture.getGlTexture(this.renderer);\r\n\r\n                    if (glTexture)\r\n                    {\r\n                        currentGroup.textures.push(glTexture);\r\n                        textureCount++;\r\n                    }\r\n                }\r\n            }\r\n\r\n            // TODO: this sum does not need to be set each frame, dirty flag?\r\n            const tint = sprite.tint.bgr + (sprite.worldAlpha * 255 << 24);\r\n            const uvs = sprite._texture._uvs.uvsUint32;\r\n            const textureId = nextTexture._id;\r\n            const vertexData = sprite.vertexData;\r\n\r\n            // xy\r\n            buffer.float32View[index++] = vertexData[0];\r\n            buffer.float32View[index++] = vertexData[1];\r\n            buffer.uint32View[index++] = uvs[0];\r\n            buffer.uint32View[index++] = tint;\r\n            buffer.float32View[index++] = textureId;\r\n\r\n            // xy\r\n            buffer.float32View[index++] = vertexData[2];\r\n            buffer.float32View[index++] = vertexData[3];\r\n            buffer.uint32View[index++] = uvs[1];\r\n            buffer.uint32View[index++] = tint;\r\n            buffer.float32View[index++] = textureId;\r\n\r\n            // xy\r\n            buffer.float32View[index++] = vertexData[4];\r\n            buffer.float32View[index++] = vertexData[5];\r\n            buffer.uint32View[index++] = uvs[2];\r\n            buffer.uint32View[index++] = tint;\r\n            buffer.float32View[index++] = textureId;\r\n\r\n            // xy\r\n            buffer.float32View[index++] = vertexData[6];\r\n            buffer.float32View[index++] = vertexData[7];\r\n            buffer.uint32View[index++] = uvs[3];\r\n            buffer.uint32View[index++] = tint;\r\n            buffer.float32View[index++] = textureId;\r\n        }\r\n\r\n        currentGroup.size = this.currentIndex - currentGroup.start;\r\n\r\n        this.vertexCount++;\r\n\r\n        if (this.vertexBuffers.length <= this.vertexCount)\r\n        {\r\n            this._createVao(gl, this.shaders[1].attributes);\r\n        }\r\n\r\n        debug.ASSERT(this.vertexBuffers.length > this.vertexCount, 'Number of Vertex Buffers is too small.');\r\n\r\n        this.vertexBuffers[this.vertexCount].upload(buffer.buffer, 0);\r\n        this.vao = this.vaos[this.vertexCount].bind();\r\n\r\n        // render the groups..\r\n        for (let i = 0; i < groupCount; ++i)\r\n        {\r\n            const group = this.groups[i];\r\n            const groupTextureCount = group.textures.length;\r\n\r\n            if (!groupTextureCount) continue;\r\n\r\n            let shader = null;\r\n\r\n            if (group.shader)\r\n            {\r\n                shader = group.shader;\r\n            }\r\n            else\r\n            {\r\n                shader = this.shaders[groupTextureCount - 1];\r\n            }\r\n\r\n            if (!shader)\r\n            {\r\n                shader = generateMultiTextureShader(this.renderer, groupTextureCount);\r\n                this.shaders[groupTextureCount - 1] = shader;\r\n            }\r\n\r\n            this.renderer.state.setShader(shader);\r\n\r\n            for (let j = 0; j < groupTextureCount; ++j)\r\n            {\r\n                group.textures[j].bind(j);\r\n            }\r\n\r\n            // set the blend mode..\r\n            this.renderer.state.setBlendMode(group.blend);\r\n\r\n            gl.drawElements(gl.TRIANGLES, group.size * 6, gl.UNSIGNED_SHORT, group.start * 6 * 2);\r\n        }\r\n\r\n        // reset elements for the next flush\r\n        this.currentIndex = 0;\r\n    }\r\n\r\n    /**\r\n     * Renders the sprite object.\r\n     *\r\n     * @param {Sprite} sprite - the sprite to render.\r\n     */\r\n    render(sprite)\r\n    {\r\n        if (this.currentIndex >= this.size)\r\n        {\r\n            this.flush();\r\n        }\r\n\r\n        // if the uvs have not updated then no point rendering just yet!\r\n        if (!sprite.texture._uvs)\r\n        {\r\n            return;\r\n        }\r\n\r\n        // increment the batchsize\r\n        this.sprites[this.currentIndex++] = sprite;\r\n    }\r\n\r\n    /**\r\n     * Destroys the sprite renderer.\r\n     *\r\n     */\r\n    destroy()\r\n    {\r\n        // detach events\r\n        this._onBeforeRenderBinding.detach();\r\n        this._onBeforeRenderBinding = null;\r\n\r\n        this._onContextChangeBinding.detach();\r\n        this._onContextChangeBinding = null;\r\n\r\n        this._destroyGlObjects();\r\n\r\n        // destroy buffers.\r\n        for (let i = 0; i < this.buffers.length; ++i)\r\n        {\r\n            this.buffers[i].destroy();\r\n        }\r\n\r\n        // null references\r\n        this.buffers = null;\r\n        this._buffersMem = null;\r\n        this.indices = null;\r\n        this.shaders = null;\r\n        this.groups = null;\r\n        this.sprites = null;\r\n        this.vertexBuffers = null;\r\n        this.vaos = null;\r\n        this.indexBuffer = null;\r\n\r\n        super.destroy();\r\n    }\r\n\r\n    /**\r\n     * Called by base Manager class when there is a WebGL context change.\r\n     *\r\n     * @private\r\n     */\r\n    _onContextChange()\r\n    {\r\n        const gl = this.renderer.gl;\r\n\r\n        this._destroyGlObjects(true);\r\n\r\n        // check max textures the GPU can handle.\r\n        this._maxTextures = Math.min(gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS), SpriteRenderer.MAX_TEXTURE_COUNT);\r\n\r\n        // check the maximum number of if statements shaders are allowed *up to* the max textures.\r\n        this._maxTextures = util.getMaxIfStatmentsInShader(gl, this._maxTextures);\r\n\r\n        this.shaders.length = this._maxTextures;\r\n        this.shaders[0] = this.shaders[0] || generateMultiTextureShader(this.renderer, 1);\r\n        this.shaders[1] = this.shaders[1] || generateMultiTextureShader(this.renderer, 2);\r\n\r\n        // create new index buffer\r\n        this.indexBuffer = glutil.GLBuffer.createIndexBuffer(gl, this.indices, gl.STATIC_DRAW);\r\n\r\n        // we use the second shader as the first one depending on your browser may omit aTextureId\r\n        // as it is not used by the shader so is optimized out.\r\n        const attribs = this.shaders[1].attributes;\r\n        const maxVaos = this.vertexBuffers.length || this.startNumVaos;\r\n\r\n        // create initial vertex buffers and VAOs\r\n        for (let i = 0; i < maxVaos; ++i)\r\n        {\r\n            this._createVao(gl, attribs);\r\n        }\r\n\r\n        this.vao = this.vaos[0];\r\n    }\r\n\r\n    /**\r\n     * Called just before the renderer starts rendering each frame.\r\n     *\r\n     * @private\r\n     */\r\n    _onBeforeRender()\r\n    {\r\n        this.vertexCount = -1;\r\n    }\r\n\r\n    /**\r\n     * Creates a new vertex buffer and VAO to manage it.\r\n     *\r\n     * @private\r\n     * @param {WebGLRenderingContext} gl - The rendering context.\r\n     * @param {*} attribs - Attribute data for the shader.\r\n     */\r\n    _createVao(gl, attribs)\r\n    {\r\n        const vbuffer = glutil.GLBuffer.createVertexBuffer(gl, null, gl.STREAM_DRAW);\r\n\r\n        this.vertexBuffers.push(vbuffer);\r\n\r\n        // build the vao object that will render..\r\n        this.vaos.push(\r\n            new glutil.GLVertexArrayObject(this.renderer.gl)\r\n                .setIndexBuffer(this.indexBuffer)\r\n                .addAttribute(vbuffer, attribs.aVertexPosition, gl.FLOAT, false, this.vertByteSize, 0)\r\n                .addAttribute(vbuffer, attribs.aTextureCoord, gl.UNSIGNED_SHORT, true, this.vertByteSize, 2 * 4)\r\n                .addAttribute(vbuffer, attribs.aColor, gl.UNSIGNED_BYTE, true, this.vertByteSize, 3 * 4)\r\n                .addAttribute(vbuffer, attribs.aTextureId, gl.FLOAT, false, this.vertByteSize, 4 * 4)\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Destroys GL objects that can change between contexts.\r\n     *\r\n     * @private\r\n     * @param {boolean} ctxRestore - Should we treat this like a context restore?\r\n     */\r\n    _destroyGlObjects(ctxRestore = false)\r\n    {\r\n        // destroy shaders\r\n        if (!ctxRestore)\r\n        {\r\n            for (let i = 0; i < this.shaders.length; ++i)\r\n            {\r\n                if (this.shaders[i])\r\n                {\r\n                    this.shaders[i].destroy();\r\n                }\r\n            }\r\n            this.shaders.length = 0;\r\n        }\r\n\r\n        // destroy vaos\r\n        for (let i = 0; i < this.vaos.length; ++i)\r\n        {\r\n            this.vaos[i].destroy();\r\n        }\r\n        this.vaos.length = 0;\r\n\r\n        // destroy vertex buffers\r\n        for (let i = 0; i < this.vertexBuffers.length; ++i)\r\n        {\r\n            this.vertexBuffers[i].destroy();\r\n        }\r\n        this.vertexBuffers.length = 0;\r\n\r\n        // destroy index buffer\r\n        if (this.indexBuffer)\r\n        {\r\n            this.indexBuffer.destroy();\r\n        }\r\n        this.indexBuffer = null;\r\n    }\r\n}\r\n\r\nfunction generateMultiTextureShader(renderer, maxTextures)\r\n{\r\n    let fragSource = fragTemplate;\r\n\r\n    fragSource = fragSource.replace(/\\{\\{count\\}\\}/gi, maxTextures);\r\n    fragSource = fragSource.replace(/\\{\\{texture_choice\\}\\}/gi, generateSampleSrc(maxTextures));\r\n\r\n    const shader = new render.Shader(renderer, vertSource, fragSource);\r\n\r\n    const sampleValues = [];\r\n\r\n    for (let i = 0; i < maxTextures; ++i)\r\n    {\r\n        sampleValues[i] = i;\r\n    }\r\n\r\n    shader.bind();\r\n    shader.uniforms.uSamplers = sampleValues;\r\n\r\n    return shader;\r\n}\r\n\r\nfunction generateSampleSrc(maxTextures)\r\n{\r\n    let src = '\\n\\n';\r\n\r\n    for (let i = 0; i < maxTextures; ++i)\r\n    {\r\n        if (i > 0) src += '\\n    else';\r\n\r\n        if (i < maxTextures - 1)\r\n        {\r\n            src += `    if(textureId == ${i}.0)`;\r\n        }\r\n\r\n        src += `\\n    {\\n        color = texture2D(uSamplers[${i}], vTextureCoord);\\n    }`;\r\n    }\r\n\r\n    src += '\\n\\n';\r\n\r\n    return src;\r\n}\r\n\r\n/**\r\n * Default batch size for the sprite renderer.\r\n *\r\n * @static\r\n * @constant\r\n * @memberof SpriteRenderer\r\n * @type {number}\r\n * @default 4096\r\n */\r\nSpriteRenderer.DEFAULT_SPRITE_BATCH_SIZE = 4096;\r\n\r\n/**\r\n * Default batch size for the sprite renderer. Defaults to 32 for desktop and 2 for phones.\r\n *\r\n * @static\r\n * @constant\r\n * @memberof SpriteRenderer\r\n * @type {number}\r\n * @default 32\r\n */\r\nSpriteRenderer.MAX_TEXTURE_COUNT = Device.tablet || Device.phone ? 2 : 32;\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/sprites/src/SpriteRenderer.js\n **/","module.exports = \"#define GLSLIFY 1\\nattribute vec2 aVertexPosition;\\nattribute vec2 aTextureCoord;\\nattribute vec4 aColor;\\nattribute float aTextureId;\\n\\nuniform mat3 uProjectionMatrix;\\n\\nvarying vec2 vTextureCoord;\\nvarying vec4 vColor;\\nvarying float vTextureId;\\n\\nvoid main(void){\\n    gl_Position = vec4((uProjectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\\n\\n    vTextureCoord = aTextureCoord;\\n    vTextureId = aTextureId;\\n    vColor = vec4(aColor.rgb * aColor.a, aColor.a);\\n}\\n\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./plugins/sprites/src/shader/multi-texture.vert\n ** module id = 79\n ** module chunks = 0\n **/","module.exports = \"#define GLSLIFY 1\\n#define TEXTURE_COUNT {{count}}\\n\\nvarying vec2 vTextureCoord;\\nvarying vec4 vColor;\\nvarying float vTextureId;\\n\\nuniform sampler2D uSamplers[TEXTURE_COUNT];\\n\\nvoid main(void)\\n{\\n    vec4 color;\\n    float textureId = floor(vTextureId + 0.5);\\n\\n    {{texture_choice}}\\n\\n    gl_FragColor = color * vColor;\\n}\\n\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./plugins/sprites/src/shader/multi-texture.frag\n ** module id = 80\n ** module chunks = 0\n **/","import { ecs, render } from '@fae/core';\r\nimport { TransformComponent } from '@fae/transform';\r\nimport { TextureComponent } from '@fae/textures';\r\nimport SpriteRenderer from './SpriteRenderer';\r\nimport SpriteComponent from './SpriteComponent';\r\n\r\n/**\r\n * @class\r\n * @memberof sprites\r\n */\r\nexport default class SpriteRenderSystem extends ecs.System\r\n{\r\n    /**\r\n     * @param {Renderer} renderer - The renderer to use.\r\n     * @param {number} priority - The priority of the system, higher means earlier.\r\n     * @param {number} frequency - How often to run the update loop. `1` means every\r\n     *  time, `2` is every other time, etc.\r\n     */\r\n    constructor(renderer, priority = SpriteRenderSystem.defaultPriority, frequency = 1)\r\n    {\r\n        super(renderer, priority, frequency);\r\n\r\n        /**\r\n         * The sprite renderer instance to use to draw/batch sprites.\r\n         *\r\n         * @member {SpriteRenderer}\r\n         */\r\n        this.spriteRenderer = new SpriteRenderer(renderer);\r\n    }\r\n\r\n    /**\r\n     * Returns true if the entity is eligible to the system, false otherwise.\r\n     *\r\n     * @param {Entity} entity - The entity to test.\r\n     * @return {boolean} True if entity should be included.\r\n     */\r\n    test(entity)\r\n    {\r\n        return entity.hasComponents(\r\n            ecs.VisibilityComponent,    // whether or not to render\r\n            TransformComponent,         // where to render\r\n            TextureComponent,           // what to render\r\n            SpriteComponent             // how to render\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Render a sprite using the batching SpriteRenderer.\r\n     *\r\n     * @param {Entity} sprite - The entity to render.\r\n     */\r\n    update(sprite)\r\n    {\r\n        if (!sprite.visible) return;\r\n\r\n        this.renderer.setActiveObjectRenderer(this.spriteRenderer);\r\n\r\n        const clean = !sprite._anchorDirty && sprite._cachedTransformUpdateId === sprite.transform._worldUpdateId;\r\n\r\n        if (sprite._texture.ready && !clean)\r\n        {\r\n            calculateVertices(sprite);\r\n            sprite._cachedTransformUpdateId = sprite.transform._worldUpdateId;\r\n            sprite._anchorDirty = false;\r\n        }\r\n\r\n        this.spriteRenderer.render(sprite);\r\n    }\r\n}\r\n\r\nrender.Renderer.addDefaultSystem(SpriteRenderSystem);\r\n\r\n/**\r\n * Updates the vertices of the entity.\r\n *\r\n * @ignore\r\n * @param {Entity} sprite - The sprite to update.\r\n */\r\nfunction calculateVertices(sprite)\r\n{\r\n    // set the vertex data\r\n    const wt = sprite.transform.worldTransform;\r\n    const a = wt.a;\r\n    const b = wt.b;\r\n    const c = wt.c;\r\n    const d = wt.d;\r\n    const tx = wt.tx;\r\n    const ty = wt.ty;\r\n    const vertexData = sprite.vertexData;\r\n    const trim = sprite._texture.trim;\r\n    const orig = sprite._texture.orig;\r\n\r\n    let w0;\r\n    let w1;\r\n    let h0;\r\n    let h1;\r\n\r\n    if (trim)\r\n    {\r\n        // if the sprite is trimmed then we need to add the extra space\r\n        // before transforming the sprite coords.\r\n        w1 = trim.x - (sprite._anchorX * orig.width);\r\n        w0 = w1 + trim.width;\r\n\r\n        h1 = trim.y - (sprite._anchorY * orig.height);\r\n        h0 = h1 + trim.height;\r\n    }\r\n    else\r\n    {\r\n        w0 = (orig.width) * (1 - sprite._anchorX);\r\n        w1 = (orig.width) * -sprite._anchorX;\r\n\r\n        h0 = orig.height * (1 - sprite._anchorY);\r\n        h1 = orig.height * -sprite._anchorY;\r\n    }\r\n\r\n    // xy\r\n    vertexData[0] = (a * w1) + (c * h1) + tx;\r\n    vertexData[1] = (d * h1) + (b * w1) + ty;\r\n\r\n    // xy\r\n    vertexData[2] = (a * w0) + (c * h1) + tx;\r\n    vertexData[3] = (d * h1) + (b * w0) + ty;\r\n\r\n    // xy\r\n    vertexData[4] = (a * w0) + (c * h0) + tx;\r\n    vertexData[5] = (d * h0) + (b * w0) + ty;\r\n\r\n    // xy\r\n    vertexData[6] = (a * w1) + (c * h0) + tx;\r\n    vertexData[7] = (d * h0) + (b * w1) + ty;\r\n}\r\n\r\n/**\r\n * @static\r\n * @constant\r\n * @member {number}\r\n * @default 1000\r\n */\r\nSpriteRenderSystem.defaultPriority = ecs.System.PRIORITY.RENDER;\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/sprites/src/SpriteRenderSystem.js\n **/","/** @namespace text-canvas */\r\n\r\nexport { default as CanvasTextWriter } from './CanvasTextWriter';\r\nexport { default as CanvasTextStyle } from './CanvasTextStyle';\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/text-canvas/src/index.js\n **/","import CanvasTextStyle from './CanvasTextStyle';\r\n\r\n// TODO: Add append methods\r\n\r\nconst rgxNewline = /\\r\\n|\\r|\\n/;\r\n\r\n/**\r\n * @class\r\n * @memberof text-canvas\r\n */\r\nexport default class CanvasTextWriter\r\n{\r\n    /**\r\n     * @param {HTMLCanvasElement} canvas - optional canvas to write to.\r\n     * @param {boolean} autoSize - When set the writer will automatically resize the\r\n     *  canvas as needed. It defaults to `true` if you do not pass in a canvas element\r\n     *  and `false` if you do pass in a canvas element.\r\n     */\r\n    constructor(canvas = null, autoSize = !canvas)\r\n    {\r\n        /**\r\n         * The canvas element that everything is drawn to.\r\n         *\r\n         * @member {HTMLCanvasElement}\r\n         */\r\n        this.canvas = canvas || document.createElement('canvas');\r\n\r\n        /**\r\n         * Should we resize the canvas when drawing to it?\r\n         *\r\n         * @member {boolean}\r\n         */\r\n        this.autoSize = autoSize;\r\n\r\n        /**\r\n         * The canvas 2d context that everything is drawn with.\r\n         *\r\n         * @private\r\n         * @member {CanvasRenderingContext2D}\r\n         */\r\n        this._textCtx = this.canvas.getContext('2d');\r\n    }\r\n\r\n    /**\r\n     * Draws the text to the canvas.\r\n     *\r\n     * @param {string} text - The text to write.\r\n     * @param {CanvasTextStyle} style - The style to draw the text with.\r\n     */\r\n    write(text, style = CanvasTextWriter.defaultStyle)\r\n    {\r\n        const ctx = this._textCtx;\r\n        const outputText = style.wordWrap ? this._wordWrap(text) : text;\r\n        const lines = outputText.split(rgxNewline);\r\n\r\n        // setup context\r\n        ctx.font = style.getFontString();\r\n        ctx.strokeStyle = style.stroke;\r\n        ctx.lineWidth = style.strokeThickness;\r\n        ctx.textBaseline = style.textBaseline;\r\n        ctx.lineJoin = style.lineJoin;\r\n        ctx.miterLimit = style.miterLimit;\r\n        ctx.fillStyle = style.getFillStyle(lines.length);\r\n        ctx.shadowBlur = style.shadowBlur;\r\n        ctx.shadowColor = style.shadowColor;\r\n        ctx.shadowOffsetX = style.shadowOffsetX;\r\n        ctx.shadowOffsetY = style.shadowOffsetY;\r\n\r\n        // calculate text width\r\n        const lineWidths = new Array(lines.length);\r\n        const fontProperties = this._determineFontProperties(ctx.font);\r\n        let maxLineWidth = 0;\r\n\r\n        // calculate line widths\r\n        for (let i = 0; i < lines.length; ++i)\r\n        {\r\n            const lineWidth = ctx.measureText(lines[i]).width + ((lines[i].length - 1) * style.letterSpacing);\r\n\r\n            lineWidths[i] = lineWidth;\r\n            maxLineWidth = Math.max(maxLineWidth, lineWidth);\r\n        }\r\n\r\n        const dsSize = style.dropShadow ? style.dropShadowDistance : 0;\r\n        const padd = (style.strokeThickness + style.padding) * 2;\r\n\r\n        // calculate width necessary for canvas\r\n        if (this.autoSize)\r\n        {\r\n            const width = maxLineWidth + dsSize + padd;\r\n\r\n            this.canvas.width = Math.ceil(width /* * this.resolution */);\r\n        }\r\n\r\n        // calculate height necessary for canvas\r\n        const fntLineHeight = dsSize + fontProperties.fontSize + padd;\r\n        const lineHeight = style.lineHeight ? style.lineHeight + padd : fntLineHeight;\r\n\r\n        if (this.autoSize)\r\n        {\r\n            const height = Math.max(lineHeight, fntLineHeight) + ((lines.length - 1) * lineHeight);\r\n\r\n            this.canvas.height = Math.ceil(height /* * this.resolution*/);\r\n        }\r\n\r\n        // clear and prepare for new text\r\n        // ctx.scale(this.resolution, this.resolution);\r\n        ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\r\n\r\n        let linePositionX = 0;\r\n        let linePositionY = 0;\r\n\r\n        // draw lines line by line\r\n        for (let i = 0; i < lines.length; ++i)\r\n        {\r\n            linePositionX = style.strokeThickness / 2;\r\n            linePositionY = ((style.strokeThickness / 2) + (i * lineHeight)) + fontProperties.ascent;\r\n\r\n            if (style.align === 'right')\r\n            {\r\n                linePositionX += maxLineWidth - lineWidths[i];\r\n            }\r\n            else if (style.align === 'center')\r\n            {\r\n                linePositionX += (maxLineWidth - lineWidths[i]) / 2;\r\n            }\r\n\r\n            if (style.stroke && style.strokeThickness)\r\n            {\r\n                this._drawText(lines[i], linePositionX + style.padding, linePositionY + style.padding, true);\r\n            }\r\n\r\n            if (style.fillStyle)\r\n            {\r\n                this._drawText(lines[i], linePositionX + style.padding, linePositionY + style.padding);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Destroys this text object.\r\n     */\r\n    destroy()\r\n    {\r\n        this._textCtx = null;\r\n        this.canvas = null;\r\n\r\n        this.style = null;\r\n    }\r\n\r\n    /**\r\n     * Calculates the ascent, descent and fontSize of a given fontStyle\r\n     *\r\n     * @private\r\n     * @param {string} fontStyle - String representing the style of the font\r\n     * @return {Object} Font properties object\r\n     */\r\n    _determineFontProperties(fontStyle)\r\n    {\r\n        if (CanvasTextWriter.fontPropertiesCache[fontStyle])\r\n        {\r\n            return CanvasTextWriter.fontPropertiesCache[fontStyle];\r\n        }\r\n\r\n        const properties = CanvasTextWriter.fontPropertiesCache[fontStyle];\r\n\r\n        // initialize if necessary\r\n        if (!CanvasTextWriter.fontPropertiesCanvas)\r\n        {\r\n            CanvasTextWriter.fontPropertiesCanvas = document.createElement('canvas');\r\n            CanvasTextWriter.fontPropertiesContext = CanvasTextWriter.fontPropertiesCanvas.getContext('2d');\r\n        }\r\n\r\n        const canvas = CanvasTextWriter.fontPropertiesCanvas;\r\n        const context = CanvasTextWriter.fontPropertiesContext;\r\n        const testText = '|Mqg';\r\n\r\n        context.textBaseline = 'alphabetic';\r\n        context.fillStyle = '#000';\r\n        context.font = fontStyle;\r\n\r\n        const width = Math.ceil(context.measureText(testText).width);\r\n        const mwidth = Math.ceil(context.measureText('M').width);\r\n        const baseline = Math.ceil(mwidth * 1.5);\r\n        const height = 2 * mwidth;\r\n\r\n        canvas.width = width;\r\n        canvas.height = height;\r\n\r\n        context.fillStyle = '#f00';\r\n        context.fillRect(0, 0, width, height);\r\n        context.fillText(testText, 0, baseline);\r\n\r\n        const imagedata = context.getImageData(0, 0, width, height).data;\r\n        const maxX = width * 4;\r\n\r\n        let y = 0;\r\n        let x = 0;\r\n\r\n        // ascent. scan from top to bottom until we find a non red pixel\r\n        ascent:\r\n        for (y = 0; y < baseline; ++y)\r\n        {\r\n            for (x = 0; x < maxX; x += 4)\r\n            {\r\n                if (imagedata[(y * maxX) + x] !== 255)\r\n                {\r\n                    break ascent;\r\n                }\r\n            }\r\n        }\r\n\r\n        properties.ascent = baseline - y;\r\n\r\n        // descent. scan from bottom to top until we find a non red pixel\r\n        descent:\r\n        for (y = height; y > baseline; --y)\r\n        {\r\n            for (x = 0; x < maxX; x += 4)\r\n            {\r\n                if (imagedata[(y * maxX) + x] !== 255)\r\n                {\r\n                    break descent;\r\n                }\r\n            }\r\n        }\r\n\r\n        properties.descent = y - baseline;\r\n        properties.fontSize = properties.ascent + properties.descent;\r\n\r\n        return properties;\r\n    }\r\n\r\n    /**\r\n     * Adds line breaks to text.\r\n     *\r\n     * @private\r\n     * @param {string} text - The text to wrap.\r\n     * @return {string} The wrapped text.\r\n     */\r\n    _wordWrap(text)\r\n    {\r\n        // Greedy wrapping algorithm that will wrap words as the line grows longer than its horizontal bounds.\r\n        const lines = text.split('\\n');\r\n        const wordWrapWidth = this.style.wordWrapWidth;\r\n        let result = '';\r\n\r\n        for (let i = 0; i < lines.length; i++)\r\n        {\r\n            const words = lines[i].split(' ');\r\n            let spaceLeft = wordWrapWidth;\r\n\r\n            for (let j = 0; j < words.length; j++)\r\n            {\r\n                const wordWidth = this._textCtx.measureText(words[j]).width;\r\n\r\n                if (this.style.breakWords && wordWidth > wordWrapWidth)\r\n                {\r\n                    // Word should be split in the middle\r\n                    const characters = words[j].split('');\r\n\r\n                    for (let c = 0; c < characters.length; c++)\r\n                    {\r\n                        const characterWidth = this._textCtx.measureText(characters[c]).width;\r\n\r\n                        if (characterWidth > spaceLeft)\r\n                        {\r\n                            result += `\\n${characters[c]}`;\r\n                            spaceLeft = wordWrapWidth - characterWidth;\r\n                        }\r\n                        else\r\n                        {\r\n                            result += `${c === 0 ? ' ' : ''}${characters[c]}`;\r\n                            spaceLeft -= characterWidth;\r\n                        }\r\n                    }\r\n                }\r\n                else\r\n                {\r\n                    const wordWidthWithSpace = wordWidth + this._textCtx.measureText(' ').width;\r\n\r\n                    if (j === 0 || wordWidthWithSpace > spaceLeft)\r\n                    {\r\n                        // Skip printing the newline if it's the first word of the line that is\r\n                        // greater than the word wrap width.\r\n                        result += `${j > 9 ? '\\n' : ''}${words[j]}`;\r\n                        spaceLeft = wordWrapWidth - wordWidth;\r\n                    }\r\n                    else\r\n                    {\r\n                        result += ` ${words[j]}`;\r\n                        spaceLeft -= wordWidthWithSpace;\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (i < lines.length - 1)\r\n            {\r\n                result += '\\n';\r\n            }\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * Render the text to the canvas\r\n     *\r\n     * @private\r\n     * @param {string} text - The text to draw\r\n     * @param {number} x - Horizontal position to draw the text\r\n     * @param {number} y - Vertical position to draw the text\r\n     * @param {boolean} isStroke - Is this draw for the stroke or the fill?\r\n     */\r\n    _drawText(text, x, y, isStroke)\r\n    {\r\n        const style = this.style;\r\n        const letterSpacing = style.letterSpacing;\r\n\r\n        // normal font-based letter spacing\r\n        if (letterSpacing === 0)\r\n        {\r\n            if (isStroke)\r\n            {\r\n                this._textCtx.strokeText(text, x, y);\r\n            }\r\n            else\r\n            {\r\n                this._textCtx.fillText(text, x, y);\r\n            }\r\n        }\r\n        else\r\n        {\r\n            // user-specified letter-spacing\r\n            const characters = text.split('');\r\n\r\n            for (let i = 0; i < characters.length; ++i)\r\n            {\r\n                const char = characters[i];\r\n\r\n                if (isStroke)\r\n                {\r\n                    this._textCtx.strokeText(char, x, y);\r\n                }\r\n                else\r\n                {\r\n                    this._textCtx.fillText(char, x, y);\r\n                }\r\n\r\n                x += this._textCtx.measureText(char).width + letterSpacing;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nCanvasTextWriter.defaultStyle = new CanvasTextStyle();\r\n\r\nCanvasTextWriter.fontPropertiesCache = {};\r\nCanvasTextWriter.fontPropertiesCanvas = null;\r\nCanvasTextWriter.fontPropertiesContext = null;\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/text-canvas/src/CanvasTextWriter.js\n **/","import assign from 'core-js/fn/object/assign';\r\n\r\n/**\r\n * @class\r\n * @memberof text-canvas\r\n */\r\nexport default class CanvasTextStyle\r\n{\r\n    /**\r\n     * @param {*} style - The style parameters. This object can contain any property of the\r\n     *  CanvasTextStyle class to override the default.\r\n     */\r\n    constructor(style = {})\r\n    {\r\n        /**\r\n         * Alignment for multiline text ('left', 'center' or 'right'), does not affect single line text.\r\n         *\r\n         * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/textAlign\r\n         *\r\n         * @member {string}\r\n         * @default 'left'\r\n         */\r\n        this.align = 'left';\r\n\r\n        /**\r\n         * Indicates if lines can be wrapped within words, it needs wordWrap to be set to true.\r\n         *\r\n         * @member {boolean}\r\n         * @default false\r\n         */\r\n        this.breakWords = false;\r\n\r\n        /**\r\n         * Blur radius of the drop shadow\r\n         *\r\n         * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/shadowBlur\r\n         *\r\n         * @member {number}\r\n         * @default 0\r\n         */\r\n        this.shadowBlur = 0;\r\n\r\n        /**\r\n         * Fill style of the drop shadow e.g 'red', '#00FF00'.\r\n         *\r\n         * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/shadowColor\r\n         *\r\n         * @member {string}\r\n         * @default '#000000'\r\n         */\r\n        this.shadowColor = '#000000';\r\n\r\n        /**\r\n         * X offset of the shadow of the drop shadow.\r\n         *\r\n         * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/shadowOffsetX\r\n         *\r\n         * @member {number}\r\n         * @default 0\r\n         */\r\n        this.shadowOffsetX = 0;\r\n\r\n        /**\r\n         * Y offset of the shadow of the drop shadow.\r\n         *\r\n         * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/shadowOffsetY\r\n         *\r\n         * @member {number}\r\n         * @default 0\r\n         */\r\n        this.shadowOffsetY = 0;\r\n\r\n        /**\r\n         * A canvas fillstyle that will be used on the text e.g 'red', '#00FF00'. Can be an array\r\n         * to create a gradient eg ['#000000','#FFFFFF'].\r\n         *\r\n         * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/fillStyle\r\n         *\r\n         * @member {string|string[]|CanvasGradient|CanvasPattern}\r\n         * @default 'black'\r\n         */\r\n        this.fillStyle = 'black';\r\n\r\n        /**\r\n         * If fills styles are supplied, this can change the type/direction of the gradient.\r\n         * True is vertical, false is horizontal.\r\n         *\r\n         * @member {boolean}\r\n         * @default true\r\n         */\r\n        this.fillGradientVertical = true;\r\n\r\n        /**\r\n         * The font family to use.\r\n         *\r\n         * @member {string}\r\n         * @default 'Arial'\r\n         */\r\n        this.fontFamily = 'Arial';\r\n\r\n        /**\r\n         * The font size (as a number it converts to px, but as a string, equivalents are\r\n         * '26px','20pt','160%' or '1.6em')\r\n         *\r\n         * @member {number|string}\r\n         * @default 26\r\n         */\r\n        this.fontSize = 26;\r\n\r\n        /**\r\n         * The font style ('normal', 'italic' or 'oblique')\r\n         *\r\n         * @member {string}\r\n         * @default 'normal'\r\n         */\r\n        this.fontStyle = 'normal';\r\n\r\n        /**\r\n         * The font variant ('normal' or 'small-caps')\r\n         *\r\n         * @member {string}\r\n         * @default 'normal'\r\n         */\r\n        this.fontVariant = 'normal';\r\n\r\n        /**\r\n         * The font weight ('normal', 'bold', 'bolder', 'lighter' and '100', '200',\r\n         * '300', '400', '500', '600', '700', 800' or '900')\r\n         *\r\n         * @member {string}\r\n         * @default 'normal'\r\n         */\r\n        this.fontWeight = 'normal';\r\n\r\n        /**\r\n         * The amount of spacing between letters.\r\n         *\r\n         * @member {number}\r\n         * @default 0\r\n         */\r\n        this.letterSpacing = 0;\r\n\r\n        /**\r\n         * The line height, a number that represents the vertical space that a letter uses.\r\n         *\r\n         * @member {number}\r\n         * @default 0\r\n         */\r\n        this.lineHeight = 0;\r\n\r\n        /**\r\n         * The lineJoin property sets the type of corner created, it can resolve spiked text issues.\r\n         * Valid values are 'bevel', 'round', or 'miter'.\r\n         *\r\n         * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/lineJoin\r\n         *\r\n         * @member {string}\r\n         * @default 'miter'\r\n         */\r\n        this.lineJoin = 'miter';\r\n\r\n        /**\r\n         * The miter limit to use when using the 'miter' lineJoin mode. This can reduce or increase\r\n         * the spikiness of rendered text.\r\n         *\r\n         * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/miterLimit\r\n         *\r\n         * @member {number}\r\n         * @default 10\r\n         */\r\n        this.miterLimit = 10;\r\n\r\n        /**\r\n         * Occasionally some fonts are cropped on top or bottom. Adding some padding will prevent this\r\n         * from happening by adding padding to the top and bottom of text height.\r\n         *\r\n         * @member {number}\r\n         * @default 0\r\n         */\r\n        this.padding = 0;\r\n\r\n        /**\r\n         * A canvas fillstyle that will be used on the text stroke e.g 'blue', '#FCFF00'.\r\n         *\r\n         * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/strokeStyle\r\n         *\r\n         * @member {string}\r\n         * @default 'black'\r\n         */\r\n        this.stroke = 'black';\r\n\r\n        /**\r\n         * A number that represents the thickness of the stroke. Default is 0 (no stroke).\r\n         *\r\n         * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/lineWidth\r\n         *\r\n         * @member {number}\r\n         * @default 0\r\n         */\r\n        this.strokeThickness = 0;\r\n\r\n        /**\r\n         * The baseline of the text that is rendered.\r\n         * Valid values are \"top\" || \"hanging\" || \"middle\" || \"alphabetic\" || \"ideographic\" || \"bottom\"\r\n         *\r\n         * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/textBaseline\r\n         *\r\n         * @member {string}\r\n         * @default 'alphabetic'\r\n         */\r\n        this.textBaseline = 'alphabetic';\r\n\r\n        /**\r\n         * Indicates if word wrap should be used.\r\n         *\r\n         * @member {boolean}\r\n         * @default false\r\n         */\r\n        this.wordWrap = false;\r\n\r\n        /**\r\n         * The width at which text will wrap, it needs wordWrap to be set to true.\r\n         *\r\n         * @member {number}\r\n         * @default 100\r\n         */\r\n        this.wordWrapWidth = 100;\r\n\r\n        // override properties based on params\r\n        assign(this, style);\r\n    }\r\n\r\n    /**\r\n     * Creates a new CanvasTextStyle with the same values as this one.\r\n     *\r\n     * @return {CanvasTextStyle} The new style\r\n     */\r\n    clone()\r\n    {\r\n        return new CanvasTextStyle(this);\r\n    }\r\n\r\n    /**\r\n     * Builds a font style string for use with canvas, based on the properties of this style.\r\n     *\r\n     * @return {string} The font string.\r\n     */\r\n    getFontString()\r\n    {\r\n        const fontSizeString = (typeof this.fontSize === 'number') ? `${this.fontSize}px` : this.fontSize;\r\n\r\n        return `${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${fontSizeString} ${this.fontFamily}`;\r\n    }\r\n\r\n    /**\r\n     * Builds a fill style for use with canvas, based on the properties of this style.\r\n     *\r\n     * @param {number} numLines - The number of lines to split a vertical gradient over (if applicable).\r\n     * @return {string|CanvasGradient|CanvasPattern} The fill style.\r\n     */\r\n    getFillStyle(numLines /* , resolution*/)\r\n    {\r\n        if (!Array.isArray(this.fillStyle))\r\n        {\r\n            return this.fillStyle;\r\n        }\r\n\r\n        // the gradient will be evenly spaced out according to how large the array is.\r\n        // ['#FF0000', '#00FF00', '#0000FF'] would created stops at 0.25, 0.5 and 0.75\r\n\r\n        const width = this.canvas.width;// / this.resolution;\r\n        const height = this.canvas.height;// / this.resolution;\r\n\r\n        // create the canvas gradient\r\n        let gradient = null;\r\n\r\n        if (this.fillGradientVertical)\r\n        {\r\n            // start the gradient at the top center of the canvas, and end at the bottom middle of the canvas\r\n            gradient = this.context.createLinearGradient(width / 2, 0, width / 2, height);\r\n        }\r\n        else\r\n        {\r\n            gradient = this.context.createLinearGradient(0, height / 2, width, height / 2);\r\n        }\r\n\r\n        // create each of the color stops\r\n        const numFills = this.fillStyle.length;\r\n        const totalStops = (numFills + 1) * (this.fillGradientVertical ? numLines : 1);\r\n\r\n        for (let i = 0; i < totalStops; ++i)\r\n        {\r\n            gradient.addColorStop((i + 1) / totalStops, this.fillStyle[i % numFills]);\r\n        }\r\n\r\n        return gradient;\r\n    }\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./plugins/text-canvas/src/CanvasTextStyle.js\n **/","require('../../modules/es6.object.assign');\nmodule.exports = require('../../modules/_core').Object.assign;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/core-js/fn/object/assign.js\n ** module id = 85\n ** module chunks = 0\n **/","// 19.1.3.1 Object.assign(target, source)\nvar $export = require('./_export');\n\n$export($export.S + $export.F, 'Object', {assign: require('./_object-assign')});\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/core-js/modules/es6.object.assign.js\n ** module id = 86\n ** module chunks = 0\n **/","var global    = require('./_global')\n  , core      = require('./_core')\n  , hide      = require('./_hide')\n  , redefine  = require('./_redefine')\n  , ctx       = require('./_ctx')\n  , PROTOTYPE = 'prototype';\n\nvar $export = function(type, name, source){\n  var IS_FORCED = type & $export.F\n    , IS_GLOBAL = type & $export.G\n    , IS_STATIC = type & $export.S\n    , IS_PROTO  = type & $export.P\n    , IS_BIND   = type & $export.B\n    , target    = IS_GLOBAL ? global : IS_STATIC ? global[name] || (global[name] = {}) : (global[name] || {})[PROTOTYPE]\n    , exports   = IS_GLOBAL ? core : core[name] || (core[name] = {})\n    , expProto  = exports[PROTOTYPE] || (exports[PROTOTYPE] = {})\n    , key, own, out, exp;\n  if(IS_GLOBAL)source = name;\n  for(key in source){\n    // contains in native\n    own = !IS_FORCED && target && target[key] !== undefined;\n    // export native or passed\n    out = (own ? target : source)[key];\n    // bind timers to global for call from export context\n    exp = IS_BIND && own ? ctx(out, global) : IS_PROTO && typeof out == 'function' ? ctx(Function.call, out) : out;\n    // extend global\n    if(target)redefine(target, key, out, type & $export.U);\n    // export\n    if(exports[key] != out)hide(exports, key, exp);\n    if(IS_PROTO && expProto[key] != out)expProto[key] = out;\n  }\n};\nglobal.core = core;\n// type bitmap\n$export.F = 1;   // forced\n$export.G = 2;   // global\n$export.S = 4;   // static\n$export.P = 8;   // proto\n$export.B = 16;  // bind\n$export.W = 32;  // wrap\n$export.U = 64;  // safe\n$export.R = 128; // real proto method for `library` \nmodule.exports = $export;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/core-js/modules/_export.js\n ** module id = 87\n ** module chunks = 0\n **/","// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028\nvar global = module.exports = typeof window != 'undefined' && window.Math == Math\n  ? window : typeof self != 'undefined' && self.Math == Math ? self : Function('return this')();\nif(typeof __g == 'number')__g = global; // eslint-disable-line no-undef\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/core-js/modules/_global.js\n ** module id = 88\n ** module chunks = 0\n **/","var core = module.exports = {version: '2.4.0'};\nif(typeof __e == 'number')__e = core; // eslint-disable-line no-undef\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/core-js/modules/_core.js\n ** module id = 89\n ** module chunks = 0\n **/","var dP         = require('./_object-dp')\n  , createDesc = require('./_property-desc');\nmodule.exports = require('./_descriptors') ? function(object, key, value){\n  return dP.f(object, key, createDesc(1, value));\n} : function(object, key, value){\n  object[key] = value;\n  return object;\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/core-js/modules/_hide.js\n ** module id = 90\n ** module chunks = 0\n **/","var anObject       = require('./_an-object')\n  , IE8_DOM_DEFINE = require('./_ie8-dom-define')\n  , toPrimitive    = require('./_to-primitive')\n  , dP             = Object.defineProperty;\n\nexports.f = require('./_descriptors') ? Object.defineProperty : function defineProperty(O, P, Attributes){\n  anObject(O);\n  P = toPrimitive(P, true);\n  anObject(Attributes);\n  if(IE8_DOM_DEFINE)try {\n    return dP(O, P, Attributes);\n  } catch(e){ /* empty */ }\n  if('get' in Attributes || 'set' in Attributes)throw TypeError('Accessors not supported!');\n  if('value' in Attributes)O[P] = Attributes.value;\n  return O;\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/core-js/modules/_object-dp.js\n ** module id = 91\n ** module chunks = 0\n **/","var isObject = require('./_is-object');\nmodule.exports = function(it){\n  if(!isObject(it))throw TypeError(it + ' is not an object!');\n  return it;\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/core-js/modules/_an-object.js\n ** module id = 92\n ** module chunks = 0\n **/","module.exports = function(it){\n  return typeof it === 'object' ? it !== null : typeof it === 'function';\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/core-js/modules/_is-object.js\n ** module id = 93\n ** module chunks = 0\n **/","module.exports = !require('./_descriptors') && !require('./_fails')(function(){\n  return Object.defineProperty(require('./_dom-create')('div'), 'a', {get: function(){ return 7; }}).a != 7;\n});\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/core-js/modules/_ie8-dom-define.js\n ** module id = 94\n ** module chunks = 0\n **/","// Thank's IE8 for his funny defineProperty\nmodule.exports = !require('./_fails')(function(){\n  return Object.defineProperty({}, 'a', {get: function(){ return 7; }}).a != 7;\n});\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/core-js/modules/_descriptors.js\n ** module id = 95\n ** module chunks = 0\n **/","module.exports = function(exec){\n  try {\n    return !!exec();\n  } catch(e){\n    return true;\n  }\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/core-js/modules/_fails.js\n ** module id = 96\n ** module chunks = 0\n **/","var isObject = require('./_is-object')\n  , document = require('./_global').document\n  // in old IE typeof document.createElement is 'object'\n  , is = isObject(document) && isObject(document.createElement);\nmodule.exports = function(it){\n  return is ? document.createElement(it) : {};\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/core-js/modules/_dom-create.js\n ** module id = 97\n ** module chunks = 0\n **/","// 7.1.1 ToPrimitive(input [, PreferredType])\nvar isObject = require('./_is-object');\n// instead of the ES6 spec version, we didn't implement @@toPrimitive case\n// and the second argument - flag - preferred type is a string\nmodule.exports = function(it, S){\n  if(!isObject(it))return it;\n  var fn, val;\n  if(S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it)))return val;\n  if(typeof (fn = it.valueOf) == 'function' && !isObject(val = fn.call(it)))return val;\n  if(!S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it)))return val;\n  throw TypeError(\"Can't convert object to primitive value\");\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/core-js/modules/_to-primitive.js\n ** module id = 98\n ** module chunks = 0\n **/","module.exports = function(bitmap, value){\n  return {\n    enumerable  : !(bitmap & 1),\n    configurable: !(bitmap & 2),\n    writable    : !(bitmap & 4),\n    value       : value\n  };\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/core-js/modules/_property-desc.js\n ** module id = 99\n ** module chunks = 0\n **/","var global    = require('./_global')\n  , hide      = require('./_hide')\n  , has       = require('./_has')\n  , SRC       = require('./_uid')('src')\n  , TO_STRING = 'toString'\n  , $toString = Function[TO_STRING]\n  , TPL       = ('' + $toString).split(TO_STRING);\n\nrequire('./_core').inspectSource = function(it){\n  return $toString.call(it);\n};\n\n(module.exports = function(O, key, val, safe){\n  var isFunction = typeof val == 'function';\n  if(isFunction)has(val, 'name') || hide(val, 'name', key);\n  if(O[key] === val)return;\n  if(isFunction)has(val, SRC) || hide(val, SRC, O[key] ? '' + O[key] : TPL.join(String(key)));\n  if(O === global){\n    O[key] = val;\n  } else {\n    if(!safe){\n      delete O[key];\n      hide(O, key, val);\n    } else {\n      if(O[key])O[key] = val;\n      else hide(O, key, val);\n    }\n  }\n// add fake Function#toString for correct work wrapped methods / constructors with methods like LoDash isNative\n})(Function.prototype, TO_STRING, function toString(){\n  return typeof this == 'function' && this[SRC] || $toString.call(this);\n});\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/core-js/modules/_redefine.js\n ** module id = 100\n ** module chunks = 0\n **/","var hasOwnProperty = {}.hasOwnProperty;\nmodule.exports = function(it, key){\n  return hasOwnProperty.call(it, key);\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/core-js/modules/_has.js\n ** module id = 101\n ** module chunks = 0\n **/","var id = 0\n  , px = Math.random();\nmodule.exports = function(key){\n  return 'Symbol('.concat(key === undefined ? '' : key, ')_', (++id + px).toString(36));\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/core-js/modules/_uid.js\n ** module id = 102\n ** module chunks = 0\n **/","// optional / simple context binding\nvar aFunction = require('./_a-function');\nmodule.exports = function(fn, that, length){\n  aFunction(fn);\n  if(that === undefined)return fn;\n  switch(length){\n    case 1: return function(a){\n      return fn.call(that, a);\n    };\n    case 2: return function(a, b){\n      return fn.call(that, a, b);\n    };\n    case 3: return function(a, b, c){\n      return fn.call(that, a, b, c);\n    };\n  }\n  return function(/* ...args */){\n    return fn.apply(that, arguments);\n  };\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/core-js/modules/_ctx.js\n ** module id = 103\n ** module chunks = 0\n **/","module.exports = function(it){\n  if(typeof it != 'function')throw TypeError(it + ' is not a function!');\n  return it;\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/core-js/modules/_a-function.js\n ** module id = 104\n ** module chunks = 0\n **/","'use strict';\n// 19.1.2.1 Object.assign(target, source, ...)\nvar getKeys  = require('./_object-keys')\n  , gOPS     = require('./_object-gops')\n  , pIE      = require('./_object-pie')\n  , toObject = require('./_to-object')\n  , IObject  = require('./_iobject')\n  , $assign  = Object.assign;\n\n// should work with symbols and should have deterministic property order (V8 bug)\nmodule.exports = !$assign || require('./_fails')(function(){\n  var A = {}\n    , B = {}\n    , S = Symbol()\n    , K = 'abcdefghijklmnopqrst';\n  A[S] = 7;\n  K.split('').forEach(function(k){ B[k] = k; });\n  return $assign({}, A)[S] != 7 || Object.keys($assign({}, B)).join('') != K;\n}) ? function assign(target, source){ // eslint-disable-line no-unused-vars\n  var T     = toObject(target)\n    , aLen  = arguments.length\n    , index = 1\n    , getSymbols = gOPS.f\n    , isEnum     = pIE.f;\n  while(aLen > index){\n    var S      = IObject(arguments[index++])\n      , keys   = getSymbols ? getKeys(S).concat(getSymbols(S)) : getKeys(S)\n      , length = keys.length\n      , j      = 0\n      , key;\n    while(length > j)if(isEnum.call(S, key = keys[j++]))T[key] = S[key];\n  } return T;\n} : $assign;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/core-js/modules/_object-assign.js\n ** module id = 105\n ** module chunks = 0\n **/","// 19.1.2.14 / 15.2.3.14 Object.keys(O)\nvar $keys       = require('./_object-keys-internal')\n  , enumBugKeys = require('./_enum-bug-keys');\n\nmodule.exports = Object.keys || function keys(O){\n  return $keys(O, enumBugKeys);\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/core-js/modules/_object-keys.js\n ** module id = 106\n ** module chunks = 0\n **/","var has          = require('./_has')\n  , toIObject    = require('./_to-iobject')\n  , arrayIndexOf = require('./_array-includes')(false)\n  , IE_PROTO     = require('./_shared-key')('IE_PROTO');\n\nmodule.exports = function(object, names){\n  var O      = toIObject(object)\n    , i      = 0\n    , result = []\n    , key;\n  for(key in O)if(key != IE_PROTO)has(O, key) && result.push(key);\n  // Don't enum bug & hidden keys\n  while(names.length > i)if(has(O, key = names[i++])){\n    ~arrayIndexOf(result, key) || result.push(key);\n  }\n  return result;\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/core-js/modules/_object-keys-internal.js\n ** module id = 107\n ** module chunks = 0\n **/","// to indexed object, toObject with fallback for non-array-like ES3 strings\nvar IObject = require('./_iobject')\n  , defined = require('./_defined');\nmodule.exports = function(it){\n  return IObject(defined(it));\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/core-js/modules/_to-iobject.js\n ** module id = 108\n ** module chunks = 0\n **/","// fallback for non-array-like ES3 and non-enumerable old V8 strings\nvar cof = require('./_cof');\nmodule.exports = Object('z').propertyIsEnumerable(0) ? Object : function(it){\n  return cof(it) == 'String' ? it.split('') : Object(it);\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/core-js/modules/_iobject.js\n ** module id = 109\n ** module chunks = 0\n **/","var toString = {}.toString;\n\nmodule.exports = function(it){\n  return toString.call(it).slice(8, -1);\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/core-js/modules/_cof.js\n ** module id = 110\n ** module chunks = 0\n **/","// 7.2.1 RequireObjectCoercible(argument)\nmodule.exports = function(it){\n  if(it == undefined)throw TypeError(\"Can't call method on  \" + it);\n  return it;\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/core-js/modules/_defined.js\n ** module id = 111\n ** module chunks = 0\n **/","// false -> Array#indexOf\n// true  -> Array#includes\nvar toIObject = require('./_to-iobject')\n  , toLength  = require('./_to-length')\n  , toIndex   = require('./_to-index');\nmodule.exports = function(IS_INCLUDES){\n  return function($this, el, fromIndex){\n    var O      = toIObject($this)\n      , length = toLength(O.length)\n      , index  = toIndex(fromIndex, length)\n      , value;\n    // Array#includes uses SameValueZero equality algorithm\n    if(IS_INCLUDES && el != el)while(length > index){\n      value = O[index++];\n      if(value != value)return true;\n    // Array#toIndex ignores holes, Array#includes - not\n    } else for(;length > index; index++)if(IS_INCLUDES || index in O){\n      if(O[index] === el)return IS_INCLUDES || index || 0;\n    } return !IS_INCLUDES && -1;\n  };\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/core-js/modules/_array-includes.js\n ** module id = 112\n ** module chunks = 0\n **/","// 7.1.15 ToLength\nvar toInteger = require('./_to-integer')\n  , min       = Math.min;\nmodule.exports = function(it){\n  return it > 0 ? min(toInteger(it), 0x1fffffffffffff) : 0; // pow(2, 53) - 1 == 9007199254740991\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/core-js/modules/_to-length.js\n ** module id = 113\n ** module chunks = 0\n **/","// 7.1.4 ToInteger\nvar ceil  = Math.ceil\n  , floor = Math.floor;\nmodule.exports = function(it){\n  return isNaN(it = +it) ? 0 : (it > 0 ? floor : ceil)(it);\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/core-js/modules/_to-integer.js\n ** module id = 114\n ** module chunks = 0\n **/","var toInteger = require('./_to-integer')\n  , max       = Math.max\n  , min       = Math.min;\nmodule.exports = function(index, length){\n  index = toInteger(index);\n  return index < 0 ? max(index + length, 0) : min(index, length);\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/core-js/modules/_to-index.js\n ** module id = 115\n ** module chunks = 0\n **/","var shared = require('./_shared')('keys')\n  , uid    = require('./_uid');\nmodule.exports = function(key){\n  return shared[key] || (shared[key] = uid(key));\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/core-js/modules/_shared-key.js\n ** module id = 116\n ** module chunks = 0\n **/","var global = require('./_global')\n  , SHARED = '__core-js_shared__'\n  , store  = global[SHARED] || (global[SHARED] = {});\nmodule.exports = function(key){\n  return store[key] || (store[key] = {});\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/core-js/modules/_shared.js\n ** module id = 117\n ** module chunks = 0\n **/","// IE 8- don't enum bug keys\nmodule.exports = (\n  'constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf'\n).split(',');\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/core-js/modules/_enum-bug-keys.js\n ** module id = 118\n ** module chunks = 0\n **/","exports.f = Object.getOwnPropertySymbols;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/core-js/modules/_object-gops.js\n ** module id = 119\n ** module chunks = 0\n **/","exports.f = {}.propertyIsEnumerable;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/core-js/modules/_object-pie.js\n ** module id = 120\n ** module chunks = 0\n **/","// 7.1.13 ToObject(argument)\nvar defined = require('./_defined');\nmodule.exports = function(it){\n  return Object(defined(it));\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/core-js/modules/_to-object.js\n ** module id = 121\n ** module chunks = 0\n **/"],"sourceRoot":""}